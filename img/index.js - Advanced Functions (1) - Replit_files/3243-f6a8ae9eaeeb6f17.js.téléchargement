"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3243,6808],{81979:function(e,t,n){var r=n(67294).createContext({activeFile:null,users:[],annotations:[],generalThread:void 0,onRequestCloseThread:function(){},handleFinalizeMessage:function(){},handleChangeMessage:function(){},setResolvedAnnotation:function(){},createAnnotationAnchorPlaceholder:function(){},markAllMessagesInReplAsSeenByUser:function(){},jumpToThread:function(){}});t.Z=r},65632:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(35944),i=n(60536),a=n.n(i),o=(n(67294),n(94184)),c=n.n(o);function s(e){var t=e.unreadDot,n=e.size,i=void 0===n?12:n,o=e.count,s=void 0===o?null:o,l=s&&s>99,u=l?"99+":null===s||void 0===s?void 0:s.toString();return(0,r.BX)("span",{className:"jsx-1c7f3b9066c4c334",children:[(0,r.tZ)("svg",{width:i,height:i,viewBox:"0 0 24 24",fill:"none",style:{color:"currentColor"},xmlns:"http://www.w3.org/2000/svg",className:"jsx-1c7f3b9066c4c334",children:(0,r.tZ)("path",{d:"M21 15C21 15.5304 20.7893 16.0391 20.4142 16.4142C20.0391 16.7893 19.5304 17 19 17H7L3 21V5C3 4.46957 3.21071 3.96086 3.58579 3.58579C3.96086 3.21071 4.46957 3 5 3H19C19.5304 3 20.0391 3.21071 20.4142 3.58579C20.7893 3.96086 21 4.46957 21 5V15Z",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",className:"jsx-1c7f3b9066c4c334"})}),t&&(0,r.tZ)("div",{className:"jsx-1c7f3b9066c4c334 unread-indicator"}),Boolean(s)&&(0,r.tZ)("div",{className:"jsx-1c7f3b9066c4c334 "+(c()("count",{overflow:l})||""),children:u}),(0,r.tZ)(a(),{id:"1c7f3b9066c4c334",children:"span.jsx-1c7f3b9066c4c334{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex}.unread-indicator.jsx-1c7f3b9066c4c334{width:5px;height:5px;-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:10px;background-color:var(--accent-red-default);-webkit-transform:translate(8px,-1px);-moz-transform:translate(8px,-1px);-ms-transform:translate(8px,-1px);-o-transform:translate(8px,-1px);transform:translate(8px,-1px);position:absolute}.count.jsx-1c7f3b9066c4c334{-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:10px;background-color:var(--accent-negative-default);-webkit-transform:translate(50%,-50%);-moz-transform:translate(50%,-50%);-ms-transform:translate(50%,-50%);-o-transform:translate(50%,-50%);transform:translate(50%,-50%);position:absolute;min-width:16px;padding:2px 3px;height:16px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;color:white;font-size:var(--font-size-small)}.overflow.jsx-1c7f3b9066c4c334{-webkit-transform:translate(25%,-50%);-moz-transform:translate(25%,-50%);-ms-transform:translate(25%,-50%);-o-transform:translate(25%,-50%);transform:translate(25%,-50%)}"})]})}},23038:function(e,t,n){n.d(t,{ZP:function(){return Z}});var r=n(35944),i=n(60536),a=n.n(i),o=n(67294),c=n(93604),s=n(35977),l=n(28898),u=n(9583);function d(e){var t=e.message,n=e.messageStyle,i=o.useMemo((function(){return"TextMessageContentType"===t.content.__typename?(0,u.kW)(t.content.text,{}):"PreviewMessageContentType"===t.content.__typename&&"string"===typeof t.content.preview?(0,u.kW)(t.content.preview,{}):null}),[t.content]),c="PreviewMessageContentType"===t.content.__typename&&"string"!==typeof t.content.preview;return t.user&&(i||c)?(0,r.BX)("div",{className:"jsx-e1dab5bcce309da6 "+(n||""),children:[(0,r.BX)("div",{className:"jsx-e1dab5bcce309da6 message",children:[i&&(0,r.tZ)(u.YI,{message:i,codeStyles:{color:"var(--accent-orange-stronger)",background:"var(--background-highest)"}}),c&&(0,r.BX)("span",{className:"jsx-e1dab5bcce309da6 typing-indicator",children:[(0,r.tZ)("span",{className:"jsx-e1dab5bcce309da6 dot"}),(0,r.tZ)("span",{className:"jsx-e1dab5bcce309da6 dot"}),(0,r.tZ)("span",{className:"jsx-e1dab5bcce309da6 dot"})]})]}),(0,r.tZ)(a(),{id:"e1dab5bcce309da6",children:".message.jsx-e1dab5bcce309da6{background:var(--background-higher);padding:var(--space-4)var(--space-8);-webkit-border-radius:var(--border-radius-8);-moz-border-radius:var(--border-radius-8);border-radius:var(--border-radius-8);font-size:var(--font-size-default);overflow-wrap:break-word;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;max-width:100%;white-space:pre-wrap}.userhighlight.jsx-e1dab5bcce309da6 .message.jsx-e1dab5bcce309da6{background:transparent}.typing-indicator.jsx-e1dab5bcce309da6{min-height:1em;display:grid;grid-auto-flow:column;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;grid-gap:var(--space-8)}.dot.jsx-e1dab5bcce309da6{width:6px;height:6px;-webkit-border-radius:6px;-moz-border-radius:6px;border-radius:6px;display:inline-block;background-color:var(--foreground-dimmest);-webkit-animation:pulse.6s infinite;-moz-animation:pulse.6s infinite;-o-animation:pulse.6s infinite;animation:pulse.6s infinite}.dot.jsx-e1dab5bcce309da6:nth-child(1){-webkit-animation-delay:0s;-moz-animation-delay:0s;-o-animation-delay:0s;animation-delay:0s}.dot.jsx-e1dab5bcce309da6:nth-child(2){-webkit-animation-delay:.2s;-moz-animation-delay:.2s;-o-animation-delay:.2s;animation-delay:.2s}.dot.jsx-e1dab5bcce309da6:nth-child(3){-webkit-animation-delay:.4s;-moz-animation-delay:.4s;-o-animation-delay:.4s;animation-delay:.4s}@-webkit-keyframes pulse{0%{background-color:var(--foreground-dimmest)}50%{background-color:var(--foreground-dimmest)}100%{background-color:var(--foreground-dimmest)}}@-moz-keyframes pulse{0%{background-color:var(--foreground-dimmest)}50%{background-color:var(--foreground-dimmest)}100%{background-color:var(--foreground-dimmest)}}@-o-keyframes pulse{0%{background-color:var(--foreground-dimmest)}50%{background-color:var(--foreground-dimmest)}100%{background-color:var(--foreground-dimmest)}}@keyframes pulse{0%{background-color:var(--foreground-dimmest)}50%{background-color:var(--foreground-dimmest)}100%{background-color:var(--foreground-dimmest)}}"})]}):null}var f=n(17847),p=n(44781),h=n(88075),m=n(19526);function v(e){var t=e.message,n=o.useMemo((function(){var e=t.timeCreated;return e?(0,f.Z)(new Date(e),"do MMM, hh:mm a"):""}),[t]),i=t.user;return(0,r.tZ)("div",{className:"resolved-message",children:(0,r.BX)(m.Ug,{align:"center",spacing:1,children:[i&&(0,r.tZ)(l.Z,{url:i.image,size:"m"}),(0,r.tZ)(h.Z,{color:"var(--foreground-default)",size:24}),(0,r.BX)(p.Z,{size:"xsmall",children:["Resolved ",n]})]})})}function g(e){var t=e.message,n=o.useMemo((function(){var e=t.timeCreated;return e?(0,f.Z)(new Date(e),"do MMM, hh:mm a"):""}),[t]),i=t.user;return(0,r.tZ)("div",{className:"resolved-message",children:(0,r.BX)(m.Ug,{align:"center",spacing:1,children:[i&&(0,r.tZ)(l.Z,{url:i.image,size:"m"}),(0,r.tZ)(h.Z,{size:24,color:"var(--foreground-dimmest)"}),(0,r.BX)(p.Z,{size:"xsmall",children:["Unresolved ",n]})]})})}var b=function(e){var t=new Date(e),n=new Date;return(0,s.Z)(n,t)<60?"now":(0,c.F)(t,!0)};function x(e){var t=e.messageGroup,n=t.messages,i=t.user,o=t.timeCreated;return i?(0,r.BX)("div",{className:"jsx-3469fc8bae278840 message-group",children:[(0,r.BX)("div",{className:"jsx-3469fc8bae278840 message-info",children:[(0,r.tZ)("div",{className:"jsx-3469fc8bae278840 avatar",children:(0,r.tZ)(l.Z,{url:i.image,size:"xs",style:{minHeight:"15px",minWidth:"15px",height:"15px",width:"15px"}})}),(0,r.tZ)("div",{className:"jsx-3469fc8bae278840 username",children:i.username}),(0,r.tZ)("div",{className:"jsx-3469fc8bae278840 time",children:b(o)})]}),(0,r.tZ)("div",{className:"jsx-3469fc8bae278840 messages",children:n.map((function(e){return(0,r.tZ)(d,{message:e},e.id)}))}),(0,r.tZ)(a(),{id:"3469fc8bae278840",children:".message-group.jsx-3469fc8bae278840{background-color:var(--background-default);color:var(--foreground-default);display:grid;position:relative;grid-template-rows:auto auto;grid-row-gap:var(--space-8);grid-template-columns:minmax(0,1fr)}.message-info.jsx-3469fc8bae278840{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;font-size:var(--font-size-small)}.messages.jsx-3469fc8bae278840{display:grid;grid-row-gap:var(--space-4);grid-template-columns:minmax(0,1fr)}.avatar.jsx-3469fc8bae278840{margin-right:5px}.username.jsx-3469fc8bae278840{color:var(--foreground-dimmer);font-weight:var(--font-weight-medium);margin-right:3px}.time.jsx-3469fc8bae278840{color:var(--foreground-dimmest)}"})]}):null}function Z(e){var t=e.messageGroup;if("TextMessageContentType"===t.messageType||"PreviewMessageContentType"===t.messageType)return(0,r.tZ)(x,{messageGroup:t});if("StatusMessageContentType"===t.messageType){var n=t.messages[0];if("StatusMessageContentType"===n.content.__typename&&"resolved"===n.content.status)return(0,r.tZ)(v,{message:n});if("StatusMessageContentType"===n.content.__typename&&"unresolved"===n.content.status)return(0,r.tZ)(g,{message:n})}return null}},27184:function(e,t,n){n.d(t,{Z:function(){return N}});var r=n(47568),i=n(26042),a=n(69396),o=n(10253),c=n(34051),s=n.n(c),l=n(35944),u=n(67294),d=n(60536),f=n.n(d),p=n(35642),h=n(94184),m=n.n(h),v=n(96594),g=n(71171),b=n.n(g),x=n(28898),Z=n(86292),y=n(2666),w=n(7297),k=n(31230),E=n(46829);function S(){var e=(0,w.Z)(["\n  query AnnotationThreadInput {\n    currentUser {\n      id\n    }\n  }\n"]);return S=function(){return e},e}var C={},T=(0,k.ZP)(S());var R=n(18332),_=n(16449),I=n(30827),P=n(65975),D=n(25245),A=u.forwardRef((function(e,t){var n,c,d=e.annote,h=e.placeholder,g=e.onChangeMessage,w=e.onFinalizeMessage,k=function(){""!==N.trim()&&(w({messageId:M||b()(),message:N.trim()}),z(null),U(""),setTimeout(H),(0,Z.j)(Z.U3.CONVERSATION_MESSAGE_SENT,{threadMessagesCount:d.messages.length,otherThreadParticipantsCount:re.length,anchorId:d.id}))},S=null===(n=function(e){var t=(0,i.Z)({},C,e);return E.useQuery(T,t)}().data)||void 0===n||null===(c=n.currentUser)||void 0===c?void 0:c.id,A=(0,o.Z)(u.useState(""),2),N=A[0],U=A[1],j=(0,o.Z)(u.useState(!1),2),B=j[0],O=j[1],G=u.useRef(null),L=(0,o.Z)(u.useState(null),2),M=L[0],z=L[1],F=(0,I.Z)(),X=(0,_.Z)(),W=X.ref,H=X.update,V=(0,o.Z)((0,R.Z)({"@":function(){var e=(0,r.Z)(s().mark((function e(t){var n,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=F.filter((function(e){return e.id!==S})),t&&(r=t.toLowerCase(),n=n.filter((function(e){return e.username.toLowerCase().startsWith(r)}))),e.abrupt("return",n.slice(0,5).map((function(e){return{icon:(0,l.tZ)(x.Z,{url:e.image,style:{height:"24px",width:"24px",minWidth:"24px",minHeight:"24px"}}),value:e.username}})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),2),$=V[0].suggestions,q=V[1],Q=(0,v.Kb)({items:(null===$||void 0===$?void 0:$.results)||[],defaultHighlightedIndex:0,isOpen:Boolean(null===$||void 0===$?void 0:$.results.length),onSelectedItemChange:function(e){var t=e.selectedItem;if($&&t){var n=$.applySuggestion({targetValue:N,suggestionValue:t.value}),r=n.fullValue,i=n.cursorIndex;U(r),setTimeout((function(){G.current&&(G.current.setSelectionRange(i,i),G.current.focus(),H())}))}}}),K=Q.isOpen,Y=Q.getInputProps,J=Q.getMenuProps,ee=Q.getItemProps,te=Q.highlightedIndex,ne=Q.getComboboxProps;u.useEffect((function(){var e="threads/drafts/".concat(d.id),t=p.Z.get(e,"string");t&&U(t);var n=G.current;return function(){if(n){var t=n.value;0!==t.length?p.Z.set(e,t):p.Z.remove(e)}}}),[]),u.useEffect((function(){setTimeout((function(){G.current&&G.current.focus()}))}),[G]);var re=(0,y.Z)(d).filter((function(e){return e.id!==S})),ie="Add a comment";return 1===re.length?ie="Reply to @".concat(re[0].username):re.length>1&&(ie="Reply"),d.isResolved&&(ie="Reply to unresolve this thread"),h&&(ie=h),(0,l.BX)("div",{className:"jsx-83fb19ea8f375c79",children:[(0,l.BX)("div",(0,a.Z)((0,i.Z)({},ne()),{className:"jsx-83fb19ea8f375c79 input-group",children:[(0,l.tZ)("textarea",(0,a.Z)((0,i.Z)({},Y({autoFocus:!0,placeholder:ie,value:N,onCompositionStart:function(){return O(!0)},onCompositionEnd:function(){return O(!1)},onChange:function(e){var t=e.target.value,n=M||b()();M||z(n),U(t),g({messageId:n,message:t})},onKeyDown:function(e){e.stopPropagation(),K||(e.nativeEvent.preventDownshiftDefault=!0,"Enter"!==e.key||e.shiftKey||B||(e.preventDefault(),k()))},rows:1,ref:function(e){G.current=e,t&&"object"===typeof t&&(t.current=e),q(e),W(e)}})),{className:"jsx-83fb19ea8f375c79 "+(m()("inputbox",{hasContent:N.length>0})||"")})),(0,l.tZ)(P.hU,{alt:"Send message",onClick:k,disabled:0===N.length,children:(0,l.tZ)(D.Z,{})})]})),(0,l.tZ)("div",(0,a.Z)((0,i.Z)({},J({})),{className:"jsx-83fb19ea8f375c79",children:K&&(0,l.tZ)("div",{className:"jsx-83fb19ea8f375c79 mention-suggestions-container",children:$.results.map((function(e,t){return(0,u.createElement)("div",(0,a.Z)((0,i.Z)({},ee({item:e,index:t})),{key:e.value,className:"jsx-83fb19ea8f375c79 "+(m()("mention-suggestion",{selected:te===t})||""),children:[e.icon,(0,l.tZ)("div",{className:"jsx-83fb19ea8f375c79",children:e.value})]}))}))})})),(0,l.tZ)(f(),{id:"83fb19ea8f375c79",children:'.input-group.jsx-83fb19ea8f375c79{display:grid;grid-template-columns:1fr -webkit-min-content;grid-template-columns:1fr min-content;grid-gap:10px;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:start;-webkit-justify-content:start;-moz-box-pack:start;-ms-flex-pack:start;justify-content:start}.inputbox.jsx-83fb19ea8f375c79{background:var(--background-higher);color:var(--foreground-default);border:none;-webkit-border-radius:var(--border-radius-8);-moz-border-radius:var(--border-radius-8);border-radius:var(--border-radius-8);padding:var(--space-8);outline:none;resize:none;font-family:"IBM Plex Sans",sans-serif;font-size:var(--font-size-default);line-height:16px;overflow-y:auto;max-height:-webkit-calc(var(--font-size-default)*18);max-height:-moz-calc(var(--font-size-default)*18);max-height:calc(var(--font-size-default)*18)}.inputbox.jsx-83fb19ea8f375c79::-webkit-input-placeholder{white-space:pre}.inputbox.jsx-83fb19ea8f375c79:-moz-placeholder{white-space:pre}.inputbox.jsx-83fb19ea8f375c79::-moz-placeholder{white-space:pre}.inputbox.jsx-83fb19ea8f375c79:-ms-input-placeholder{white-space:pre}.inputbox.jsx-83fb19ea8f375c79::-ms-input-placeholder{white-space:pre}.inputbox.jsx-83fb19ea8f375c79::placeholder{white-space:pre}.inputbox.hasContent.jsx-83fb19ea8f375c79{-webkit-border-radius:6px;-moz-border-radius:6px;border-radius:6px}.mention-suggestions-container.jsx-83fb19ea8f375c79{padding-top:1em;display:grid;grid-row-gap:var(--space-4);overflow:hidden}.mention-suggestion.jsx-83fb19ea8f375c79{display:grid;grid-template-columns:-webkit-min-content -webkit-max-content;grid-template-columns:min-content max-content;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;grid-column-gap:var(--space-8);padding:var(--space-8)0;cursor:pointer;color:var(--foreground-default)}.mention-suggestion.selected.jsx-83fb19ea8f375c79{background-color:var(--background-root)}.mention-suggestion.selected.jsx-83fb19ea8f375c79>*.jsx-83fb19ea8f375c79{-webkit-transform:scale(1.1);-moz-transform:scale(1.1);-ms-transform:scale(1.1);-o-transform:scale(1.1);transform:scale(1.1)}'})]})}));A.displayName="ThreadInputForwarded";var N=A},6801:function(e,t,n){n.d(t,{AS:function(){return C},Hj:function(){return D},Rp:function(){return R},Tt:function(){return N},gE:function(){return I},ig:function(){return j},j7:function(){return w},xT:function(){return E},yi:function(){return k}});var r=n(26042),i=n(7297),a=n(31230),o=n(46829);function c(){var e=(0,i.Z)(["\n  fragment AnnotationsUser on User {\n    id\n    username\n    image\n  }\n"]);return c=function(){return e},e}function s(){var e=(0,i.Z)(["\n  fragment AnnotationMessageContent on MessageContentType {\n    __typename\n    ... on TextMessageContentType {\n      text\n    }\n    ... on PreviewMessageContentType {\n      preview\n    }\n    ... on StatusMessageContentType {\n      status\n    }\n  }\n"]);return s=function(){return e},e}function l(){var e=(0,i.Z)(["\n  fragment AnnotationsUIMessage on AnnotationMessage {\n    id\n    user {\n      id\n      ...AnnotationsUser\n    }\n    anchor {\n      id\n    }\n    timeCreated\n    content {\n      __typename\n      ...AnnotationMessageContent\n    }\n    currentUserIsAuthor\n    seen\n  }\n  ","\n  ","\n"]);return l=function(){return e},e}function u(){var e=(0,i.Z)(["\n  fragment AnnotationsUIAnchor on AnnotationAnchor {\n    id\n    user {\n      id\n      ...AnnotationsUser\n    }\n    path\n    otVersion\n    indexStart\n    indexEnd\n    isResolved\n    isGeneral\n    messages {\n      id\n      ...AnnotationsUIMessage\n    }\n  }\n  ","\n  ","\n"]);return u=function(){return e},e}function d(){var e=(0,i.Z)(["\n  query AnnotationAnchorsByRepl($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        annotationAnchors {\n          id\n          ...AnnotationsUIAnchor\n        }\n      }\n    }\n    currentUser {\n      id\n      username\n      image\n    }\n  }\n  ","\n"]);return d=function(){return e},e}function f(){var e=(0,i.Z)(["\n  mutation CreateAnnotationAnchor(\n    $annotationAnchor: AnnotationAnchorInput!\n    $annotationMessage: AnnotationMessageInput\n    $highlight: AnnotationHighlightInput\n  ) {\n    createAnnotationAnchor(\n      annotationAnchor: $annotationAnchor\n      annotationMessage: $annotationMessage\n      highlight: $highlight\n    ) {\n      ... on UserError {\n        message\n      }\n      ... on AnnotationAnchor {\n        id\n        ...AnnotationsUIAnchor\n      }\n    }\n  }\n  ","\n"]);return f=function(){return e},e}function p(){var e=(0,i.Z)(["\n  mutation UpdateAnnotationAnchor(\n    $id: String!\n    $changes: AnnotationAnchorChangesInput!\n  ) {\n    updateAnnotationAnchor(id: $id, changes: $changes) {\n      ... on UserError {\n        message\n      }\n      ... on AnnotationAnchor {\n        id\n        ...AnnotationsUIAnchor\n      }\n    }\n  }\n  ","\n"]);return p=function(){return e},e}function h(){var e=(0,i.Z)(["\n  mutation CreateAnnotationMessage(\n    $replId: String!\n    $anchorId: String!\n    $annotationMessage: AnnotationMessageInput!\n    $highlight: AnnotationHighlightInput\n  ) {\n    createAnnotationMessage(\n      replId: $replId\n      anchorId: $anchorId\n      annotationMessage: $annotationMessage\n      highlight: $highlight\n    ) {\n      ... on UserError {\n        message\n      }\n      ... on AnnotationAnchor {\n        id\n        ...AnnotationsUIAnchor\n      }\n    }\n  }\n  ","\n"]);return h=function(){return e},e}function m(){var e=(0,i.Z)(["\n  mutation updateThreadPreview(\n    $threadId: String!\n    $messageId: String!\n    $message: String\n  ) {\n    updateThreadPreview(\n      threadId: $threadId\n      messageId: $messageId\n      message: $message\n    )\n  }\n"]);return m=function(){return e},e}function v(){var e=(0,i.Z)(["\n  subscription AnnotationUpdates($replId: String!) {\n    updatedAnnotation: annotationUpdatesByRepl(replId: $replId) {\n      id\n      ...AnnotationsUIAnchor\n    }\n  }\n  ","\n"]);return v=function(){return e},e}function g(){var e=(0,i.Z)(["\n  subscription MessagePreview($threadId: String!) {\n    threadPreview(threadId: $threadId) {\n      userId\n      messageId\n      message\n    }\n  }\n"]);return g=function(){return e},e}var b={},x=(0,a.ZP)(c()),Z=(0,a.ZP)(s()),y=(0,a.ZP)(l(),x,Z),w=(0,a.ZP)(u(),x,y),k=(0,a.ZP)(d(),w);function E(e){var t=(0,r.Z)({},b,e);return o.useQuery(k,t)}var S=(0,a.ZP)(f(),w);function C(e){var t=(0,r.Z)({},b,e);return o.useMutation(S,t)}var T=(0,a.ZP)(p(),w);function R(e){var t=(0,r.Z)({},b,e);return o.useMutation(T,t)}var _=(0,a.ZP)(h(),w);function I(e){var t=(0,r.Z)({},b,e);return o.useMutation(_,t)}var P=(0,a.ZP)(m());function D(e){var t=(0,r.Z)({},b,e);return o.useMutation(P,t)}var A=(0,a.ZP)(v(),w);function N(e){var t=(0,r.Z)({},b,e);return o.useSubscription(A,t)}var U=(0,a.ZP)(g());function j(e){var t=(0,r.Z)({},b,e);return o.useSubscription(U,t)}},2666:function(e,t){t.Z=function(e){var t={},n=!0,r=!1,i=void 0;try{for(var a,o=e.messages[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var c=a.value;c.user&&(t[c.user.id]=c.user)}}catch(s){r=!0,i=s}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return Object.values(t)}},7842:function(e,t,n){n.d(t,{Z:function(){return i}});var r=["TextMessageContentType","PreviewMessageContentType"];function i(e){var t=[],n=null,i=!0,a=!1,o=void 0;try{for(var c,s=e[Symbol.iterator]();!(i=(c=s.next()).done);i=!0){var l,u,d,f,p=c.value;if(!n||(null===p||void 0===p||null===(l=p.user)||void 0===l?void 0:l.id)!==(null===n||void 0===n||null===(u=n.user)||void 0===u?void 0:u.id)||(null===p||void 0===p||null===(d=p.anchor)||void 0===d?void 0:d.id)!==(null===n||void 0===n?void 0:n.anchorId)||!r.includes(n.messageType)||!r.includes(p.content.__typename)||new Date(p.timeCreated).getTime()-new Date(n.timeCreated).getTime()>6e5)n&&t.push(n),n={user:p.user,timeCreated:p.timeCreated,anchorId:null===p||void 0===p||null===(f=p.anchor)||void 0===f?void 0:f.id,messages:[p],messageType:p.content.__typename};else n.messages.push(p)}}catch(h){a=!0,o=h}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}return n&&t.push(n),t}},49630:function(e,t,n){n.d(t,{Ft:function(){return h},Vy:function(){return g},kL:function(){return v}});var r=n(47568),i=n(10253),a=n(34051),o=n.n(a),c=n(67294),s=n(92876),l=n(78120),u=n(86292);function d(e,t,n){return f.apply(this,arguments)}function f(){return(f=(0,r.Z)(o().mark((function e(t,n,r){var i,a,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.path&&"number"===typeof t.indexStart&&"number"===typeof t.indexEnd&&t.otVersion){e.next=2;break}return e.abrupt("return");case 2:if(r!==t.otVersion){e.next=4;break}return e.abrupt("return",{path:t.path,indexStart:t.indexStart,indexEnd:t.indexEnd,otVersion:t.otVersion});case 4:return i=window.performance.now(),a=function(){(0,u.j)(u.U3.ANNOTATION_FASTFORWARDED,{opCount:r-t.otVersion,anchorId:t.id,flagPid1Fastforwards:!0,time:window.performance.now()-i})},e.next=8,n({indexStart:t.indexStart,indexEnd:t.indexEnd,versionFrom:t.otVersion,versionTo:r});case 8:return c=e.sent,a(),e.abrupt("return",{path:t.path,indexStart:c.indexStart,indexEnd:c.indexEnd,otVersion:r});case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var p=n(99408);function h(e){return m.apply(this,arguments)}function m(){return(m=(0,r.Z)(o().mark((function e(t){var n,r,i,a,c,u,f;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.anchor,r=t.version,i=t.transformSelection,a=t.content,n.path){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,d(n,i,r);case 5:if(c=e.sent){e.next=8;break}return e.abrupt("return",null);case 8:return u=function(){if(c){var e=c.indexStart,t=c.indexEnd;try{var n=l.xv.of(a.split("\n")),r=n.lineAt(e),i=n.lineAt(t),o=n.sliceString(n.line(Math.max(r.number-2,1)).from,e),u=n.sliceString(t,n.line(Math.min(i.number+2,n.lines)).to);return{precode:o,code:n.sliceString(e,t),postcode:u}}catch(d){s.Tb(d)}}},f=function(){try{for(var e=l.xv.of(a.split("\n")),t=e.lineAt(c.indexStart),n=e.lineAt(c.indexEnd),r=[],i=t.number===n.number?Math.max(0,t.number-1):t.number,o=Math.min(e.lines,n.number+1),u=i;u<=o;u++)r.push(e.line(u).text);return{startLineNumber:i,lines:r}}catch(d){s.Tb(d)}},e.abrupt("return",{anchor:n,newSelection:c,newPosition:undefined,getHighlight:u,getSnippet:f});case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){var t=(0,p.Z)().fs,n=c.useRef(null),r=c.useRef(null),a=(0,i.Z)(c.useState(!1),2),o=a[0],s=a[1];return c.useEffect((function(){if(e){var i=function(){r.current=null,s(!1)},a=t.watchOtFile(e,{onReady:function(e){var t=e.transformSelection,i=e.initialContent;n.current=i.toString(),r.current=t,s(!0)},onMoveOrDelete:function(){i()},onError:function(){i()},onChange:function(e){var t=e.latestContent;n.current=t}});return function(){i(),a()}}}),[e,t]),{contentRef:n,transformSelectionRef:r,loadedFile:o}}function g(e){var t=(0,p.Z)().fs,n=(0,i.Z)(c.useState(null),2),r=n[0],a=n[1],o=v(null===e||void 0===e?void 0:e.path),s=o.contentRef,l=o.loadedFile,u=o.transformSelectionRef;return c.useEffect((function(){(null===e||void 0===e?void 0:e.path)&&l&&u.current&&null!==s.current&&h({anchor:e,version:t.getOTVersion(e.path),transformSelection:u.current,content:s.current}).then((function(e){a(e)})).catch((function(){a(null)}))}),[t,e,l]),r}},20934:function(e,t,n){n.d(t,{Q:function(){return a},c:function(){return i}});var r=n(91131),i=(0,r.cn)(!1),a=(0,r.cn)(null)},36764:function(e,t,n){n.d(t,{n:function(){return u}});var r=n(26042),i=n(7297),a=n(31230),o=n(46829);function c(){var e=(0,i.Z)(["\n  mutation MarkMessagesAsSeen(\n    $replId: String!\n    $threadId: String\n    $messageIds: [String!]\n  ) {\n    markMessagesAsSeen(\n      replId: $replId\n      threadId: $threadId\n      messageIds: $messageIds\n    ) {\n      ... on AnnotationMessageList {\n        messages {\n          id\n          seen\n        }\n      }\n    }\n  }\n"]);return c=function(){return e},e}var s={},l=(0,a.ZP)(c());function u(e){var t=(0,r.Z)({},s,e);return o.useMutation(l,t)}},83223:function(e,t,n){n.d(t,{Z:function(){return c}});var r=n(10253),i=n(67294),a=n(63377),o=n(36764);function c(e){var t=(0,a.Z)(),n=(0,r.Z)((0,o.n)(),1)[0];i.useEffect((function(){if(e){var r=e.messages.filter((function(e){return!e.seen})).map((function(e){return e.id}));0!==r.length&&n({variables:{replId:t,threadId:e.id,messageIds:r},optimisticResponse:{markMessagesAsSeen:{messages:r.map((function(e){return{id:e,seen:!0,__typename:"AnnotationMessage"}})),__typename:"AnnotationMessageList"}}})}}),[t,e,n])}},722:function(e,t,n){n.d(t,{Z:function(){return u}});var r=n(14924),i=n(26042),a=n(69396),o=n(10253),c=n(67294),s=n(6801),l=n(81979);function u(e){var t=c.useContext(l.Z).users,n=(0,o.Z)(c.useState({}),2),u=n[0],d=n[1],f=c.useRef(null),p=c.useCallback((function(){var e={};for(var t in u)Date.now()-u[t].time<1e3&&(e[t]=u[t]);d(e)}),[u,d]);return(0,s.ig)({variables:{threadId:e},onSubscriptionData:function(n){var o,c,s=n.subscriptionData;if(null===(o=s.data)||void 0===o?void 0:o.threadPreview){var l=null===(c=s.data)||void 0===c?void 0:c.threadPreview;if("number"===typeof l.userId){var u=new Date,h=u.toJSON();d((function(n){return(0,a.Z)((0,i.Z)({},n),(0,r.Z)({},l.userId,{time:u.getTime(),user:t.find((function(e){return e.id===l.userId})),id:l.messageId,currentUserIsAuthor:!1,timeCreated:h,timeUpdated:h,anchor:{id:e},content:{__typename:"PreviewMessageContentType",preview:l.message}}))})),f.current&&clearTimeout(f.current),f.current=setTimeout(p,2e3)}}},skip:!e}),c.useMemo((function(){return Object.values(u)}),[u])}},30827:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(26042),i=n(7297),a=n(31230),o=n(46829);function c(){var e=(0,i.Z)(["\n  query ThreadReplCollaborators($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        owner {\n          ... on User {\n            id\n            username\n            image\n          }\n          ... on Team {\n            id\n            username\n            image\n          }\n        }\n        permissions {\n          id\n          user {\n            id\n            username\n            image\n          }\n        }\n      }\n    }\n  }\n"]);return c=function(){return e},e}var s={},l=(0,a.ZP)(c());var u=n(63377);function d(){var e,t=function(e){var t=(0,r.Z)({},s,e);return o.useQuery(l,t)}({variables:{replId:(0,u.Z)()}}).data;if("Repl"!==(null===t||void 0===t?void 0:t.repl.__typename))return[];var n=[];(null===(e=t.repl.owner)||void 0===e?void 0:e.username)&&"User"===t.repl.owner.__typename&&n.push(t.repl.owner);var i=!0,a=!1,c=void 0;try{for(var d,f=t.repl.permissions[Symbol.iterator]();!(i=(d=f.next()).done);i=!0){var p,h=d.value;(null===(p=h.user)||void 0===p?void 0:p.username)&&n.push(h.user)}}catch(m){a=!0,c=m}finally{try{i||null==f.return||f.return()}finally{if(a)throw c}}return n}},90914:function(e,t,n){n.d(t,{R1:function(){return l},wB:function(){return u}});var r=n(26042),i=n(7297),a=n(31230),o=n(46829);function c(){var e=(0,i.Z)(["\n  query GenerateCode($input: GenerateCodeInput!) {\n    currentUser {\n      id\n      isAdmin: hasRole(role: ADMIN)\n    }\n    generateCode(input: $input) {\n      ... on GenerateCodeResult {\n        id\n        code\n        metadata\n      }\n      ... on UserError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n  }\n"]);return c=function(){return e},e}var s={},l=(0,a.ZP)(c());function u(e){var t=(0,r.Z)({},s,e);return o.useLazyQuery(l,t)}},39:function(e,t,n){n.d(t,{Sf:function(){return c},UP:function(){return s},eC:function(){return o}});var r=n(48551),i={js:"javascript",jsx:"javascript",ts:"typescript",tsx:"typescript",py:"python",go:"go"},a={rs:"rust",lsp:"lisp",sh:"bash",cpp:"c++",hs:"haskell",go:"go",rb:"ruby"};function o(e){if(!e)return!1;var t=(0,r.r6)(e);return Boolean(i[t])}function c(e){var t=(0,r.r6)(e);return i[t]?i[t]:a[t]?a[t]:t}function s(e){var t=(0,r.r6)(e);return i[t]?i[t]:"unknown"}},95984:function(e,t,n){n.d(t,{R$:function(){return te},Wo:function(){return J},D2:function(){return V},XZ:function(){return re},JJ:function(){return Y},sN:function(){return ae},ZP:function(){return ie},s3:function(){return ee}});var r=n(14924),i=n(26042),a=n(69396),o=n(10253),c=n(35944),s=n(67294),l=n(81255),u=n(1144),d=n(69346),f=n(17556),p=n(7286),h=n(87653),m=n(64080),v=n(88808),g=n(86514),b=n(75026),x=n(96659),Z=n(41034),y=n(8527),w=n(46702),k=n(93160),E=n(33279),S=n(43530),C=n(17713),T=n(87514),R=n(79688),_=n(92876),I=n(86292),P=n(44044),D=n(91674),A=n(55528),N=n(58823),U=n(99408),j=n(77365),B=n(29163),O=n(51995),G=n(8941),L=n(40381),M=n(41656),z=n(93058),F=n(15682),X=n(44676),W=n(37424);function H(e){var t=e.view,n=e.metadata,r=e.closeMenu,i=n.text,a=n.icon,f=(0,z.Z)().showError,p=s.useRef(!1),h=(0,o.Z)(s.useState(!1),2),m=h[0],v=h[1],g=(0,o.Z)(s.useState(null),2),b=g[0],x=g[1],Z=(0,U.Z)().fs,y=(0,L.Z)(),w=(0,A.Z)(y||""),k=(0,W.H)(),E=k("label"),S=k("menu"),C=s.useRef(null),T=(0,o.Z)((0,F.XZ)(C,!1),4),R=(T[0],T[1]),H=T[2],V=T[3];return(0,F.Ym)(R,C),s.useEffect((function(){if(w&&y&&m&&!p.current){var e=t.state,n=e.selection.main,r={start:(0,M.s)(e.doc,n.from),end:(0,M.s)(e.doc,n.to)};p.current=!0,w.request.codeActions(y,r).then((function(e){if((0,I.j)(I.U3.EDITOR_CONTEXT_MENU_CODE_ACTIONS_REQUESTED,{success:!("error"in e),numActions:"result"in e&&e.result?e.result.length:null}),"error"in e)return p.current=!1,x([]),f("Something went wrong fetching code actions"),void _.Tb(new Error(e.error.message));null!==e.result&&0!==e.result.length?x(e.result):x([])}))}}),[w,m,y,b,t,f]),(0,c.BX)(d.ZP,{tag:"li",onClick:function(e){e.stopPropagation(),v((function(e){return!e}))},children:[(0,c.BX)(d.ZP,{css:[P.gU.listItem,l.l0.p(8),l.l0.flex.row,l.l0.align.center],children:[a,(0,c.tZ)(d.ZP,{css:[l.l0.pl(8)],children:(0,c.tZ)(u.x,{id:E,children:i})}),(0,c.tZ)(d.ZP,{css:[l.l0.position.absolute,l.l0.right(4)],children:(0,c.tZ)(B.Z,{alt:"Toggle Code Actions",tooltipHidden:!0,"aria-expanded":m,"aria-controls":S,onClick:function(){V(),v((function(e){return!e}))},innerRef:C,onKeyDown:H,children:(0,c.tZ)(G.Z,{rotate:m?90:0,style:{transition:"200ms ease"}})})})]}),m&&!b?(0,c.BX)(d.ZP,{css:[l.l0.p(8),l.l0.flex.row,l.l0.align.center],children:[(0,c.tZ)(u.x,{color:"dimmer",children:"Loading actions..."}),(0,c.tZ)(d.ZP,{css:[l.l0.align.center,l.l0.justify.center,l.l0.position.absolute,l.l0.right(4),l.l0.width(24),l.l0.height(24)],children:(0,c.tZ)(j.Z,{})})]}):null,m&&b&&w?(0,c.BX)(d.ZP,{tag:"ul",role:"menubar","aria-orientation":"vertical","aria-labelledby":E,id:S,children:[b.map((function(e,t){return(0,c.tZ)(X.Z,{onClick:function(){if(D.Command.is(e))return w.request.executeCommand(e.command,e.arguments),void r();var t=e.edit,n=e.command;t&&(0,N.w)({edit:t,fs:Z,client:w}),n&&w.request.executeCommand(n.command,n.arguments),r()},children:(0,c.tZ)(d.ZP,{css:[P.gU.listItem,l.l0.p(8),l.l0.flex.row,l.l0.align.center],children:(0,c.BX)(d.ZP,{css:[l.l0.flex.row,l.l0.justify.spaceBetween,l.l0.width("100%")],children:[(0,c.tZ)(u.x,{css:[l.l0.maxWidth("90%")],children:e.title}),(0,c.tZ)(d.ZP,{tag:"span",children:(0,c.tZ)(O.Z,{size:12})})]})})},t)})),0===b.length?(0,c.tZ)(d.ZP,{css:[l.l0.p(8),l.l0.flex.row,l.l0.align.center],children:(0,c.tZ)(u.x,{color:"dimmer",children:"No actions available"})}):null]}):null]})}var V,$,q=n(77836),Q=n(7474),K=n(15085),Y="Divider";!function(e){e.Cut="Cut",e.Copy="Copy",e.Paste="Paste",e.JumpToDefinition="JumpToDefinition",e.JumpToTypeDefinition="JumpToTypeDefinition",e.JumpToImplementation="JumpToImplementation",e.FindReferences="FindReferences",e.Rename="Rename",e.SelectAllOccurrences="SelectAllOccurrences",e.CodeActions="CodeActions",e.CopyLinkToPos="CopyLinkToPos",e.ToggleBreakpoint="ToggleBreakpoint",e.StartThread="StartThread",e.ExplainCode="ExplainCode",e.GenerateCode="GenerateCode",e.TransformCode="TransformCode",e.SearchCode="SearchCode"}(V||(V={}));var J=($={},(0,r.Z)($,V.Cut,{text:"Cut",icon:(0,c.tZ)(x.Z,{}),keyboardShortcut:{cmdOrCtrlKey:!0,key:"X"}}),(0,r.Z)($,V.Copy,{text:"Copy",icon:(0,c.tZ)(Z.Z,{}),keyboardShortcut:{cmdOrCtrlKey:!0,key:"C"}}),(0,r.Z)($,V.Paste,{text:"Paste",icon:(0,c.tZ)(y.Z,{}),keyboardShortcut:{cmdOrCtrlKey:!0,key:"V"}}),(0,r.Z)($,V.JumpToDefinition,{text:"Jump to definition",icon:(0,c.tZ)(w.Z,{}),keyboardShortcut:{cmdOrCtrlKey:!0,key:"F12"}}),(0,r.Z)($,V.JumpToTypeDefinition,{text:"Jump to type definition",icon:(0,c.tZ)(T.Z,{})}),(0,r.Z)($,V.JumpToImplementation,{text:"Jump to implementation",icon:(0,c.tZ)(R.Z,{})}),(0,r.Z)($,V.FindReferences,{text:"Find references",icon:(0,c.tZ)(h.Z,{}),keyboardShortcut:{shiftKey:!0,key:"F12"}}),(0,r.Z)($,V.Rename,{text:"Rename all occurrences",icon:(0,c.tZ)(m.Z,{}),keyboardShortcut:{key:"F2"}}),(0,r.Z)($,V.SelectAllOccurrences,{text:"Select all occurrences",icon:(0,c.tZ)(p.Z,{}),keyboardShortcut:{key:"F2",cmdOrCtrlKey:!0}}),(0,r.Z)($,V.CodeActions,{text:"Code actions",icon:(0,c.tZ)(C.Z,{}),keyboardShortcut:{key:".",cmdOrCtrlKey:!0}}),(0,r.Z)($,V.CopyLinkToPos,{text:"Copy link to position",icon:(0,c.tZ)(v.Z,{})}),(0,r.Z)($,V.ToggleBreakpoint,{text:"Toggle breakpoint",icon:(0,c.tZ)(g.Z,{})}),(0,r.Z)($,V.StartThread,{text:"Start thread",icon:(0,c.tZ)(b.Z,{}),keyboardShortcut:{key:"/",altKey:!0}}),(0,r.Z)($,V.ExplainCode,{text:"Explain code",icon:(0,c.tZ)(S.Z,{})}),(0,r.Z)($,V.GenerateCode,{text:"Generate code",icon:(0,c.tZ)(q.Z,{}),keyboardShortcut:{key:"g",altKey:!0}}),(0,r.Z)($,V.TransformCode,{text:"Transform code",icon:(0,c.tZ)(Q.Z,{}),keyboardShortcut:{key:"t",altKey:!0}}),(0,r.Z)($,V.SearchCode,{text:"Search code",icon:(0,c.tZ)(h.Z,{})}),$);function ee(e){return e===Y}var te=35;function ne(e){var t=e.dom,n=e.verticalOffset,r=e.coords,i=r.x,a=r.y,o=t.getBoundingClientRect().bottom,c=document.documentElement.clientWidth;if(i+275>c&&(i=c-275-5),a+n>o){var s=a-n;return s<0?{x:i+5,y:0}:{x:i,y:s}}return{x:i,y:a}}function re(e){var t=e.view,n=e.coords,r=e.closeMenu,i=e.verticalOffset,a=e.children,u=e.width,p=void 0===u?275:u,h=t.dom,m=(0,f.Z)(r,[]),v=(0,o.Z)(s.useState((function(){return ne({dom:h,verticalOffset:i,coords:n})})),2),g=v[0],b=g.x,x=g.y,Z=v[1];return s.useEffect((function(){Z(ne({dom:h,verticalOffset:i,coords:n}))}),[n,i,h]),(0,c.tZ)(k.Z,{innerRef:m,background:"higher",className:"cm-custom-context-menu",css:[l.l0.position.fixed,l.l0.flex.column,l.l0.justify.center,l.l0.borderRadius(8),l.l0.shadow(1),l.l0.width(p),l.l0.zIndex(101),{border:"1px solid ".concat(l.TV.outlineDimmest)},{left:b,top:x}],children:(0,c.tZ)(K.ZP,{children:(0,c.tZ)(F.uP,{options:{direction:"vertical"},children:(0,c.tZ)(d.ZP,{tag:"ul",role:"menubar","aria-orientation":"vertical","aria-label":"Context",children:a})})})})}function ie(e){var t=e.view,n=e.closeMenu,r=e.actions,o=e.onAction,s=r.filter((function(e){switch(e){case V.TransformCode:return!t.state.selection.main.empty;case V.StartThread:return 0!==t.state.doc.length;default:return!0}})),l=s.map((function(e){return ee(e)?1:te})).reduce((function(e,t){return e+t}),0);return(0,c.tZ)(re,(0,a.Z)((0,i.Z)({verticalOffset:l},e),{children:s.map((function(e,i){return ee(e)?(0,c.tZ)(d.ZP,{css:[{borderBottom:"1px solid var(--background-highest)"}]},i):e===V.CodeActions?(0,c.tZ)(H,{view:t,closeMenu:n,metadata:J[e]},e):e===V.StartThread&&t.state.selection.main.from===t.state.doc.length?null:(0,c.tZ)(X.Z,{onClick:function(){o(e),n()},children:(0,c.tZ)(oe,{item:e,isFirst:0===i,isLast:i===r.length-1})},e)}))}))}function ae(e){var t=e.children,n=e.isFirst,r=e.isLast;return(0,c.tZ)(d.ZP,{css:[l.l0.p(8),l.l0.flex.row,l.l0.align.center,n&&{borderTopLeftRadius:4,borderTopRightRadius:4},r&&{borderBottomLeftRadius:4,borderBottomRightRadius:4}],children:t})}function oe(e){var t=e.item,n=e.isFirst,r=e.isLast,i=J[t],a=i.text,o=i.icon,s=i.keyboardShortcut;return(0,c.BX)(ae,{isFirst:n,isLast:r,children:[o,(0,c.tZ)(d.ZP,{css:[l.l0.px(8)],children:(0,c.tZ)(u.x,{children:a})}),s?(0,c.tZ)(d.ZP,{css:[l.l0.position.absolute,l.l0.right(4)],children:(0,c.tZ)(E.Z,{shortcut:s,small:!0,hideBorder:!0})}):null]})}},44676:function(e,t,n){var r=n(10253),i=n(35944),a=n(15682),o=n(65975),c=n(67294),s=(0,o.KD)("button");t.Z=function(e){var t=e.onClick,n=e.children,l=c.useRef(null),u=(0,r.Z)((0,a.XZ)(l,!1),4),d=u[0],f=u[1],p=u[2],h=u[3];return(0,a.Ym)(f,l),(0,i.tZ)(s,{ref:l,role:"menuitem",css:[o.l0.reset.button,o.gU.listItem],onClick:function(e){h(),t(e)},onKeyDown:p,tabIndex:d,children:n})}},65674:function(e,t,n){n.d(t,{_j:function(){return o},gm:function(){return u},yK:function(){return s},Gj:function(){return a},f3:function(){return d},fI:function(){return f},EE:function(){return p},ZF:function(){return h}});var r=n(10253),i=n(31557),a={regexp:/-?\b\d+\.?\d*\b/g,cursor:"ew-resize",onDrag:function(e,t,n){var r=Number(e)+n.movementX;isNaN(r)||t(r.toString())}},o={regexp:/true|false/g,cursor:"pointer",onClick:function(e,t){switch(e){case"true":return t("false");case"false":return t("true")}}};function c(e){var t=new RegExp("".concat(e,"\\(-?\\b\\d+\\.?\\d*\\b\\s*(,\\s*-?\\b\\d+\\.?\\d*\\b)?"),"g"),n=new RegExp("".concat(e,"\\((?<x>-?\\b\\d+\\.?\\d*\\b)\\s*(,\\s*(?<y>-?\\b\\d+\\.?\\d*\\b))?"));return{regexp:t,cursor:"move",onDrag:function(t,r,i){var a,o,c=n.exec(t),s=Number(null===c||void 0===c||null===(a=c.groups)||void 0===a?void 0:a.x),l=Number(null===c||void 0===c||null===(o=c.groups)||void 0===o?void 0:o.y);isNaN(s)||(isNaN(l)&&(l=s),r("".concat(e,"(").concat(s+i.movementX,", ").concat(l+i.movementY)))}}}var s=c("vec2");c("ellipse"),c("circle"),c("point"),c("rect"),c("square"),c("vertex");function l(e){var t=new RegExp("".concat(e,"\\(.*\\)"),"g"),n=new RegExp("".concat(e,"\\((?<r>\\d+)\\s*,\\s*(?<g>\\d+)\\s*,\\s*(?<b>\\d+)\\)"));return{regexp:t,cursor:"pointer",onClick:function(t,i){var a,o,c,s=n.exec(t),l=Number(null===s||void 0===s||null===(a=s.groups)||void 0===a?void 0:a.r),u=Number(null===s||void 0===s||null===(o=s.groups)||void 0===o?void 0:o.g),d=Number(null===s||void 0===s||null===(c=s.groups)||void 0===c?void 0:c.b),f=document.createElement("input");f.type="color",isNaN(l+u+d)||(f.value=function(e,t,n){return"#"+e.toString(16)+t.toString(16)+n.toString(16)}(l,u,d)),f.addEventListener("input",(function(t){var n=t.target;if(n.value){var a=(0,r.Z)(function(e){var t=parseInt(e.substring(1),16);return[t>>16&255,t>>8&255,255&t]}(n.value),3),o=a[0],c=a[1],s=a[2];i("".concat(e,"(").concat(o,", ").concat(c,", ").concat(s,")"))}})),f.click()}}}var u=l("rgb"),d=l("background"),f=l("fill"),p=l("stroke"),h={regexp:/https?:\/\/[^\s)"]+/g,cursor:"pointer",onClick:function(e){(0,i.Z)(e)&&window.open(e,"_blank")}}},98284:function(e,t,n){n.d(t,{Fy:function(){return E},Vw:function(){return S},dp:function(){return T},u5:function(){return C}});var r=n(10253),i=n(35944),a=n(60536),o=n.n(a),c=n(67294),s=n(24561),l=n(61134),u=n(57731),d=n(94184),f=n.n(d),p=n(47421),h=n(63736),m=n(69346),v=n(81255),g=n(29163),b=n(48869),x=n(1144),Z=n(34847),y=n(59006),w=n(41656);function k(e){var t=e.height,n=e.loading;return(0,i.BX)("div",{className:o().dynamic([["5a8d0f5b84417a3b",[t]]])+" "+(f()("loader",{loading:n})||""),children:[(0,i.BX)(s.ZP,{viewBox:"0 0 100 36",backgroundColor:v.TV.backgroundHighest,foregroundColor:v.TV.backgroundHigher,children:[(0,i.tZ)("rect",{x:"0",y:"0",rx:"3",ry:"3",width:"4",height:"4",className:o().dynamic([["5a8d0f5b84417a3b",[t]]])}),(0,i.tZ)("rect",{x:"6",y:"0",rx:"2",ry:"2",width:"92",height:"4",className:o().dynamic([["5a8d0f5b84417a3b",[t]]])})]}),(0,i.tZ)(o(),{id:"5a8d0f5b84417a3b",dynamic:[t],children:".loader.__jsx-style-dynamic-selector{padding:var(--space-8);display:none}.loader.loading.__jsx-style-dynamic-selector{height:".concat(t,";display:block}")})]})}function E(e){var t=e.maxHeight,n=e.minHeight,a=e.extensions,s=void 0===a?[]:a,u=e.allowScroll,d=void 0===u||u,h=e.fontSize,m=e.hideGutter,g=e.path,b=e.snippet,x=e.style,Z=e.elevation,E=e.onNavigateToCode,S=(0,l.Z)({hideGutter:m,filePath:g,fontSize:h,readOnly:!0}),C=S.view,T=S.ref,R=(0,r.Z)(c.useState(!1),2),_=R[0],I=R[1],P=c.useRef(v.TV.backgroundDefault),D=(0,y.Z)({view:C});return c.useEffect((function(){if(C&&b&&g){var e="lines"in b?b.lines.join("\n"):b.doc;C.dispatch({changes:{from:0,to:C.state.doc.length,insert:e},effects:D.reconfigure([(0,p.Eu)({formatNumber:function(e){return String(e+b.startLineNumber-1)}}),s])});var t,n={root:v.TV.backgroundRoot,higher:v.TV.backgroundHigher,highest:v.TV.backgroundHighest,default:v.TV.backgroundDefault};return P.current=Z&&null!==(t=n[Z])&&void 0!==t?t:v.TV.backgroundDefault,I(!0),function(){C.dispatch({effects:D.reconfigure([])})}}}),[C,b,g,D,s,Z]),(0,i.BX)("div",{style:x,className:o().dynamic([["7371a85c4a264eca",[t||"10em",n,P.current,P.current]]]),children:[(0,i.tZ)("div",{ref:T,onClick:function(e){if(E&&C){var t=e.clientX,n=e.clientY,r=C.posAtCoords({x:t,y:n}),i=null!==r?(0,w.s)(C.state.doc,r):null;E(i)}},className:o().dynamic([["7371a85c4a264eca",[t||"10em",n,P.current,P.current]]])+" "+(f()("snippet-editor",{"no-scroll":!d,loading:!_})||"")}),(0,i.tZ)(k,{loading:!_,height:t}),(0,i.tZ)(o(),{id:"7371a85c4a264eca",dynamic:[t||"10em",n,P.current,P.current],children:".snippet-editor.__jsx-style-dynamic-selector .cm-scroller{max-height:".concat(t||"10em",";min-height:").concat(n,";scrollbar-width:thin;outline:none}.snippet-editor.__jsx-style-dynamic-selector .cm-content{padding-bottom:0}.snippet-editor.__jsx-style-dynamic-selector .cm-editor{background-color:").concat(P.current,"}.snippet-editor.loading.__jsx-style-dynamic-selector{display:none}.snippet-editor.no-scroll.__jsx-style-dynamic-selector .cm-scroller{overflow:hidden}.snippet-editor.__jsx-style-dynamic-selector ::-webkit-scrollbar{width:4px}.snippet-editor.__jsx-style-dynamic-selector .cm-gutters{min-width:unset;background-color:").concat(P.current,"}")})]})}function S(e){var t=e.path,n=e.doc,a=e.extensions,o=void 0===a?[]:a,s=e.numMatches,l=e.onNavigateToCode,u=e.initiallyExpanded,d=(0,r.Z)(c.useState(u),2),f=d[0],p=d[1],y=f?"block":"none",w=f?180:0,k=f?"Collapse snippet":"Expand snippet";return(0,i.BX)(m.ZP,{children:[(0,i.BX)(m.ZP,{css:[v.l0.flex.row,v.l0.p(4),{justifyContent:"space-between"}],children:[(0,i.BX)(m.ZP,{css:[v.l0.rowWithGap(8),v.l0.center,v.l0.p(4)],children:[(0,i.tZ)(h.Z,{path:t}),(0,i.tZ)(x.x,{children:t}),(0,i.tZ)(x.x,{color:"dimmest",children:(0,Z.Z)("match",s,!0)})]}),(0,i.tZ)(g.Z,{alt:k,tooltipHidden:!0,onClick:function(){return p((function(e){return!e}))},children:(0,i.tZ)(b.Z,{rotate:w,style:{transition:"200ms ease"}})})]}),(0,i.tZ)(m.ZP,{css:[v.l0.p(4),{display:y}],children:(0,i.tZ)(E,{path:t,snippet:{doc:n,startLineNumber:1},extensions:o,maxHeight:"max-content",allowScroll:!0,hideGutter:!0,onNavigateToCode:l})})]})}function C(e){var t=e.path,n=e.snippet,r=e.maxHeight,a=e.minHeight,c=e.extensions,s=void 0===c?[]:c,l=e.allowScroll,u=void 0===l||l,d=e.onNavigateToCode,f=function(e){if(!e)return"";var t="lines"in e?e.lines.length:e.doc.lines;return(0,Z.Z)("line",t,!0)}(n);return(0,i.BX)("div",{className:"jsx-ea81418c08a690a7 snippet-container",children:[(0,i.BX)("div",{className:"jsx-ea81418c08a690a7 snippet-header",children:[(0,i.BX)("div",{className:"jsx-ea81418c08a690a7 path-container",children:[(0,i.tZ)("span",{className:"jsx-ea81418c08a690a7 lang-icon",children:(0,i.tZ)(h.Z,{path:t,fill:"var(--accent-primary-default)"})}),(0,i.tZ)("span",{className:"jsx-ea81418c08a690a7 path",children:t}),(0,i.BX)("span",{className:"jsx-ea81418c08a690a7 lines",children:["  ","\u2022 ",f]})]}),(0,i.tZ)("div",{onClick:d,className:"jsx-ea81418c08a690a7 jump-to-code",children:"Jump to code"})]}),(0,i.tZ)(E,{path:t,fontSize:12,snippet:n,maxHeight:r||"54pt",minHeight:a,extensions:s,allowScroll:u}),(0,i.tZ)(o(),{id:"ea81418c08a690a7",children:".snippet-container.jsx-ea81418c08a690a7{display:grid;border:1px solid var(--background-higher);-webkit-border-radius:var(--border-radius-4);-moz-border-radius:var(--border-radius-4);border-radius:var(--border-radius-4);grid-gap:var(--space-4)}.snippet-header.jsx-ea81418c08a690a7{display:grid;grid-auto-flow:column;grid-template-columns:1fr -webkit-max-content;grid-template-columns:1fr max-content;padding:var(--space-4);grid-gap:var(--space-8)}.path-container.jsx-ea81418c08a690a7{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;overflow:hidden}.lang-icon.jsx-ea81418c08a690a7{width:20px;height:20px;display:-webkit-inline-box;display:-webkit-inline-flex;display:-moz-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center}.path.jsx-ea81418c08a690a7{font-size:var(--font-size-small);color:var(--accent-primary-default);overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis}.lines.jsx-ea81418c08a690a7{font-size:var(--font-size-small);color:var(--accent-primary-dimmer);white-space:pre}.jump-to-code.jsx-ea81418c08a690a7{font-size:var(--font-size-small);color:var(--accent-primary-default);cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center}"})]})}function T(e){var t=e.extensions,n=void 0===t?[]:t,r=e.timeString,a=e.message,c=e.onClick,s=e.snippet,l=e.avatar,d=e.path;return(0,i.BX)("div",{onClick:c,className:"jsx-ac67521191136beb snippet-container",children:[(0,i.tZ)(E,{path:d,snippet:s,fontSize:12,maxHeight:"36pt",minHeight:"36pt",allowScroll:!1,style:{opacity:.7},extensions:n}),(0,i.BX)("div",{className:"jsx-ac67521191136beb snippet-first-message",children:[l?(0,i.tZ)(u.Z,{src:l.src,size:24,alt:l.name}):(0,i.tZ)("div",{className:"jsx-ac67521191136beb"}),(0,i.tZ)("div",{className:"jsx-ac67521191136beb text",children:a}),(0,i.tZ)("div",{className:"jsx-ac67521191136beb time",children:r})]}),(0,i.tZ)(o(),{id:"ac67521191136beb",children:".snippet-container.jsx-ac67521191136beb{display:grid;border:1px solid var(--outline-dimmest);-webkit-border-radius:var(--border-radius-8);-moz-border-radius:var(--border-radius-8);border-radius:var(--border-radius-8);overflow:hidden;grid-gap:var(--space-4);max-width:100%;cursor:pointer;-webkit-transition:-webkit-transform.1s ease-in-out;-moz-transition:-moz-transform.1s ease-in-out;-o-transition:-o-transform.1s ease-in-out;transition:-webkit-transform.1s ease-in-out;transition:-moz-transform.1s ease-in-out;transition:-o-transform.1s ease-in-out;transition:transform.1s ease-in-out}.snippet-container.jsx-ac67521191136beb:hover{-webkit-transform:scale(1.05);-moz-transform:scale(1.05);-ms-transform:scale(1.05);-o-transform:scale(1.05);transform:scale(1.05)}.snippet-first-message.jsx-ac67521191136beb{border-top:1px solid var(--outline-dimmest);font-size:var(--font-size-default);background:var(--background-root);color:var(--foreground-default);padding:var(--space-8);display:grid;grid-auto-flow:column;grid-template-columns:-webkit-min-content 1fr -webkit-max-content;grid-template-columns:min-content 1fr max-content;grid-gap:var(--space-8);-webkit-box-pack:start;-webkit-justify-content:start;-moz-box-pack:start;-ms-flex-pack:start;justify-content:start;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center}.text.jsx-ac67521191136beb{-o-text-overflow:ellipsis;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.time.jsx-ac67521191136beb{font-size:var(--font-size-small)}"})]})}},58142:function(e,t,n){n.d(t,{Z:function(){return h}});var r=n(51438),i=n(28668),a=n(25171),o=n(47421),c=n(78120),s=n(81255),l=n(34847),u=new(function(e){(0,i.Z)(n,e);var t=(0,a.Z)(n);function n(){var e;return(0,r.Z)(this,n),(e=t.call(this)).elementClass="cm-gutterElement-hidden",e}return n.prototype.toDOM=function(){var e=document.createElement("span");e.classList.add("cm-hidden-lines-gutter");var t=document.createElement("span");return t.classList.add("cm-dot"),e.appendChild(t),e},n}(o.SJ)),d=function(e){(0,i.Z)(n,e);var t=(0,a.Z)(n);function n(e){var i;return(0,r.Z)(this,n),(i=t.call(this)).numLines=e,i}var o=n.prototype;return o.eq=function(e){return e.numLines===this.numLines},o.toDOM=function(){var e=document.createElement("span");return e.textContent="".concat(this.numLines," hidden ").concat((0,l.Z)("line",this.numLines)),e.className="cm-hidden-lines",e},n}(o.l9),f=o.p.mark({class:"cm-searchResultMatch"}),p=o.tk.baseTheme({".cm-hidden-lines":{color:"var(--foreground-dimmer)",backgroundColor:"var(--background-highest)",display:"inline-block",width:"100%"},".cm-hidden-lines-gutter":{backgroundColor:"var(--background-highest)",display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%"},".cm-dot":{height:"5px",width:"5px",backgroundColor:"var(--foreground-dimmest)",borderRadius:"50%",display:"inline-block"},".cm-tooltip .cm-scroller":{border:"2px solid var(--background-highest)",borderRadius:"var(--border-radius-4)"},".cm-tooltip .cm-scroller:hover":{border:"2px solid var(--accent-primary-dimmest)",boxShadow:"var(--shadow-1)",cursor:"pointer"},".cm-searchResultMatch":{color:s.TV.foregroundDefault,backgroundColor:s.TV.accentPrimaryDimmest,outline:s.TV.accentPrimaryDimmer+" solid 1px"},".cm-searchResultMatch span":{color:s.TV.foregroundDefault},".cm-tooltip .cm-searchResultMatch:hover":{opacity:.8},".cm-tooltip .cm-gutterElement":{display:"flex",marginTop:0,padding:"0 !important",width:"var(--space-24) !important",textAlign:"center",alignItems:"center",justifyContent:"center",lineHeight:"21px"},".cm-tooltip .cm-line":{padding:0},".cm-tooltip .cm-gutters":{padding:0},".cm-tooltip .cm-content":{paddingTop:0},".cm-tooltip .cm-lineWrapping":{whiteSpace:"pre"},".cm-tooltip .cm-cursor":{display:"none"},".cm-tooltip .cm-selectionBackground":{display:"none"}});function h(e,t){var n=e.sort((function(e,t){return e.from-t.from})),r=n.map((function(e){var t=e.from,n=e.to;return f.range(t,n)})),i=o.lg.define((function(){return{}}),{decorations:function(){return o.p.set(r)}}),a=function(e,t){var n=[],r=1;e.forEach((function(i,a){var o=t.lineAt(i.from),c=t.lineAt(i.to);r<o.number-2&&n.push({startLine:r,endLine:o.number-2}),r=c.number+2,a===e.length-1&&r<t.lines&&n.push({startLine:r,endLine:t.lines})}));var i=n.map((function(e){var n=t.line(e.startLine),r=t.line(e.endLine);return o.p.replace({widget:new d(e.endLine-e.startLine+1)}).range(n.from,r.to)})),a=n.map((function(e){var n=t.line(e.startLine);return o.p.line({class:"cm-line-hidden"}).range(n.from)})),s=c.QQ.define({create:function(){return o.p.set(i)},update:function(e){return e},provide:function(e){return o.tk.decorations.from(e)}}),l=c.QQ.define({create:function(){return o.p.set(a)},update:function(e){return e},provide:function(e){return o.tk.decorations.from(e)}}),f=n.map((function(e){var n=t.line(e.startLine);return u.range(n.from)})),h=o.p2.of(c.Xs.of(f));return[s,l,p,h]}(n,t);return[i,a]}},60523:function(e,t,n){var r=n(67294).createContext(null);t.Z=r},89321:function(e,t,n){n.d(t,{AL:function(){return Z},GD:function(){return h},VO:function(){return p},Y:function(){return b},tT:function(){return v}});var r=n(26042),i=n(7297),a=n(31230),o=n(6801),c=n(46829);function s(){var e=(0,i.Z)(["\n  query CodemirrorThread($id: String!) {\n    thread: annotationAnchor(id: $id) {\n      ... on AnnotationAnchor {\n        id\n        ...AnnotationsUIAnchor\n      }\n    }\n    currentUser {\n      id\n      username\n      image\n    }\n  }\n  ","\n"]);return s=function(){return e},e}function l(){var e=(0,i.Z)(["\n  mutation CreateThread(\n    $thread: AnnotationAnchorInput!\n    $message: AnnotationMessageInput\n    $highlight: AnnotationHighlightInput\n  ) {\n    createThread: createAnnotationAnchor(\n      annotationAnchor: $thread\n      annotationMessage: $message\n      highlight: $highlight\n    ) {\n      ... on AnnotationAnchor {\n        id\n        ...AnnotationsUIAnchor\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return l=function(){return e},e}function u(){var e=(0,i.Z)(["\n  mutation UpdateThread($id: String!, $changes: AnnotationAnchorChangesInput!) {\n    updateThread: updateAnnotationAnchor(id: $id, changes: $changes) {\n      ... on UserError {\n        message\n      }\n      ... on AnnotationAnchor {\n        id\n        ...AnnotationsUIAnchor\n      }\n    }\n  }\n  ","\n"]);return u=function(){return e},e}function d(){var e=(0,i.Z)(["\n  mutation CreateThreadMessage(\n    $replId: String!\n    $threadId: String!\n    $threadMessage: AnnotationMessageInput!\n    $highlight: AnnotationHighlightInput\n  ) {\n    createThreadMessage: createAnnotationMessage(\n      replId: $replId\n      anchorId: $threadId\n      annotationMessage: $threadMessage\n      highlight: $highlight\n    ) {\n      ... on UserError {\n        message\n      }\n      ... on AnnotationAnchor {\n        id\n        ...AnnotationsUIAnchor\n      }\n    }\n  }\n  ","\n"]);return d=function(){return e},e}var f={},p=(0,a.ZP)(s(),o.j7);function h(e){var t=(0,r.Z)({},f,e);return c.useQuery(p,t)}var m=(0,a.ZP)(l(),o.j7);function v(e){var t=(0,r.Z)({},f,e);return c.useMutation(m,t)}var g=(0,a.ZP)(u(),o.j7);function b(e){var t=(0,r.Z)({},f,e);return c.useMutation(g,t)}var x=(0,a.ZP)(d(),o.j7);function Z(e){var t=(0,r.Z)({},f,e);return c.useMutation(x,t)}},24638:function(e,t,n){n.d(t,{Jq:function(){return l},eR:function(){return u}});var r=n(26042),i=n(7297),a=n(31230),o=n(46829);function c(){var e=(0,i.Z)(["\n  query ThreadsByFileHook($replId: String!, $path: String!) {\n    threadsByFile(replId: $replId, path: $path) {\n      ... on ThreadsByFileResult {\n        threads {\n          id\n          path\n          otVersion\n          indexStart\n          indexEnd\n          messageCount\n          unreadCount\n          user {\n            id\n            image\n            username\n          }\n          participants {\n            id\n            image\n            username\n          }\n          isGeneral\n          isResolved\n        }\n      }\n    }\n  }\n"]);return c=function(){return e},e}var s={},l=(0,a.ZP)(c());function u(e){var t=(0,r.Z)({},s,e);return o.useQuery(l,t)}},67992:function(e,t,n){n.d(t,{nE:function(){return Q},OQ:function(){return V},qi:function(){return M},UQ:function(){return z},YM:function(){return W},PQ:function(){return q},ZS:function(){return $},eR:function(){return X},zj:function(){return Y},cR:function(){return H}});var r=n(51438),i=n(14924),a=n(28668),o=n(26042),c=n(69396),s=n(25171),l=n(35944),u=n(78120),d=n(410),f=n(65975),p=n(47421),h=n(73935),m=n(47568),v=n(34051),g=n.n(v),b=n(65632),x=n(67294),Z=n(89321),y=function(e){var t=e.isOpen,n=e.threadId,r=e.apolloClient,i=(0,x.useState)(!1),a=i[0],o=i[1],c=function(){var e=(0,m.Z)(g().mark((function e(){var t;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===r||void 0===r?void 0:r.query({query:Z.VO,variables:{id:n}});case 2:if(!(t=e.sent)){e.next=5;break}return e.abrupt("return",{thread:t.data.thread,error:t.error});case 5:return e.abrupt("return",null);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,x.useEffect)((function(){r&&c().then((function(e){if(e){var t=e.thread;e.error||o("AnnotationAnchor"===(null===t||void 0===t?void 0:t.__typename)&&(null===t||void 0===t?void 0:t.messages.some((function(e){return!e.seen}))))}}))}),[r]);var s={alt:{default:"View threads",close:"Dismiss thread"}};return(0,l.tZ)(f.hU,{alt:t?s.alt.close:s.alt.default,size:24,className:"thread-indicator",css:[f.l0.width(20),f.l0.height(20),f.l0.transition.snappy,f.l0.cursor.pointer,f.l0.display.flex,f.l0.borderRadius(8),f.l0.position.relative,f.l0.overflow("visible"),t?f.l0.color.accentPrimaryStrongest:f.l0.color.foregroundDimmest,{borderWidth:f.TV.borderWidthDefault,borderStyle:"solid",borderColor:t?f.TV.accentPrimaryDefault:"transparent",backgroundColor:t?f.TV.accentPrimaryDimmer:f.TV.backgroundHigher,outline:0},{":hover":{borderColor:t?f.TV.accentPrimaryStronger:f.TV.outlineDimmer,color:t?f.TV.accentPrimaryStrongest:f.TV.foregroundDimmer,background:t?f.TV.accentPrimaryDefault+" !important":f.TV.backgroundHighest},svg:{width:12,height:12}}],children:(0,l.BX)(l.HY,{children:[a?(0,l.tZ)("div",{css:[f.l0.width(8),f.l0.height(8),f.l0.backgroundColor.redStronger,f.l0.position.absolute,f.l0.top(-1),f.l0.left(-1),f.l0.borderRadius("full")]}):null,(0,l.tZ)(b.Z,{})]})})},w=n(34528),k=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}var i=n.prototype;return i.compare=function(e){return this==e||this.constructor==e.constructor&&this.eq(e)},i.eq=function(e){return!1},i.destroy=function(e){},n}(u.uU);k.prototype.elementClass="",k.prototype.toDOM=void 0,k.prototype.mapMode=u.gc.TrackBefore,k.prototype.startSide=k.prototype.endSide=-1,k.prototype.point=!0;var E=u.r$.define(),S={class:"",renderEmptyElements:!1,elementStyle:"",markers:function(){return u.Xs.empty},lineMarker:function(){return null},lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},C=u.r$.define();var T=u.r$.define({combine:function(e){return e.some((function(e){return e}))}});function R(e){var t=[_];return e&&!1===e.fixed&&t.push(T.of(!0)),t}var _=p.lg.fromClass(function(){function e(t){(0,r.Z)(this,e),this.view=t,this.prevViewport=t.viewport,this.dom=document.createElement("div"),this.dom.className="cm-right-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.width="0px",this.dom.style.minHeight=this.view.contentHeight+"px",this.gutters=t.state.facet(C).map((function(e){return new A(t,e)}));var n=!0,i=!1,a=void 0;try{for(var o,c=this.gutters[Symbol.iterator]();!(n=(o=c.next()).done);n=!0){var s=o.value;this.dom.appendChild(s.dom)}}catch(l){i=!0,a=l}finally{try{n||null==c.return||c.return()}finally{if(i)throw a}}this.fixed=!t.state.facet(T),this.fixed&&(this.dom.style.position="sticky",this.dom.style.right="0"),this.syncGutters(!1),t.scrollDOM.insertBefore(this.dom,t.contentDOM.nextSibling)}var t=e.prototype;return t.update=function(e){if(this.updateGutters(e)){var t=this.prevViewport,n=e.view.viewport,r=Math.min(t.to,n.to)-Math.max(t.from,n.from);this.syncGutters(r<.8*(n.to-n.from))}e.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(T)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=e.view.viewport},t.syncGutters=function(e){var t=this,n=this.dom.nextSibling;e&&this.dom.remove();var r=u.Xs.iter(this.view.state.facet(E),this.view.viewport.from),i=[],a=this.gutters.map((function(e){return new D(e,t.view.viewport,-t.view.documentPadding.top)})),o=!0,c=!1,s=void 0;try{for(var l,d=this.view.viewportLineBlocks[Symbol.iterator]();!(o=(l=d.next()).done);o=!0){var f=l.value,h=void 0;if(Array.isArray(f.type)){var m=!0,v=!1,g=void 0;try{for(var b,x=f.type[Symbol.iterator]();!(m=(b=x.next()).done);m=!0){var Z=b.value;if(Z.type==p.kH.Text){h=Z;break}}}catch(N){v=!0,g=N}finally{try{m||null==x.return||x.return()}finally{if(v)throw g}}}else h=f.type==p.kH.Text?f:void 0;if(h){i.length&&(i=[]),P(r,i,f.from);var y=!0,w=!1,k=void 0;try{for(var S,C=a[Symbol.iterator]();!(y=(S=C.next()).done);y=!0){S.value.line(this.view,h,i)}}catch(N){w=!0,k=N}finally{try{y||null==C.return||C.return()}finally{if(w)throw k}}}}}catch(N){c=!0,s=N}finally{try{o||null==d.return||d.return()}finally{if(c)throw s}}var T=!0,R=!1,_=void 0;try{for(var I,A=a[Symbol.iterator]();!(T=(I=A.next()).done);T=!0){I.value.finish()}}catch(N){R=!0,_=N}finally{try{T||null==A.return||A.return()}finally{if(R)throw _}}e&&this.view.scrollDOM.insertBefore(this.dom,n)},t.updateGutters=function(e){var t=e.startState.facet(C),n=e.state.facet(C),r=e.docChanged||e.heightChanged||e.viewportChanged||!u.Xs.eq(e.startState.facet(E),e.state.facet(E),e.view.viewport.from,e.view.viewport.to);if(t==n){var i=!0,a=!1,o=void 0;try{for(var c,s=this.gutters[Symbol.iterator]();!(i=(c=s.next()).done);i=!0){c.value.update(e)&&(r=!0)}}catch(D){a=!0,o=D}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}}else{r=!0;var l=[],d=!0,f=!1,p=void 0;try{for(var h,m=n[Symbol.iterator]();!(d=(h=m.next()).done);d=!0){var v=h.value,g=t.indexOf(v);g<0?l.push(new A(this.view,v)):(this.gutters[g].update(e),l.push(this.gutters[g]))}}catch(D){f=!0,p=D}finally{try{d||null==m.return||m.return()}finally{if(f)throw p}}var b=!0,x=!1,Z=void 0;try{for(var y,w=this.gutters[Symbol.iterator]();!(b=(y=w.next()).done);b=!0){var k=y.value;k.dom.remove(),l.indexOf(k)<0&&k.destroy()}}catch(D){x=!0,Z=D}finally{try{b||null==w.return||w.return()}finally{if(x)throw Z}}var S=!0,T=!1,R=void 0;try{for(var _,I=l[Symbol.iterator]();!(S=(_=I.next()).done);S=!0){var P=_.value;this.dom.appendChild(P.dom)}}catch(D){T=!0,R=D}finally{try{S||null==I.return||I.return()}finally{if(T)throw R}}this.gutters=l}return r},t.destroy=function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.gutters[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){r.value.destroy()}}catch(a){t=!0,n=a}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}this.dom.remove()},e}(),{provide:function(e){return p.tk.scrollMargins.of((function(t){var n=t.plugin(e);return n&&0!=n.gutters.length&&n.fixed?t.textDirection==p.Nm.LTR?{left:n.dom.offsetWidth}:{right:n.dom.offsetWidth}:null}))}});function I(e){return Array.isArray(e)?e:[e]}function P(e,t,n){for(;e.value&&e.from<=n;)e.from==n&&t.push(e.value),e.next()}var D=function(){function e(t,n,i){(0,r.Z)(this,e),this.gutter=t,this.height=i,this.localMarkers=[],this.i=0,this.cursor=u.Xs.iter(t.markers,n.from)}var t=e.prototype;return t.line=function(e,t,n){this.localMarkers.length&&(this.localMarkers=[]),P(this.cursor,this.localMarkers,t.from);var r=n.length?this.localMarkers.concat(n):this.localMarkers,i=this.gutter.config.lineMarker(e,t,r);i&&r.unshift(i);var a=this.gutter;if(0!=r.length||a.config.renderEmptyElements){var o=t.top-this.height;if(this.i==a.elements.length){var c=new N(e,t.height,o,r);a.elements.push(c),a.dom.appendChild(c.dom)}else a.elements[this.i].update(e,t.height,o,r);this.height=t.bottom,this.i++}},t.finish=function(){for(var e=this.gutter;e.elements.length>this.i;){var t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}},e}(),A=function(){function e(t,n){var i=this,a=function(e){i.dom.addEventListener(e,(function(r){var i=t.lineBlockAtHeight(r.clientY-t.documentTop);n.domEventHandlers[e](t,i,r)&&r.preventDefault()}))};for(var o in(0,r.Z)(this,e),this.view=t,this.config=n,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:""),n.domEventHandlers)a(o);this.markers=I(n.markers(t)),n.initialSpacer&&(this.spacer=new N(t,0,0,[n.initialSpacer(t)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}var t=e.prototype;return t.update=function(e){var t=this.markers;if(this.markers=I(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){var n=this.config.updateSpacer(this.spacer.markers[0],e);n!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[n])}var r=e.view.viewport;return!u.Xs.eq(this.markers,t,r.from,r.to)||!!this.config.lineMarkerChange&&this.config.lineMarkerChange(e)},t.destroy=function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.elements[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){r.value.destroy()}}catch(a){t=!0,n=a}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}},e}(),N=function(){function e(t,n,i,a){(0,r.Z)(this,e),this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(t,n,i,a)}var t=e.prototype;return t.update=function(e,t,n,r){this.height!=t&&(this.dom.style.height=(this.height=t)+"px"),this.above!=n&&(this.dom.style.marginTop=(this.above=n)?n+"px":""),function(e,t){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(!e[n].compare(t[n]))return!1;return!0}(this.markers,r)||this.setMarkers(e,r)},t.setMarkers=function(e,t){for(var n="cm-gutterElement",r=this.dom.firstChild,i=0,a=0;;){var o=a,c=i<t.length?t[i++]:null,s=!1;if(c){var l=c.elementClass;l&&(n+=" "+l);for(var u=a;u<this.markers.length;u++)if(this.markers[u].compare(c)){o=u,s=!0;break}}else o=this.markers.length;for(;a<o;){var d=this.markers[a++];if(d.toDOM){d.destroy(r);var f=r.nextSibling;r.remove(),r=f}}if(!c)break;c.toDOM&&(s?r=r.nextSibling:this.dom.insertBefore(c.toDOM(e),r)),s&&a++}this.dom.className=n,this.markers=t},t.destroy=function(){this.setMarkers(null,[])},e}();var U=u.r$.define(),j=u.r$.define({combine:function(e){return(0,u.BO)(e,{formatNumber:String,domEventHandlers:{}},{domEventHandlers:function(e,t){var n=function(e){var n=r[e],i=t[e];r[e]=n?function(e,t,r){return n(e,t,r)||i(e,t,r)}:i},r=Object.assign({},e);for(var i in t)n(i);return r}})}}),B=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(e){var i;return(0,r.Z)(this,n),(i=t.call(this)).number=e,i}var i=n.prototype;return i.eq=function(e){return this.number==e.number},i.toDOM=function(){return document.createTextNode(this.number)},n}(k);function O(e,t){return e.state.facet(j).formatNumber(t,e.state)}C.compute([j],(function(e){return{class:"cm-lineNumbers",renderEmptyElements:!1,markers:function(e){return e.state.facet(U)},lineMarker:function(e,t,n){return n.some((function(e){return e.toDOM}))?null:new B(O(e,e.state.doc.lineAt(t.from).number))},lineMarkerChange:function(e){return e.startState.facet(j)!=e.state.facet(j)},initialSpacer:function(e){return new B(O(e,G(e.state.doc.lines)))},updateSpacer:function(e,t){var n=O(t.view,G(t.view.state.doc.lines));return n==e.number?e:new B(n)},domEventHandlers:e.facet(j).domEventHandlers}}));function G(e){for(var t=9;t<e;)t=10*t+9;return t}var L=new(function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){var e;return(0,r.Z)(this,n),(e=t.apply(this,arguments)).elementClass="cm-activeLineGutter",e}return n}(k));E.compute(["selection"],(function(e){var t=[],n=-1,r=!0,i=!1,a=void 0;try{for(var o,c=e.selection.ranges[Symbol.iterator]();!(r=(o=c.next()).done);r=!0){var s=o.value;if(s.empty){var l=e.doc.lineAt(s.head).from;l>n&&(n=l,t.push(L.range(l)))}}}catch(d){i=!0,a=d}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return u.Xs.of(t)}));var M=u.Py.define(),z=u.Py.define(),F=u.Py.define(),X=u.Py.define(),W=u.Py.define(),H=p.tk.baseTheme({".replit-thread-highlight":{background:f.TV.blueDimmest},".cm-thread-indicator-gutter":{transform:"translate(calc(-100% - var(--space-8)));",width:"20px",overflow:"visible"}}),V=u.QQ.define({create:function(){return{}},update:function(e,t){var n=e;return(0,d.j)(t,M,(function(e){n=e.value})),t.changes.empty?n:n=Object.values(n).map((function(e){return(0,c.Z)((0,o.Z)({},e),{indexStart:t.changes.mapPos(e.indexStart),indexEnd:t.changes.mapPos(e.indexEnd)})})).reduce((function(e,t){return e[t.id]=t,e}),{})}}),$=u.QQ.define({create:function(){return null},update:function(e,t){var n=e;return(0,d.j)(t,z,(function(e){var r=t.state,i=r.selection.main;n={id:e.value,indexStart:i.from,indexEnd:i.empty?Math.min(i.to+1,r.doc.length):i.to}})),(0,d.j)(t,F,(function(){n=null})),(0,d.j)(t,W,(function(){n=null})),null!==n&&(0,d.j)(t,M,(function(e){if(!n)throw new Error("expected newPlaceholder");e.value[n.id]&&(n=null)})),!t.changes.empty&&n&&(n=(0,c.Z)((0,o.Z)({},n),{indexStart:t.changes.mapPos(n.indexStart),indexEnd:t.changes.mapPos(n.indexEnd)})),n}}),q=u.QQ.define({create:function(){return null},update:function(e,t){var n=e;return(0,d.j)(t,W,(function(e){n=e.value})),(0,d.j)(t,z,(function(e){n=e.value})),n}}),Q=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(e,i){var a;return(0,r.Z)(this,n),(a=t.call(this)).id=e,a.setThreadElements=i,a}var l=n.prototype;return l.eq=function(e){return e.id===this.id},l.toDOM=function(e){var t=this,n=document.createElement("div");n.className="cm-thread-portal-widget";var r=e.dom.querySelector(".cm-scroller"),a=e.dom.querySelector(".cm-gutters");return r&&a&&(0,w.L)(n,r,a),setTimeout((function(){t.setThreadElements((function(e){return(0,c.Z)((0,o.Z)({},e),(0,i.Z)({},t.id,n))}))})),n},l.destroy=function(e){var t=this;e.remove(),setTimeout((function(){t.setThreadElements((function(e){var n=(0,o.Z)({},e);return delete n[t.id],n}))}))},l.ignoreEvent=function(){return!0},n}(p.l9),K=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(e,i,a){var o;return(0,r.Z)(this,n),(o=t.call(this)).id=e,o.active=i,o.apolloClient=a,o}var i=n.prototype;return i.toDOM=function(e){var t=this,n=document.createElement("span");return n.setAttribute("aria-hidden","true"),n.className="cm-thread-indicator-widget",h.render((0,l.tZ)(y,{isOpen:this.active,threadId:this.id,apolloClient:this.apolloClient}),n),n.style.cursor="pointer",n.onclick=function(n){n.stopPropagation(),n.preventDefault(),e.dispatch({effects:[W.of(e.state.field(q)===t.id?null:t.id)]})},n},i.eq=function(e){return e.id===this.id&&e.active===this.active},n}(k),Y=function(e){return t={class:"cm-thread-indicator-gutter",markers:function(t){var n=t.state.field(V),r=t.state.field(q);return u.Xs.of(Object.values(n).filter((function(e){return e.indexEnd!==e.indexStart})).map((function(n){var i=t.state.doc.lineAt(Math.min(n.indexStart,n.indexEnd)).from;return new K(n.id,n.id===r,e).range(i)})),!0)},initialSpacer:function(){return new K("initial-spacer",!1)}},[R(),C.of((0,o.Z)({},S,t))];var t}},34528:function(e,t,n){function r(e,t,n){var r=t.clientWidth,i=n.clientWidth;e.style.maxWidth="".concat(r,"px"),e.style.position="sticky",e.style.zIndex="201",e.style.marginLeft="-".concat(i,"px")}n.d(t,{L:function(){return r}})},2230:function(e,t,n){n.d(t,{Z:function(){return Z}});var r=n(26042),i=n(69396),a=n(10253),o=n(29815),c=n(67294),s=n(93058),l=n(89321),u=n(24638),d=n(6801),f=n(30827),p=n(63377),h=n(9583),m=n(99408),v=n(67992),g=n(61193);function b(e,t){if(!e)return null;var n,r=e.state.field(v.OQ),i=e.state.field(v.ZS),a=null!==(n=r[t])&&void 0!==n?n:(null===i||void 0===i?void 0:i.id)===t?i:null;return a||null}function x(e,t){if(!e)return null;var n=b(e,t);if(!n)return null;var r=Math.min(n.indexStart,n.indexEnd),i=Math.max(n.indexStart,n.indexEnd),a=e.state.doc.lineAt(r),o=e.state.doc.lineAt(i),c=e.state.doc.sliceString(e.state.doc.line(Math.max(a.number-2,1)).from,r),s=e.state.doc.sliceString(i,e.state.doc.line(Math.min(o.number+2,e.state.doc.lines)).to);return{precode:c,code:e.state.doc.sliceString(r,i),postcode:s}}function Z(e,t,n){var Z=(0,s.Z)().showError,y=(0,p.Z)(),w=(0,g.c)("flag-typing-indicator"),k=w.enabled,E=(w.loading,(0,g.c)("flag-typing-presence")),S=E.enabled,C=(E.loading,(0,f.Z)().map((function(e){return e.username}))),T=(0,m.Z)().fs,R=(0,l.GD)({variables:{id:e}}),_=R.data,I=R.error,P=R.loading,D=R.client,A=!(!_||P||"AnnotationAnchor"===_.thread.__typename),N=P,U=c.useMemo((function(){return N||!_?null:"UserError"===_.thread.__typename?{id:e,__typename:"AnnotationAnchor",messages:[],isGeneral:!1,isResolved:!1}:"AnnotationAnchor"===_.thread.__typename?_.thread:null}),[_,e,N]),j=(0,a.Z)((0,l.tT)({onError:function(e){return Z(e.message)},update:function(e,t){var n,r;t.errors?t.errors.forEach((function(e){return Z(e.message)})):"UserError"!==(null===(n=t.data)||void 0===n||null===(r=n.createThread)||void 0===r?void 0:r.__typename)||Z(t.data.createThread.message)}}),1),B=j[0],O=(0,a.Z)((0,l.AL)({onError:function(e){return Z(e.message)},update:function(e,t){var n;if(t.errors)t.errors.forEach((function(e){return Z(e.message)}));else{var r=null===(n=t.data)||void 0===n?void 0:n.createThreadMessage;r&&"UserError"===r.__typename&&Z(r.message)}}}),1),G=O[0],L=(0,a.Z)((0,l.Y)({onError:function(e){return Z(e.message)},update:function(e,t){var n;if(t.errors)t.errors.forEach((function(e){return Z(e.message)}));else{var r=null===(n=t.data)||void 0===n?void 0:n.updateThread;r&&"UserError"===r.__typename&&Z(r.message)}}}),1),M=L[0],z=(0,a.Z)((0,d.Hj)(),1)[0],F=function(){var e=null===_||void 0===_?void 0:_.currentUser;return e?{user:{__typename:"User",id:e.id,username:e.username,image:e.image}}:{}};return{thread:U,isPlaceholder:A,error:I,loading:N,getHighlight:x,getLatestAnchor:function(){return b(t,e)},updateThread:function(e){var t,n=e.changes,a="AnnotationAnchor"===(null===_||void 0===_||null===(t=_.thread)||void 0===t?void 0:t.__typename)?_.thread:null;if(!a)throw new Error("expected thread");M({variables:{id:a.id,changes:n},optimisticResponse:{updateThread:(0,i.Z)((0,r.Z)({},a,n),{isResolved:"boolean"===typeof n.isResolved?n.isResolved:a.isResolved})}})},finalizeThreadMessage:function(a){var c,s=a.message,d=a.messageId,f={id:d,text:s,mentions:(0,h.kW)(s,{users:(0,o.Z)(C).concat(["everyone"])}).mentions};if(A&&t&&n){var p=t.state.field(v.ZS),m={id:e,replId:y,indexStart:null===p||void 0===p?void 0:p.indexStart,indexEnd:null===p||void 0===p?void 0:p.indexEnd,otVersion:T.getOTVersion(n),path:n};B({variables:{thread:m,message:f,highlight:x(t,e)},optimisticResponse:{__typename:"RootMutationType",createThread:(0,i.Z)((0,r.Z)({__typename:"AnnotationAnchor"},m,F()),{messages:[(0,i.Z)((0,r.Z)({id:d,timeCreated:Date.now(),currentUserIsAuthor:!0},F()),{content:{text:s,__typename:"TextMessageContentType"},anchor:{id:m.id,__typename:"AnnotationAnchor"},__typename:"AnnotationMessage",seen:!0})],isResolved:!1,isGeneral:!1})}}),D.writeQuery({query:l.VO,variables:{id:e},data:{thread:(0,i.Z)((0,r.Z)((0,i.Z)((0,r.Z)({},m),{isResolved:!1,isGeneral:!1}),F()),{messages:[(0,i.Z)((0,r.Z)({id:d,timeCreated:Date.now(),currentUserIsAuthor:!0},F()),{content:{text:s,__typename:"TextMessageContentType"},anchor:{id:m.id,__typename:"AnnotationAnchor"},__typename:"AnnotationMessage",seen:!0})],__typename:"AnnotationAnchor"}),currentUser:null===_||void 0===_?void 0:_.currentUser}});var g=D.readQuery({query:u.Jq,variables:{replId:y,path:n}});if(g){var b,Z="ThreadsByFileResult"===(null===(b=g.threadsByFile)||void 0===b?void 0:b.__typename)?g.threadsByFile.threads:[],w=F().user;D.writeQuery({query:u.Jq,variables:{replId:y,path:n},data:{threadsByFile:{__typename:"ThreadsByFileResult",threads:(0,o.Z)(Z).concat([(0,r.Z)({messageCount:1,unreadCount:0,__typename:"AnnotationAnchor",isGeneral:!1,user:w,isResolved:!1,participants:[w]},m)])}}})}}else{var k="AnnotationAnchor"===(null===_||void 0===_||null===(c=_.thread)||void 0===c?void 0:c.__typename)?_.thread:null;if(!k)throw new Error("expected thread");G({variables:{replId:y,threadId:k.id,threadMessage:f,highlight:x(t,k.id)},optimisticResponse:{createThreadMessage:(0,i.Z)((0,r.Z)({},k),{messages:(0,o.Z)(k.messages.filter((function(e){return!e.id.startsWith("chat-")}))).concat([(0,i.Z)((0,r.Z)({},F(),f),{content:{text:f.text,__typename:"TextMessageContentType"},anchor:{id:k.id,__typename:"AnnotationAnchor"},__typename:"AnnotationMessage",timeCreated:Date.now(),currentUserIsAuthor:!0,seen:!0})])})}})}},changeThreadMessage:function(t){var n=t.messageId,r=t.message;k&&z({variables:{threadId:e,messageId:n,message:null!==S&&void 0!==S&&S?r:null}})}}}},410:function(e,t,n){function r(e,t,n){if("effects"in e){var i=!0,a=!1,o=void 0;try{for(var c,s=e.effects[Symbol.iterator]();!(i=(c=s.next()).done);i=!0){var l=c.value;l.is(t)&&n(l)}}catch(m){a=!0,o=m}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}}else{var u=!0,d=!1,f=void 0;try{for(var p,h=e.transactions[Symbol.iterator]();!(u=(p=h.next()).done);u=!0){r(p.value,t,n)}}catch(m){d=!0,f=m}finally{try{u||null==h.return||h.return()}finally{if(d)throw f}}}}n.d(t,{j:function(){return r}})},41656:function(e,t,n){function r(e,t){var n=Math.max(t.line+1,1),r=e.line(Math.min(n,e.lines));if(n>e.lines)return r.to;var i=r.from+t.character;return Math.min(i,r.to)}function i(e,t){var n=e.lineAt(t);return{line:n.number-1,character:t-n.from}}n.d(t,{R:function(){return r},s:function(){return i}})},94561:function(e,t,n){var r=n(40872),i=n(26042),a=n(69396),o=n(35944),c=n(60536),s=n.n(c);t.Z=function(e){var t=(0,r.Z)({},e);return(0,o.BX)(o.HY,{children:[(0,o.tZ)(s(),{id:"fcfe85a13ecbf46b",children:".one.jsx-fcfe85a13ecbf46b{opacity:.1;-webkit-animation:dot 1.5s ease-in-out infinite;-moz-animation:dot 1.5s ease-in-out infinite;-o-animation:dot 1.5s ease-in-out infinite;animation:dot 1.5s ease-in-out infinite;-webkit-animation-delay:0s;-moz-animation-delay:0s;-o-animation-delay:0s;animation-delay:0s}.two.jsx-fcfe85a13ecbf46b{opacity:.1;-webkit-animation:dot 1.5s ease-in-out infinite;-moz-animation:dot 1.5s ease-in-out infinite;-o-animation:dot 1.5s ease-in-out infinite;animation:dot 1.5s ease-in-out infinite;-webkit-animation-delay:.1s;-moz-animation-delay:.1s;-o-animation-delay:.1s;animation-delay:.1s}.three.jsx-fcfe85a13ecbf46b{opacity:.1;-webkit-animation:dot 1.5s ease-in-out infinite;-moz-animation:dot 1.5s ease-in-out infinite;-o-animation:dot 1.5s ease-in-out infinite;animation:dot 1.5s ease-in-out infinite;-webkit-animation-delay:.2s;-moz-animation-delay:.2s;-o-animation-delay:.2s;animation-delay:.2s}@-webkit-keyframes dot{\n            0% {\n              opacity: 0.1;\n            }\n            50% {\n              opacity: 1;\n            }\n            100% {\n              opacity: 0.1;\n            }\n        }@-moz-keyframes dot{\n            0% {\n              opacity: 0.1;\n            }\n            50% {\n              opacity: 1;\n            }\n            100% {\n              opacity: 0.1;\n            }\n        }@-o-keyframes dot{\n            0% {\n              opacity: 0.1;\n            }\n            50% {\n              opacity: 1;\n            }\n            100% {\n              opacity: 0.1;\n            }\n        }@keyframes dot{\n            0% {\n              opacity: 0.1;\n            }\n            50% {\n              opacity: 1;\n            }\n            100% {\n              opacity: 0.1;\n            }\n        }"}),(0,o.tZ)("span",(0,a.Z)((0,i.Z)({},t),{className:"jsx-fcfe85a13ecbf46b "+(t&&null!=t.className&&t.className||"one"),children:"."})),(0,o.tZ)("span",(0,a.Z)((0,i.Z)({},t),{className:"jsx-fcfe85a13ecbf46b "+(t&&null!=t.className&&t.className||"two"),children:"."})),(0,o.tZ)("span",(0,a.Z)((0,i.Z)({},t),{className:"jsx-fcfe85a13ecbf46b "+(t&&null!=t.className&&t.className||"three"),children:"."}))]})}},25386:function(e,t,n){var r=n(47568),i=n(10253),a=n(29815),o=n(34051),c=n.n(o),s=n(35944),l=n(60536),u=n.n(l),d=n(67294),f=n(99408),p=n(83261),h=n(35256),m=n(58794),v=n(15519),g=n(93058),b=n(86292),x=n(48551),Z=n(26224),y=n(29163),w=n(55528),k=n(56030),E=n(77365),S=n(81255),C=n(9117),T=n(79652),R=n(65975),_=36,I=function(){return(0,s.BX)("div",{className:"jsx-3e741e4d889c73d "+u().dynamic([["7b5cc3030f1a201a",[_]]])+" file-header-format-button",children:[(0,s.tZ)("div",{className:"jsx-3e741e4d889c73d "+u().dynamic([["7b5cc3030f1a201a",[_]]])+" file-header-format-icon",children:(0,s.BX)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16.581 16.428",className:"jsx-3e741e4d889c73d "+u().dynamic([["7b5cc3030f1a201a",[_]]]),children:[(0,s.tZ)("path",{d:"M13.26.747H3.323A2.569,2.569,0,0,0,.754,3.316h0v9.795a2.569,2.569,0,0,0,2.568,2.57h9.937a2.569,2.569,0,0,0,2.569-2.569h0V3.316A2.569,2.569,0,0,0,13.26.747Z",className:"jsx-3e741e4d889c73d "+u().dynamic([["7b5cc3030f1a201a",[_]]])+" cls-1"}),(0,s.tZ)("path",{d:"M13.118,11.269a.759.759,0,0,1-.759.759H3.921a.759.759,0,0,1-.759-.759V11.23a.671.671,0,0,1,.689-.653l.07.006h8.438a.671.671,0,0,1,.753.578.7.7,0,0,1,.006.069ZM3.161,5.111V5.073a.759.759,0,0,1,.759-.759h8.439a.759.759,0,0,1,.759.759v.038a.759.759,0,0,1-.759.759H3.921a.759.759,0,0,1-.76-.758ZM3.148,8.2a.759.759,0,0,1,.758-.76H8.4a.759.759,0,0,1,.759.759v.038a.759.759,0,0,1-.759.759H3.907a.759.759,0,0,1-.759-.759Z",className:"jsx-3e741e4d889c73d "+u().dynamic([["7b5cc3030f1a201a",[_]]])+" cls-2"})]})}),(0,s.tZ)(u(),{id:"3e741e4d889c73d",children:".file-header-format-button.jsx-3e741e4d889c73d .cls-1{fill:var(--foreground-default)}.file-header-format-button.jsx-3e741e4d889c73d .cls-2{fill:var(--background-default)}"}),(0,s.tZ)(u(),{id:"7b5cc3030f1a201a",dynamic:[_],children:".file-header-format-button.__jsx-style-dynamic-selector{padding:0 10px;height:100%;width:".concat(_,"px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;cursor:pointer;opacity:.7}.file-header-format-button.__jsx-style-dynamic-selector:hover{opacity:1}.file-header-format-icon.__jsx-style-dynamic-selector{height:16px;width:16px;cursor:pointer}")})]})};function P(e){var t=e.filePath,n=e.replLanguage,a=(0,f.Z)(),o=a.fs,s=a.container,l=(0,p.Z)({container:s,service:"format",skip:!v.Z.supportsFormatting(n)}).channel,u=(0,i.Z)(d.useState(!1),2),b=u[0],x=u[1],Z=(0,g.Z)().showError,y=function(){return x(!1)};return d.useEffect((function(){if(b&&l){var e=!1,n=[],i=o.watchOtFile(t,{onReady:function(e){!function(e,t){a.apply(this,arguments)}(e.initialContent,e.writeOp)},onChange:function(e){var t=e.op;n=h.compose(t,n)},onError:function(){y()},onMoveOrDelete:function(){y()}});return function(){e=!0,i()}}function a(){return(a=(0,r.Z)(c().mark((function r(i,a){var o,s,u,d;return c().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!e&&l){r.next=2;break}return r.abrupt("return");case 2:if(0!==i.length){r.next=5;break}return y(),r.abrupt("return");case 5:return r.next=7,l.request({file:{path:t,content:i.toBuffer()}});case 7:if(o=r.sent,!e){r.next=10;break}return r.abrupt("return");case 10:if(!o.error&&o.file){r.next=14;break}return Z("Failed to format ".concat(t),1500),y(),r.abrupt("return");case 14:if(0!==(s=m.Z.from(o.file.content)).length){r.next=18;break}return y(),r.abrupt("return");case 18:if(0!==(u=h.diffStr(i.toString(),s.toString())).length){r.next=22;break}return y(),r.abrupt("return");case 22:if(0!==(d=n.length>0?h.transform(u,n,"left"):u).length){r.next=26;break}return y(),r.abrupt("return");case 26:a(d),y();case 28:case"end":return r.stop()}}),r)})))).apply(this,arguments)}}),[l,t,o,b,Z]),d.useEffect(y,[t]),v.Z.supportsFormatting(n)?function(){return x(!0)}:null}function D(e){var t=e.formatWithLsp,n=e.formatWithService,r=e.replLanguage,i=e.filePath,a=(null===t||void 0===t?void 0:t.fn)||n;if(!a)throw new Error("Expected format function");(0,b.j)(b.U3.AUTO_FORMAT_USED,{language:r,extension:(0,x.r6)(i)}),a()}t.Z=function(e){var t=e.filePath,n=e.replLanguage,i=e.inline,o=e.onComplete,l=e.disableKeyboardShortcut,u=P({filePath:t,replLanguage:n}),p=function(e){var t,n=e.filePath,i=(0,Z.Z)().preferences,o=(0,f.Z)().fs,s=(0,w.Z)(n),l=Boolean(null===(t=null===s||void 0===s?void 0:s.getServerCapabilities())||void 0===t?void 0:t.documentFormattingProvider),u=(0,d.useState)([]),p=u[0],m=u[1],v=(0,g.Z)(),b=v.showError,x=v.showConfirm;return l?{fn:function(){if(!p.includes(n)){m((function(e){return(0,a.Z)(e).concat([n])}));var e=[],t=function(e){e?b("Sorry, formatting ".concat(n," failed"),1500):x("Formatted ".concat(n," successfully"),1500),l(),m((function(e){return e.filter((function(e){return e!==n}))}))},l=o.watchOtFile(n,{onReady:function(){var a=(0,r.Z)(c().mark((function r(a){var o,l,u,d,f;return c().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o=a.initialContent,l=a.writeOp,s){r.next=3;break}throw new Error("LSP client not found");case 3:return r.next=5,s.request.format(n,{insertSpaces:i.indentIsSpaces,tabSize:i.indentSize});case 5:if(!("error"in(u=r.sent))){r.next=9;break}return t(!0),r.abrupt("return");case 9:if(!u.cancelled){r.next=12;break}return t(!0),r.abrupt("return");case 12:if(u.result){r.next=15;break}return t(!0),r.abrupt("return");case 15:if(d=(0,k.Z)(u.result,o.toString()),0!==(f=e.length>0?h.transform(d,e,"left"):d).length){r.next=20;break}return t(),r.abrupt("return");case 20:l(f),t();case 22:case"end":return r.stop()}}),r)})));return function(e){return a.apply(this,arguments)}}(),onChange:function(t){var n=t.op;e=h.compose(n,e)}})}},isFormatting:p.includes(n)}:null}({filePath:t});if((0,C.x)({cmdOrCtrlKey:!0,altKey:!1,shiftKey:!1,key:"S"},{enabled:Boolean(!l&&(0,x.Mb)(t)&&(p||u)),run:function(){D({formatWithLsp:p,formatWithService:u,replLanguage:n,filePath:t})}}),!(0,x.Mb)(t)||!p&&!u)return null;var m=(0,x.eb)(t),v=function(){D({formatWithLsp:p,formatWithService:u,replLanguage:n,filePath:t}),o&&o()};return i?(0,s.tZ)(R.zx,{text:"Format",iconLeft:(0,s.tZ)(T.Z,{}),onClick:v}):(0,s.tZ)(y.Z,{css:[S.l0.zIndex(1),{alignSelf:"center"}],alt:(null===p||void 0===p?void 0:p.isFormatting)?"Formatting ".concat(m,", please wait"):"Format ".concat(m," code"),tooltipPlacement:"left-end",onClick:v,children:(null===p||void 0===p?void 0:p.isFormatting)?(0,s.tZ)(E.Z,{}):(0,s.tZ)(I,{})})}},30439:function(e,t,n){n.d(t,{BW:function(){return l},Fc:function(){return u}});var r=n(26042),i=n(7297),a=n(31230),o=n(46829);function c(){var e=(0,i.Z)(["\n  query RunningOutOfCyclesBanner {\n    currentUser {\n      id\n      cycles {\n        forecast(daysFromNow: 7) {\n          ... on CyclesForecast {\n            hasSufficientCycles\n          }\n        }\n      }\n    }\n  }\n"]);return c=function(){return e},e}var s={},l=(0,a.ZP)(c());function u(e){var t=(0,r.Z)({},s,e);return o.useQuery(l,t)}},4445:function(e,t,n){n.d(t,{E:function(){return r},c:function(){return i}});var r="Procfile";function i(e){var t={};return e.split("\n").forEach((function(e){if(""!==e){var n=e.match(/^([A-Za-z0-9_]+):\s*(.+)$/);if(n){var r=n[2].trim().split(" "),i=n[1];t[i]={command:r[0],options:r.slice(1)}}}})),t}},16449:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(10253),i=n(67294),a=n(79367),o=n.n(a),c=n(43797);function s(){var e=(0,r.Z)(i.useState(null),2),t=e[0],n=e[1];return(0,c.Z)((function(){if(t)return o()(t),function(){o().destroy(t)}}),[t]),{ref:n,update:function(){t&&o().update(t)}}}},47979:function(e,t,n){n.d(t,{f6:function(){return l},oj:function(){return s},xZ:function(){return d}});var r=n(10253),i=n(67294),a=n(99408),o=n(40381);function c(e){var t=(0,r.Z)(i.useState(!1),2),n=t[0],o=t[1],c=(0,a.Z)().dotReplit;return i.useEffect((function(){var t=!1;return c.getConfig().then((function(n){t||n.error||n.config.language===e&&o(!0)})),function(){t=!0}}),[e,c]),n}function s(){return c("kaboom")}function l(){return c("kaboomdraw")}var u=/^draw.[tj]s$/;function d(){var e=(0,o.Z)();return l()&&Boolean(null===e||void 0===e?void 0:e.match(u))}},58482:function(e,t,n){n.d(t,{Z:function(){return u}});var r=n(11163),i=n.n(r),a=n(99408),o=n(67294),c=n(65456),s=n(13482),l="You have unsaved changes";function u(){var e=(0,a.Z)().fs,t=(0,r.useRouter)(),n=(0,o.useState)(!1),u=n[0],d=n[1],f=(0,o.useRef)(!1),p=function(){if(!f.current&&!window.confirm(l))throw i().events.emit("routeChangeError"),i().replace(i(),i().asPath),new Error("Abort route change. Please ignore this error.")};return(0,o.useEffect)((function(){return d(e.getStatus()===c.kO.Syncing),e.onStatusChange((function(e){d(e===c.kO.Syncing)}))}),[e]),(0,o.useEffect)((function(){var e=function(e){if(!f.current)return e.preventDefault(),e.returnValue=l,l};if(u)return window.addEventListener("beforeunload",e),s.g||t.events.on("routeChangeStart",p),function(){window.removeEventListener("beforeunload",e),s.g||t.events.off("routeChangeStart",p)}}),[u,t.events]),function(e){return f.current=e}}},18888:function(e,t,n){n.d(t,{Z:function(){return m}});var r=n(10253),i=n(67294),a=n(26042),o=n(7297),c=n(31230),s=n(46829);function l(){var e=(0,o.Z)(["\n  mutation ReplFsUpdated($replId: String!) {\n    updateReplTimeUpdated(id: $replId) {\n      ... on Repl {\n        id\n        timeUpdated\n      }\n    }\n  }\n"]);return l=function(){return e},e}var u={},d=(0,c.ZP)(l());var f=n(37053),p=n(2916),h=n(99408);function m(){var e=(0,r.Z)(function(e){var t=(0,a.Z)({},u,e);return s.useMutation(d,t)}(),1)[0],t=(0,h.Z)().fs,n=(0,p.Z)(),o=null===n||void 0===n?void 0:n.currentUserPermissions.containerWrite,c=null===n||void 0===n?void 0:n.id;(0,i.useEffect)((function(){if(o&&c){var n=(0,f.Z)((function(){return e({variables:{replId:c}})}),{wait:6e4,maxWait:6e5}),r=t.onStatusChange((function(){n()}));return function(){n.isScheduled()&&n.flush(),r()}}}),[t,c,o,e])}},4989:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(67294),i=n(63805);function a(){var e=(0,r.useRef)(0),t=(0,r.useState)(!1),n=t[0],a=t[1],o=window.visualViewport;return(0,r.useEffect)((function(){if(o&&(0,i.isMobile)({tablet:!1})){var t=function(){var t=o.height<.8*e.current;a(t)};return e.current=o.height,o.addEventListener("resize",t),function(){o.removeEventListener("resize",t)}}}),[o]),n}},35923:function(e,t,n){n.d(t,{V:function(){return m},Q:function(){return y}});var r=n(82670),i=n(26042),a=n(53144),o=n(51438),c=.5*(Math.sqrt(3)-1),s=(3-Math.sqrt(3))/6,l=new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]),u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Math.random;(0,o.Z)(this,e);var n="function"===typeof t?t:f(t);this.p=d(n),this.perm=new Uint8Array(512),this.permMod12=new Uint8Array(512);for(var r=0;r<512;r++)this.perm[r]=this.p[255&r],this.permMod12[r]=this.perm[r]%12}return e.prototype.noise2D=function(e,t){var n,r,i=this.permMod12,a=this.perm,o=0,u=0,d=0,f=(e+t)*c,p=Math.floor(e+f),h=Math.floor(t+f),m=(p+h)*s,v=e-(p-m),g=t-(h-m);v>g?(n=1,r=0):(n=0,r=1);var b=v-n+s,x=g-r+s,Z=v-1+2*s,y=g-1+2*s,w=255&p,k=255&h,E=.5-v*v-g*g;if(E>=0){var S=3*i[w+a[k]];o=(E*=E)*E*(l[S]*v+l[S+1]*g)}var C=.5-b*b-x*x;if(C>=0){var T=3*i[w+n+a[k+r]];u=(C*=C)*C*(l[T]*b+l[T+1]*x)}var R=.5-Z*Z-y*y;if(R>=0){var _=3*i[w+1+a[k+1]];d=(R*=R)*R*(l[_]*Z+l[_+1]*y)}return 70*(o+u+d)},e}();function d(e){for(var t=new Uint8Array(256),n=0;n<256;n++)t[n]=n;for(var r=0;r<255;r++){var i=r+~~(e()*(256-r)),a=t[r];t[r]=t[i],t[i]=a}return t}function f(e){var t=0,n=0,r=0,i=1,a=function(){var e=4022871197;return function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)}}();return t=a(" "),n=a(" "),r=a(" "),(t-=a(e))<0&&(t+=1),(n-=a(e))<0&&(n+=1),(r-=a(e))<0&&(r+=1),function(){var e=2091639*t+2.3283064365386963e-10*i;return t=n,n=r,r=e-(i=0|e)}}var p=new u;var h=n(25108);function m(e){var t=!1,n=0,r=0,i=null,a=function(c){if(t){var s=c-n;r+=s,n=c,i=window.requestAnimationFrame(a),e({elapsedTime:r,deltaTime:s,stop:o})}},o=function(){t&&(t=!1,i&&window.cancelAnimationFrame(i))};return{start:function(){t||(r=0,n=performance.now(),t=!0,i=window.requestAnimationFrame(a))},stop:o}}var v=function(){return(0,a.hd)(600,1200)},g=function(){return(0,a.hd)(1,3)},b=function(){return{width:(0,a.hd)(5,20),height:(0,a.hd)(5,20)}},x=function(){return(0,a.vF)()};function Z(e){return Array.isArray(e)?(0,a.DQ)(e):(0,r.Z)(e,Function)?e():e}function y(){var e=!1,t=null,n=null,r=[],o=null,c={},s=function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=function(){var e=i.value;if(c[e])return"continue";var t=new Image;t.src=e,t.onerror=function(){h.error('Failed to load particle image "'.concat(e,'"'))},c[e]=t},o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0)a()}catch(s){n=!0,r=s}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}};return{getIsInstalled:function(){return e},addParticles:function(e){for(var t=e.x,n=e.y,l=e.numParticles,u=void 0===l?150:l,d=e.spread,f=void 0===d?60:d,p=e.heading,h=void 0===p?90:p,m=e.airDrag,y=void 0===m?.9:m,w=e.color,k=void 0===w?x:w,E=e.gravity,S=void 0===E?800:E,C=e.velocity,T=void 0===C?v:C,R=e.size,_=void 0===R?b:R,I=e.lifetime,P=void 0===I?g:I,D=e.flip,A=void 0===D||D,N=e.image,U=void 0===N?void 0:N,j=Z(f),B=Z(h),O=(0,a.Id)(j),G=(0,a.Id)(-B),L=Z(u),M=0;M<L;M++){var z=G+(0,a.hd)(-O/2,O/2),F=Z(T),X=Z(_),W=X.width,H=X.height,V=Z(P),$=Z(k),q=Z(y),Q=Z(t),K=Z(n),Y=Z(U);"string"===typeof Y&&(c[Y]||s([Y]),Y=c[Y]),r.push((0,i.Z)({seed:(0,a.hd)(0,1e5),x:Q,y:K,gravity:S,airDrag:q,scaleX:1,scaleY:1,rotation:(0,a.hd)(0,(0,a.Id)(360)),velocityX:Math.cos(z)*F,velocityY:Math.sin(z)*F,angularVelocity:(0,a.hd)((0,a.Id)(-400),(0,a.Id)(400)),color:$,alpha:1,width:W,height:H,flip:A,lifetime:V,lifetimeRemaining:V},Y?{image:Y,type:"image"}:{type:(0,a.DQ)(["rectangle","ellipse"])}))}null===o||void 0===o||o.start()},clearParticles:function(){r=[]},uninstall:function(){e&&(t&&document.body.contains(t)&&document.body.removeChild(t),o&&o.stop(),t=null,n=null,e=!1,c={})},install:function(){e||(t=function(){var e=document.createElement("canvas");return e.style.position="fixed",e.style.top="0px",e.style.left="0px",e.style.pointerEvents="none",e.style.zIndex="999999",e.width=document.documentElement.clientWidth,e.height=document.documentElement.clientHeight,e.id="replit-particles-simulation",e.setAttribute("role","image"),e.ariaHidden="true",e}(),(n=t.getContext("2d"))&&(document.body.appendChild(t),o=m((function(e){var i=e.deltaTime,o=e.stop;if(t&&n){var c=n,s=window.scrollX,l=window.scrollY;t.width!==document.documentElement.clientWidth&&(t.width=document.documentElement.clientWidth),t.height!==document.documentElement.clientHeight&&(t.height=document.documentElement.clientHeight),n.clearRect(0,0,t.width,t.height),r.map((function(e){return function(e){var t=e.particle,n=e.deltaTime;t.velocityY+=t.gravity*n/1e3,t.x+=t.velocityX*n/1e3,t.y+=t.velocityY*n/1e3,t.rotation+=t.angularVelocity*n/1e3,t.velocityX*=t.airDrag,t.velocityY*=t.airDrag,t.flip&&(t.scaleY=2*(0,a.WE)(t.lifetimeRemaining,.5));var r=(0,a.NC)(t.velocityX,t.velocityY),i=(0,a.$G)(t.velocityX,t.velocityY),o=r+.05*p.noise2D(t.seed,t.lifetimeRemaining);t.velocityX=Math.cos(o)*i,t.velocityY=Math.sin(o)*i,t.lifetimeRemaining-=n/1e3,t.lifetimeRemaining<=0?t.alpha=0:t.alpha=1-(t.lifetime-t.lifetimeRemaining)/t.lifetime}({particle:e,deltaTime:i})})),r.map((function(e){return function(e){var t=e.particle,n=e.ctx,r=e.scrollX,i=e.scrollY,a=t.width*t.scaleX,o=t.height*t.scaleY,c=t.x-r,s=t.y-i;n.save(),n.translate(c,s),n.rotate(t.rotation),n.globalAlpha=t.alpha,"image"===t.type?n.drawImage(t.image,-a/2,-o/2,a,o):"rectangle"===t.type?(n.fillStyle=t.color,n.fillRect(-a/2,-o/2,a,o)):"ellipse"===t.type&&(n.fillStyle=t.color,n.beginPath(),n.ellipse(0,0,a/2,o/2,0,0,2*Math.PI),n.fill()),n.restore()}({particle:e,ctx:c,scrollX:s,scrollY:l})})),0===(r=r.filter((function(e){return e.lifetimeRemaining>0}))).length&&o()}})),e=!0))},preloadImages:s,unloadImages:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;delete c[o]}}catch(s){n=!0,r=s}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}}}},98146:function(e,t,n){n.d(t,{$0:function(){return r.$},hd:function(){return i.hd},su:function(){return r.s}});var r=n(46808),i=n(53144)},46808:function(e,t,n){n.d(t,{$:function(){return h},s:function(){return r}});var r,i=n(26042),a=n(99534),o=n(10253),c=n(67294),s=n(53144),l=n(35923),u=n(91131),d=n(42895),f=(0,l.Q)(),p=(0,u.cn)(f);function h(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).preloadImages,t=(0,o.Z)((0,u.KO)(p),1),n=t[0],r=(0,d.T)();c.useEffect((function(){return n.install(),function(){n.uninstall()}}),[n]),c.useEffect((function(){e&&n.preloadImages(e)}),[n,e]);var l=function(e){r||n.addParticles(e)},f=function(e){var t=e.element,n=(0,a.Z)(e,["element"]);if(!r){var o=(0,s.tj)(t),c=o.x,u=o.y;l((0,i.Z)({x:c,y:u},n))}},h=function(e){r||n.addParticles((0,i.Z)({numParticles:125,spread:360,velocity:function(){return(0,s.hd)(400,900)},size:function(){return{width:(0,s.hd)(5,15),height:(0,s.hd)(5,25)}}},e))},m=function(e){var t=e.element,n=(0,a.Z)(e,["element"]);if(!r){var o=(0,s.tj)(t),c=o.x,l=o.y;h((0,i.Z)({x:c,y:l},n))}},v=function(e){var t=e.direction,o=(0,a.Z)(e,["direction"]);r||n.addParticles((0,i.Z)({heading:t},o))},g=function(e){var t=e.element,o=e.direction,c=(0,a.Z)(e,["element","direction"]);if(!r){var l=(0,s.tj)(t),u=l.x,d=l.y;n.addParticles((0,i.Z)({x:u,y:d,numParticles:100,velocity:function(){return(0,s.hd)(400,1500)},spread:60,size:function(){return{width:(0,s.hd)(5,15),height:(0,s.hd)(5,25)}},heading:o},c))}};return{fireBurst:l,fireBurstFrom:f,fireCircularBurst:h,fireCircularBurstFrom:m,fireDirectionalBurst:v,fireDirectionalBurstFrom:g}}!function(e){e[e.East=0]="East",e[e.NorthEast=45]="NorthEast",e[e.North=90]="North",e[e.NorthWest=135]="NorthWest",e[e.West=180]="West",e[e.SouthWest=225]="SouthWest",e[e.South=270]="South"}(r||(r={}))},53144:function(e,t,n){n.d(t,{$G:function(){return d},DQ:function(){return o},Id:function(){return l},NC:function(){return u},WE:function(){return p},hd:function(){return c},tj:function(){return i},vF:function(){return s}});var r=n(99621);function i(e){var t=function(e){var t=e.getBoundingClientRect();return{x:t.left+t.width/2,y:t.top+t.height/2}}(e);return{x:t.x+window.scrollX,y:t.y+window.scrollY}}function a(e,t){return(0,r.Z)(e,t,!1)}function o(e){return e[a(0,e.length-1)]}function c(e,t){return(0,r.Z)(e,t,!0)}function s(){return"hsl(".concat(a(0,360),", 100%, 70%)")}function l(e){return e*Math.PI/180}function u(e,t){return Math.atan2(t,e)}function d(e,t){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2))}function f(e,t){return(e%t+t)%t}function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t-Math.abs(f(e,2*t)-t)}},56919:function(e,t,n){n.d(t,{t:function(){return s}});var r=n(7297),i=n(51889),a=n(31230),o=n(52892);function c(){var e=(0,r.Z)(["\n  mutation deleteRepl($id: String!) {\n    deleteRepl(id: $id) {\n      id\n    }\n  }\n"]);return c=function(){return e},e}(0,a.ZP)(c());var s=function(e){var t=(0,o.Z)({id:e.id,__typename:e.__typename||"Repl"}),n=function(e,n){return n.node.id===t};return(0,i._M)((function(){return[["data",i.Dx,"recentRepls",n],["data",t]]}))}},31557:function(e,t,n){function r(e){if(!e)return!1;try{var t=new URL(e);return Boolean(t)}catch(n){return!1}}n.d(t,{Z:function(){return r}})},75474:function(e,t,n){n.d(t,{Z:function(){return R}});var r=n(10253),i=n(35944),a=n(60536),o=n.n(a),c=n(67294),s=n(86292),l=n(6951),u=n(44781),d=n(93058),f=n(26042),p=n(7297),h=n(31230),m=n(46829);function v(){var e=(0,p.Z)(["\n  query MultiplayerInviteUrl($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        inviteUrl\n        owner {\n          ... on User {\n            id\n          }\n          ... on Team {\n            id\n          }\n        }\n      }\n    }\n  }\n"]);return v=function(){return e},e}function g(){var e=(0,p.Z)(["\n  mutation MultiplayerRefreshInviteUrl($replId: String!) {\n    refreshMultiplayerInviteLink(replId: $replId) {\n      id\n      ... on Repl {\n        id\n        inviteUrl\n      }\n    }\n  }\n"]);return g=function(){return e},e}function b(){var e=(0,p.Z)(["\n  mutation DeleteMultiplayerInviteUrl($replId: String!) {\n    deleteMultiplayerInviteLink(replId: $replId) {\n      ... on Repl {\n        id\n        inviteUrl\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n"]);return b=function(){return e},e}var x={},Z=(0,h.ZP)(v());var y=(0,h.ZP)(g());var w=(0,h.ZP)(b());var k=n(27206),E=n(19526),S=n(4158),C=n(67629),T=n(88808);function R(e){var t,n,a,p=e.replId,h=(0,d.Z)(),v=h.showConfirm,g=h.showError,b=function(e){var t=(0,f.Z)({},x,e);return m.useQuery(Z,t)}({variables:{replId:p}}),R=b.data,_=b.loading,I=b.error,P=(0,r.Z)(function(e){var t=(0,f.Z)({},x,e);return m.useMutation(y,t)}({variables:{replId:p},onError:function(e){return g(e.message)}}),2),D=P[0],A=P[1],N=(0,r.Z)(function(e){var t=(0,f.Z)({},x,e);return m.useMutation(w,t)}({variables:{replId:p},optimisticResponse:{deleteMultiplayerInviteLink:{id:p,inviteUrl:null,__typename:"Repl"},__typename:"RootMutationType"},onError:function(e){return g(e.message)},onCompleted:function(e){"UserError"!==e.deleteMultiplayerInviteLink.__typename?"Repl"===e.deleteMultiplayerInviteLink.__typename&&v("Join link deleted"):g(e.deleteMultiplayerInviteLink.message)}}),2),U=N[0],j=N[1],B=A.loading||j.loading,O=c.useRef(null),G="Repl"===(null===R||void 0===R||null===(t=R.repl)||void 0===t?void 0:t.__typename)&&"Team"===(null===(n=R.repl.owner)||void 0===n?void 0:n.__typename),L="Repl"===(null===R||void 0===R||null===(a=R.repl)||void 0===a?void 0:a.__typename)&&R.repl.inviteUrl?window.location.origin+R.repl.inviteUrl:null;c.useEffect((function(){A.error&&g(A.error.message),A.data&&(0,s.j)(s.U3.MP2_REFRESHED_LINK,{replId:p})}),[A.error,A.data,p,g]);var M=function(){O&&O.current&&O.current.select()},z=function(){return(0,i.BX)("div",{"aria-label":"Anyone on the internet with this link can join and edit this Repl","data-microtip-position":"top","data-microtip-size":"medium",role:"tooltip","data-micro":!0,className:"jsx-e33ed68cec233d59 information-icon-container",children:[(0,i.tZ)(S.Z,{}),(0,i.tZ)(o(),{id:"e33ed68cec233d59",children:".information-icon-container.jsx-e33ed68cec233d59{margin-left:5px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;text-align:center}"})]})};return _?(0,i.tZ)(u.Z,{children:"loading..."}):I?(0,i.tZ)(u.Z,{children:"Error: please contact support"}):L?(0,i.BX)(E.gC,{align:"stretch",spacing:1,children:[(0,i.tZ)(u.Z,{foreground:2,size:"small",children:(0,i.BX)(E.Ug,{align:"center",children:["Invite ",G?"guests":"friends"," with a join link",z()]})}),(0,i.BX)(E.Ug,{wrap:"nowrap",align:"center",spacing:1,children:[(0,i.tZ)("div",{className:"jsx-1dd1818beded4b33 input-link",children:(0,i.tZ)(k.ZP,{ref:O,readOnly:!0,onChange:function(){return null},value:B?"loading...":L,onClick:M})}),(0,i.tZ)("div",{"aria-label":"Copy","data-microtip-position":"bottom",role:"tooltip",className:"jsx-1dd1818beded4b33",children:(0,i.tZ)(l.Z,{color:"primary",Icon:T.Z,onClick:function(){M(),document.execCommand("copy"),v("Link copied")}})}),(0,i.tZ)("div",{"aria-label":"Delete link","data-microtip-position":"bottom",role:"tooltip",className:"jsx-1dd1818beded4b33",children:(0,i.tZ)(l.Z,{color:"red",Icon:C.Z,onClick:function(e){e.preventDefault(),B||U()}})})]}),(0,i.BX)(u.Z,{size:"small",foreground:2,children:[(0,i.tZ)("a",{onClick:function(e){e.preventDefault(),B||D()},className:"jsx-1dd1818beded4b33",children:"Generate a new link"})," ","(The current one will stop working)"]}),(0,i.tZ)(o(),{id:"1dd1818beded4b33",children:".input-link.jsx-1dd1818beded4b33{-webkit-box-flex:1;-webkit-flex:1 1 auto;-moz-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}.input-link.jsx-1dd1818beded4b33 input{cursor:text!important}"})]}):(0,i.tZ)("div",{style:{marginTop:"var(--space-8)"},children:(0,i.tZ)(l.Z,{fullWidth:!0,color:"default",onClick:function(){B||D()},children:(0,i.BX)(E.Ug,{align:"center",children:["Generate a join link",z()]})})})}},87238:function(e,t,n){n.d(t,{Pk:function(){return v},Ux:function(){return g},Vg:function(){return x},eX:function(){return y}});var r=n(26042),i=n(7297),a=n(31230),o=n(9523),c=n(46829);function s(){var e=(0,i.Z)(["\n  query ReplEnvironmentServicesConnector($id: String!) {\n    repl(id: $id) {\n      ... on Repl {\n        id\n        ...CrosisContextRepl\n      }\n    }\n    currentUser {\n      id\n      ...CrosisContextCurrentUser\n    }\n  }\n  ","\n  ","\n"]);return s=function(){return e},e}function l(){var e=(0,i.Z)(["\n  query ReplEnvironmentServicesConnectorPermissions($id: String!) {\n    repl(id: $id) {\n      ... on Repl {\n        id\n        permissions {\n          id\n        }\n      }\n    }\n  }\n"]);return l=function(){return e},e}function u(){var e=(0,i.Z)(["\n  query ReplEnvironmentServicesConnectorTitle($id: String!) {\n    repl(id: $id) {\n      ... on Repl {\n        id\n        title\n      }\n    }\n  }\n"]);return u=function(){return e},e}function d(){var e=(0,i.Z)(["\n  query ReplEnvironmentServicesConnectorCurriculum($id: String!) {\n    currentUser {\n      id\n      isTeacher: hasRole(role: TEACHER)\n      ...CrosisContextCurrentUser\n    }\n    repl(id: $id) {\n      ... on Repl {\n        id\n        isProject\n        isProjectFork\n        isModelSolution\n        isModelSolutionFork\n        owner {\n          ... on Team {\n            id\n          }\n          ... on User {\n            id\n          }\n        }\n        language\n        origin {\n          id\n          ...CrosisContextRepl\n          origin {\n            id\n            ...CrosisContextRepl\n          }\n        }\n      }\n    }\n  }\n  ","\n  ","\n"]);return d=function(){return e},e}function f(){var e=(0,i.Z)(["\n  subscription ReplEnvironmentUserCanWrite($replId: String!) {\n    currentUserCanWrite(replId: $replId)\n  }\n"]);return f=function(){return e},e}function p(){var e=(0,i.Z)(["\n  query ReplEnvironmentServicesConnectorShowHiddenFiles($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        templateInfo {\n          label\n        }\n      }\n    }\n  }\n"]);return p=function(){return e},e}function h(){var e=(0,i.Z)(["\n  query ReplEnvironmentServicesConnectorAdminTracking($id: String!) {\n    repl(id: $id) {\n      ... on Repl {\n        id\n        url\n        language\n        isProjectFork\n        owner {\n          ... on Team {\n            id\n          }\n          ... on User {\n            id\n          }\n        }\n      }\n    }\n    currentUser {\n      id\n      teams {\n        id\n        isAdmin\n      }\n    }\n  }\n"]);return h=function(){return e},e}var m={},v=(0,a.ZP)(s(),o.C,o.D);l();var g=(0,a.ZP)(u());d(),o.D,o.C;var b=(0,a.ZP)(f());function x(e){var t=(0,r.Z)({},m,e);return c.useSubscription(b,t)}var Z=(0,a.ZP)(p());function y(e){var t=(0,r.Z)({},m,e);return c.useQuery(Z,t)}h()},5442:function(e,t,n){n.d(t,{Z:function(){return c}});var r=n(67294),i=n(99408),a=n(63377),o=n(87238);function c(){var e=(0,i.Z)().session,t=(0,a.Z)(),n=(0,o.eX)({variables:{replId:t}}).data,c="Repl"===(null===n||void 0===n?void 0:n.repl.__typename)?n.repl:null;r.useEffect((function(){var t;c&&(null===(t=c.templateInfo)||void 0===t?void 0:t.label.includes("Blank Repl"))&&e.setAreHiddenFilesVisible(!0)}),[e,c])}},536:function(e,t,n){n.d(t,{Z:function(){return f}});var r=n(7787),i=n(40381),a=n(63377),o=n(67294),c=n(48551),s=n(99408),l=n(32117);function u(e){var t=Boolean(window.performance.getEntriesByName(r.Iy.pageNavStart,"mark").length),n="time to code";window.performance.measure(n,t?r.Iy.pageNavStart:void 0);var i=window.performance.getEntriesByName(n,"measure")[0];if(i){var a="page invisible fetch connection metadata",o=i.duration;if(Boolean(window.performance.getEntriesByName(r.Iy.fetchConnectionMetadataPageInvisibleStart,"mark").length))window.performance.measure(a,r.Iy.fetchConnectionMetadataPageInvisibleStart,r.Iy.fetchConnectionMetadataPageInvisibleEnd),o-=window.performance.getEntriesByName(a,"measure")[0].duration,window.performance.clearMeasures(a),window.performance.clearMarks(r.Iy.fetchConnectionMetadataPageInvisibleStart),window.performance.clearMarks(r.Iy.fetchConnectionMetadataPageInvisibleEnd);r.kg.time("time to code minus page invisible",o,{ssr:!t,workspaceType:e}),r.kg.time("time to code with page invisible",i.duration,{ssr:!t,workspaceType:e}),window.performance.clearMeasures(n),l.v.addTiming("time_to_code_minus_page_invisible",o),l.v.addTiming("time_to_code_with_page_invisible",i.duration)}else r.kg.info("Could not obtain measure for time to code",{workspaceType:e})}var d=new Set;function f(e){var t=e.workspaceType,n=(0,a.Z)(),r=(0,i.Z)(),l=(0,s.Z)().fs;(0,o.useEffect)((function(){var e;if(r&&!d.has(n))return d.add(n),e=(0,c.Mb)(r)?l.watchOtFile(r,{onReady:function(){u(t),e()}}):l.watchFile(r,{onChange:function(){u(t),e()}})}),[r,n,t,l])}},46701:function(e,t,n){n.d(t,{gx:function(){return d}});var r=n(35944),i=n(67294),a=n(91131),o=n(69346),c=n(14921),s=n(65975),l=n(2548),u=n(1144),d=(0,a.cn)(!1),f=function(e){var t=e.reason;return(0,r.BX)(o.ZP,{css:[s.l0.center,s.l0.minWidth(225),s.l0.height(225),s.l0.p(16),s.l0.color.foregroundDefault,s.l0.backgroundColor.backgroundOverlay,s.l0.zIndex(5e5),{cursor:"not-allowed"}],children:[(0,r.tZ)(l.Z,{height:80}),(0,r.BX)(u.x,{variant:"subheadBig",css:[s.l0.mt(32)],dataCy:"import-loading-spinner",children:[t,"..."]})]})};function p(){return(0,a.Dv)(d)?(0,r.tZ)(c.Z,{children:(0,r.tZ)(o.ZP,{css:[s.l0.position.fixed,s.l0.flex.row,s.l0.align.center,s.l0.justify.center,s.l0.backgroundColor.backgroundOverlay,{top:0,bottom:0,left:0,right:0,zIndex:5e5,cursor:"not-allowed"}],children:(0,r.tZ)(f,{reason:"Importing"})})}):null}t.ZP=(0,i.memo)(p)},23445:function(e,t,n){n.d(t,{Z:function(){return ie},k:function(){return re}});var r=n(35944),i=n(67294),a=n(91131),o=n(40705),c=n(63377),s=n(47979),l=n(26042),u=n(7297),d=n(31230),f=n(46829);function p(){var e=(0,u.Z)(["\n  fragment ReplEnvironmentDockRepl on Repl {\n    isProjectFork\n    isModelSolution\n    isProject\n    isProjectFork\n    owner {\n      __typename\n      ... on Team {\n        id\n        isAdmin\n      }\n      ... on User {\n        id\n      }\n    }\n    currentUserPermissions {\n      containerWrite\n    }\n    lang {\n      id\n      key\n      engine\n      supportsGit\n      hasLibSearch\n      supportsPackager3\n      hasDAP\n    }\n    config {\n      isServer\n    }\n  }\n"]);return p=function(){return e},e}function h(){var e=(0,u.Z)(["\n  query ReplEnvironmentDock($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        ...ReplEnvironmentDockRepl\n      }\n    }\n    currentUser {\n      id\n      isAdmin: hasRole(role: ADMIN)\n    }\n  }\n  ","\n"]);return h=function(){return e},e}var m={},v=(0,d.ZP)(p()),g=(0,d.ZP)(h(),v);var b=n(24888),x=n(62944),Z=n(87514),y=n(83074),w=n(89364),k=n(82893),E=n(1557),S=n(42844),C=n(88075),T=n(54774),R=n(86514),_=n(3234),I=n(29780),P=n(99408),D=n(47568),A=n(34051),N=n.n(A),U=n(6951),j=n(44781),B=n(19526),O=n(70804),G=n(30019),L=n(12215),M=n(81255);function z(e){var t=e.isVisible,n=e.children,a=e.onDismiss,o=(0,c.Z)(),s=(0,P.Z)().fs,l=(0,L.Z)("workspace","enveditorintro"),u=l.shouldDisplay,d=l.register,f=l.dismiss;return i.useEffect((function(){var e=!1,n=function(){var n=(0,D.Z)(N().mark((function n(){var r;return N().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.readFile(".env");case 2:if(r=n.sent,!e){n.next=5;break}return n.abrupt("return");case 5:if(!r.error){n.next=7;break}return n.abrupt("return");case 7:t&&d();case 8:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return n(),function(){e=!0}}),[o,s,t,d]),(0,r.tZ)("div",{css:[M.l0.display.flex,M.l0.width("100%"),M.l0.height("100%"),M.l0.center],children:(0,r.BX)(O.Z,{isOpen:u,placement:"right",showArrow:!0,children:[i.cloneElement(n,{tooltipHidden:u}),(0,r.BX)(B.gC,{spacing:1,align:"stretch",children:[(0,r.tZ)(G.Z,{level:4,children:"Looking for your .env file?"}),(0,r.tZ)(j.Z,{size:"small",children:"Your environment moved here, click on the icon to the left to check it out and edit your environment."}),(0,r.tZ)(B.Ug,{justify:"end",children:(0,r.tZ)(U.Z,{color:"primary",onClick:function(e){e.stopPropagation(),f(),a()},children:"dismiss"})})]})]})})}var F=n(11163),X=n(65e3),W=n(95901),H=n(43804),V=n(42325),$=n(35642);function q(e){var t,n,a=e.isVisible,o=e.children,s=e.onDismiss,l=(0,c.Z)(),u=(0,V.CH)({variables:{replId:l}}),d=u.data,f=u.loading,p="io-tests-popover-dismissed-".concat(l),h=$.Z.get(p,"boolean");if(!d||f)return null;var m="Repl"===(null===d||void 0===d||null===(t=d.repl)||void 0===t?void 0:t.__typename)?d.repl:null;if(!m)return null;var v=m.isProjectFork,g=m.ioTests,b=m.owner,x=(null===(n=m.unitTests)||void 0===n?void 0:n.tests)?m.unitTests.tests:[],Z="Team"===(null===b||void 0===b?void 0:b.__typename)&&(null===b||void 0===b?void 0:b.isAdmin),y=g.length>0||x.length>0,w=!Z&&v&&!h&&y&&a;return(0,r.tZ)("div",{css:[M.l0.display.flex,M.l0.width("100%"),M.l0.height("100%"),M.l0.center],children:(0,r.BX)(O.Z,{isOpen:w,placement:"right",showArrow:!0,borderColor:"var(--accent-purple-default)",children:[i.cloneElement(o,{tooltipHidden:w}),(0,r.BX)(B.gC,{spacing:1,align:"stretch",children:[g.length>0?(0,r.BX)(j.Z,{size:"small",children:["This project has ",(0,r.tZ)("strong",{children:g.length})," input/output"," ",g.length>1?"tests":"test","."]}):(0,r.BX)(j.Z,{size:"small",children:["This project has ",(0,r.tZ)("strong",{children:x.length})," unit"," ",x.length>1?"tests":"test","."]}),(0,r.tZ)(j.Z,{size:"small",children:"Run tests to check your work!"}),(0,r.tZ)(B.Ug,{justify:"end",children:(0,r.tZ)(U.Z,{onClick:function(e){e.stopPropagation(),$.Z.set(p,!0),s()},children:"dismiss"})})]})]})})}var Q=n(25497),K=n(69128),Y=n(49012),J=n(61193);function ee(){var e,t=function(e){var t=(0,l.Z)({},m,e);return f.useQuery(g,t)}({variables:{replId:(0,c.Z)()}}).data,n="Repl"===(null===t||void 0===t||null===(e=t.repl)||void 0===e?void 0:e.__typename)?null===t||void 0===t?void 0:t.repl:null;return n?{repl:n,currentUser:(null===t||void 0===t?void 0:t.currentUser)||null}:{repl:null,currentUser:null}}function te(){var e=ee().repl,t=(0,a.b9)(_.ye),n=(0,a.b9)(_.jw),o=null===e||void 0===e?void 0:e.lang.hasDAP,c=function(){var e=(0,P.Z)().dotReplit,t=(0,i.useState)(!1),n=t[0],r=t[1];return(0,i.useEffect)((function(){return e.watch((function(e){var t,n;e.error?e.error===Q.Yt.NotFound&&r(!1):r(Boolean(null===e||void 0===e||null===(t=e.config)||void 0===t||null===(n=t.debugger)||void 0===n?void 0:n.support))}))})),n}();(0,i.useEffect)((function(){o||c?t({type:"debugger",icon:(0,r.tZ)(w.Z,{}),tooltip:"Debugger"}):n("debugger")}),[o,c,t,n])}var ne=!1;function re(){var e=ee().currentUser,t=(0,F.useRouter)();return(null===e||void 0===e?void 0:e.isAdmin)||Boolean(t.query.debug)||ne}function ie(){var e=(0,a.Dv)(_.nv),t=(0,_.S$)();return function(){var e=(0,a.b9)(_.ye),t=(0,a.b9)(_.jw),n=(0,X.Z)().isTutorial,o=(0,I.v)();(0,i.useEffect)((function(){if(n)return e({type:"tutorial",icon:(0,r.tZ)(Z.Z,{}),tooltip:"Tutorial"}),void o({type:"tutorial",percent:25});t("tutorial")}),[n,t,e,o])}(),function(){var e=(0,a.b9)(_.ye),t=(0,a.b9)(_.jw),n=(0,s.oj)(),o=(0,X.Z)().isTutorial,c=(0,I.v)();(0,i.useEffect)((function(){if(n)return e({type:"kaboombar",icon:(0,r.tZ)(T.Z,{}),tooltip:"Kaboom"}),void(o||c({type:"kaboombar"}));t("kaboombar")}),[n,o,t,e,c])}(),function(){var e,t=(0,a.b9)(_.ye);(0,i.useEffect)((function(){t({type:"filetree",icon:(0,r.tZ)(b.Z,{}),tooltip:"Files"})}),[t]);var n=(0,I.v)(),o=(0,X.Z)().isTutorial,c=null===(e=(0,W.e)(H.H.Sidepane))||void 0===e?void 0:e.isActive;(0,i.useEffect)((function(){if(c&&!o){var e=setInterval((function(){n({type:"filetree"})}),200);return function(){clearInterval(e)}}}),[c,n,o])}(),function(){var e=ee().repl,t=(0,a.b9)(_.ye),n=(0,a.b9)(_.jw),o=Boolean(null===e||void 0===e?void 0:e.lang.supportsGit);(0,i.useEffect)((function(){o?t({type:"git",icon:(0,r.tZ)(y.Z,{}),tooltip:"Version control"}):n("git")}),[o,n,t])}(),function(){var e=(0,a.b9)(_.ye),t=(0,a.b9)(_.jw),n=(0,o.x)();(0,i.useEffect)((function(){(null===n||void 0===n?void 0:n.packageSearch)?e({type:"packager",tooltip:"Packager",icon:(0,r.tZ)(x.Z,{})}):t("packager")}),[n,e,t])}(),function(){var e=ee().repl,t=(0,a.b9)(_.ye),n=(0,a.b9)(_.jw),o=e&&!(null===e||void 0===e?void 0:e.lang.key.startsWith("html"));(0,i.useEffect)((function(){o?t({type:"envEditor",icon:(0,r.tZ)(k.Z,{}),IconWrapper:z,tooltip:"Secrets (Environment variables)"}):n("envEditor")}),[o,t,n])}(),te(),function(){var e=ee().repl,t=(0,a.b9)(_.ye),n=(0,a.b9)(_.jw),o=e&&!(null===e||void 0===e?void 0:e.lang.key.startsWith("html"));(0,i.useEffect)((function(){o?t({type:"database",icon:(0,r.tZ)(E.Z,{}),tooltip:"Database"}):n("database")}),[o,t,n])}(),function(){var e=(0,a.b9)(_.ye),t=(0,a.b9)(_.jw),n=(0,J.c)("flag-repl-auth-sidebar"),c=n.enabled,s=(n.loading,(0,o.x)()),l=c&&s;(0,i.useEffect)((function(){l?e({type:"replAuth",icon:(0,r.tZ)(Y.Z,{}),tooltip:"Authentication"}):t("replAuth")}),[l,e,t])}(),function(){var e=ee().repl,t=(0,a.b9)(_.ye),n=(0,a.b9)(_.jw),o=(null===e||void 0===e?void 0:e.isProject)||(null===e||void 0===e?void 0:e.isProjectFork);(0,i.useEffect)((function(){o?t({type:"autograder",icon:(0,r.tZ)(C.Z,{}),tooltip:"Tests",IconWrapper:q}):n("autograder")}),[o,t,n])}(),function(){var e=ee().repl,t=(0,a.b9)(_.ye),n=(0,a.b9)(_.jw),o=(null===e||void 0===e?void 0:e.isProject)||(null===e||void 0===e?void 0:e.isProjectFork),c=(0,K.Z)().language,s=!o&&null!==c;(0,i.useEffect)((function(){s?t({type:"unitTests",icon:(0,r.tZ)(C.Z,{}),tooltip:"Unit tests"}):n("unitTests")}),[s,t,n])}(),function(){var e,t,n=ee().repl,o=(0,a.b9)(_.ye),c=(0,a.b9)(_.jw),s=(null===n||void 0===n?void 0:n.isProjectFork)&&!(null===n||void 0===n?void 0:n.isModelSolution)&&"Team"===(null===n||void 0===n||null===(e=n.owner)||void 0===e?void 0:e.__typename)&&(null===n||void 0===n||null===(t=n.owner)||void 0===t?void 0:t.isAdmin);(0,i.useEffect)((function(){s?o({type:"education",icon:(0,r.tZ)(Z.Z,{}),tooltip:"Teams for Education"}):c("education")}),[s,o,c])}(),function(){var e=(0,a.b9)(_.ye);(0,i.useEffect)((function(){e({type:"preferences",icon:(0,r.tZ)(S.Z,{}),tooltip:"Settings"})}),[e])}(),function(){var e=(0,a.b9)(_.ye),t=(0,a.b9)(_.jw),n=re();(0,i.useEffect)((function(){window.debug=function(){ne=!0,e({type:"adminPanel",icon:(0,r.tZ)(R.Z,{}),tooltip:"Debug"})}}),[e]),(0,i.useEffect)((function(){var i="adminPanel";n?e({type:i,icon:(0,r.tZ)(R.Z,{}),tooltip:"Debug"}):t(i)}),[n,e,t])}(),{items:e,activeItem:t}}},56356:function(e,t,n){n.d(t,{B:function(){return a},Z:function(){return o}});var r=n(55877),i=n.n(r),a=15;function o(e){var t=e.isStacked,n=e.isHTML,r=e.codeEditorPath,a=void 0===r?"":r,o={codeEditor:{paneId:i()(),pane:{type:"codeEditor",data:{path:a}}},output:{paneId:i()(),pane:{type:n?"webview":"runnerOutput"}},shell:{paneId:i()(),pane:{type:"shell"}}},c={};Object.values(o).forEach((function(e){var t=e.paneId,n=e.pane;c[t]=n}));var s=function(e){var t=e.codeEditorId,n=e.outputId,r=e.shellId;return{floating:[],tiling:e.isStacked?{type:"split",stacked:!0,percent:100,children:[{id:i()(),percent:60,type:"paneGroup",panes:[t],activeIndex:0},{id:i()(),percent:40,type:"paneGroup",panes:[n,r],activeIndex:0}]}:{type:"split",stacked:!1,percent:100,children:[{id:i()(),percent:55,type:"paneGroup",panes:[t],activeIndex:0},{id:i()(),percent:45,type:"paneGroup",panes:[n,r],activeIndex:0}]}}}({codeEditorId:o.codeEditor.paneId,outputId:o.output.paneId,shellId:o.shell.paneId,isStacked:t});return{layout:s,data:c}}},75338:function(e,t,n){n.d(t,{ZP:function(){return K},FL:function(){return Y}});var r=n(47568),i=n(26042),a=n(69396),o=n(10253),c=n(34051),s=n.n(c),l=n(67294),u=n(99408),d=n(91131),f=n(7297),p=n(31230),h=n(46829);function m(){var e=(0,f.Z)(["\n  query ReplEnvironment2DoGitHubImportFlow($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        config {\n          gitRemoteUrl\n          doClone\n        }\n      }\n    }\n    currentUser {\n      id\n      gitHubInfo {\n        accessToken\n      }\n      username\n    }\n  }\n"]);return m=function(){return e},e}function v(){var e=(0,f.Z)(["\n  mutation ReplEnvironment2DoGitHubImportFlowFinishClone(\n    $input: UpdateReplInput!\n  ) {\n    updateRepl(input: $input) {\n      repl {\n        id\n        config {\n          doClone\n        }\n      }\n    }\n  }\n"]);return v=function(){return e},e}function g(){var e=(0,f.Z)(["\n  query GitHubImportRootOriginReplUrl($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        rootOriginReplUrl\n      }\n    }\n  }\n"]);return g=function(){return e},e}var b={},x=(0,p.ZP)(m());var Z=(0,p.ZP)(v());var y=(0,p.ZP)(g());var w=n(67128),k=n(63377),E=n(16799),S=n(83971),C=n(88812),T=n(46701),R=n(93058),_=n(48287),I=n(65456),P=n(31066),D=n(11731),A=n(37452),N=n(47491),U=n(70931),j=n(35424),B=n.n(j),O=n(75240),G=n(66223),L=n(9523);function M(){var e=(0,f.Z)(["\n  query DotReplitEditorRootOriginRepl($rootOriginReplUrl: String!) {\n    repl(url: $rootOriginReplUrl) {\n      ... on Repl {\n        id\n        ...CrosisContextRepl\n      }\n    }\n    currentUser {\n      id\n      ...CrosisContextCurrentUser\n    }\n  }\n  ","\n  ","\n"]);return M=function(){return e},e}function z(){var e=(0,f.Z)(["\n  query DotReplitEditorRootOriginReplById($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        ...CrosisContextRepl\n      }\n    }\n    currentUser {\n      id\n      ...CrosisContextCurrentUser\n    }\n  }\n  ","\n  ","\n"]);return z=function(){return e},e}var F={},X=(0,p.ZP)(M(),L.C,L.D);var W=(0,p.ZP)(z(),L.C,L.D);var H="Couldn't fetch the template .replit. Please try again.",V=function(){var e=(0,R.Z)().showError,t=function(e){var t=(0,i.Z)({},F,e);return h.useQuery(W,t)}({fetchPolicy:"no-cache",skip:!0}).refetch,n=function(e){var t=(0,i.Z)({},F,e);return h.useQuery(X,t)}({fetchPolicy:"no-cache",skip:!0}).refetch,a=l.useCallback(function(){var i=(0,r.Z)(s().mark((function r(i){var a,o,c,l,u,d,f,p,h,m,v,g;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(a=i.replId,o=i.replUrl,!a){r.next=8;break}return r.next=5,t({replId:a});case 5:case 11:c=r.sent,r.next=15;break;case 8:if(!o){r.next=14;break}return r.next=11,n({rootOriginReplUrl:o});case 14:throw new Error("how did we even get here?");case 15:if(l=c.data,u=c.error,l&&!u){r.next=19;break}return e(H),r.abrupt("return",null);case 19:if(d=l.repl,f=l.currentUser,"Repl"===(null===d||void 0===d?void 0:d.__typename)&&"CurrentUser"===(null===f||void 0===f?void 0:f.__typename)){r.next=23;break}return e(H),r.abrupt("return",null);case 23:return(p=(0,O.Z)({onUnrecoverableError:function(){e(H)}})).connect({context:{repl:d,currentUser:f,asViewer:!0}}),h=(0,G.Z)({container:p}),r.prev=27,r.next=30,h.readFile(C.l);case 30:"content"in(v=r.sent)&&(m=v.content),r.next=39;break;case 34:return r.prev=34,r.t0=r.catch(27),e(H),p.destroy(),r.abrupt("return",null);case 39:if(p.destroy(),m){r.next=43;break}return e(H),r.abrupt("return",null);case 43:r.prev=44,g=B().parse(m.toString()),r.next=52;break;case 48:return r.prev=48,r.t1=r.catch(44),e(H),r.abrupt("return",null);case 52:return r.abrupt("return",g);case 53:case"end":return r.stop()}}),r,null,[[27,34],[44,48]])})));return function(e){return i.apply(this,arguments)}}(),[t,n,e]);return a},$=n(4445),q=n(48764).Buffer;function Q(e){return new Promise((function(t,n){var r=e.openChannel({service:"gcsfiles"},(function(e){if(!e.error)return e.channel.request({persistMirror:{path:"."}}).then((function(e){e.ok,r(),t()})),function(e){e.willReconnect&&r()};n(e.error)}))}))}function K(){var e=(0,d.b9)(D._N);Y({insertConfigPlugin:function(){return e("config")},setConfigScreenLockIsOpen:(0,d.b9)(T.gx)})}function Y(e){var t=e.insertConfigPlugin,n=e.setConfigScreenLockIsOpen,c=(0,k.Z)(),d=(0,o.Z)(function(e){var t=(0,i.Z)({},b,e);return h.useMutation(Z,t)}(),2),f=d[0],p=d[1],m=(0,u.Z)(),v=m.container,g=m.fs,T=m.runner,D=m.dotReplit,j=m.session,B=m.nixService,O=(0,S.Z)(v),G=(0,R.Z)(),L=G.showNotice,M=G.showError,z=G.showConfirm,F=function(e){var t=(0,i.Z)({},b,e);return h.useQuery(y,t)}({skip:!0}).refetch,X=V();(0,l.useEffect)((function(){p.error&&M("Failed to finish cloning Repl - "+p.error)}),[p.error]),(0,l.useEffect)((function(){p.data&&z("Finished cloning Repl")}),[p.data]),(0,l.useEffect)((function(){H()}),[]);var W=(0,o.Z)(function(e){var t=(0,i.Z)({},b,e);return h.useLazyQuery(x,t)}({variables:{replId:c},fetchPolicy:"no-cache",onCompleted:function(){var e=(0,r.Z)(s().mark((function e(t){var n,r,i,a,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.repl,r=t.currentUser,"Repl"===n.__typename&&r&&"CurrentUser"===r.__typename){e.next=4;break}return e.abrupt("return");case 4:if(n.config.gitRemoteUrl){e.next=6;break}return e.abrupt("return");case 6:if(n.config.doClone){e.next=8;break}return e.abrupt("return");case 8:be({remote:null!==(a=n.config.gitRemoteUrl)&&void 0!==a?a:"",accessToken:null!==(o=null===(i=r.gitHubInfo)||void 0===i?void 0:i.accessToken)&&void 0!==o?o:null,username:r.username});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),1),H=W[0],K={isInitialized:!1,hasConflictsWithFetchedRemote:!1,hasMergeBaseWithFetchedRemote:!0,authError:w.l4.NONE,badState:w.$U.None,remote:"",repoId:null,branch:"",defaultBranch:"main",branches:[],installations:[],changedFiles:[],commits:[],commitsAhead:null,commitsBehind:null,remoteToken:null,gitHubName:null,ownerId:null,gitHubAvatarUrl:null,gitHubEmail:null},Y=function(){var e=(0,r.Z)(s().mark((function e(t){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O({args:E.D6.format(K,null!==t&&void 0!==t?t:"")});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=(0,r.Z)(s().mark((function e(t){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O({args:E.M7.format(K,t)});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=(0,r.Z)(s().mark((function e(){var t,n,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O({args:E.LO.format(K)});case 2:if(t=e.sent,E.LO.parse){e.next=5;break}return e.abrupt("return");case 5:return n=E.LO.parse(K,null===t.error?t.output:""),r=n.remote,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),te=function(){var e=(0,r.Z)(s().mark((function e(t){var n,r,o,c,l;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.remote,r=t.remoteToken,e.next=3,O({args:E.Di.format((0,a.Z)((0,i.Z)({},K),{remote:n,remoteToken:r}))});case 3:if(o=e.sent,E.Di.parse){e.next=6;break}return e.abrupt("return");case 6:return c=E.Di.parse(K,null===o.error?o.output:"HEAD branch: main"),l=c.defaultBranch,e.abrupt("return",l);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ne=function(){var e=(0,r.Z)(s().mark((function e(t){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O({args:E.lR.format((0,a.Z)((0,i.Z)({},K),{defaultBranch:t}))});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),re=function(){var e=(0,r.Z)(s().mark((function e(t){var n,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.remote,r=t.remoteToken,e.next=3,ie();case 3:return e.next=5,ee();case 5:return e.next=7,ae({deepen:!0,remote:n,remoteToken:r});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ie=function(){var e=(0,r.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O({args:E.GE.format(K)});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ae=function(){var e=(0,r.Z)(s().mark((function e(t){var n,r,o,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.deepen,r=void 0!==n&&n,o=t.remote,c=t.remoteToken,!o.startsWith("https://api.glitch.com")){e.next=5;break}return e.next=4,O({args:["git","fetch",o,"+refs/heads/*:refs/remotes/origin/*"]});case 4:return e.abrupt("return");case 5:return e.next=7,O({args:E.he.format((0,a.Z)((0,i.Z)({},K),{remote:o,remoteToken:c}),r)});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),oe=function(){var e=(0,r.Z)(s().mark((function e(t){var n,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&(null===(n=t.nix)||void 0===n?void 0:n.channel)){e.next=8;break}return e.next=5,B.getLatestStableChannel();case 5:r=e.sent,e.next=9;break;case 8:r=t.nix.channel;case 9:return e.next=11,D.updateDotReplit([(0,_.cU)(r)]);case 11:e.sent.error||L("Nix channel was not detected in your imported .replit file but is required for all Nix Repls. The latest stable Nix channel "+'"'.concat(r,'" was automatically added to your .replit file.'),1e4);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ce=function(){var e=(0,r.Z)(s().mark((function e(){var t,n,r,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F({replId:c});case 2:if(t=e.sent,n=t.data,!t.error){e.next=7;break}return e.abrupt("return",null);case 7:if("Repl"===n.repl.__typename){e.next=9;break}return e.abrupt("return",null);case 9:if(r=n.repl.rootOriginReplUrl){e.next=12;break}return e.abrupt("return",null);case 12:return e.next=14,X({replUrl:r});case 14:return i=e.sent,e.abrupt("return",i);case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),se=function(){var e=(0,r.Z)(s().mark((function e(t){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.packager){e.next=2;break}return e.abrupt("return");case 2:return n=t.packager,e.next=5,D.updateDotReplit([(0,_.w2)(n)]);case 5:e.sent.error||L("A packager was not detected in your imported .replit file and was automatically added.",1e4);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),le=function(){var e=(0,r.Z)(s().mark((function e(t,n){var r,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&n.env){e.next=2;break}return e.abrupt("return");case 2:if(r=n.env,!t){e.next=12;break}e.t0=s().keys(r);case 5:if((e.t1=e.t0()).done){e.next=12;break}if(i=e.t1.value,!t[i]){e.next=9;break}return e.abrupt("continue",5);case 9:t[i]=r[i],e.next=5;break;case 12:return e.next=14,D.updateDotReplit([(0,_.EX)(r)]);case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ue=function(){var e=(0,r.Z)(s().mark((function e(t){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.debugger){e.next=2;break}return e.abrupt("return");case 2:return n=t.debugger,e.next=5,D.updateDotReplit([(0,_.SD)(n)]);case 5:e.sent.error||L("A debugger was not detected in your imported .replit file so a recommended debugger was automatically added.",1e4);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),de=function(){var e=(0,r.Z)(s().mark((function e(t){var n,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&(null===(n=t.unitTest)||void 0===n?void 0:n.language)){e.next=3;break}return e.abrupt("return");case 3:return r=t.unitTest.language,e.next=6,D.updateDotReplit([(0,_.MY)(r)]);case 6:e.sent.error||L("Unit test configuration was not detected in your imported .replit file and so a recommended config was automatically added.",1e4);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fe=function(){var e=(0,r.Z)(s().mark((function e(){var t,n,r,i,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,D.getConfig();case 3:if(!(n=e.sent).error&&n.config){e.next=6;break}return e.abrupt("return");case 6:return r=n.config,e.next=9,ce();case 9:return i=e.sent,(a=[]).push(le(r.env,i)),(null===(t=r.nix)||void 0===t?void 0:t.channel)||a.push(oe(i)),r.packager||a.push(se(i)),r.debugger||a.push(ue(i)),r.unitTest||a.push(de(i)),e.next=18,Promise.all(a);case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),pe=function(){var e=(0,r.Z)(s().mark((function e(){var t,n,r,i,a,o,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,g.readDir(P.Ql);case 3:if(!(i=e.sent).error){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,D.getConfig();case 8:if(a=e.sent,!(null===(t=a.config)||void 0===t||null===(n=t.gitHubImport)||void 0===n?void 0:n.requiredFiles)){e.next=16;break}return o=a.config.gitHubImport.requiredFiles,c=o.map((function(e){return new RegExp(e)})),e.next=14,Promise.all(i.children.filter((function(e){return!c.some((function(t){return t.test(e.filename)}))})).map((function(e){return e.type===I.Tv.Directory?g.deleteDir(e.filename):g.deleteFile(e.filename)})));case 14:e.next=19;break;case 16:if(!(null===(r=a.config)||void 0===r?void 0:r.entrypoint)){e.next=19;break}return e.next=19,g.deleteFile(a.config.entrypoint);case 19:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),he=function(){var e=(0,r.Z)(s().mark((function e(t,n,r){var i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y(r);case 2:return e.next=4,J(t);case 4:return e.next=6,ee();case 6:return e.next=8,ae({deepen:!1,remote:t,remoteToken:n});case 8:return e.next=10,te({remote:t,remoteToken:n});case 10:return i=e.sent,e.next=13,ne(null!==i&&void 0!==i?i:"");case 13:return e.next=15,re({remote:t,remoteToken:n});case 15:if("html"!==T.mode){e.next=20;break}return e.next=18,Q(v);case 18:return e.next=20,T.run();case 20:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),me=function(){var e=(0,r.Z)(s().mark((function e(){var t,n,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.readDir(P.Ql);case 2:if(!(t=e.sent).error){e.next=5;break}return e.abrupt("return");case 5:n=t.children.map((function(e){return e.filename})),(r=(0,A.T)(n,"nix"))&&j.openFile(r);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ve=function(){var e=(0,r.Z)(s().mark((function e(t,n){var r,i,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,N.J9)({repoNameWithOwner:t,accessToken:n});case 2:if(!("error"in(r=e.sent))){e.next=5;break}return e.abrupt("return",{hasDotReplit:!1,hasProcfile:!1});case 5:return i=r.some((function(e){return e.path===C.l})),a=r.some((function(e){return e.path===$.E})),e.abrupt("return",{hasDotReplit:i,hasProcfile:a});case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ge=function(){var e=(0,r.Z)(s().mark((function e(t,n){var r,i,a,o,c,l,u,d;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,N.LK)({repoNameWithOwner:t,filePath:$.E,accessToken:n});case 2:if(!("error"in(r=e.sent))){e.next=5;break}return e.abrupt("return",{showConfigPanel:!0});case 5:if(i=q.from(r.content,"base64").toString(),a=(0,$.c)(i)){e.next=9;break}return e.abrupt("return",{showConfigPanel:!0});case 9:if(c=null!==(o=a.web)&&void 0!==o?o:a.worker){e.next=13;break}return e.abrupt("return",{showConfigPanel:!0});case 13:return l=c.command+" "+c.options.join(" "),e.next=16,D.updateDotReplit([(0,_.KQ)(l),(0,_.xz)("interpreter")]);case 16:if(u=e.sent,d=a.web&&!a.worker||!a.web&&a.worker,!u.error&&d){e.next=20;break}return e.abrupt("return",{showConfigPanel:!0});case 20:return e.abrupt("return",{showConfigPanel:!1});case 21:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),be=function(){var e=(0,r.Z)(s().mark((function e(r){var i,a,o,l,u,d,p,h,m,v;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.remote,a=r.accessToken,o=r.username,n(!0),e.next=4,pe();case 4:return e.next=6,he(i,a,o);case 6:return e.next=8,fe();case 8:return e.next=10,f({variables:{input:{id:c,doClone:!1}}});case 10:return e.next=12,me();case 12:if(l=(0,U.J)(i),u=!1,!l){e.next=29;break}return d=l.username,p=l.repository,e.next=18,ve("".concat(d,"/").concat(p),a);case 18:if(h=e.sent,m=h.hasDotReplit,!h.hasProcfile||m){e.next=28;break}return e.next=24,ge("".concat(d,"/").concat(p),a);case 24:v=e.sent,u=!v.showConfigPanel,e.next=29;break;case 28:u=m;case 29:if(n(!1),"html"!==T.mode){e.next=32;break}return e.abrupt("return");case 32:if(!u){e.next=34;break}return e.abrupt("return");case 34:t();case 35:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}},95642:function(e,t,n){n.d(t,{Z:function(){return m},d:function(){return v}});var r=n(47568),i=n(34051),a=n.n(i),o=n(91131),c=n(67294),s=n(63377),l=n(74275),u=n(99408),d=n(37452),f=n(6625),p=n(95068),h=n(16965);function m(e){var t=(0,h.Z)(e.initialLayoutState),n=(0,o.Dv)(p.dD),r=(0,s.Z)(),i=(0,l.mk)(),a=(0,l.A6)();(0,c.useEffect)((function(){if(n)return i({initialLayoutState:t.current,replId:r}),function(){a()}}),[r,i,a,n,t])}function v(){var e=(0,c.useState)(!1),t=e[0],n=e[1],i=(0,s.Z)(),o=(0,u.Z)(),p=o.dotReplit,h=o.fs,m=(0,f.Z)(),v=(0,l.n7)();return{reset:(0,c.useCallback)((0,r.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(!0),e.next=3,(0,d.W)({fs:h,dotReplit:p,replId:i});case 3:if(t=e.sent.entrypoint,m.current){e.next=6;break}return e.abrupt("return");case 6:n(!0),v({entrypoint:t});case 8:case"end":return e.stop()}}),e)}))),[i,h,p,v,m]),reseting:t}}},3234:function(e,t,n){n.d(t,{Oi:function(){return l},S$:function(){return p},jw:function(){return d},nv:function(){return s},ye:function(){return u}});var r=n(29815),i=n(91131),a=n(86292),o=n(1086),c=n(35869),s=(0,i.cn)([]),l=function(e){var t={action:"opened"};switch(e){case"git":return(0,a.j)(a.U3.VERSION_CONTROL_FEATURE_USED,t);case"envEditor":return(0,a.j)(a.U3.ENV_EDITOR_USED,t);case"database":return(0,a.j)(a.U3.DATABASE_USED,t);case"replAuth":return(0,a.j)(a.U3.AUTH_SIDEBAR_USED,t);case"packager":return(0,a.j)(a.U3.PACKAGE_MANAGER_USED,t);case"unitTests":return(0,a.j)(a.U3.REPL_UNIT_TEST_USED,t);case"debugger":return(0,a.j)(a.U3.DEBUGGER_USED,t)}},u=(0,i.cn)(null,(function(e,t,n){var i=e(s);i.some((function(e){return e.type===n.type}))||t(s,o.D.reduce((function(e,t){if(n.type===t)return(0,r.Z)(e).concat([n]);var a=i.find((function(e){return e.type===t}));return a?(0,r.Z)(e).concat([a]):e}),[]))})),d=(0,i.cn)(null,(function(e,t,n){var r=e(s),i=r.filter((function(e){return e.type!==n}));i.length!==r.length&&t(s,i)})),f=(0,i.cn)((function(e){var t=e(c.TL);return t.width>0?t.pane.type:null}));function p(){return(0,i.Dv)(f)}},1086:function(e,t,n){n.d(t,{D:function(){return r}});var r=["tutorial","kaboombar","filetree","git","packager","envEditor","debugger","database","replAuth","autograder","unitTests","education","preferences","adminPanel"]},47875:function(e,t,n){n.d(t,{H:function(){return a},Q:function(){return o}});var r=n(91131),i=n(21131),a=(0,r.cn)({flagSaveLayoutState:!1,flagThreadsPane:!1,flagThreads2:!1,flagGhostrunner:!1});function o(e){var t=(0,i.Z)((function(){return(0,r.cn)((function(t){return Boolean(t(a)[e])}))}),[e]);return(0,r.Dv)(t)}},29780:function(e,t,n){n.d(t,{I:function(){return p},v:function(){return f}});var r=n(91131),i=n(35869),a=n(3234),o=n(72676),c=n(95068),s=n(12727),l=n(56356),u=(0,r.cn)(null,(function(e,t,n){var r=n.type,u=n.keepOpen,d=e(i.ko),f=e(i.TL);if(d&&f.pane.type===r&&!u)return t(i.TL,(function(e){return{width:0,pane:e.pane}})),void t(o.iH,e(c.g4));var p=e(s.CK);if(f.width>0){var h=n.percent?p.width*(n.percent/100):f.width;return t(i.TL,{width:h,pane:{type:r}}),t(o.iH,e(c.g4)),void(0,a.Oi)(r)}var m=void 0===n.percent?l.B:n.percent,v=p.width*(m/100);t(i.TL,{width:v,pane:{type:r}}),t(o.iH,e(c.g4)),(0,a.Oi)(r)})),d=(0,r.cn)(null,(function(e,t,n){t(u,{type:n.type,percent:n.percent,keepOpen:!0})}));function f(){return(0,r.b9)(d)}function p(){return(0,r.b9)(u)}},74275:function(e,t,n){n.d(t,{Mn:function(){return Q},B:function(){return Y},A6:function(){return ne},mk:function(){return J},n7:function(){return ee},ne:function(){return $}});var r=n(47568),i=n(10253),a=n(34051),o=n.n(a),c=n(95068),s=n(71171),l=n.n(s),u=n(91131),d=n(62991),f=n.n(d),p=n(7297),h=n(31230);function m(){var e=(0,p.Z)(["\n  mutation SaveReplLayoutState($input: SetReplLayoutStateInput!) {\n    setReplLayoutState(input: $input) {\n      ... on Repl {\n        id\n        layoutState\n      }\n    }\n  }\n"]);return m=function(){return e},e}var v=(0,h.ZP)(m());var g=n(58809),b=n(12727),x=n(47875),Z=n(48551),y=n(54992),w=n(72676),k=n(21131),E=n(28173),S=n(63035),C=n(56356),T=n(66421),R=n(35869),_={filetree:!0,codeEditor:!0,database:!0,replAuth:!0,webview:!0,media:!0,vnc:!0,pedit:!0,education:!0,runnerOutput:!0,unitTests:!0,autograder:!0,markdown:!0,shell:!0,packager:!0,envEditor:!0,commands:!0,draw:!0,preferences:!0,adminPanel:!0,git:!0,kaboombar:!0,instructions:!0,debugger:!0,tutorial:!0,config:!0,threadInbox:!0,extension:!0,docs:!0,videoPlayer:!0,chat:!0};function I(e){if("number"!==typeof e)throw new Error("Expected number")}function P(e){if("string"!==typeof e)throw new Error("Expected string")}function D(e){if(P(e.type),I(e.percent),"paneGroup"!==e.type){if("split"===e.type)return function(e){if("boolean"!==typeof e)throw new Error("Expected boolean")}(e.stacked),function(e){if(!Array.isArray(e.children))throw new Error("Expected children")}(e),void e.children.forEach(D);throw new Error("Invalid pane type: "+e.type)}if(P(e.id),!Array.isArray(e.panes))throw new Error("Expected panes array");e.panes.map(P)}function A(e,t){if(!Array.isArray(e.floating))throw new Error("Expected floating");e.floating.forEach((function(e){if(P(e.id),"floatingPaneGroup"!==e.type)throw new Error("Expected floatingPaneGroup type");if(!Array.isArray(e.panes))throw new Error("Expected panes array");!function(e){[e.x,e.y,e.width,e.height].forEach(I)}(e.rect),e.panes.forEach((function(e){if(P(e),!t.includes(e))throw new Error("Unrecognized id")}))})),e.tiling&&D(e.tiling)}function N(e){if("object"!==typeof e)throw new Error("Expected object");if(!_[e.type])throw new Error("Expected valid pane, got: ".concat(e.type))}function U(e){!function(e){if("object"!==typeof e)throw new Error("Expected object");Object.values(e).map(N)}(e.data),A(e.layout,Object.keys(e.data)),void 0!==e.sidebarPercent&&function(e){if("number"!==typeof e)throw new Error("Expected number");if(e<0)throw new Error("Expected positive number");if(e>100)throw new Error("Expected number less than 100")}(e.sidebarPercent)}var j=n(25602),B=n(8357),O=n(1086),G=n(11731);var L=(0,u.cn)((function(e){var t=e(b.CK);return function(e,t){var n=t.min,r=t.max;return Math.min(Math.max(n,e),r)}(e(R.Ob)/t.width*100,{min:0,max:100})})),M=(0,u.cn)((function(e){var t=e(c.g4),n={};e(b.Eh).forEach((function(t){n[t.paneId]=e(t.data)}));var r=e(L);return{layout:t,data:n,sidebarPercent:r}})),z=(0,u.cn)(null),F=(0,u.cn)(null),X=(0,u.cn)(null);function W(e,t){return H.apply(this,arguments)}function H(){return(H=(0,r.Z)(o().mark((function e(t,n){var r,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=void 0,e.prev=2,e.next=5,null===g.l||void 0===g.l?void 0:g.l.mutate({mutation:v,variables:{input:{replId:t,state:n}}});case 5:i=e.sent,e.next=11;break;case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",{success:!1,retry:!0});case 11:if(!("Repl"===(null===i||void 0===i||null===(r=i.data)||void 0===r?void 0:r.setReplLayoutState.__typename))){e.next=14;break}return e.abrupt("return",{success:!0,retry:void 0});case 14:return e.abrupt("return",{success:!1,retry:!1});case 15:case"end":return e.stop()}}),e,null,[[2,8]])})))).apply(this,arguments)}var V=(0,u.cn)(null,function(){var e=(0,r.Z)(o().mark((function e(t,n,r){var i,a,s,u,d,p;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=t(F))||i.retry){e.next=3;break}return e.abrupt("return");case 3:if(!(i&&Date.now()-i.timestamp<6e4)){e.next=5;break}return e.abrupt("return");case 5:if(t(c.dD)){e.next=7;break}return e.abrupt("return");case 7:if(t(x.H).flagSaveLayoutState){e.next=10;break}return e.abrupt("return");case 10:if(a=t(M),s=t(q)){e.next=14;break}return e.abrupt("return");case 14:if(u=t(z),r.force||!f()(u,a)){e.next=17;break}return e.abrupt("return");case 17:return d=l()(),n(X,d),e.next=21,W(s,a);case 21:if(p=e.sent,t(X)===d){e.next=24;break}return e.abrupt("return");case 24:if(n(X,null),!p.retry){e.next=28;break}return n(F,{timestamp:Date.now(),retry:!0}),e.abrupt("return");case 28:if(p.success){e.next=31;break}return n(F,{timestamp:Date.now(),retry:!1}),e.abrupt("return");case 31:n(z,a);case 32:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}());function $(){var e=(0,u.b9)(V);return(0,k.Z)((function(){return(0,E.Z)(e,1e3)}),[e])}var q=(0,u.cn)(null),Q=(0,u.cn)(null),K=(0,u.cn)(null,(function(e,t,n){var r=n.replId,a=n.initialLayoutState,o=n.codeEditorPath;t(q,r);var s=e(x.H).flagSaveLayoutState,l=a?function(e){try{U(e)}catch(t){return null}return e}(a):null,u=e(S.gM),d=e(S.h$),f=s&&l?l:(0,C.Z)({isStacked:d,isHTML:u,codeEditorPath:o}),p=f.data,h=f.layout;Object.entries(p).forEach((function(n){var r=(0,i.Z)(n,2),a=r[0],o=r[1],c=e((0,b.z)(a));t(c.data,o)}));var m=e(b.CK),v=void 0!==(null===l||void 0===l?void 0:l.sideBarPercent)?null===l||void 0===l?void 0:l.sideBarPercent:C.B;if(t(R.TL,{width:m.width*(v/100),pane:{type:"filetree"}}),t(w.iH,h),t(Q,l?"saved":"default"),t(z,e(M)),l){var g=!0,k=!1,E=void 0;try{for(var T,_=O.D[Symbol.iterator]();!(g=(T=_.next()).done);g=!0){var I=T.value;t(G.ao,{type:I})}}catch(L){k=!0,E=L}finally{try{g||null==_.return||_.return()}finally{if(k)throw E}}var P=e(c.S6).map((function(t){return{path:(0,y.DQ)(e(t.data)),isHidden:t.isHidden}})).filter((function(e){var t=e.path;return Boolean(t)})).sort((function(e,t){return Number(t.isHidden)-Number(e.isHidden)})),D=P.length?P[0].path:null;if(D){if((0,j.u9)()){var A=e(c.S6).find((function(t){return(0,y.DQ)(e(t.data))===D}));A&&t(B.v,{paneId:A.paneId,data:{type:"codeEditor",data:{path:""}}})}else t(c.Sg,D);if(!(0,Z.gK)(D)){var N=P.find((function(e){return e.path&&(0,Z.gK)(e.path)}));N&&t(c.Md,N.path)}}}})),Y=(0,u.cn)(null,(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e(q);if(!r){var i=new Error("Expected replId");throw t(T.xm,{error:i}),i}t(K,{codeEditorPath:n.entrypoint,initialLayoutState:null,replId:r}),t(V,{force:!0})}));function J(){return(0,u.b9)(K)}function ee(){return(0,u.b9)(Y)}var te=(0,u.cn)(null,(function(e,t){t(c.g4,{tiling:null,floating:[]}),t(c.yv,[]),t(c.Md,null),t(Q,null),t(b.vA)}));function ne(){return(0,u.b9)(te)}},79848:function(e,t,n){n.d(t,{b:function(){return o},p:function(){return c}});var r=n(55877),i=n.n(r),a=n(53153);function o(e,t){var n={protocolVersion:a.Wj,messageDirection:a.s1.TO_NATIVE,messageId:t,payload:e};null!=window.ReactNativeWebView?window.ReactNativeWebView.postMessage(JSON.stringify(n)):window.postMessage(n,window.origin)}function c(e){var t=null!==e&&void 0!==e?e:i()();o({messageType:a.cF.ERROR},t)}},53153:function(e,t,n){var r,i,a,o;n.d(t,{CF:function(){return k},H7:function(){return h},MB:function(){return y},Of:function(){return a},Se:function(){return v},T$:function(){return x},Wj:function(){return c},aB:function(){return Z},ac:function(){return b},b9:function(){return o},cF:function(){return r},fz:function(){return m},m7:function(){return g},s1:function(){return i}}),function(e){e.ERROR="ERROR",e.ACK="ACK",e.RESET="RESET",e.TEXT_EDITOR_CLOSED="TEXT_EDITOR_CLOSED",e.TEXT_EDITOR_STATE="WORKSPACE_STATE",e.TEXT_EDITOR_STATE_REQUEST="WORKSPACE_STATE_REQUEST",e.WORKSPACE_STATE="WORKSPACE_STATE1",e.WORKSPACE_STATE_REQUEST="WORKSPACE_STATE_REQUEST1",e.REQUEST_SET_SELECTION="REQUEST_SET_SELECTION",e.REQUEST_REPLACE_SELECTION="REQUEST_REPLACE_SELECTION",e.REQUEST_SET_TEXT="REQUEST_SET_TEXT",e.REQUEST_INSERT_TEXT="REQUEST_INSERT_TEXT",e.REQUEST_PASTE_TEXT="REQUEST_PASTE_TEXT",e.TEXT_EDITOR_REQUEST_ACTION="TEXT_EDITOR_REQUEST_ACTION",e.WORKSPACE_REQUEST_ACTION="WORKSPACE_REQUEST_ACTION"}(r||(r={})),function(e){e.FROM_NATIVE="FROM_NATIVE",e.TO_NATIVE="TO_NATIVE"}(i||(i={})),function(e){e.OPEN_FILETREE="OPEN_FILETREE",e.OPEN_NEW_PANE="OPEN_NEW_PANE",e.TOGGLE_DRAWER="TOGGLE_DRAWER",e.TOGGLE_ALLPANES="TOGGLE_ALLPANES",e.TOGGLE_RUN_STATE="TOGGLE_RUN_STATE"}(a||(a={})),function(e){e.REQUEST_UNDO="REQUEST_UNDO",e.REQUEST_REDO="REQUEST_REDO",e.REQUEST_BLUR="REQUEST_BLUR",e.REQUEST_FOCUS="REQUEST_FOCUS",e.REQUEST_INDENT_SELECTION="REQUEST_INDENT_SELECTION",e.REQUEST_DEDENT_SELECTION="REQUEST_DEDENT_SELECTION",e.REQUEST_TOGGLE_COMMENT="REQUEST_TOGGLE_COMMENT"}(o||(o={}));var c="1";function s(e){return null!==e&&void 0!==e&&"string"===typeof e}function l(e){return s(e)||null===e}function u(e){return null!==e&&void 0!==e&&"boolean"===typeof e}function d(e){return null!=e&&"number"===typeof e&&!Number.isNaN(e)&&Number.isFinite(e)&&Number.isSafeInteger(e)&&e>=0}function f(e){return null!=e&&("object"===typeof e&&null!=e&&("location"in e&&"length"in e&&d(e.location)&&d(e.length)))}function p(e){return null!=e&&(!!Array.isArray(e)&&!!e.every((function(e){return f(e)})))}function h(e){return null!=e&&("object"===typeof e&&null!=e&&("messageType"in e&&"isDrawerOpen"in e&&"isShowingAllPanes"in e&&"runState"in e&&"activePaneType"in e&&"activePaneFilePath"in e&&e.messageType===r.WORKSPACE_STATE&&u(e.isDrawerOpen)&&u(e.isShowingAllPanes)&&s(e.runState)&&l(e.activePaneType)&&l(e.activePaneFilePath)))}function m(e){return null!=e&&("object"===typeof e&&null!=e&&("messageType"in e&&"filePath"in e&&"revisionId"in e&&"text"in e&&e.messageType===r.REQUEST_REPLACE_SELECTION&&s(e.filePath)&&s(e.revisionId)&&s(e.text)))}function v(e){return null!=e&&("object"===typeof e&&null!=e&&("messageType"in e&&"filePath"in e&&"selections"in e&&"revisionId"in e&&e.messageType===r.REQUEST_SET_SELECTION&&s(e.filePath)&&p(e.selections)&&s(e.revisionId)))}function g(e){return null!=e&&("object"===typeof e&&null!=e&&("messageType"in e&&"filePath"in e&&"text"in e&&"selections"in e&&"revisionId"in e&&e.messageType===r.REQUEST_SET_TEXT&&s(e.filePath)&&s(e.text)&&p(e.selections)&&s(e.revisionId)))}function b(e){return null!=e&&("object"===typeof e&&null!=e&&("messageType"in e&&"filePath"in e&&"text"in e&&"insertionRange"in e&&"selections"in e&&"revisionId"in e&&e.messageType===r.REQUEST_INSERT_TEXT&&s(e.filePath)&&s(e.text)&&f(e.insertionRange)&&p(e.selections)&&s(e.revisionId)))}function x(e){return null!=e&&("object"===typeof e&&null!=e&&("messageType"in e&&"filePath"in e&&"text"in e&&"revisionId"in e&&e.messageType===r.REQUEST_PASTE_TEXT&&s(e.filePath)&&s(e.text)&&s(e.revisionId)))}function Z(e){return null!=e&&("object"===typeof e&&null!=e&&("messageType"in e&&"revisionId"in e&&"filePath"in e&&"action"in e&&e.messageType===r.TEXT_EDITOR_REQUEST_ACTION&&s(e.revisionId)&&s(e.filePath)&&s(e.action)))}function y(e){return null!=e&&("object"===typeof e&&null!=e&&("messageType"in e&&"action"in e&&e.messageType===r.WORKSPACE_REQUEST_ACTION&&s(e.action)))}function w(e){if(null==e)return!1;if("object"!==typeof e||null==e)return!1;if(!("messageType"in e)||!s(e.messageType))return!1;switch(e.messageType){case r.ERROR:case r.ACK:case r.RESET:return!0;case r.TEXT_EDITOR_CLOSED:return function(e){return null!=e&&"object"===typeof e&&null!=e&&"messageType"in e&&"filePath"in e&&e.messageType===r.TEXT_EDITOR_CLOSED&&s(e.filePath)}(e);case r.TEXT_EDITOR_STATE:case r.TEXT_EDITOR_STATE_REQUEST:case r.WORKSPACE_STATE:case r.WORKSPACE_STATE_REQUEST:return!0;case r.REQUEST_SET_SELECTION:return v(e);case r.REQUEST_SET_TEXT:return g(e);case r.REQUEST_INSERT_TEXT:return b(e);case r.REQUEST_PASTE_TEXT:return x(e);case r.REQUEST_REPLACE_SELECTION:return m(e);case r.TEXT_EDITOR_REQUEST_ACTION:return Z(e);case r.WORKSPACE_REQUEST_ACTION:return y(e);default:return!1}}function k(e){return null!=e&&("object"===typeof e&&null!=e&&("protocolVersion"in e&&"messageDirection"in e&&"messageId"in e&&"payload"in e&&s(e.protocolVersion)&&s(e.messageDirection)&&s(e.messageId)&&w(e.payload)))}},2548:function(e,t,n){var r=n(26042),i=n(69396),a=n(35944),o=n(70917),c={animationDuration:"800ms",animationIterationCount:"infinite",animationTimingFunction:"ease-in-out"},s=(0,o.F4)("\n  0% { transform: translate(0px, 0px) }\n  25% { transform: translate(0px, 80px) }\n  50% { transform: translate(100px, 80px) }\n  75% { transform: translate(100px, 160px) }\n  100% { transform: translate(0px, 160px) }\n"),l=(0,o.F4)("\n  0% { transform: translate(0px, 0px) }\n  25% { transform: translate(0px, -80px) }\n  50% { transform: translate(-100px, -80px) }\n  100% { transform: translate(-100px, -80px) }\n"),u=(0,o.F4)("\n  0% { transform: translate(0px, 0px) }\n  50% { transform: translate(0px, 0px) }\n  75% { transform: translate(0px, -80px) }\n  100% { transform: translate(100px, -80px) }\n");t.Z=function(e){var t=e.height,n=void 0===t?24:t,o=e.color,d={width:84,height:64,fill:void 0===o?"#F26207":o,rx:12};return(0,a.BX)("svg",{width:n/1.2,height:n,viewBox:"0 0 200 240",xmlns:"http://www.w3.org/2000/svg",children:[(0,a.tZ)("rect",(0,i.Z)((0,r.Z)({css:[c,{animationName:s}]},d),{x:8,y:8})),(0,a.tZ)("rect",(0,i.Z)((0,r.Z)({css:[c,{animationName:l}]},d),{x:108,y:88})),(0,a.tZ)("rect",(0,i.Z)((0,r.Z)({css:[c,{animationName:u}]},d),{x:8,y:168}))]})}},15335:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(67294),i=n(99408);function a(){var e=(0,i.Z)().container,t=(0,r.useState)(e.getConnectionState()),n=t[0],a=t[1];return(0,r.useEffect)((function(){return e.onConnectionStateChanged(a)}),[e]),n}},2916:function(e,t,n){n.d(t,{Z:function(){return c}});var r=n(10253),i=n(67294),a=n(99408),o=n(75240);function c(){var e,t,n=(0,a.Z)().container,c=(0,r.Z)(i.useState(null!==(t=null===(e=n.getContext())||void 0===e?void 0:e.repl)&&void 0!==t?t:null),2),s=c[0],l=c[1];return i.useEffect((function(){return n.onConnectionStateChanged((function(e){var t,r;e===o.e.CONNECTED&&l(null!==(r=null===(t=n.getContext())||void 0===t?void 0:t.repl)&&void 0!==r?r:null)}))}),[l,n]),s}},96357:function(e,t,n){n.d(t,{m:function(){return r}});var r=function(e){return e&&e.args?(e.args&&e.args.length>=3&&"sh"===e.args[0]&&"-c"===e.args[1]?e.args.slice(2):e.args).join(" "):""}},48287:function(e,t,n){n.d(t,{$0:function(){return h},D3:function(){return a},EX:function(){return l},If:function(){return i},Jk:function(){return m},KQ:function(){return r},MY:function(){return c},SD:function(){return d},cU:function(){return s},lw:function(){return f},qR:function(){return o},w2:function(){return p},xz:function(){return u}});var r=function(e){return{op:"add",path:"run",value:JSON.stringify(e)}},i=function(e){return{op:"add",path:"entrypoint",value:JSON.stringify(e)}},a=function(e){return{op:"add",path:"compile",value:JSON.stringify(e)}},o=function(e){return{op:"add",path:"onBoot",value:JSON.stringify(e)}},c=function(e){return{op:"add",path:"unitTest/language",value:JSON.stringify(e)}},s=function(e){return{op:"add",path:"nix/channel",value:JSON.stringify(e)}},l=function(e){return{op:"add",path:"env",value:JSON.stringify(e)}},u=function(e){return{op:"remove",path:"string"===typeof e?e:e.join("/"),value:""}},d=function(e){return{op:"add",path:"debugger",value:JSON.stringify(e)}},f=function(e){return{op:"add",path:"interpreter",value:JSON.stringify(e)}},p=function(e){return{op:"add",path:"packager",value:JSON.stringify(e)}},h=function(e){return{op:"add",path:"auth/pageEnabled",value:JSON.stringify(e)}},m=function(e){return{op:"add",path:"auth/buttonEnabled",value:JSON.stringify(e)}}},37432:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(10253),i=n(67294),a=n(6625),o=n(84810),c=n(31066);function s(e){var t=e.path,n=e.initialExpanded,s=e.fs,l=(0,r.Z)(i.useState(null),2),u=l[0],d=l[1],f=(0,r.Z)(i.useState(null),2),p=f[0],h=f[1],m=(0,r.Z)(i.useState(Boolean(n)),2),v=m[0],g=m[1],b=(0,a.Z)();i.useEffect((function(){if(v){var e=s.watchDir(t,{onChange:function(e){d(e.filter((function(e){return!(0,o.C)(t===c.Ql?e.filename:t+"/"+e.filename)})))},onError:function(e){h(e)}});return function(){b.current&&d(null),e()}}}),[s,t,v,d,h]);var x=i.useCallback((function(){g(!0)}),[]),Z=i.useCallback((function(){g(!1)}),[]);return v?p?{collapse:Z,expand:x,children:null,expanded:v,loading:!1,error:p}:u?{collapse:Z,expand:x,children:u,loading:!1,error:p,expanded:v}:{collapse:Z,expand:x,children:u,loading:!0,error:p,expanded:v}:{collapse:Z,expand:x,children:null,loading:!1,error:null,expanded:v}}},36739:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(10253),i=n(67294);function a(e,t){var n=(0,r.Z)(i.useState(null),2),a=n[0],o=n[1];return i.useEffect((function(){var n=!1;return e.readFile(t).then((function(e){n||o(e)})),function(){n=!0}}),[e,t]),a}},58823:function(e,t,n){n.d(t,{w:function(){return c}});var r=n(56030),i=n(65456),a=n(58794);function o(e){var t=e.path,n=e.fs,a=e.edits,o=!1,c=n.watchOtFile(t,{onReady:function(e){var t=e.writeOp,n=e.initialContent;t((0,r.Z)(a,n.toString())),o=!0},onStatusChange:function(e){e===i.KF.Clean&&o&&c()}})}function c(e){var t=e.edit,n=e.fs,r=e.client,c=t.documentChanges,s=t.changes;if(c&&c.forEach((function(e){if("textDocument"in e){var t=e.edits,c=e.textDocument;o({path:r.documentUriToPath(c.uri),fs:n,edits:t})}else switch(e.kind){case"create":var s=r.documentUriToPath(e.uri),l=e.options,u=Boolean((null===l||void 0===l?void 0:l.overwrite)||!(null===l||void 0===l?void 0:l.ignoreIfExists)),d=function(){n.writeFile(s,a.Z.from("")).then((function(e){if(e.error)throw new Error("Something went wrong writing to a file")}))};if(u){d();break}n.stat(s).then((function(e){e.exists||d()}));break;case"delete":var f=r.documentUriToPath(e.uri),p=e.options,h=Boolean(null===p||void 0===p?void 0:p.recursive),m=Boolean(null===p||void 0===p?void 0:p.ignoreIfNotExists);n.stat(f).then((function(e){if(!e.exists)throw new Error("Expected file to exist");if(e.type===i.Tv.Directory&&!h)throw new Error("Trying to delete a directory without recursive option enabled");n.deleteFile(f).then((function(e){var t=e.error;if((t!==i.Df.NotFound||!m)&&t)throw new Error("Something went wrong deleting the file")}))}));break;case"rename":var v=r.documentUriToPath(e.oldUri),g=r.documentUriToPath(e.newUri),b=e.options,x=Boolean((null===b||void 0===b?void 0:b.overwrite)||!(null===b||void 0===b?void 0:b.ignoreIfExists)),Z=function(){n.moveFile(v,g).then((function(e){if(e.error)throw new Error("Something went wrong moving the file")}))};if(x){Z();break}n.stat(g).then((function(e){e.exists||Z()}))}})),s)for(var l in s){var u=r.documentUriToPath(l),d=s[l];o({path:u,fs:n,edits:d})}}},4862:function(e,t,n){function r(e){var t,n=e.getServerCapabilities();return{isAutoCompleteSupported:Boolean(null===n||void 0===n?void 0:n.completionProvider),isCompletionItemResolveSupported:Boolean(null===n||void 0===n||null===(t=n.completionProvider)||void 0===t?void 0:t.resolveProvider),isDocumentSymbolSupported:Boolean(null===n||void 0===n?void 0:n.documentSymbolProvider),isFindReferencesSupported:Boolean(null===n||void 0===n?void 0:n.referencesProvider),isFindDefinitionSupported:Boolean(null===n||void 0===n?void 0:n.definitionProvider),isFindTypeDefinitionSupported:Boolean(null===n||void 0===n?void 0:n.typeDefinitionProvider),isFindImplementationSupported:Boolean(null===n||void 0===n?void 0:n.implementationProvider),isTextDocumentSyncSupported:Boolean(null===n||void 0===n?void 0:n.textDocumentSync),isHoverSupported:Boolean(null===n||void 0===n?void 0:n.hoverProvider),isRenameSupported:Boolean(null===n||void 0===n?void 0:n.renameProvider),isCodeActionsSupported:Boolean(null===n||void 0===n?void 0:n.codeActionProvider),isSignatureHelpSupported:Boolean(null===n||void 0===n?void 0:n.signatureHelpProvider)}}n.d(t,{Z:function(){return r}})},56030:function(e,t,n){n.d(t,{Z:function(){return c}});var r=n(10253),i=n(78120),a=n(41656),o=n(35256);function c(e,t){var n=[];if(!e.length)return n;var c=i.xv.of(t.split("\n"));if(1===e.length){var s=(0,r.Z)(e,1)[0],l=s.range,u=l.start,d=l.end,f=s.newText;if(0===(0,a.R)(c,u))if((0,a.R)(c,d)===c.length)return(0,o.diffStr)(t,f)}var p=!0,h=!1,m=void 0;try{for(var v,g=e[Symbol.iterator]();!(p=(v=g.next()).done);p=!0){var b=v.value,x=b.range,Z=b.newText,y=[],w=(0,a.R)(c,x.start);w>0&&y.push(w);var k=(0,a.R)(c,x.end);k>w&&y.push({d:k-w}),Z.length>0&&y.push(Z),n=(0,o.compose)(n,(0,o.transform)(y,n,"right"))}}catch(E){h=!0,m=E}finally{try{p||null==g.return||g.return()}finally{if(h)throw m}}return n}},55528:function(e,t,n){n.d(t,{Z:function(){return v}});var r=n(10253),i=n(67294),a=n(99408),o=n(2916),c=n(26042),s=n(69396),l=n(58830),u=n(7787),d=n(48444);function f(e){return Math.floor(performance.now()-e.startTime)}var p=new WeakSet;function h(e){var t=e.client,n=e.replId,r=e.language;if(!p.has(t)){p.add(t);var i=new Map,a=function(e){return{method:e.method,replid:n,language:r,startTime:Math.floor(e.startTime)}},o=(0,l.Z)((function(e,t){var n=f(t);n>1e4&&u.kg.time("LSP unresponsive request",n,a(t))})),h=setInterval((function(){i.forEach((function(e){o(e.id,e)}))}),2e3);return(0,d.uf)([t.onRequest((function(e){var t=e.id,n=e.data;Math.random()<.01&&i.set(t,{id:t,method:n.method,startTime:performance.now()})})),t.onResponse((function(e){var t=e.id,n=e.error,r=i.get(t);null!=r&&(i.delete(t),u.kg.time("LSP request",f(r),(0,s.Z)((0,c.Z)({},a(r)),{result:null==n?"ok":"error"})))})),t.onCancelRequest((function(e){var t=i.get(e);null!=t&&(i.delete(e),u.kg.time("LSP request",f(t),(0,s.Z)((0,c.Z)({},a(t)),{result:"cancelled"})))})),function(){return clearInterval(h)},function(){return p.delete(t)}])}}var m=n(11625);function v(e){var t=(0,o.Z)(),n=(0,a.Z)(),c=n.lsp,s=n.lspnix,l=(0,r.Z)(i.useState(null),2),u=l[0],d=l[1];return i.useEffect((function(){if(null===t||void 0===t?void 0:t.language){var n,r;if(t.language.startsWith("nix")||t.language.startsWith("html"))n=s.onClient(e,d);else(null===(r=c.getClient())||void 0===r?void 0:r.isSupportedFile(e))?d(c.getClient()):d(null),n=c.onClient((function(t){(null===t||void 0===t?void 0:t.isSupportedFile(e))?d(t):d(null)}));return function(){n(),d(null)}}}),[c,s,e,null===t||void 0===t?void 0:t.language]),i.useEffect((function(){if(u&&t)return h({client:u,replId:t.id,language:(0,m.D)(e)})}),[u,t,e]),u}},58502:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(10253),i=n(67294);function a(e){var t=e.presence,n=(0,r.Z)(i.useState(t.getActiveUsers()),2),a=n[0],o=n[1];return i.useEffect((function(){return o(t.getActiveUsers()),t.onActiveUsersChange((function(e){return o(e)}))}),[t]),a}},86601:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(10253),i=n(67294),a=n(99408);function o(){var e=(0,a.Z)().presence,t=(0,r.Z)(i.useState(e.getFollowedUser()),2),n=t[0],o=t[1];return i.useEffect((function(){return o(e.getFollowedUser()),e.onFollowedUserChanged(o)}),[e]),n}},32027:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(86601);function i(){var e=(0,r.Z)();return e?e.color:null}},91513:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(99408),i=n(67294),a=n(48551);function o(e){var t=(0,r.Z)(),n=t.session,o=t.fs,c=(0,i.useCallback)((function(t){var r=t.code,i=t.insertAt,c=t.newLine,s=void 0===c||c;if(!e||(0,a.T3)(e)||(0,a.sL)(e)||(0,a.IQ)(e))throw new Error("Invalid file, this should never happen");if(0!==r.length)var l=o.watchOtFile(e,{onReady:function(e){var t,a=e.initialContent,c=e.writeOp,u=a.toString(),d=n.getCursorPosition().offset;t="end"===i?u.length:"number"===typeof i?i:d;var f=r;s&&(0!==t&&t!==u.length&&-1===(t=u.indexOf("\n",t))&&(t=u.length),0!==t&&"\n"!==u[t-1]&&(f="\n"+f),"\n"!==u[t]&&(f+="\n"));var p=[f];t>0&&p.unshift(t),c(p),o.flush().finally((function(){l()}))}})}),[e,n,o]);return!e||(0,a.T3)(e)||(0,a.sL)(e)?null:c}},7182:function(e,t,n){var r;n.d(t,{z:function(){return r}}),function(e){e.FileNode="FILE_NODE",e.FileHeaderTab="FILE_HEADER_TAB",e.Code="CODE",e.Pane="PANE"}(r||(r={}))},54774:function(e,t,n){n.d(t,{Z:function(){return c}});var r=n(26042),i=n(69396),a=n(35944),o=(n(67294),n(81183));function c(e){return(0,a.tZ)(o.Z,(0,i.Z)((0,r.Z)({},e),{children:(0,a.tZ)("path",{d:"M22.0005 12.4999V8.50012H20.001V6.49987H18V5.50012H20.001V2.50012H17.001V4.49962H15V6.49987H9V4.49962H7.0005V2.50012H4.0005V5.50012H6V6.49987H4.0005V8.50012H2.001V12.4999H0V19.4996H3V15.4999H4.0005V19.4996H6V21.4999H11.001V18.4999H7.0005V17.5001H17.001V18.4999H13.0005V21.4999H18V19.4996H20.001V15.4999H21V19.4996H24V12.4999H22.0005ZM9 11.5001H6V8.50012H9V11.5001ZM18 11.5001H15V8.50012H18V11.5001Z",fill:"currentColor",stroke:"none"})}))}},11533:function(e,t,n){n.d(t,{jz:function(){return k},yC:function(){return y}});var r=n(47568),i=n(10253),a=n(34051),o=n.n(a),c=n(35944),s=(n(67294),n(92876)),l=n(87653),u=n(86292),d=n(36706),f=n(26600),p=n(50009),h=n(19526),m=n(28173),v=n(3218),g=n(64743),b=100,x="signal: broken pipe",Z=["exit status 1",x];function y(e){return w.apply(this,arguments)}function w(){return(w=(0,r.Z)(o().mark((function e(t){var n,r,a,c,l,d,f,p,h,m,v,g,y,w,k,E,S,C,T,R,_,I,P,D,A,N;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.query,r=t.container,a=window.performance.now(),e.next=4,r.exec("ag","--noaffinity","--context=0","--workers=1","--literal","--ackmate","--pager","head -".concat(300),"--",n);case 4:if(c=e.sent,l=c.output,d=c.error,f=d&&!Z.includes(d),(0,u.j)(u.U3.COMMAND_BAR_SEARCH,{duration:window.performance.now()-a,failed:f}),!f){e.next=12;break}return s.Tb(new Error("Search command failed with error: ".concat(d))),e.abrupt("return",{error:d,results:null,isPartialResult:!1});case 12:if(l){e.next=14;break}return e.abrupt("return",{error:null,results:{},isPartialResult:!1});case 14:p=l.split("\n"),h={},m="",v=0,g=d===x,y=!0,w=!1,k=void 0,e.prev=20,E=p[Symbol.iterator]();case 22:if(y=(S=E.next()).done){e.next=46;break}if(C=S.value){e.next=26;break}return e.abrupt("continue",43);case 26:if(!C.startsWith(":")){e.next=30;break}return m=C.slice(1),h[m]=[],e.abrupt("continue",43);case 30:if(!(v>=b)){e.next=33;break}return g=!0,e.abrupt("break",46);case 33:T=C.indexOf(";"),R=parseInt(C.slice(0,T),10),_=C.slice(T+1),I=_.indexOf(":"),P=_.slice(0,I).split(","),D=P.map((function(e){var t=(0,i.Z)(e.split(" "),2),n=t[0],r=t[1];return{column:parseInt(n,10),length:parseInt(r,10)}})),A=_.slice(I+1),N=A.length>151?A.substring(0,149)+"\u2026":A,v++,h[m].push({content:N,lineNumber:R,matches:D});case 43:y=!0,e.next=22;break;case 46:e.next=52;break;case 48:e.prev=48,e.t0=e.catch(20),w=!0,k=e.t0;case 52:e.prev=52,e.prev=53,y||null==E.return||E.return();case 55:if(e.prev=55,!w){e.next=58;break}throw k;case 58:return e.finish(55);case 59:return e.finish(52);case 60:return e.abrupt("return",{error:null,results:h,isPartialResult:g});case 61:case"end":return e.stop()}}),e,null,[[20,48,52,60],[53,,55,59]])})))).apply(this,arguments)}function k(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).keyboardShortcut;return function(t){var n,a=t.container,s=t.onSelect,u=(0,m.Z)((function(e,t,n){y(e).then(t).catch(n)}),200);return{data:{type:"basic",label:"Search",icon:(0,c.tZ)(l.Z,{}),description:"Search through your files",keyboardShortcut:e},config:{callOnLeave:!0},commands:function(){var e=(0,r.Z)(o().mark((function e(t){var r,l,m,b,x,Z,y,w,k,E,S,C,T;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l={},!(0,g.sA)(t)){e.next=4;break}return e.abrupt("return",l);case 4:if(!(0!==t.relativeSearchDepth&&t.searchValue.length<4)){e.next=6;break}return e.abrupt("return",l);case 6:if(m=t.searchPath?t.searchPath.join(" "):null){e.next=9;break}return e.abrupt("return",l);case 9:if(1!==(null===(r=t.searchPath)||void 0===r?void 0:r.length)||"files"!==t.searchPath[0]&&"search"!==t.searchPath[0]){e.next=11;break}return e.abrupt("return",l);case 11:return b=Math.random(),n=b,e.next=15,new Promise((function(e,t){u({query:m,container:a},e,t)}));case 15:if(x=e.sent,Z=x.results,!(y=x.error)){e.next=20;break}return e.abrupt("return",{Error:{data:{type:"error",label:y}}});case 20:if(b===n){e.next=22;break}return e.abrupt("return",l);case 22:if(Z){e.next=24;break}return e.abrupt("return",l);case 24:for(w=!0,k=!1,E=void 0,e.prev=25,S=function(){var e=(0,i.Z)(T.value,2),t=e[0];e[1].forEach((function(e){l["".concat(t,":").concat(e.lineNumber)]={config:{match:function(){var n;return{score:(null===(n=v.Z.match(m,e.content))||void 0===n?void 0:n.score)||1,render:function(n){var r=n.isActive,i=(0,c.tZ)(d.JI,{path:t,isActive:r});return(0,c.BX)(h.gC,{spacing:"4px",wrap:"nowrap",children:[(0,c.BX)(f.W,{isActive:r,icon:i,children:[t,":",e.lineNumber]}),(0,c.tZ)(p.xK,{source:e.content,matches:e.matches})]})}}}},data:{label:t,description:"".concat(t,":").concat(e.lineNumber),icon:(0,c.tZ)(d.JI,{path:t}),type:"action",run:function(){s(t,e.lineNumber,e.matches[0].column)}}}}))},C=Object.entries(Z)[Symbol.iterator]();!(w=(T=C.next()).done);w=!0)S();e.next=34;break;case 30:e.prev=30,e.t0=e.catch(25),k=!0,E=e.t0;case 34:e.prev=34,e.prev=35,w||null==C.return||C.return();case 37:if(e.prev=37,!k){e.next=40;break}throw E;case 40:return e.finish(37);case 41:return e.finish(34);case 42:return e.abrupt("return",l);case 43:case"end":return e.stop()}}),e,null,[[25,30,34,42],[35,,37,41]])})));return function(t){return e.apply(this,arguments)}}()}}}k({keyboardShortcut:{cmdOrCtrlKey:!0,altKey:!1,shiftKey:!0,key:"F"}})},36706:function(e,t,n){n.d(t,{JI:function(){return p},a2:function(){return h}});var r=n(47568),i=n(34051),a=n.n(i),o=n(35944),c=n(67294),s=n(3218),l=n(24888),u=n(63736),d=n(26600),f=n(64743);function p(e){var t=e.path,n=e.isActive;return(0,o.tZ)(u.Z,{path:t,fill:n?"var(--white)":void 0,fillDefaultFileIcon:n})}function h(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).keyboardShortcut;return function(t){var n=t.fs,i=t.onSelect,u=t.onCreateNewFile,h=t.session;return{data:{type:"basic",label:"Files",icon:(0,o.tZ)(l.Z,{}),description:"Find a file",keyboardShortcut:e},config:{callOnLeave:!0},commands:function(){var e=(0,r.Z)(a().mark((function e(t){var r,l,m,v,g,b,x,Z,y,w,k,E,S,C,T;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l={},!(0,f.sA)(t)){e.next=4;break}return e.abrupt("return",l);case 4:if(m=t.searchPath?t.searchPath.join(" ").toLowerCase():void 0,0===t.relativeSearchDepth||m&&!(m.length<2)){e.next=7;break}return e.abrupt("return",l);case 7:if(t.callStage!==f.xS.Leave||0!==t.relativeSearchDepth&&!t.getCurrentOptions().some((function(e){return e.token.value===m}))){e.next=9;break}return e.abrupt("return",l);case 9:return e.next=11,n.listFiles();case 11:if(!(v=e.sent).error||!(null===(r=t.searchPath)||void 0===r?void 0:r.length)){e.next=15;break}return g=t.searchPath.join(" "),e.abrupt("return",{newFile:{data:{label:g,description:"Create a new file",icon:(0,o.tZ)(p,{path:g}),type:"action",run:function(){return u(g)}},config:{match:function(){return{score:1}}}}});case 15:if("exit status 1"!==v.error){e.next=17;break}return e.abrupt("return",l);case 17:if(b=v.files){e.next=20;break}throw new Error("Expected files");case 20:for(x=h.getRecentFiles(),Z=!0,y=!1,w=void 0,e.prev=22,k=function(){var e=S.value,t=!m||s.Z.match(m,e);if(!t)return"continue";var n=x.includes(e);l[e]={config:{match:function(){return!0===t?{score:n?2:1}:{score:n?2*t.score:t.score,render:function(n){var r=n.isActive,i=(0,o.tZ)(p,{path:e,isActive:r});return(0,o.tZ)(d.W,{isActive:r,icon:i,children:(0,o.tZ)(o.HY,{children:c.Children.map(t.elements,(function(e,t){return(0,o.tZ)(c.Fragment,{children:e},t)}))})})}}}},data:{label:e,description:"",icon:(0,o.tZ)(p,{path:e}),type:"action",run:function(){return i(e)}}}},E=b[Symbol.iterator]();!(Z=(S=E.next()).done);Z=!0)k();e.next=31;break;case 27:e.prev=27,e.t0=e.catch(22),y=!0,w=e.t0;case 31:e.prev=31,e.prev=32,Z||null==E.return||E.return();case 34:if(e.prev=34,!y){e.next=37;break}throw w;case 37:return e.finish(34);case 38:return e.finish(31);case 39:return t.searchPath&&(C=t.searchPath.join(" "),T=Object.values(l).some((function(e){var t;return(null===(t=e.data)||void 0===t?void 0:t.label)===C})),T||(l.newFile={data:{label:C,description:"Create a new file",icon:(0,o.tZ)(p,{path:C}),type:"action",run:function(){return u(C)}},config:{match:function(){return{score:1}}}})),e.abrupt("return",l);case 41:case"end":return e.stop()}}),e,null,[[22,27,31,39],[32,,34,38]])})));return function(t){return e.apply(this,arguments)}}()}}}h({keyboardShortcut:{cmdOrCtrlKey:!0,altKey:!1,shiftKey:!1,key:"P"}})},73138:function(e,t,n){n.d(t,{Y:function(){return y},Z:function(){return S}});var r=n(35944),i=n(67294),a=n(59119),o=n(78120),c=n(47421),s=n(59006),l=n(410),u=n(68122),d=n(82378),f=n(65975),p=n(44781),h=n(48444),m=n(23445),v=(0,d.u)(null),g=(0,d.u)(null),b=(0,d.u)({from:0,to:0}),x=c.p.mark({class:"ast-hover"}),Z=c.tk.baseTheme({".ast-hover":{background:f.TV.backgroundHighest}});function y(e){var t=e.view,n=(0,s.Z)({view:t}),r=(0,m.k)();(0,i.useEffect)((function(){if(r&&t){v.current=t.state;var e=o.Py.define(),i=(0,h.uf)([g.subscribe((function(n){t.dispatch({effects:e.of(n)})})),b.subscribe((function(e){t.dispatch({selection:{anchor:e.from,head:e.to}})}))]);return t.dispatch({effects:n.reconfigure([c.tk.updateListener.of((function(e){(e.selectionSet||e.docChanged)&&(v.current=e.state)})),o.QQ.define({create:function(){return c.p.none},update:function(t,n){return t=t.map(n.changes),(0,l.j)(n,e,(function(e){t=null==e.value?c.p.none:c.p.set([x.range(e.value.from,e.value.to)])})),t},provide:function(e){return c.tk.decorations.from(e)}}),Z])}),function(){v.current=null,i(),t.dispatch({effects:n.reconfigure([])})}}}),[t,r,n])}var w=(0,i.memo)((function(e){var t=e.node,n=e.index,i=e.active,a=e.terminal,o=t.type.name,c={from:t.from,to:t.to};return(0,r.BX)(f.G7,{css:[{marginLeft:4*n+(a?4:0)},f.l0.mb(4),f.l0.rowWithGap(2),f.l0.align.center,f.l0.cursor.pointer],onMouseEnter:function(){g.current=c},onClick:function(){g.current=null,b.current=c},children:[(0,r.tZ)(p.Z,{size:"small",fontFamily:o.length>1?"sans-serif":"monospace",fontWeight:i?"bold":"regular",children:o}),(0,r.BX)(p.Z,{size:"xsmall",truncate:!0,children:["(",t.from," \u2013 ",t.to,")"]})]})}));function k(e,t){for(var n=[];t(e);)n.push(e.node);return n}var E=(0,i.memo)((function(e){var t=e.state,n=(0,a.qz)(t),o=t.selection.main.head,c=(0,i.useMemo)((function(){return k(n.cursorAt(o),(function(e){return e.parent()})).reverse()}),[n,o]),s=(0,i.useMemo)((function(){return k(n.cursorAt(o),(function(e){return e.prevSibling()}))}),[n,o]),l=(0,i.useMemo)((function(){return k(n.cursorAt(o),(function(e){return e.nextSibling()}))}),[n,o]);return(0,r.BX)(f.G7,{css:f.l0.ml(4),onMouseLeave:function(){g.current=null},children:[c.map((function(e,t){return(0,r.tZ)(w,{node:e,index:t},t)})),s.map((function(e,t){return(0,r.tZ)(w,{node:e,index:c.length,terminal:!0},t)})),(0,r.tZ)(w,{node:n.resolveInner(t.selection.main.head),index:c.length,terminal:!0,active:!0}),l.map((function(e,t){return(0,r.tZ)(w,{node:e,index:c.length,terminal:!0},t)}))]})}));function S(){var e=(0,u.Z)(v);return e?(0,r.tZ)(E,{state:e}):null}},59821:function(e,t,n){n.d(t,{C:function(){return g},P:function(){return b}});var r=n(51438),i=n(26042),a=n(69396),o=n(10253),c=n(35944),s=n(67294),l=n(65975),u=n(48386),d=n(77365),f=n(75597),p=n(74454),h=n(68122),m=n(82378),v=n(97992),g=new(function(){function e(){var t=this;(0,r.Z)(this,e),this.counter=0,this.enabled=!1,this.logs=(0,m.u)([]),this.clear=function(){t.logs.current=[]}}var t=e.prototype;return t.toggle=function(e){this.enabled=e},t.add=function(e){if(!this.enabled)return{id:-1};var t=this.counter++,n={id:t,request:e,requestTime:Date.now()};return this.logs.update((function(e){return[n].concat(e).slice(0,10)})),{id:t}},t.update=function(e,t){this.enabled&&this.logs.update((function(n){var r=n.findIndex((function(t){return t.id===e.id}));if(-1===r)return n;var i=n.slice();return i[r]=t(i[r]),i}))},t.complete=function(e,t){this.update(e,(function(e){return(0,a.Z)((0,i.Z)({},e),{response:t,responseTime:Date.now()})}))},t.abort=function(e){this.logs.update((function(t){return t.filter((function(t){return t.id!==e.id}))}))},e}()),b=function(){var e,t=(0,h.Z)(g.logs);return(0,c.BX)(l.G7,{css:[l.l0.flex.column],children:[(0,c.BX)(l.G7,{css:[l.l0.flex.row,l.l0.align.center,l.l0.m(4),l.l0.position.sticky,l.l0.top(0),l.l0.backgroundColor.backgroundDefault,l.l0.zIndex(1)],children:[(0,c.tZ)(l.xv,{css:l.l0.flex.grow(1),children:"Requests"}),(0,c.tZ)(u.Z,{onClick:g.clear})]}),(0,c.BX)(l.G7,{css:[l.l0.flex.grow(1),l.l0.flex.column,l.l0.overflow("auto")],children:[t.map((function(t){return(0,c.tZ)(x,{log:t},null!==(e=t.id)&&void 0!==e?e:t.requestTime.valueOf())})),!t.length&&(0,c.tZ)(l.G7,{css:l.l0.m(4),children:"\ud83d\ude14 No logs yet..."})]})]})},x=(0,s.memo)((function(e){var t=e.log,n=t.requestTime,r=t.responseTime,i=t.request,a=t.response,s=(0,o.Z)((0,p.Z)(!0),2),u=s[0],d=s[1],f=i.code.length>20?"...".concat(i.code.slice(-20)):i.code;return(0,c.BX)(l.G7,{css:[l.l0.my(4),l.l0.mx(4)],children:[(0,c.BX)(l.G7,{role:"button",onClick:d,onKeyDown:d,tabIndex:0,css:[l.l0.flex.row,l.l0.rowWithGap(4),{"&:hover":{cursor:"pointer",".lspLog-requestMethod":{textDecoration:"underline"}}}],children:[(0,c.BX)(l.G7,{css:[l.l0.flex.grow(1),l.l0.rowWithGap(2)],children:[(0,c.tZ)(l.xv,{children:Z(t)}),(0,c.tZ)(l.xv,{children:(0,c.tZ)("code",{children:f})})]}),(0,c.tZ)(l.G7,{css:{opacity:.5},children:null!=r&&(0,c.BX)(l.xv,{css:l.l0.fontSize(13),children:[r.valueOf()-n.valueOf()," ms"]})})]}),!u&&(0,c.BX)(c.HY,{children:[void 0!==i&&(0,c.tZ)(v.g,{name:"request",src:i}),void 0!==a&&("SuggestCodeResult"===a.__typename?(0,c.BX)("details",{children:[(0,c.tZ)("summary",{children:"Response"}),(0,c.tZ)("pre",{css:[l.l0.overflow("scroll"),l.l0.borderRadius(4),l.l0.p(4),{border:"1px solid ".concat(l.TV.outlineDimmest)}],children:a.code})]}):(0,c.tZ)(v.g,{name:"response",src:a}))]})]})}));function Z(e){var t=e.response;return t?"SuggestCodeResult"===t.__typename?(0,c.tZ)(f.Check,{}):(0,c.tZ)(f.Frown,{}):(0,c.tZ)(d.Z,{})}},97992:function(e,t,n){n.d(t,{L:function(){return E},g:function(){return C}});var r=n(26042),i=n(69396),a=n(10253),o=n(35944),c=n(5152),s=n.n(c),l=n(67294),u=n(37424),d=n(40381),f=n(55528),p=n(65975),h=n(48386),m=n(72806),v=n(519),g=n(77365),b=n(75597),x=n(8394),Z=n(74454),y=n(48444),w=n(25108),k=s()((function(){return n.e(367).then(n.t.bind(n,55171,23))}),{loadableGenerated:{webpack:function(){return[55171]}},ssr:!1}),E=function(){var e,t=(0,d.Z)(),n=(0,f.Z)(t||""),c=(0,u.H)(),s=(0,a.Z)((0,Z.Z)(!0),2),g=s[0],x=s[1],w=(0,l.useState)(""),k=w[0],E=w[1],C=(0,l.useState)((function(){return[]})),R=C[0],_=C[1],I=(0,a.Z)((0,Z.Z)(!0),2),P=I[0],D=I[1],A=(0,a.Z)((0,Z.Z)(!0),2),N=A[0],U=A[1],j=(0,l.useCallback)((function(e){_((function(t){return[e].concat(t)}))}),[]),B=(0,l.useCallback)((function(e,t){_((function(n){return n.map((function(n){return n.id===e?t(n):n}))}))}),[]),O=(0,l.useCallback)((function(){_([])}),[]),G=(0,l.useMemo)((function(){var e=k.split(",").map((function(e){return e.trim()})),t=R;return P||(t=t.filter((function(e){return null==e.notification}))),N||(t=t.filter((function(e){return null==e.request}))),k&&(t=t.filter((function(t){return e.some((function(e){var n;return null===(n=t.request||t.notification)||void 0===n?void 0:n.method.toLowerCase().includes(e.toLowerCase())}))}))),t}),[R,P,N,k]);return(0,l.useEffect)((function(){return(0,y.uf)([null===n||void 0===n?void 0:n.onRequest((function(e){g&&j({id:e.id,canceled:!1,request:e.data,requestTime:new Date})})),null===n||void 0===n?void 0:n.onResponse((function(e){g&&B(e.id,(function(t){return(0,r.Z)((0,i.Z)((0,r.Z)({},t),{responseTime:new Date}),void 0!==e.result?{response:e.result}:{error:e.error})}))})),null===n||void 0===n?void 0:n.onCancelRequest((function(e){g&&B(e,(function(e){return(0,i.Z)((0,r.Z)({},e),{canceled:!0})}))})),null===n||void 0===n?void 0:n.onSendNotification((function(e){g&&j({canceled:!1,notification:e,requestTime:new Date})}))])}),[n,j,B,g]),(0,o.BX)(p.G7,{css:[p.l0.flex.column],children:[(0,o.BX)(p.G7,{css:[p.l0.flex.row,p.l0.align.center,p.l0.m(4),p.l0.position.sticky,p.l0.top(0),p.l0.backgroundColor.backgroundDefault,p.l0.zIndex(1)],children:[(0,o.tZ)(p.xv,{css:p.l0.flex.grow(1),children:n?(0,o.BX)(o.HY,{children:[(0,o.tZ)(T,{})," logs for ",(0,o.tZ)("code",{children:t})]}):"No LSP"}),(0,o.tZ)(v.Z,{isOn:g,onChange:x}),(0,o.tZ)(h.Z,{onClick:O})]}),(0,o.BX)(p.G7,{css:[p.l0.rowWithGap(8),p.l0.m(4),p.l0.mb(8)],children:[(0,o.BX)(p.G7,{css:p.l0.rowWithGap(4),children:[(0,o.tZ)(b.Filter,{}),(0,o.tZ)(p.xv,{children:"Show"})]}),(0,o.BX)(p.G7,{css:p.l0.rowWithGap(4),children:[(0,o.tZ)(m.Z,{id:c("showNotifications"),checked:P,onChange:D}),(0,o.tZ)("label",{htmlFor:c("showNotifications"),children:" Notifications"})]}),(0,o.BX)(p.G7,{css:p.l0.rowWithGap(4),children:[(0,o.tZ)(m.Z,{id:c("showRequests"),checked:N,onChange:U}),(0,o.tZ)("label",{htmlFor:c("showRequests"),children:" Requests"})]})]}),(0,o.tZ)(p.G7,{css:p.l0.rowWithGap(4),children:(0,o.tZ)(p.II,{id:c("filterLsp"),placeholder:"Filter by method (Separate by ,)",onChange:function(e){return E(e.target.value)},value:k})}),(0,o.BX)(p.G7,{css:[p.l0.flex.grow(1),p.l0.flex.column,p.l0.overflow("auto")],children:[G.map((function(t){return(0,o.tZ)(S,{log:t},null!==(e=t.id)&&void 0!==e?e:t.requestTime.valueOf())})),!G.length&&(0,o.tZ)(p.G7,{css:p.l0.m(4),children:"\ud83d\ude14 No logs yet..."})]})]})},S=l.memo((function(e){var t,n=e.log,r=n.requestTime,i=n.responseTime,c=n.request,s=n.response,l=n.notification,u=n.id,d=(0,a.Z)((0,Z.Z)(!0),2),f=d[0],h=d[1];return(0,o.BX)(p.G7,{css:[p.l0.my(4),p.l0.mx(4)],children:[(0,o.BX)(p.G7,{role:"button",onClick:h,onKeyDown:h,tabIndex:0,css:[p.l0.flex.row,p.l0.rowWithGap(4),{"&:hover":{cursor:"pointer",".lspLog-requestMethod":{textDecoration:"underline"}}}],children:[(0,o.BX)(p.G7,{css:[p.l0.flex.grow(1),p.l0.rowWithGap(2)],children:[(0,o.tZ)(p.xv,{className:"lspLog-emoji",children:R(n)}),(0,o.BX)(p.xv,{className:"lspLog-requestMethod",children:[(0,o.tZ)("code",{children:null===(t=c||l)||void 0===t?void 0:t.method}),null!=u&&(0,o.BX)("code",{className:"lspLog-logId",css:{opacity:.5},children:["#",u]})]})]}),(0,o.tZ)(p.G7,{css:{opacity:.5},children:null!=i&&(0,o.BX)(p.xv,{css:p.l0.fontSize(13),children:[i.valueOf()-r.valueOf()," ms"]})})]}),!f&&(0,o.BX)(o.HY,{children:[void 0!==c&&(0,o.tZ)(C,{name:"request.params",src:c.params}),void 0!==l&&(0,o.tZ)(C,{name:"notification.params",src:l.params}),void 0!==s&&(0,o.tZ)(C,{name:"response",src:s})]})]})})),C=(0,l.memo)((function(e){var t=e.name,n=e.src,i=(0,x.Z)();return(0,o.tZ)(p.G7,{css:{marginTop:5,".node-ellipsis":{letterSpacing:-2},".object-key span":{letterSpacing:0},".object-key-val":{paddingBottom:"0 !important"},'.object-key + span[style*="margin"], .array-key + span[style*="margin"]':{marginLeft:"0 !important"},".variable-row, .pushed-content .object-key-val":{paddingLeft:"10px !important",paddingBottom:"0 !important"}},children:(0,o.tZ)(k,{iconStyle:"triangle",style:{backgroundColor:"transparent"},displayDataTypes:!1,theme:i,collapseStringsAfterLength:40,collapsed:1,displayObjectSize:!1,name:t,enableClipboard:function(e){var t=(0,r.Z)({},e.src);Object.assign(globalThis,{$msg:t}),w.log("$msg"),w.log(t),navigator.clipboard.writeText(JSON.stringify(t,null,2)).finally((function(){}))},src:"object"===typeof n&&null!==n?n:{value:n}})})})),T=function(){return(0,o.tZ)(p.xv,{css:{display:"inline",fontStyle:"italic",fontWeight:600,textShadow:"".concat(p.TV.redDimmer," 2px 2px")},children:"LSP"})};function R(e){var t=e.canceled,n=e.response,r=e.notification;return t?(0,o.tZ)(b.Close,{}):r?(0,o.tZ)(b.Info,{}):void 0!==n?(0,o.tZ)(b.Check,{}):(0,o.tZ)(g.Z,{})}},8394:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(67003);function i(){return(0,r.Fg)().isDarkColorScheme?"bright":"bright:inverted"}},74454:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(67294);function i(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=(0,r.useState)(e),n=t[0],i=t[1],a=(0,r.useCallback)((function(){return i((function(e){return!e}))}),[]);return[n,a]}},42325:function(e,t,n){n.d(t,{AA:function(){return k},CH:function(){return g},Gg:function(){return m},Ne:function(){return S},pV:function(){return y},vk:function(){return x}});var r=n(26042),i=n(7297),a=n(31230),o=n(64576),c=n(46829);function s(){var e=(0,i.Z)(["\n  fragment AutograderTest on ReplTemplateTest {\n    id\n    name\n    input\n    output\n    name\n    type\n  }\n"]);return s=function(){return e},e}function l(){var e=(0,i.Z)(["\n  query Autograder($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        currentUserPermissions {\n          writeTests\n        }\n        template {\n          id\n        }\n        ioTests {\n          id\n          ...AutograderTest\n        }\n        unitTests {\n          meta {\n            id\n            ...UnitTestsReplUnitTestMeta\n          }\n          tests {\n            id\n            ...UnitTestsReplUnitTest\n            lastRun(replId: $replId) {\n              ... on ReplUnitTestLastRun {\n                status\n              }\n              ... on UserError {\n                message\n              }\n            }\n          }\n        }\n        isProject\n        isProjectFork\n        owner {\n          ... on Team {\n            id\n            isAdmin\n          }\n          ... on User {\n            id\n          }\n        }\n      }\n    }\n  }\n  ","\n  ","\n  ","\n"]);return l=function(){return e},e}function u(){var e=(0,i.Z)(["\n  mutation SaveIOTestResults(\n    $teamId: Int!\n    $replId: String!\n    $results: [IOTestResultInput!]!\n  ) {\n    saveIOTestResults(teamId: $teamId, replId: $replId, results: $results) {\n      ... on UserError {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n    }\n  }\n"]);return u=function(){return e},e}function d(){var e=(0,i.Z)(["\n  mutation CreateAutograderTest($input: CreateTemplateTestInput!) {\n    createTemplateTest(input: $input) {\n      ... on ReplTemplateTest {\n        id\n        ...AutograderTest\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return d=function(){return e},e}function f(){var e=(0,i.Z)(["\n  mutation UpdateAutograderTest($input: UpdateTemplateTestInput!) {\n    updateTemplateTest(input: $input) {\n      ... on ReplTemplateTest {\n        id\n        ...AutograderTest\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return f=function(){return e},e}function p(){var e=(0,i.Z)(["\n  mutation DeleteAutograderTest($testId: Int!) {\n    deleteTemplateTest(testId: $testId) {\n      ... on ReplTemplate {\n        id\n        tests {\n          id\n          ...AutograderTest\n        }\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return p=function(){return e},e}var h={},m=(0,a.ZP)(s()),v=(0,a.ZP)(l(),m,o.aA,o.Rb);function g(e){var t=(0,r.Z)({},h,e);return c.useQuery(v,t)}var b=(0,a.ZP)(u());function x(e){var t=(0,r.Z)({},h,e);return c.useMutation(b,t)}var Z=(0,a.ZP)(d(),m);function y(e){var t=(0,r.Z)({},h,e);return c.useMutation(Z,t)}var w=(0,a.ZP)(f(),m);function k(e){var t=(0,r.Z)({},h,e);return c.useMutation(w,t)}var E=(0,a.ZP)(p(),m);function S(e){var t=(0,r.Z)({},h,e);return c.useMutation(E,t)}},35129:function(e,t,n){n.d(t,{Z:function(){return Ol}});var r=n(26042),i=n(10253),a=n(35944),o=n(29815),c=n(60536),s=n.n(c),l=n(67294),u=n(63805),d=n(4989),f=n(69346),p=n(81255),h=n(79736),m=n(7919),v=n(45383),g=n(28173),b=n(13482),x=n(2581),Z=function(e){var t=e.buttons,n=e.onClick,r=e.onUndo,i=e.onRedo;return(0,a.BX)("nav",{className:"jsx-43582faf24448cbd",children:[t.map((function(e){return(0,a.tZ)("button",{onClick:function(t){t.stopPropagation(),t.preventDefault(),n(e)},className:"jsx-43582faf24448cbd",children:void 0!==e.label?e.label:e.value},e.value)})),(0,a.tZ)("button",{onClick:function(e){e.stopPropagation(),e.preventDefault(),r()},className:"jsx-43582faf24448cbd",children:(0,a.tZ)(h.Z,{})}),(0,a.tZ)("button",{onClick:function(e){e.stopPropagation(),e.preventDefault(),i()},className:"jsx-43582faf24448cbd",children:(0,a.tZ)(m.Z,{})}),(0,a.tZ)(s(),{id:"43582faf24448cbd",children:'nav.jsx-43582faf24448cbd{font-family:Monaco,Menlo,"Ubuntu Mono",Consolas,source-code-pro,monospace;height:48px;background-color:var(--background-root);display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:stretch;-webkit-align-items:stretch;-moz-box-align:stretch;-ms-flex-align:stretch;align-items:stretch}button.jsx-43582faf24448cbd{color:var(--foreground-default);padding:10px;font-family:inherit;font-size:16px;background-color:transparent;border:0 none;-webkit-box-flex:1;-webkit-flex:1 1 auto;-moz-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}'})]})},y=[{value:"{}",cursorOffset:1},{value:"()",cursorOffset:1},{value:'""',cursorOffset:1}],w=function(e){var t=e.path,n=(0,o.Z)(y).concat([{value:"= ",cursorOffset:2}]);return t.endsWith(".html")&&(n.unshift({value:"<>",cursorOffset:1}),n.unshift({label:"div",value:"<div></div>",cursorOffset:5})),n},k="visualViewport"in window;function E(e){var t=e.filePath,n=e.isLoading,r=(0,x.uN)(),o=(0,d.Z)();l.useEffect((function(){o&&r&&r.requestMeasure({read:function(){return{cursor:r.coordsAtPos(r.state.selection.main.head),scroller:r.scrollDOM.getBoundingClientRect()}},write:function(e){var t=e.cursor,n=e.scroller;if(t){var i=(t.top+t.bottom)/2,a=(n.top+n.bottom)/2;Math.abs(i-a)>5&&(r.scrollDOM.scrollTop+=i-a+(b.g?50:0))}}})}),[o,r]);var c=(0,i.Z)(l.useState(0),2),s=c[0],h=c[1];if(l.useEffect((function(){if(b.g){var e=window.visualViewport;if(k&&e){var t=(0,g.Z)((function(){h(window.innerHeight-e.height-e.offsetTop)}),100);return e.addEventListener("scroll",t),e.addEventListener("resize",t),function(){e.removeEventListener("scroll",t),e.removeEventListener("resize",t)}}}}),[]),!o||n)return null;if(!(0,u.isMobile)({tablet:!1}))return null;var m=(0,a.tZ)(Z,{onUndo:function(){r&&((0,v.Yw)(r),r.focus())},onRedo:function(){r&&((0,v.KX)(r),r.focus())},onClick:function(e){if(r){var t,n=null!==(t=r.state.selection.ranges[0].from)&&void 0!==t?t:0;r.dispatch({changes:{from:n,insert:e.value},selection:{anchor:n+e.cursorOffset}}),r.focus()}},buttons:w({path:t})});return!b.g||k?(0,a.tZ)(f.ZP,{css:[p.l0.position.fixed,p.l0.width("100%"),p.l0.zIndex(100),p.l0.bottom(s),p.l0.left(0)],children:m}):m}var S=n(61193),C=n(7182),T=n(53201),R=[{img:"/public/images/kaboomdraw/rect.png",code:"\ndrawRect({\n\tpos: vec2(80, 80),\n\twidth: 120,\n\theight: 80,\n\tcolor: rgb(250, 242, 164),\n})\n    ".trim()},{img:"/public/images/kaboomdraw/triangle.png",code:"\ndrawTriangle({\n\tpos: vec2(100, 100),\n\tp1: vec2(0, -48),\n\tp2: vec2(-60, 48),\n\tp3: vec2(60, 48),\n\tcolor: rgb(164, 250, 204),\n})\n  ".trim()},{img:"/public/images/kaboomdraw/circle.png",code:"\ndrawCircle({\n\tpos: vec2(100, 100),\n\tradius: 48,\n\tcolor: rgb(181, 164, 250),\n})\n    ".trim()},{img:"/public/images/kaboomdraw/ellipse.png",code:"\ndrawEllipse({\n\tpos: vec2(120, 100),\n\tradiusX: 64,\n\tradiusY: 40,\n\tcolor: rgb(164, 209, 250),\n})\n    ".trim()},{img:"/public/images/kaboomdraw/polygon.png",code:"\ndrawPolygon({\n\tpos: vec2(100, 100),\n\tpts: [\n\t\tvec2(0, -48),\n\t\tvec2(-64, 0),\n\t\tvec2(-32, 64),\n\t\tvec2(32, 64),\n\t\tvec2(64, 0),\n\t],\n\tcolor: rgb(250, 164, 226),\n})\n    ".trim()},{img:"/public/images/kaboomdraw/text.png",code:'\ndrawText({\n\ttext: "hi",\n\tpos: vec2(60, 60),\n})\n    '.trim()}],_=function(e){var t=e.img,n=e.code,r=(0,i.Z)((0,T.c)({item:{type:C.z.Code,code:n},type:C.z.Code}),2)[1];return(0,a.tZ)("img",{alt:"kaboom shape",ref:r,src:t,css:[p.l0.p(12),{userDrag:"none",height:"100%",cursor:"pointer",transition:"0.1s transform",":hover":{transform:"scale(1.2)"}}]})},I=function(){return(0,a.tZ)(f.ZP,{css:[p.l0.flex.row,p.l0.justify.spaceEvenly,p.l0.backgroundColor.backgroundHigher,p.l0.borderRadius(8),p.l0.width("calc(100% - 32px)"),p.l0.height("64px"),p.l0.position.absolute,p.l0.overflowY("hidden"),{zIndex:5,left:16,bottom:16,border:"solid 1px var(--outline-dimmest)"}],children:R.map((function(e){return(0,a.tZ)(_,(0,r.Z)({},e),e.img)}))})},P=n(47979),D=n(69396),A=n(73935),N=n(68928),U=n(99408),j=n(47568),B=n(34051),O=n.n(B),G=n(8415),L=n(55528),M=n(4862);function z(e){var t=(0,i.Z)(l.useState(null),2),n=t[0],r=t[1];return l.useEffect((function(){if(e)return r((0,M.Z)(e)),e.onServerCapabilitiesChange((function(){r((0,M.Z)(e))}));r(null)}),[e]),n}var F=n(26224),X=n(78120),W=n(34790),H=n(47421),V=n(41656),$=n(410);var q=n(65975),Q=n(92350),K=n(91674),Y=n(9903),J={p:{fontSize:"calc(".concat(q.TV.fontSizeDefault," + 1px)"),padding:"".concat(q.TV.space2," ").concat(q.TV.space8),lineHeight:1.4,marginBottom:"".concat(q.TV.space8," !important")},"p:last-child":{marginBottom:"".concat(q.TV.space4," !important")},pre:{margin:"".concat(q.TV.space2," ").concat(q.TV.space8," ").concat(q.TV.space2," ").concat(q.TV.space4," !important")},"pre + p":{borderTop:"1px solid ".concat(q.TV.outlineDimmest),paddingTop:q.TV.space4}},ee=l.memo((function(e){var t=e.content;return(0,a.tZ)(Q.ZP,{css:J,components:{code:function(e){return(0,a.tZ)(Y.Z,(0,r.Z)({minimal:!0,disableCopy:!0},e))}},children:t})}));function te(e){var t=e.content;return"string"===typeof t?(0,a.tZ)(ee,{content:t}):t.kind===K.MarkupKind.PlainText?(0,a.tZ)(q.G7,{children:(0,a.tZ)(q.xv,{multiline:!0,children:t.value})}):(0,a.tZ)(ee,{content:t.value})}var ne=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=X.Py.define(),r=X.QQ.define({create:function(){return t},update:function(t,r){return(0,$.j)(r,n,(function(n){t=e(n.value,t)})),t}});return{effect:n,state:r}}(),re=X.Py.define(),ie=X.QQ.define({create:function(){return null},update:function(e,t){if(!t.isUserEvent("input.type"))return e;if(t.changes.empty)return e;var n="";return t.changes.iterChanges((function(e,t,r,i,a){n=a.sliceString(0,1)})),n||null}});function ae(e){var t=e.lspClient,n=e.path,i=e.setDecoration,o=function(e){return A.createPortal((0,a.tZ)(oe,(0,r.Z)({},e)),c)},c=document.createElement("div"),s={};function l(e,t){return u.apply(this,arguments)}function u(){return u=(0,j.Z)(O().mark((function e(r,i){var a,o,c,s,l,u;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=(null===(a=t.getServerCapabilities())||void 0===a||null===(o=a.signatureHelpProvider)||void 0===o?void 0:o.triggerCharacters)||[]){e.next=4;break}return e.abrupt("return",null);case 4:if(s=r.field(d,!1),l=r.field(ie,!1),s||null!=l&&c.includes(l)){e.next=8;break}return e.abrupt("return",null);case 8:return e.next=10,se(r,i,t,n);case 10:if((u=e.sent)&&u.signatures.length){e.next=13;break}return e.abrupt("return",null);case 13:return e.abrupt("return",u);case 14:case"end":return e.stop()}}),e)}))),u.apply(this,arguments)}var d=X.QQ.define({create:function(){return null},update:function(e,t){return t.isUserEvent("select.pointer")?null:(e&&t.newSelection.main.from!==e.pos&&(e=(0,D.Z)((0,r.Z)({},e),{pos:t.newSelection.main.from})),(0,$.j)(t,ne.effect,(function(n){var r=n.value;e=r?{pos:t.newSelection.main.from,create:function(){return function(e){var t=0,n=function(n){i((0,a.tZ)(o,{help:e,index:t,onLayout:n}))};return n(),s.dom=c,s.update=function(r){(0,$.j)(r,re,(function(i){t=(t+i.value+e.signatures.length)%e.signatures.length,n((function(){(0,H.E2)(r.view)}))}))},s}(r)},above:!0}:null})),e)},provide:function(e){return H.hJ.from(e)}}),f=H.lg.define((function(){var e=(0,g.Z)(function(){var e=(0,j.Z)(O().mark((function e(t){var n,r;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=t.state.selection.main).empty){e.next=7;break}return e.next=4,l(t.state,n.from);case 4:(r=e.sent)&&(0,W._B)(t),t.dispatch({effects:ne.effect.of(r)});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),0);return{update:function(t){t.transactions.some((function(e){return e.selection}))&&t.state.selection.main.empty&&e(t.view)}}})),p=function(e){return function(t){return!!function(e){var t=e.state.field(ne.state,!1);return null!=t&&t.signatures.length>1}(t)&&(t.dispatch({effects:re.of(e)}),!0)}},h=[{key:"ArrowDown",run:p(1)},{key:"ArrowUp",run:p(-1)},{key:"Escape",run:function(e){return!!e.state.field(ne.state,!1)&&(e.dispatch({effects:ne.effect.of(null)}),!0)}}];return[d,ne.state,ie,f,X.Wl.high(H.$f.of(h))]}var oe=function(e){var t,n,r=e.help,i=e.index,o=e.onLayout,c="1px solid ".concat(p.TV.outlineDimmest),s="min(425px, 80vw)";l.useLayoutEffect((function(){return null===o||void 0===o?void 0:o()}),[o]);var u=r.signatures[i],d=r.signatures.length>1;if(!u)return null;var h=u.documentation,m=null!=r.activeParameter&&(null===(t=u.parameters)||void 0===t||null===(n=t[r.activeParameter])||void 0===n?void 0:n.documentation);return(0,a.BX)(f.ZP,{css:[p.l0.flex.row,{width:"max-content"}],children:[d&&(0,a.tZ)(f.ZP,{css:[p.l0.flex.row,p.l0.pl(4),{borderRight:c,paddingBottom:5}],children:(0,a.BX)("span",{css:[{alignSelf:"flex-end"},p.l0.p(4)],children:[i+1,"/",r.signatures.length]})}),(0,a.BX)(f.ZP,{children:[(0,a.tZ)(f.ZP,{css:[p.l0.py(4),p.l0.pl(d?4:8),p.l0.pr(8),p.l0.maxHeight(100),p.l0.overflowY("scroll"),p.l0.font.code,{lineHeight:p.TV.lineHeightSmall,maxWidth:s}],children:(0,a.tZ)(ce,{signature:u,activeParameter:r.activeParameter})}),Boolean(h||m)&&(0,a.BX)(f.ZP,{css:[p.l0.px(d?4:8),p.l0.py(2),p.l0.maxHeight(200),p.l0.overflow("scroll"),{borderTop:c,maxWidth:s}],children:[m?(0,a.tZ)(te,{content:m}):null,h?(0,a.tZ)(te,{content:h}):null]})]})]})};function ce(e){var t,n=e.signature,r=n.label,o=n.parameters,c=e.activeParameter;if(null==c||!o)return(0,a.tZ)("span",{children:r});var s=null===(t=o[c])||void 0===t?void 0:t.label;if(!s)return(0,a.tZ)("span",{children:r});var l=(0,i.Z)("string"===typeof s?[r.indexOf(s),r.indexOf(s)+s.length]:s,2),u=l[0],d=l[1];return(0,a.BX)("div",{children:[(0,a.tZ)("span",{children:r.slice(0,u)}),(0,a.tZ)("strong",{children:s}),(0,a.tZ)("span",{children:r.slice(d)})]})}function se(e,t,n,r){return le.apply(this,arguments)}function le(){return le=(0,j.Z)(O().mark((function e(t,n,r,i){var a;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.request.signatureHelp(i,(0,V.s)(t.doc,n));case 2:if(!("error"in(a=e.sent))){e.next=5;break}throw new Error("Something went wrong fetching signature help results: ".concat(a.error.message));case 5:return e.abrupt("return",a.result);case 6:case"end":return e.stop()}}),e)}))),le.apply(this,arguments)}var ue=n(24920);function de(e){var t=e.lspClient,n=e.path;return H.tk.updateListener.of((function(e){var r;if(e.docChanged){var i=null===(r=t.getServerCapabilities())||void 0===r?void 0:r.textDocumentSync;if(i!==ue.TextDocumentSyncKind.None&&t.isOpen(n))if(i!==ue.TextDocumentSyncKind.Full)t.notify.didChange(n,function(e,t){var n=[],r=t;return e.iterChanges((function(e,t,i,a,o){var c=o.sliceString(0),s=t-e,l=s+i;n.push({range:{start:(0,V.s)(r,i),end:(0,V.s)(r,l)},rangeLength:s,text:c}),r=r.replace(i,l,o)})),n}(e.changes,e.startState.doc));else{var a=e.view.state.doc.toString();t.notify.didChange(n,[{text:a}])}}}))}var fe=n(28519);function pe(e){var t=e.lspClient,n=e.path;return H.lg.define((function(e){var r=t.onDiagnostics((function(t){if(t.path===n){var r=function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done);r=!0){var s=o.value,l=(0,V.R)(t.doc,s.range.start),u=(0,V.R)(t.doc,s.range.end);if(l===u){var d=t.wordAt(u);if(d)l=d.from,u=d.to;else{if(!(u<t.doc.length))continue;u+=1}}var f="info";switch(s.severity){case K.DiagnosticSeverity.Error:f="error";break;case K.DiagnosticSeverity.Warning:f="warning";break;case K.DiagnosticSeverity.Hint:case K.DiagnosticSeverity.Information:f="info"}n.push({from:l,to:u,severity:f,message:s.message,source:s.source})}}catch(p){i=!0,a=p}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n}(t.diagnostics,e.state);e.dispatch((0,fe.p0)(e.state,r))}}));return{destroy:function(){r()}}}))}var he,me,ve=n(14924),ge=n(1864),be=n(51438),xe=n(28668),Ze=n(99534),ye=n(25171),we=n(59119),ke=n(52951),Ee=n(45785),Se=n(82662),Ce=n(82670);!function(e){e[e.Dollar=0]="Dollar",e[e.Colon=1]="Colon",e[e.Comma=2]="Comma",e[e.CurlyOpen=3]="CurlyOpen",e[e.CurlyClose=4]="CurlyClose",e[e.Backslash=5]="Backslash",e[e.Forwardslash=6]="Forwardslash",e[e.Pipe=7]="Pipe",e[e.Int=8]="Int",e[e.VariableName=9]="VariableName",e[e.Format=10]="Format",e[e.Plus=11]="Plus",e[e.Dash=12]="Dash",e[e.QuestionMark=13]="QuestionMark",e[e.EOF=14]="EOF"}(he||(he={})),function(e){e[e.DollarSign=36]="DollarSign",e[e.Plus=43]="Plus",e[e.Comma=44]="Comma",e[e.Dash=45]="Dash",e[e.Slash=47]="Slash",e[e.Digit0=48]="Digit0",e[e.Digit9=57]="Digit9",e[e.Colon=58]="Colon",e[e.QuestionMark=63]="QuestionMark",e[e.A=65]="A",e[e.Z=90]="Z",e[e.Backslash=92]="Backslash",e[e.Underline=95]="Underline",e[e.a=97]="a",e[e.z=122]="z",e[e.OpenCurlyBrace=123]="OpenCurlyBrace",e[e.Pipe=124]="Pipe",e[e.CloseCurlyBrace=125]="CloseCurlyBrace"}(me||(me={}));var Te,Re=function(){function e(){(0,be.Z)(this,e),this.value="",this.pos=0}var t=e.prototype;return t.text=function(e){this.value=e,this.pos=0},t.tokenText=function(e){return this.value.substr(e.pos,e.len)},t.next=function(){if(this.pos>=this.value.length)return{type:14,pos:this.pos,len:0};var t,n=this.pos,r=0,i=this.value.charCodeAt(n);if("number"===typeof(t=e._table[i]))return this.pos+=1,{type:t,pos:n,len:1};if(e.isDigitCharacter(i)){t=8;do{r+=1,i=this.value.charCodeAt(n+r)}while(e.isDigitCharacter(i));return this.pos+=r,{type:t,pos:n,len:r}}if(e.isVariableCharacter(i)){t=9;do{i=this.value.charCodeAt(n+ ++r)}while(e.isVariableCharacter(i)||e.isDigitCharacter(i));return this.pos+=r,{type:t,pos:n,len:r}}t=10;do{r+=1,i=this.value.charCodeAt(n+r)}while(!isNaN(i)&&"undefined"===typeof e._table[i]&&!e.isDigitCharacter(i)&&!e.isVariableCharacter(i));return this.pos+=r,{type:t,pos:n,len:r}},e.isDigitCharacter=function(e){return e>=48&&e<=57},e.isVariableCharacter=function(e){return 95===e||e>=97&&e<=122||e>=65&&e<=90},e}();Re._table=(Te={},(0,ve.Z)(Te,36,0),(0,ve.Z)(Te,58,1),(0,ve.Z)(Te,44,2),(0,ve.Z)(Te,123,3),(0,ve.Z)(Te,125,4),(0,ve.Z)(Te,92,5),(0,ve.Z)(Te,47,6),(0,ve.Z)(Te,124,7),(0,ve.Z)(Te,43,11),(0,ve.Z)(Te,45,12),(0,ve.Z)(Te,63,13),Te);var _e=function(){function e(){var t;(0,be.Z)(this,e),this._children=[],t=this,["parent"].forEach((function(e){Object.defineProperty(t,e,{enumerable:!1,writable:!0})}))}var t=e.prototype;return t.appendChild=function(e){return(0,Ce.Z)(e,Ie)&&(0,Ce.Z)(this._children[this._children.length-1],Ie)?this._children[this._children.length-1].value+=e.value:(e.parent=this,this._children.push(e)),this},t.replace=function(e,t){var n,r=e.parent,i=r.children.indexOf(e),a=r.children.slice(0);(n=a).splice.apply(n,[i,1].concat((0,o.Z)(t))),r._children=a,function e(t,n){var r=!0,i=!1,a=void 0;try{for(var o,c=t[Symbol.iterator]();!(r=(o=c.next()).done);r=!0){var s=o.value;s.parent=n,e(s.children,s)}}catch(l){i=!0,a=l}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}}(t,r)},t.toString=function(){return this.children.reduce((function(e,t){return e+t.toString()}),"")},t.len=function(){return 0},t.match=function(e){var t=!0,n=!1,r=void 0;try{for(var a,o=Object.entries(Le)[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){var c=(0,i.Z)(a.value,2),s=c[0],l=c[1];if((0,Ce.Z)(this,l)&&s in e)return e[s](this)}}catch(u){n=!0,r=u}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}},(0,ke.Z)(e,[{key:"children",get:function(){return this._children}},{key:"snippet",get:function(){for(var e=this;;){if(!e)return;if((0,Ce.Z)(e,Oe))return e;e=e.parent}}}]),e}(),Ie=function(e){(0,xe.Z)(n,e);var t=(0,ye.Z)(n);function n(e){var r;return(0,be.Z)(this,n),(r=t.call(this)).value=e,r}var r=n.prototype;return r.toString=function(){return this.value},r.toTextmateString=function(){return n.escape(this.value)},r.len=function(){return this.value.length},r.clone=function(){return new n(this.value)},n.escape=function(e){return e.replace(/\$|}|\\/g,"\\$&")},n}(_e),Pe=function(e){(0,xe.Z)(n,e);var t=(0,ye.Z)(n);function n(){return(0,be.Z)(this,n),t.apply(this,arguments)}return n}(_e),De=function(e){(0,xe.Z)(n,e);var t=(0,ye.Z)(n);function n(e){var r;return(0,be.Z)(this,n),(r=t.call(this)).index=e,r}var r=n.prototype;return r.toTextmateString=function(){var e="";return this.transform&&(e=this.transform.toTextmateString()),0!==this.children.length||this.transform?0===this.children.length?"${".concat(this.index).concat(e,"}"):this.choice?"${".concat(this.index,"|").concat(this.choice.toTextmateString(),"|").concat(e,"}"):"${".concat(this.index,":").concat(this.children.map((function(e){return e.toTextmateString()})).join("")).concat(e,"}"):"$".concat(this.index)},r.clone=function(){var e=new n(this.index);return this.transform&&(e.transform=this.transform.clone()),e._children=this.children.map((function(e){return e.clone()})),e},n.compareByIndex=function(e,t){return e.index===t.index?0:e.isFinalTabstop?1:t.isFinalTabstop||e.index<t.index?-1:e.index>t.index?1:0},(0,ke.Z)(n,[{key:"isFinalTabstop",get:function(){return 0===this.index}},{key:"choice",get:function(){return 1===this._children.length&&(0,Ce.Z)(this._children[0],Ae)?this._children[0]:void 0}}]),n}(Pe),Ae=function(e){(0,xe.Z)(n,e);var t=(0,ye.Z)(n);function n(){var e;return(0,be.Z)(this,n),(e=t.apply(this,arguments)).options=[],e}var r=n.prototype;return r.appendChild=function(e){return(0,Ce.Z)(e,Ie)&&(e.parent=this,this.options.push(e)),this},r.toString=function(){return this.options[0].value},r.toTextmateString=function(){return this.options.map((function(e){return e.value.replace(/\||,/g,"\\$&")})).join(",")},r.len=function(){return this.options[0].len()},r.clone=function(){var e=new n;return this.options.forEach(e.appendChild,e),e},n}(_e),Ne=function(e){(0,xe.Z)(n,e);var t=(0,ye.Z)(n);function n(){var e;return(0,be.Z)(this,n),(e=t.apply(this,arguments)).regexp=new RegExp(""),e}var r=n.prototype;return r.resolve=function(e){var t=this,n=!1,r=e.replace(this.regexp,(function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return n=!0,t._replace(r.slice(0,-2))}));return!n&&this._children.some((function(e){return(0,Ce.Z)(e,Ue)&&Boolean(e.elseValue)}))&&(r=this._replace([])),r},r._replace=function(e){var t="",n=!0,r=!1,i=void 0;try{for(var a,o=this._children[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var c=a.value;if((0,Ce.Z)(c,Ue)){var s=e[c.index]||"";t+=s=c.resolve(s)}else t+=c.toString()}}catch(l){r=!0,i=l}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return t},r.toString=function(){return""},r.toTextmateString=function(){return"/".concat(this.regexp.source,"/").concat(this.children.map((function(e){return e.toTextmateString()})),"/").concat((this.regexp.ignoreCase?"i":"")+(this.regexp.global?"g":""))},r.clone=function(){var e=new n;return e.regexp=new RegExp(this.regexp.source,(this.regexp.ignoreCase?"i":"")+(this.regexp.global?"g":"")),e._children=this.children.map((function(e){return e.clone()})),e},n}(_e),Ue=function(e){(0,xe.Z)(n,e);var t=(0,ye.Z)(n);function n(e,r,i,a){var o;return(0,be.Z)(this,n),(o=t.call(this)).index=e,o.shorthandName=r,o.ifValue=i,o.elseValue=a,o}var r=n.prototype;return r.resolve=function(e){return"upcase"===this.shorthandName?e?e.toLocaleUpperCase():"":"downcase"===this.shorthandName?e?e.toLocaleLowerCase():"":"capitalize"===this.shorthandName?e?e[0].toLocaleUpperCase()+e.substr(1):"":"pascalcase"===this.shorthandName?e?this._toPascalCase(e):"":"camelcase"===this.shorthandName?e?this._toCamelCase(e):"":Boolean(e)&&"string"===typeof this.ifValue?this.ifValue:e||"string"!==typeof this.elseValue?e||"":this.elseValue},r._toPascalCase=function(e){var t=e.match(/[a-z0-9]+/gi);return t?t.map((function(e){return e.charAt(0).toUpperCase()+e.substr(1)})).join(""):e},r._toCamelCase=function(e){var t=e.match(/[a-z0-9]+/gi);return t?t.map((function(e,t){return 0===t?e.charAt(0).toLowerCase()+e.substr(1):e.charAt(0).toUpperCase()+e.substr(1)})).join(""):e},r.toTextmateString=function(){var e="${";return e+=this.index,this.shorthandName?e+=":/".concat(this.shorthandName):this.ifValue&&this.elseValue?e+=":?".concat(this.ifValue,":").concat(this.elseValue):this.ifValue?e+=":+".concat(this.ifValue):this.elseValue&&(e+=":-".concat(this.elseValue)),e+="}"},r.clone=function(){return new n(this.index,this.shorthandName,this.ifValue,this.elseValue)},n}(_e),je=function(e){(0,xe.Z)(n,e);var t=(0,ye.Z)(n);function n(e){var r;return(0,be.Z)(this,n),(r=t.call(this)).name=e,r}var r=n.prototype;return r.resolve=function(e){var t=e.resolve(this);return this.transform&&(t=this.transform.resolve(t||"")),void 0!==t&&(this._children=[new Ie(t)],!0)},r.toTextmateString=function(){var e="";return this.transform&&(e=this.transform.toTextmateString()),0===this.children.length?"${".concat(this.name).concat(e,"}"):"${".concat(this.name,":").concat(this.children.map((function(e){return e.toTextmateString()})).join("")).concat(e,"}")},r.clone=function(){var e=new n(this.name);return this.transform&&(e.transform=this.transform.clone()),e._children=this.children.map((function(e){return e.clone()})),e},n}(Pe);function Be(e,t){for(var n=(0,o.Z)(e);n.length>0;){var r,i=n.shift();if(!t(i))break;(r=n).unshift.apply(r,(0,o.Z)(i.children))}}var Oe=function(e){(0,xe.Z)(n,e);var t=(0,ye.Z)(n);function n(){return(0,be.Z)(this,n),t.apply(this,arguments)}var r=n.prototype;return r.offset=function(e){var t=0,n=!1;return this.walk((function(r){return r===e?(n=!0,!1):(t+=r.len(),!0)})),n?t:-1},r.fullLen=function(e){var t=0;return Be([e],(function(e){return t+=e.len(),!0})),t},r.enclosingPlaceholders=function(e){for(var t=[],n=e.parent;n;)(0,Ce.Z)(n,De)&&t.push(n),n=n.parent;return t},r.resolveVariables=function(e){var t=this;return this.walk((function(n){return(0,Ce.Z)(n,je)&&n.resolve(e)&&delete t._placeholders,!0})),this},r.appendChild=function(e){return delete this._placeholders,(0,Ee.Z)((0,Se.Z)(n.prototype),"appendChild",this).call(this,e)},r.replace=function(e,t){return delete this._placeholders,(0,Ee.Z)((0,Se.Z)(n.prototype),"replace",this).call(this,e,t)},r.toTextmateString=function(){return this.children.reduce((function(e,t){return e+t.toTextmateString()}),"")},r.clone=function(){var e=new n;return this._children=this.children.map((function(e){return e.clone()})),e},r.walk=function(e){Be(this.children,e)},(0,ke.Z)(n,[{key:"placeholderInfo",get:function(){if(!this._placeholders){var e,t=[];this.walk((function(n){return(0,Ce.Z)(n,De)&&(t.push(n),e=!e||e.index<n.index?n:e),!0})),this._placeholders={all:t,last:e}}return this._placeholders}},{key:"placeholders",get:function(){return this.placeholderInfo.all}}]),n}(_e),Ge=function(){function e(){(0,be.Z)(this,e),this._scanner=new Re,this._token={type:14,pos:0,len:0}}var t=e.prototype;return t.text=function(e){return this.parse(e).toString()},t.parse=function(e,t,n){this._scanner.text(e),this._token=this._scanner.next();for(var r=new Oe;this._parse(r););var i=new Map,a=[],o=0;r.walk((function(e){return(0,Ce.Z)(e,De)&&(o+=1,e.isFinalTabstop?i.set(0,void 0):!i.has(e.index)&&e.children.length>0?i.set(e.index,e.children):a.push(e)),!0}));var c=!0,s=!1,l=void 0;try{for(var u,d=a[Symbol.iterator]();!(c=(u=d.next()).done);c=!0){var f=u.value,p=i.get(f.index);if(p){var h=new De(f.index);h.transform=f.transform;var m=!0,v=!1,g=void 0;try{for(var b,x=p[Symbol.iterator]();!(m=(b=x.next()).done);m=!0){var Z=b.value;h.appendChild(Z.clone())}}catch(y){v=!0,g=y}finally{try{m||null==x.return||x.return()}finally{if(v)throw g}}r.replace(f,[h])}}}catch(y){s=!0,l=y}finally{try{c||null==d.return||d.return()}finally{if(s)throw l}}return n||(n=o>0&&t),!i.has(0)&&n&&r.appendChild(new De(0)),r},t._accept=function(e,t){if(void 0===e||this._token.type===e){var n=!t||this._scanner.tokenText(this._token);return this._token=this._scanner.next(),n}return!1},t._backTo=function(e){return this._scanner.pos=e.pos+e.len,this._token=e,!1},t._until=function(e){for(var t=this._token;this._token.type!==e;){if(14===this._token.type)return!1;if(5===this._token.type){var n=this._scanner.next();if(0!==n.type&&4!==n.type&&5!==n.type)return!1}this._token=this._scanner.next()}var r=this._scanner.value.substring(t.pos,this._token.pos).replace(/\\(\$|}|\\)/g,"$1");return this._token=this._scanner.next(),r},t._parse=function(e){return this._parseEscaped(e)||this._parseTabstopOrVariableName(e)||this._parseComplexPlaceholder(e)||this._parseComplexVariable(e)||this._parseAnything(e)},t._parseEscaped=function(e){var t;return!!(t=this._accept(5,!0))&&(t=this._accept(0,!0)||this._accept(4,!0)||this._accept(5,!0)||t,e.appendChild(new Ie(t)),!0)},t._parseTabstopOrVariableName=function(e){var t,n=this._token;return this._accept(0)&&(t=this._accept(9,!0)||this._accept(8,!0))?(e.appendChild(/^\d+$/.test(t)?new De(Number(t)):new je(t)),!0):this._backTo(n)},t._parseComplexPlaceholder=function(e){var t,n=this._token;if(!(this._accept(0)&&this._accept(3)&&(t=this._accept(8,!0))))return this._backTo(n);var r=new De(Number(t));if(this._accept(1))for(;;){if(this._accept(4))return e.appendChild(r),!0;if(!this._parse(r))return e.appendChild(new Ie("${"+t+":")),r.children.forEach(e.appendChild,e),!0}else{if(!(r.index>0&&this._accept(7)))return this._accept(6)?this._parseTransform(r)?(e.appendChild(r),!0):(this._backTo(n),!1):this._accept(4)?(e.appendChild(r),!0):this._backTo(n);for(var i=new Ae;;){if(this._parseChoiceElement(i)){if(this._accept(2))continue;if(this._accept(7)&&(r.appendChild(i),this._accept(4)))return e.appendChild(r),!0}return this._backTo(n),!1}}},t._parseChoiceElement=function(e){for(var t=this._token,n=[];2!==this._token.type&&7!==this._token.type;){var r=void 0;if(!(r=(r=this._accept(5,!0))?this._accept(2,!0)||this._accept(7,!0)||this._accept(5,!0)||r:this._accept(void 0,!0)))return this._backTo(t),!1;n.push(r)}return 0===n.length?(this._backTo(t),!1):(e.appendChild(new Ie(n.join(""))),!0)},t._parseComplexVariable=function(e){var t,n=this._token;if(!(this._accept(0)&&this._accept(3)&&(t=this._accept(9,!0))))return this._backTo(n);var r=new je(t);if(!this._accept(1))return this._accept(6)?this._parseTransform(r)?(e.appendChild(r),!0):(this._backTo(n),!1):this._accept(4)?(e.appendChild(r),!0):this._backTo(n);for(;;){if(this._accept(4))return e.appendChild(r),!0;if(!this._parse(r))return e.appendChild(new Ie("${"+t+":")),r.children.forEach(e.appendChild,e),!0}},t._parseTransform=function(e){for(var t=new Ne,n="",r="";!this._accept(6);){var i=void 0;if(i=this._accept(5,!0))n+=i=this._accept(6,!0)||i;else{if(14===this._token.type)return!1;n+=this._accept(void 0,!0)}}for(;!this._accept(6);){var a=void 0;if(a=this._accept(5,!0))a=this._accept(5,!0)||this._accept(6,!0)||a,t.appendChild(new Ie(a));else if(!this._parseFormatString(t)&&!this._parseAnything(t))return!1}for(;!this._accept(4);){if(14===this._token.type)return!1;r+=this._accept(void 0,!0)}try{t.regexp=new RegExp(n,r)}catch(o){return!1}return e.transform=t,!0},t._parseFormatString=function(e){var t=this._token;if(!this._accept(0))return!1;var n=!1;this._accept(3)&&(n=!0);var r=this._accept(8,!0);if(!r)return this._backTo(t),!1;if(!n)return e.appendChild(new Ue(Number(r))),!0;if(this._accept(4))return e.appendChild(new Ue(Number(r))),!0;if(!this._accept(1))return this._backTo(t),!1;if(this._accept(6)){var i=this._accept(9,!0);return i&&this._accept(4)?(e.appendChild(new Ue(Number(r),i)),!0):(this._backTo(t),!1)}if(this._accept(11)){var a=this._until(4);if(a)return e.appendChild(new Ue(Number(r),void 0,a,void 0)),!0}else if(this._accept(12)){var o=this._until(4);if(o)return e.appendChild(new Ue(Number(r),void 0,void 0,o)),!0}else if(this._accept(13)){var c=this._until(1);if(c){var s=this._until(4);if(s)return e.appendChild(new Ue(Number(r),void 0,c,s)),!0}}else{var l=this._until(4);if(l)return e.appendChild(new Ue(Number(r),void 0,void 0,l)),!0}return this._backTo(t),!1},t._parseAnything=function(e){return 14!==this._token.type&&(e.appendChild(new Ie(this._scanner.tokenText(this._token))),this._accept(void 0),!0)},e.escape=function(e){return e.replace(/\$|}|\\/g,"\\$&")},e.guessNeedsClipboard=function(e){return/\${?CLIPBOARD/.test(e)},e}(),Le={Text:Ie,Placeholder:De,Variable:je,FormatString:Ue,Choice:Ae};function Me(e,t){var n=t.mapPos(e.from,-1,X.gc.TrackDel),r=t.mapPos(e.to,1,X.gc.TrackDel);return null==n||null==r?null:{field:e.field,from:n,to:r}}var ze=function(){function e(t){(0,be.Z)(this,e),this.lines=t.split(/\r\n?|\n/).map((function(e){return(new Ge).parse(e).children}))}return e.prototype.apply=function(t){var n=t.view,r=t.from,i=t.to,a=e.instantiate(this.lines,t),o=a.text,c=a.ranges,s={from:r,to:i,insert:X.xv.of(o)},l={changes:s,scrollIntoView:!0};if(c.length&&(l.selection=qe(c,0)),c.length>1){var u=new We(c,0),d=l.effects=[He.of(u)];void 0===n.state.field($e,!1)&&d.push(X.Py.appendConfig.of([$e,Ke,Ye]))}if(r===i&&!c.length){var f=X.as.of(s,n.state.doc.length),p=n.state.selection.ranges.map((function(e){return e.map(f,0)}));l.selection=X.jT.create(p,n.state.selection.mainIndex)}return l},e.resolveVariable=function(e,t){var n=t.view,r=t.from,i=t.path;switch(e){case"TM_FILENAME":return(0,ge.basename)(i);case"TM_FILENAME_BASE":return(0,ge.basename)(i,(0,ge.extname)(i));case"TM_DIRECTORY":return(0,ge.dirname)(i);case"TM_FILEPATH":return i;case"TM_LINE_INDEX":return(n.state.doc.lineAt(r).number-1).toString();case"TM_LINE_NUMBER":return n.state.doc.lineAt(r).number.toString();default:return e}},e.instantiate=function(t,n){var i,a=n.view,c=n.from,s=a.state,l=[],u=[],d=s.doc.lineAt(c),f=/^\s*/.exec(d.text)[0],p=s.facet(we.c),h=!0,m=!1,v=void 0;try{for(var g,b=function(){var t=g.value,r=0,i="",a=function(e){var t=0,n=r;if(0===r&&(t=/^\t*/.exec(e)[0].length)){var a=f+p.repeat(t);e=a+e.slice(t),n+=a.length}return i+=e,r+=e.length,{line:l.length,from:n,to:r}},o=function(t){var i=!0,s=!1,d=void 0;try{for(var f,p=t[Symbol.iterator]();!(i=(f=p.next()).done);i=!0){f.value.match({Text:function(e){a(e.value)},Variable:function(t){var r=t.name,i=t.transform,o=e.resolveVariable(r,n);i&&(o=o.replace(i.regexp,(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.children.map((function(e){return e.match({Text:function(e){return e.value},FormatString:function(e){return e.resolve(t[e.index])}})})).filter(Boolean).join("")}))),a(o)},Choice:function(e){a(e.options[0].value)},Placeholder:function(e){var t,n=l.length?c+l.map((function(e){return e.length})).reduce((function(e,t){return e+t})):c;if(null===(t=e.children)||void 0===t?void 0:t.length){var i={field:e.index,from:n+r,to:null};u.push(i),o(e.children),i.to=n+r}else{a("");var s=n+r;u.push({field:e.index,from:s,to:s})}}})}}catch(h){s=!0,d=h}finally{try{i||null==p.return||p.return()}finally{if(s)throw d}}};o(t),l.push(i)},x=t[Symbol.iterator]();!(h=(g=x.next()).done);h=!0)b()}catch(y){m=!0,v=y}finally{try{h||null==x.return||x.return()}finally{if(m)throw v}}var Z=(i=Math).max.apply(i,(0,o.Z)(u.map((function(e){return e.field}))));return{text:l,ranges:u.map((function(e){var t=e.field,n=(0,Ze.Z)(e,["field"]);return(0,D.Z)((0,r.Z)({},n),{field:0===t?Z:t-1})}))}},e}(),Fe=H.p.widget({widget:new(function(e){(0,xe.Z)(n,e);var t=(0,ye.Z)(n);function n(){return(0,be.Z)(this,n),t.apply(this,arguments)}var r=n.prototype;return r.toDOM=function(){var e=document.createElement("span");return e.className="cm-snippetFieldPosition",e},r.ignoreEvent=function(){return!1},n}(H.l9))}),Xe=H.p.mark({class:"cm-snippetField"}),We=function(){function e(t,n){(0,be.Z)(this,e),this.ranges=t,this.active=n,this.deco=H.p.set(t.map((function(e){return(e.from===e.to?Fe:Xe).range(e.from,e.to)})))}var t=e.prototype;return t.map=function(t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,c=this.ranges[Symbol.iterator]();!(r=(o=c.next()).done);r=!0){var s=Me(o.value,t);if(!s)return null;n.push(s)}}catch(l){i=!0,a=l}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return new e(n,this.active)},t.isSelectionInsideField=function(e){var t=this;return e.ranges.every((function(e){return t.ranges.some((function(n){return n.field===t.active&&n.from<=e.from&&n.to>=e.to}))}))},e}(),He=X.Py.define({map:function(e,t){return null===e||void 0===e?void 0:e.map(t)}}),Ve=X.Py.define(),$e=X.QQ.define({create:function(){return null},update:function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,o=t.effects[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var c=a.value;if(c.is(He))return c.value;if(c.is(Ve)&&e)return new We(e.ranges,c.value)}}catch(s){r=!0,i=s}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return e&&t.docChanged&&(e=e.map(t.changes)),e&&t.selection&&!e.isSelectionInsideField(t.selection)&&(e=null),e},provide:function(e){return H.tk.decorations.from(e,(function(e){return e?e.deco:H.p.none}))}});function qe(e,t){return X.jT.create(e.filter((function(e){return e.field===t})).map((function(e){return X.jT.range(e.from,e.to)})))}function Qe(e){return function(t){var n,r=t.state,i=t.dispatch,a=r.field($e,!1);if(!a||e<0&&0===a.active)return!1;var c=a.active+e,s=(n=Math).max.apply(n,(0,o.Z)(a.ranges.map((function(e){return e.field})))),l=e>0&&a.active>=s;return i(r.update({selection:qe(a.ranges,c),effects:He.of(l?null:new We(a.ranges,c))})),!0}}var Ke=X.Wl.highest(H.$f.of([{key:"Tab",run:Qe(1),shift:Qe(-1)},{key:"Escape",run:function(e){var t=e.state,n=e.dispatch;return!!t.field($e,!1)&&(n(t.update({effects:He.of(null)})),!0)}}])),Ye=H.tk.domEventHandlers({mousedown:function(e,t){var n,r=t.state.field($e,!1);if(!r||null==(n=t.posAtCoords({x:e.clientX,y:e.clientY})))return!1;var i=r.ranges.find((function(e){return e.from<=n&&e.to>=n}));return!(!i||i.field===r.active)&&(t.dispatch({selection:qe(r.ranges,i.field),effects:He.of(r.ranges.some((function(e){return e.field>i.field}))?new We(r.ranges,i.field):null)}),!0)}});function Je(e){var t=Object.keys(e).join(""),n=/\w/.test(t);return n&&(t=t.replace(/\w/g,"")),"[".concat(n?"\\w":"").concat(t.replace(/[^\w\s]/g,"\\$&"),"]")}function et(e,t){var n=e.state,r=e.pos;if(e.explicit)return{triggerKind:ue.CompletionTriggerKind.Invoked};var i=n.doc.lineAt(r),a=i.text[r-i.from-1],o=i.text.substring(0,r-i.from);if(null===t||void 0===t?void 0:t.includes(a)){var c=a;return{triggerKind:ue.CompletionTriggerKind.TriggerCharacter,triggerCharacter:c}}return o.match(/\w$/)?{triggerKind:ue.CompletionTriggerKind.Invoked}:null}var tt=Object.entries(K.CompletionItemKind).reduce((function(e,t){var n=(0,i.Z)(t,2),a=n[0],o=n[1];return(0,r.Z)((0,ve.Z)({},o,a.toLowerCase()),e)}),{});function nt(e,t){var n=(0,V.R)(e.state.doc,t.range.start),r=(0,V.R)(e.state.doc,t.range.end);if(null!==n&&null!==r)return{from:n,to:r,insert:t.newText}}function rt(e){var t=e.context,n=e.items,c=e.client,s=e.path,l=e.setDecoration,u=n.filter((function(e){return Boolean(e.label)})).map((function(e){var t,n=e.additionalTextEdits,u={label:e.label,detail:e.detail,apply:function(t,a,c,l){if(e.insertTextFormat!==K.InsertTextFormat.Snippet){var u=function(e){var t,n=e.view,a=e.item,o=e.from,c=e.to,s=n.state,l=s.doc,u=s.selection,d=[];if(a.textEdit){var f=a.textEdit,p=f.range,h=f.newText,m=(0,V.R)(l,p.start),v=(0,V.R)(l,p.end);if(null===m||null===v)return;d.push({from:m,insert:h,to:Math.max(v,u.main.to)})}else{var g=a.insertText||a.label;d.push({from:o,to:c,insert:g})}var b=(0,i.Z)(d,1)[0],x="";null===(t=a.additionalTextEdits)||void 0===t||t.forEach((function(e){var t=nt(n,e);t&&("from"in b&&t.from===b.from&&(x=t.insert),d.push(t))}));var Z=c-o;u.ranges.forEach((function(e){if(e!==u.main){if(!("insert"in b)||!b.insert)throw new Error("Expected insert in mainChange");var t=e.from-Z,n=x+b.insert;d.push({from:t,to:e.to,insert:n})}}));var y=d.map((function(e){return"from"in e&&"undefined"!==typeof e.to?(0,D.Z)((0,r.Z)({},e),{from:Math.min(e.from,e.to),to:Math.max(e.from,e.to)}):e})),w=X.as.of(y,l.length),k=u.ranges.map((function(e){return e.map(w,0)}));return{changes:w,selection:X.jT.create(k,u.mainIndex)}}({view:t,item:(0,D.Z)((0,r.Z)({},e),{additionalTextEdits:n}),to:l,from:c});u&&t.dispatch({changes:u.changes,selection:u.selection,annotations:W.Jv.of(a)})}else{var d,f,p,h,m=[];n&&m.push({changes:n.map((function(e){return nt(t,e)}))});var v=null!==(h=null!==(p=null===(f=e.textEdit)||void 0===f?void 0:f.newText)&&void 0!==p?p:e.insertText)&&void 0!==h?h:e.label,g=new ze(v);e.textEdit&&"range"in e.textEdit&&(c=(0,V.R)(t.state.doc,e.textEdit.range.start),l=Math.max(l,(0,V.R)(t.state.doc,e.textEdit.range.end)));var b=g.apply({view:t,from:c,to:l,path:s});(d=t).dispatch.apply(d,(0,o.Z)(m).concat([b]))}},type:e.kind&&tt[e.kind],filterText:(null!==(t=e.filterText)&&void 0!==t?t:e.label).toLowerCase(),sortText:e.sortText||e.label},d=(0,M.Z)(c).isCompletionItemResolveSupported;return c&&d?u.info=(0,j.Z)(O().mark((function t(){var r,i,o,u,d,f;return O().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.request.resolveCompletionItem(e);case 2:if(r=t.sent,i="cancelled"in r&&r.cancelled,o="result"in r?r.result:null,!i&&o){t.next=7;break}return t.abrupt("return",null);case 7:if(o.additionalTextEdits&&(n=o.additionalTextEdits),u=[],o.detail&&o.detail!==e.detail&&o.detail!==e.label&&(d="```"+(0,ge.extname)(s).slice(1)+"\n"+o.detail+"\n```",u.push((0,a.tZ)(te,{content:{value:d,kind:"markdown"}}))),o.documentation&&u.push((0,a.tZ)(te,{content:o.documentation})),0!==u.length){t.next=13;break}return t.abrupt("return",null);case 13:return f=document.createElement("div"),l(A.createPortal((0,a.tZ)(a.HY,{children:u}),f)),t.abrupt("return",f);case 16:case"end":return t.stop()}}),t)}))):e.documentation&&(u.info=function(){if(!e.documentation)return null;var t=document.createElement("div");return l(A.createPortal((0,a.tZ)(te,{content:e.documentation}),t)),t}),u})),d=(0,i.Z)(function(e){var t=Object.create(null),n=Object.create(null),r=!0,i=!1,a=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done);r=!0){var s=o.value.label;t[s[0]]=!0;for(var l=1;l<s.length;l++)n[s[l]]=!0}}catch(d){i=!0,a=d}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}var u=Je(t)+Je(n)+"*$";return[new RegExp("^"+u),new RegExp(u)]}(u),2),f=d[0],p=d[1],h=t.matchBefore(p),m=t.pos;if(h){m=h.from;var v=h.text.toLowerCase();/^\w+$/.test(v)&&(u=u.filter((function(e){return e.filterText.startsWith(v)})).sort((function(e,t){var n=e.sortText,r=t.sortText;return n.startsWith(h.text)&&!r.startsWith(h.text)?-1:!n.startsWith(h.text)&&r.startsWith(h.text)?1:0})))}return{from:m,options:u,validFor:f}}var it=n(68122),at=n(45826);function ot(e){var t=e.content,n=e.className,i=e.showHoveredVariable;if("string"!==typeof t&&"kind"in t)return(0,a.tZ)(te,{content:t});var o=(Array.isArray(t)?t:[t]).map((function(e){return"string"===typeof e?e:"```"+e.language+"\n"+e.value+"\n```"})).join("\n");return(0,a.tZ)(Q.ZP,{css:i?[p.l0.maxHeight(st),p.l0.overflowY("auto")]:void 0,className:n,components:{code:function(e){return(0,a.tZ)(Y.Z,(0,r.Z)({minimal:!0,disableCopy:!0},e))}},children:o})}function ct(e){var t=e.dom,n=(0,Ze.Z)(e,["dom"]);return A.createPortal((0,a.tZ)(lt,(0,r.Z)({},n)),t)}var st=100;function lt(e){var t=e.className,n=e.content,o=e.textHovered,c=(0,S.c)("flag-debugger-hover-variable"),s=c.enabled,u=(c.loading,(0,U.Z)().debuggest),d=(0,it.Z)(u.mainClient),h=d&&("running"===d.state.current||"paused"===d.state.current),m=(0,i.Z)(l.useState(!1),2),v=m[0],g=m[1],b=(0,i.Z)(l.useState(void 0),2),x=b[0],Z=b[1],y=s&&h&&x;return l.useEffect((function(){function e(){return e=(0,j.Z)(O().mark((function e(){var t,n,i;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!s||!h){e.next=11;break}return g(!0),e.prev=2,e.next=6,d.evaluate({expression:o,context:"hover"});case 6:n=e.sent,(null===(t=n.body)||void 0===t?void 0:t.result)&&(i=(0,r.Z)({name:o,value:n.body.result},n.body),Z(i));case 8:return e.prev=8,g(!1),e.finish(8);case 11:case"end":return e.stop()}}),e,null,[[2,,8,11]])}))),e.apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[s,d,h,o]),(0,a.BX)(f.ZP,{css:[J,y?p.l0.maxHeight(st+190):p.l0.maxHeight(190),p.l0.minHeight(30),p.l0.overflowY("auto"),p.l0.borderRadius(4),p.l0.backgroundColor.backgroundDefault],children:[v?void 0:(0,a.tZ)(ot,{content:n,className:t,showHoveredVariable:Boolean(y)}),y?(0,a.tZ)(f.ZP,{css:[p.l0.maxHeight(190),p.l0.overflowY("auto")],children:(0,a.tZ)(at._,{depth:0,client:d,variable:x})}):void 0]})}function ut(e){var t,n,r=e.hover,i=e.state,o=e.offset,c=e.languageId,s=e.setDecoration;if((Array.isArray(r.contents)||"string"===typeof r.contents)&&0===r.contents.length)return s(null),null;c.endsWith("css")&&Array.isArray(r.contents)&&(r.contents={kind:"markdown",value:"```html \n".concat(r.contents[0],"\n```\n").concat(r.contents[1],"\n      ")});var l="",u=i.doc;if(r.range)t=(0,V.R)(u,r.range.start),n=(0,V.R)(u,r.range.end),l=u.sliceString(t,n);else if(n=void 0,(t=o)<=i.doc.length){var d=i.wordAt(t);d?(l=u.sliceString(d.from,d.to),t=Math.min(t,d.from),n=d.to):l=u.sliceString(t,t+1)}return{pos:t,end:n,create:function(){var e=document.createElement("div");return e.classList.add("hover-tooltip"),e.style.padding="0",s((0,a.tZ)(ct,{dom:e,content:r.contents,textHovered:l})),{dom:e,mount:function(e){var t;t=function(){(0,H.E2)(e)},[0,50,200,1e3].forEach((function(e){return setTimeout(t,e)}))}}},above:!0}}var dt,ft=n(6951),pt=n(67629),ht=n(98284),mt=n(58142),vt=n(1144),gt=n(17556),bt=n(77365);function xt(e){var t=e.dom,n=(0,Ze.Z)(e,["dom"]);return A.createPortal((0,a.tZ)(yt,(0,r.Z)({},n)),t)}function Zt(e){var t=e.matchesMap,n=e.fileToContents,r=e.type,o=e.onClose,c=Object.keys(t),s=(0,U.Z)().session;if(0===c.length){var l=r===dt.REFERENCES?"No references found":"No definitions found";return(0,a.tZ)(vt.x,{color:"dimmer",css:[p.l0.pl(4),p.l0.py(8)],children:l})}return(0,a.tZ)(f.ZP,{children:c.map((function(e){var r=t[e],l=n[e],u=(0,mt.Z)(r,l);return(0,a.tZ)(f.ZP,{css:[p.l0.p(4)],children:(0,a.tZ)(ht.Vw,{path:e,extensions:[u],doc:l,numMatches:r.length,initiallyExpanded:1===c.length,onNavigateToCode:function(t){if(null!==t)s.updateDeeplink({path:e,line:t.line+1,col:t.character});else{var n=(0,i.Z)(r,1)[0],a=l.lineAt(n.from),c=n.from-a.from;s.updateDeeplink({path:e,line:a.number,col:c})}o()}})},e)}))})}function yt(e){var t=e.files,n=e.onClose,c=e.references,s=e.definitions,u=e.currentFile,d=e.currentFileContents,h=function(e,t){if(!v)throw new Error("Expected LSP Client");var n=v.documentUriToPath(e.uri),r=e.range,i=r.start,a=r.end;n in t||(t[n]=[]);var o=x[n],c=o.line(i.line+1),s=o.line(a.line+1);t[n].push({from:c.from+i.character,to:s.from+a.character})},m=(0,U.Z)().fs,v=(0,L.Z)(u),g=(0,gt.Z)(n,[]),b=(0,i.Z)(l.useState((0,ve.Z)({},u,X.xv.of(d.split("\n")))),2),x=b[0],Z=b[1];l.useEffect((function(){if(t.length){var e=!1;return function(){n.apply(this,arguments)}(),function(){e=!0}}function n(){return n=(0,j.Z)(O().mark((function n(){var i;return O().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i={},n.next=3,Promise.all(t.map(function(){var e=(0,j.Z)(O().mark((function e(t){var n;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.readFile(t);case 2:if(!(n=e.sent).error){e.next=5;break}throw new Error("Something went wrong reading file with path ".concat(t,". Received error: ").concat(n.error));case 5:i[t]=X.xv.of(n.content.toString().split("\n"));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:if(!e){n.next=5;break}return n.abrupt("return");case 5:Z((function(e){return(0,r.Z)({},e,i)}));case 6:case"end":return n.stop()}}),n)}))),n.apply(this,arguments)}}),[m,t]);var y=(0,o.Z)(c).concat((0,o.Z)(s));if(!v||y.some((function(e){return!(v.documentUriToPath(e.uri)in x)})))return(0,a.tZ)(f.ZP,{style:{width:p.TV.space128,height:p.TV.space128,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,a.tZ)(bt.Z,{size:32})});var w={},k={};return c.forEach((function(e){h(e,w)})),s.forEach((function(e){h(e,k)})),(0,a.BX)(f.ZP,{innerRef:g,css:[p.l0.minWidth("375px"),p.l0.maxWidth("500px"),p.l0.pt(4)],children:[(0,a.tZ)(f.ZP,{css:{borderBottom:"1px solid var(--background-highest)"},children:(0,a.BX)(f.ZP,{css:[p.l0.p(4)],children:[(0,a.BX)(f.ZP,{css:[p.l0.flex.row,p.l0.justify.spaceBetween,p.l0.align.center,p.l0.pr(4)],children:[(0,a.tZ)(vt.h,{level:2,variant:"subheadDefault",css:[p.l0.p(4),p.l0.pl(8)],children:"Definitions"}),(0,a.tZ)(ft.Z,{filled:!1,border:!1,onClick:n,children:(0,a.tZ)(pt.Z,{})})]}),(0,a.tZ)(Zt,{matchesMap:k,fileToContents:x,type:dt.DEFINITION,onClose:n})]})}),(0,a.tZ)(f.ZP,{children:(0,a.BX)(f.ZP,{css:[p.l0.p(4)],children:[(0,a.tZ)(vt.h,{level:2,variant:"subheadDefault",css:[p.l0.p(4),p.l0.pl(8)],children:"References"}),(0,a.tZ)(Zt,{matchesMap:w,fileToContents:x,type:dt.REFERENCES,onClose:n})]})})]})}!function(e){e.DEFINITION="DEFINITION",e.REFERENCES="REFERENCES"}(dt||(dt={}));var wt=X.Py.define();var kt=n(27206),Et=n(30992),St=n(61756),Ct=n(29163),Tt=n(88075);function Rt(e){var t=e.dom,n=(0,Ze.Z)(e,["dom"]);return A.createPortal((0,a.tZ)(_t,(0,r.Z)({},n)),t)}function _t(e){var t=e.onRename,n=e.closeInput,r=e.variable,i=(0,gt.Z)(n,[]),o=l.useRef(null),c=(0,Et.Y)(r,(function(e){return e?e===r?{message:"Must pick a new name"}:void 0:{message:"New name can't be empty"}}));return l.useEffect((function(){var e=function(e){"Escape"===e.key&&n()};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}),[n]),l.useEffect((function(){setTimeout((function(){o.current&&o.current.focus()}))}),[c]),(0,a.tZ)(f.ZP,{innerRef:i,css:[p.l0.backgroundColor.backgroundDefault,p.l0.flex.column,p.l0.justify.center,p.l0.borderRadius(4),p.l0.shadow(2),p.l0.width(200)],children:(0,a.tZ)("form",{onSubmit:function(e){e.preventDefault(),c.error||(n(),t(c.value))},children:(0,a.BX)(f.ZP,{css:[p.l0.justify.center],children:[(0,a.BX)(f.ZP,{css:[p.l0.flex.row,p.l0.align.center,p.l0.pr(4)],children:[(0,a.tZ)(vt.h,{level:2,variant:"subheadDefault",css:[p.l0.p(4),p.l0.pl(8)],children:"Rename"}),(0,a.tZ)(vt.h,{level:2,variant:"subheadDefault",color:"dimmer",css:[p.l0.maxWidth(100),p.l0.overflow("hidden"),{whiteSpace:"nowrap",textOverflow:"ellipsis"}],children:r}),(0,a.tZ)(Ct.Z,{alt:"Close rename input",tooltipHidden:!0,onClick:n,css:[p.l0.position.absolute,p.l0.top(4),p.l0.right(4)],children:(0,a.tZ)(pt.Z,{})})]}),(0,a.tZ)(f.ZP,{css:[p.l0.justify.center,p.l0.align.center,p.l0.p(8),p.l0.pt(4)],children:(0,a.tZ)(kt.ZP,{name:"rename",ref:o,onBlur:c.handleBlur,onChange:function(e){return c.setValue(e.target.value)},value:c.value,placeholder:"New name",autoFocus:!0,autoCorrect:"off",autoCapitalize:"off",autoComplete:"off",validationResults:c.error?[{message:c.error.message,state:"error"}]:void 0,style:{padding:p.TV.space4,borderRadius:p.TV.borderRadius4}})}),(0,a.tZ)(f.ZP,{css:[p.l0.flex.rowReverse,p.l0.p(8),p.l0.pt(0)],children:(0,a.tZ)(St.ZP,{type:"submit",text:"Rename",colorway:"primary",iconLeft:(0,a.tZ)(Tt.Z,{}),disabled:Boolean(c.error)||!c.value})})]})})})}var It=X.Py.define();var Pt=n(37053),Dt=n(82378),At=n(70917),Nt=n(8941),Ut=n(86292),jt=n(37552);function Bt(e,t,n){var r=n.find((function(n){var r=n.range;return(0,V.R)(e,r.end)>=t&&(0,V.R)(e,r.start)<=t}));return null==r?[]:r.children?[r].concat(Bt(e,t,r.children)):[r]}var Ot=n(58e3);function Gt(e){var t=e.currentSymbol,n=e.value;return(0,a.BX)(q.G7,{css:q.l0.rowWithGap(2),children:[(0,a.tZ)(Ot.u,{kind:n.kind}),(0,a.tZ)(q.xv,{css:[q.l0.fontSize(14),q.l0.maxWidth(175),n===t&&{fontWeight:q.TV.fontWeightMedium}],children:n.name})]})}var Lt=(0,At.iv)([q.l0.rowWithGap(2),q.l0.align.center]),Mt=[q.l0.backgroundColor.backgroundDefault,q.l0.height(20),q.l0.p(2),{span:[q.l0.mr(0),q.l0.maxWidth(175)],svg:q.l0.mr(4)}],zt=[q.l0.color.foregroundDefault,q.l0.maxHeight("40vh"),q.l0.overflowY("auto"),{"&::-webkit-scrollbar":{width:0},scrollbarWidth:"none"}];function Ft(e){var t,n;return(null!==(n=null===e||void 0===e||null===(t=e.children)||void 0===t?void 0:t.length)&&void 0!==n?n:0)>0}function Xt(e){return e.sort((function(e,t){return e.range.start.line-t.range.start.line||e.range.start.character-t.range.start.character}))}function Wt(){(0,Ut.j)(Ut.U3.CODE_NAVIGATION_USED,{action:"opened"})}function Ht(e){var t=e.values,n=void 0===t?[]:t,r=e.symbol,i=e.getKey,o=e.onClick,c=l.useMemo((function(){return Xt(n)}),[n]);return(0,a.tZ)(q.ZE,{cssProps:[Mt,!c.length&&{pointerEvents:"none"}],icon:(0,a.tZ)(Ot.u,{kind:r.kind}),label:r.name,onAction:o,menuCssProps:zt,onOpen:Wt,items:c,children:function(e){return(0,a.tZ)(jt.ck,{textValue:e.name,children:(0,a.tZ)(Gt,{currentSymbol:r,value:e})},i(e))}})}function Vt(e){var t=e.dom,n=(0,Ze.Z)(e,["dom"]);return A.createPortal((0,a.BX)(q.G7,{css:[q.l0.flex.row,q.l0.align.center,q.l0.color.foregroundDimmer,q.l0.px(2),q.l0.py(4),q.l0.maxWidth("100%"),q.l0.overflowX("auto"),{"&::-webkit-scrollbar":{height:0},scrollbarWidth:"none"}],children:[(0,a.tZ)(Nt.Z,{size:16}),(0,a.tZ)($t,(0,r.Z)({},n))]}),t)}function $t(e){var t=e.doc,n=e.cursor,o=e.symbols,c=(0,Ze.Z)(e,["doc","cursor","symbols"]),s=(0,i.Z)(l.useState((function(){return Bt(t,n,o)})),2),u=s[0],d=s[1];return l.useEffect((function(){var e=Bt(t,n,o);(e.length!==u.length||e.some((function(e,t){return e!==u[t]})))&&d(e)}),[u,t,n,o]),(0,a.tZ)(qt,(0,r.Z)({symbolPath:u,symbols:o},c))}var qt=l.memo((function(e){var t=e.symbols,n=e.moveCursor,r=e.symbolPath,i=function(e){var t=e.items;return(0,a.tZ)(q.G7,{css:Lt,children:(0,a.tZ)(q.ZE,{icon:(0,a.tZ)("span",{}),onAction:u,cssProps:Mt,label:"...",menuCssProps:zt,onOpen:Wt,items:Xt(t),children:function(e){return(0,a.tZ)(jt.ck,{textValue:e.name,children:(0,a.tZ)(Gt,{value:e})},l(e))}})})},o=r.length-1,c=r[o],s=[],l=function(e){return s.push(e)-1},u=function(e){n(s[e].selectionRange.start),(0,Ut.j)(Ut.U3.CODE_NAVIGATION_USED,{action:"jumped"})},d=null;return Ft(c)?d=(0,a.tZ)(i,{items:c.children}):!r.length&&t.length&&(d=(0,a.tZ)(i,{items:t})),(0,a.BX)(q.G7,{css:[q.l0.flex.row],children:[r.map((function(e,n){return(0,a.BX)(q.G7,{css:Lt,children:[(0,a.tZ)(Ht,{getKey:l,onClick:u,symbol:e,values:0===n?t:r[n-1].children}),(n!==o||Ft(e))&&(0,a.tZ)(Nt.Z,{size:16})]},n)})),d]})})),Qt=H.tk.baseTheme({".cm-panels":{border:"none",zIndex:"1 !important"},".cm-panel:not(:empty)":{background:q.TV.backgroundDefault}});function Kt(e){var t=e.debounce,n=e.setDecoration,r=e.documentSymbols;return[H.mH.of((function(e){var i=document.createElement("div"),o=(0,Dt.u)({doc:e.state.doc,cursor:e.state.selection.main.head}),c=(0,g.Z)(o.set,t);function s(t){e.dispatch({scrollIntoView:!0,selection:X.jT.cursor((0,V.R)(e.state.doc,t))}),e.focus()}function l(){var e=(0,it.Z)(r),t=(0,it.Z)(o),n=t.doc,c=t.cursor;return e?(0,a.tZ)(Vt,{moveCursor:s,dom:i,symbols:e,cursor:c,doc:n}):null}return{dom:i,top:!0,mount:function(){n((0,a.tZ)(l,{}))},update:function(e){e.selectionSet&&r.current&&c({doc:e.view.state.doc,cursor:e.state.selection.main.head})}}})),Qt]}var Yt=n(17713),Jt=n(58823),en=n(95984),tn=n(40381),nn=n(44676);function rn(e){var t=e.containerProps,n=e.codeActions,i=e.onExecuted,o=(0,U.Z)().fs,c=(0,tn.Z)(),s=(0,L.Z)(c||"");return n.length&&s?(0,a.tZ)(en.XZ,(0,D.Z)((0,r.Z)({},t),{children:n.map((function(e,t){return(0,a.tZ)(nn.Z,{onClick:function(t){if(t.stopPropagation(),K.Command.is(e))return s.request.executeCommand(e.command,e.arguments),void i();var n=e.edit,r=e.command;n&&(0,Jt.w)({edit:n,fs:o,client:s}),r&&s.request.executeCommand(r.command,r.arguments),i()},children:(0,a.tZ)(en.sN,{isFirst:0===t,isLast:t===n.length-1,children:(0,a.tZ)(vt.x,{children:e.title})})},t)}))})):null}var an=n(92876),on=n(21131);var cn=new Map;var sn="undefined"===typeof WeakRef?function(e){return{deref:function(){return e}}}:WeakRef,ln=n(6625);function un(e){var t=e.path,n=e.range,r=e.lspClient;n=function(e){var t,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:JSON.stringify)(e),r=null===(t=cn.get(n))||void 0===t?void 0:t.deref();return null!=r?r:(cn.set(n,new sn(e)),e)}(n);var a=(0,ln.Z)(),c=(0,i.Z)(function(e,t){var n=l.useRef(),r=(0,on.Z)((function(){return(0,g.Z)((function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];e.apply(void 0,(0,o.Z)(r)).then((function(e){var t;null===(t=n.current)||void 0===t||t.call(n,e)}))}),t)}),[e,t]);return[r,l.useCallback((function(e){n.current=e}),[])]}(r.request.codeActions,1e3),2),s=c[0],u=c[1],d=(0,i.Z)(l.useState([]),2),f=d[0],p=d[1],h=l.useCallback((0,j.Z)(O().mark((function e(){return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r&&t){e.next=2;break}return e.abrupt("return");case 2:u((function(e){a.current&&("error"in e?(p([]),an.Tb(new Error(e.error.message))):null===e.result||0===e.result.length?p([]):p(e.result))})),s(t,n);case 4:case"end":return e.stop()}}),e)}))),[r,t,s,n,u,a]);return l.useEffect((function(){return h(),function(){s.cancel()}}),[h,s]),[f,h]}var dn=X.Py.define();function fn(e){var t=e.state,n=t.doc,r=t.selection.main,i=r.from,a=r.to;return{start:(0,V.s)(n,i),end:(0,V.s)(n,a)}}var pn=function(e){var t=e.view,n=e.path,r=e.lspClient,o=e.visible,c=e.coords,s=(0,i.Z)(l.useState({x:0,y:0}),2),u=s[0],d=s[1],f=(0,i.Z)(un({path:n,lspClient:r,range:fn(t)}),2),p=f[0],h=f[1],m=(0,it.Z)(o),v=(0,it.Z)(c),g=l.useCallback((function(){o.current=!1}),[o]);if(l.useEffect((function(){v&&d({x:v.left,y:v.top})}),[v]),!p.length)return null;var b=p.some((function(e){return"kind"in e&&"quickfix"===e.kind}))?"#75bdff":"#ffcc00";return(0,a.BX)("div",{role:"presentation",onMouseDown:function(e){m||(e.stopPropagation(),e.preventDefault(),d({x:e.nativeEvent.pageX,y:e.nativeEvent.pageY}),o.current=!m)},children:[(0,a.tZ)(Yt.Z,{css:{fill:b,color:b},className:"lightbulb"}),m&&(0,a.tZ)(rn,{containerProps:{view:t,verticalOffset:en.R$*p.length,closeMenu:g,width:"auto",coords:u},onExecuted:function(){g(),h()},codeActions:p})]})},hn=function(e){(0,xe.Z)(n,e);var t=(0,ye.Z)(n);function n(){var e;return(0,be.Z)(this,n),(e=t.apply(this,arguments)).visible=(0,Dt.u)(!1),e.coords=(0,Dt.u)(null),e.container=l.createRef(),e}var i=n.prototype;return i.toDOM=function(e){var t=document.createElement("div");return t.setAttribute("aria-hidden","true"),t.className="cm-code-action",this.visible.current=!1,this.props.setDecoration(A.createPortal((0,a.tZ)("span",{ref:this.container,children:(0,a.tZ)(pn,(0,D.Z)((0,r.Z)({},this.props),{view:e,visible:this.visible,coords:this.coords}))}),t)),t},i.contains=function(e){var t;return(null===(t=this.container.current)||void 0===t?void 0:t.contains(e))||!1},i.updateDOM=function(){return!0},i.ignoreEvent=function(){return!1},n}(H.l9);var mn=function(e){return H.lg.fromClass(function(){function t(n){(0,be.Z)(this,t),this.widget=new hn,this.widget.props=e,this.decoration=H.p.widget({widget:this.widget,side:0}),this.updateDecorations(n)}var n=t.prototype;return n.update=function(e){var t=this;(e.docChanged||e.selectionSet)&&this.updateDecorations(e.view),(0,$.j)(e,dn,(function(n){var r=n.value;t.widget.visible.current=!0,t.widget.coords.current=r,t.updateDecorations(e.view)}))},n.updateDecorations=function(e){var t,n=e.state,r=n.doc,i=n.selection,a=r.lineAt(i.main.from);t=function(e){return/^( {2}|\u3000|\t)/.test(e)}(a.text)||1===a.number&&1===r.lines?a.from:1===a.number?Math.min(r.length,a.to+1):r.lineAt(a.from-1).from,this.decorations=H.p.set([this.decoration.range(t)])},t}(),{decorations:function(e){return e.decorations},eventHandlers:{mousedown:function(e){this.widget.visible.current&&this.widget.contains(e.target)&&(e.stopPropagation(),e.preventDefault())},keyup:function(e){"Escape"===e.key&&(this.widget.visible.current=!1)},scroll:function(){this.widget.visible.current=!1}}})},vn=H.tk.baseTheme({".cm-code-action":{position:"absolute",zIndex:101,top:"calc(50% - 8px)",left:"0",height:"16px",width:"16px",background:"transparent",fontFamily:q.TV.fontFamilyDefault,cursor:"pointer","& svg":{display:"block"}}});var gn=n(59006),bn=H.tk.theme({".cm-content":{paddingBottom:"".concat(400,"px")}});function xn(e){var t=e.view,n=(0,gn.Z)({view:t});l.useEffect((function(){if(t)return t.dispatch({effects:n.reconfigure(bn)}),function(){t.dispatch({effects:n.reconfigure([])})}}),[t,n])}var Zn=n(25108),yn=function(e){(0,xe.Z)(n,e);var t=(0,ye.Z)(n);function n(){var e;return(0,be.Z)(this,n),(e=t.apply(this,arguments)).state={error:null,errorInfo:null},e}var r=n.prototype;return r.componentDidCatch=function(e,t){an.Tb(e,{extra:{errorInfo:t,category:"ws-scrollbar"}}),this.setState({error:e,errorInfo:t}),Zn.error({error:e,errorInfo:t})},r.render=function(){return this.state.error?null:this.props.children},n}(l.Component),wn=n(96486),kn=X.Py.define(),En=H.tk.baseTheme({".cm-scrollbar-element.severity-info":{backgroundColor:q.TV.accentPrimaryStronger},".cm-scrollbar-element.severity-warning":{backgroundColor:q.TV.yellowStrongest},".cm-scrollbar-element.severity-error":{backgroundColor:q.TV.redStronger}});var Sn=H.p.mark({class:"cm-highlight"}),Cn=H.tk.baseTheme({"&light .cm-highlight":{backgroundColor:"#f5f6f8",outline:"1px solid #ccd1d7"},"&dark .cm-highlight":{backgroundColor:"#3f434b",outline:"1px solid #5c616a"},"&light .cm-activeLine .cm-highlight":{backgroundColor:"#e0e3e7",outline:"1px solid #c3c8cf"},"&dark .cm-activeLine .cm-highlight":{backgroundColor:"#444850",outline:"1px solid #5e636d"}}),Tn=X.Py.define(),Rn=X.QQ.define({create:function(){return H.p.none},provide:function(e){return H.tk.decorations.from(e)},update:function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,o=t.effects[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var c=a.value;if(c.is(Tn)){if(!c.value)return H.p.none;e=H.p.set(c.value.flatMap((function(e){return e.range})).map((function(e){var n=(0,V.R)(t.newDoc,e.start),r=(0,V.R)(t.newDoc,e.end);return n===r?void 0:Sn.range(n,r)})).filter(Boolean),!0)}}}catch(s){r=!0,i=s}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return e}});var _n=H.tk.baseTheme({".cm-scrollbar-element.active-word":{backgroundColor:q.TV.foregroundDimmer,height:"5px"}});var In=H.tk.baseTheme({"::-webkit-scrollbar":{width:"10px"},"::-webkit-scrollbar-thumb":{borderRadius:"10px"},"::-webkit-scrollbar-thumb:hover":{transition:"0.2s"},"&dark ::-webkit-scrollbar-thumb":{background:"rgba(86, 86, 86, 0.25)",borderRadius:"10px"},"&dark ::-webkit-scrollbar-thumb:hover":{background:"rgba(86, 86, 86, 0.4)"},"&light ::-webkit-scrollbar-thumb":{background:"#e5e5e5",borderRadius:"10px"},"&light ::-webkit-scrollbar-thumb:hover":{background:"#e0e0e0"}}),Pn=H.tk.baseTheme({".cm-scrollbar-element":{position:"absolute",height:"2px"},".cm-semantic-scrollbar-container":{pointerEvents:"none",position:"fixed",right:0,height:"100%",width:"10px"},"&light .cm-scrollbar-element.cursor":{backgroundColor:"#507aac"},"&dark .cm-scrollbar-element.cursor":{backgroundColor:"#98aac1"}});function Dn(e,t){var n=e.state.doc,r=400/e.defaultLineHeight;return n.length<t?{display:"none"}:{top:100*(n.lineAt(t).number/(n.lines+r))+"%"}}function An(e){var t=e.setDecoration;return H.lg.define((function(e){var n=function(t){var n=t.item;return(0,a.tZ)("div",{className:"cm-scrollbar-element ".concat(n.className),style:(0,r.Z)({},n.style,Dn(e,n.pos))})},i=function(){(0,it.Z)(s);var t=Array.from((0,it.Z)(c).values()).flat(1),r=(0,l.useRef)(!1);return!0!==r.current&&o.getBoundingClientRect().left<e.scrollDOM.getBoundingClientRect().right&&(r.current=!0),(0,a.BX)("div",{style:{opacity:r.current?void 0:0},children:[(0,a.tZ)("div",{className:"cm-scrollbar-element cursor",css:{width:10},style:Dn(e,e.state.selection.main.head)}),t.map((function(e){return(0,a.tZ)(yn,{children:(0,a.tZ)(n,{item:e})},e.key)}))]})},o=document.createElement("div");o.className="cm-semantic-scrollbar-container",e.scrollDOM.appendChild(o);var c=(0,Dt.u)(new Map),s=(0,Dt.u)(!1);return t(A.createPortal((0,a.tZ)(i,{}),o)),{destroy:function(){o.remove()},update:function(e){var t=c.current;(0,$.j)(e,kn,(function(e){var n=e.value;t===c.current&&(t=new Map(t)),null===n.items?t.delete(n.name):t.set(n.name,n.items)})),c.current=t,(e.docChanged||e.geometryChanged||e.selectionSet)&&(s.current=!s.current)}}}))}function Nn(e){var t,n=e.lspClient,i=e.path,c=e.decorations,s=e.rename,l=e.semanticScrollbarEnabled,u=e.highlightActiveWordEnabled,d=(0,M.Z)(n),f=function(e){return function(t){setTimeout((function(){c.update((function(n){return n.set(e,t)}))}))}},p=[de({lspClient:n,path:i}),pe({lspClient:n,path:i})];return u&&p.push(function(e){var t=e.lspClient,n=e.path;return[Cn,Rn,H.tk.updateListener.of(function(){var e=(0,j.Z)(O().mark((function e(r){var i,a,o,c;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.docChanged){e.next=3;break}return r.view.dispatch({effects:[Tn.of(null)]}),e.abrupt("return");case 3:if(r.selectionSet){e.next=5;break}return e.abrupt("return");case 5:return i=r.state,a=i.doc,o=i.selection,e.next=8,t.request.documentHighlights(n,(0,V.s)(a,o.main.head));case 8:c=e.sent,r.view.dispatch({effects:[Tn.of("error"in c?null:c.result)]});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())]}({lspClient:n,path:i})),l&&p.push((t={setDecoration:f("semanticScrollbar")},[In,Pn,An(t),[En,X.yy.transactionExtender.of((function(e){var t;return(0,$.j)(e,fe.lC,(function(e){var n=e.value,r=(0,wn.uniqBy)(n.map((function(e){return{className:"severity-".concat(e.severity),key:"".concat(e.from,"-").concat(e.to,"-").concat(e.severity),pos:e.from,style:{marginLeft:5,width:5}}})),(function(e){return e.key}));t=kn.of({name:"diagnostics",items:r})})),t?{effects:[t]}:null}))],[_n,X.yy.transactionExtender.of((function(e){var t;return(0,$.j)(e,Tn,(function(n){var r=n.value;if(r){var i=(0,wn.uniqBy)(r.map((function(t){return{className:"active-word",key:[t.range.start.line,t.range.start.character,t.range.end.line,t.range.end.character].join("-"),pos:(0,V.R)(e.newDoc,t.range.start),style:{marginLeft:2,width:5}}})),(function(e){return e.key}));t=kn.of({name:"activeWord",items:i})}else t=kn.of({name:"activeWord",items:[]})})),t?{effects:[t]}:null}))]])),d.isAutoCompleteSupported&&p.push(function(e){var t=e.lspClient,n=e.path,r=e.setDecoration;function i(){return i=(0,j.Z)(O().mark((function e(i){var a,o,c,s,l,u,d;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.getServerCapabilities()){e.next=4;break}return e.abrupt("return",null);case 4:if(c=(null===o||void 0===o||null===(a=o.completionProvider)||void 0===a?void 0:a.triggerCharacters)||[],s=et(i,c)){e.next=8;break}return e.abrupt("return",null);case 8:return e.next=10,t.request.completion(n,(0,V.s)(i.state.doc,i.pos),s);case 10:if(!("error"in(l=e.sent))){e.next=13;break}return e.abrupt("return",null);case 13:if(u=l.result,!i.aborted){e.next=16;break}return e.abrupt("return",null);case 16:if(u){e.next=18;break}return e.abrupt("return",null);case 18:return d=Array.isArray(u)?u:u.items,e.abrupt("return",rt({context:i,items:d,client:t,path:n,setDecoration:r}));case 20:case"end":return e.stop()}}),e)}))),i.apply(this,arguments)}return(0,W.ys)({defaultKeymap:!1,closeOnBlur:!1,override:[(0,W.eC)(["LineComment","BlockComment","String"],(function(e){return i.apply(this,arguments)}))]})}({setDecoration:f("autocomplete"),lspClient:n,path:i})),d.isSignatureHelpSupported&&p.push(ae({setDecoration:f("signatureSuggestion"),lspClient:n,path:i})),d.isHoverSupported&&p.push(function(e){var t=e.lspClient,n=e.path,r=e.setDecoration,i=(0,H.bF)(function(){var e=(0,j.Z)(O().mark((function e(i,a){var o,c,s,l;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=(0,V.s)(i.state.doc,a),e.next=3,t.request.hover(n,o);case 3:if(c=e.sent,s=t.getLanguageId(n),!("error"in c)){e.next=8;break}return r(null),e.abrupt("return",null);case 8:if(null!==(l=c.result)){e.next=12;break}return r(null),e.abrupt("return",null);case 12:return e.abrupt("return",ut({hover:l,offset:a,state:i.state,languageId:s,setDecoration:r}));case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),{hoverTime:0});return i}({setDecoration:f("hoverTooltip"),lspClient:n,path:i})),d.isDocumentSymbolSupported&&p.push(function(e){var t=e.lspClient,n=e.path,r=e.setDecoration,i=(0,Dt.u)(null),a=(0,g.Z)(i.set,200),o=(0,Pt.Z)((0,j.Z)(O().mark((function e(){var r;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.request.documentSymbol(n);case 2:(r=e.sent)&&"result"in r&&r.result.length&&"range"in r.result[0]?a(r.result):a(null);case 4:case"end":return e.stop()}}),e)}))),{wait:200}),c=H.lg.define((function(){return o(),{update:function(e){e.docChanged&&o()}}}));return[Kt({path:n,setDecoration:r,documentSymbols:i,debounce:200}),c]}({setDecoration:f("codeNavigation"),lspClient:n,path:i})),d.isCodeActionsSupported&&p.push(function(e){return[vn,mn(e)]}({setDecoration:f("codeActions"),lspClient:n,path:i})),(d.isFindDefinitionSupported||d.isFindReferencesSupported)&&p.push(function(e){var t=e.setDecoration,n=e.lspClient,i=e.path,c=X.Py.define(),s=X.Py.define(),l=H.tk.updateListener.of(function(){var e=(0,j.Z)(O().mark((function e(t){var r,a,l,u,d,f,p,h,m,v,g,b,x,Z,y,w,k,E,S,C,T,R,_,I,P,D,A,N,U,j;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Z=function(){t.view.dispatch({effects:s.of(null)})},r=null,a=!0,l=!1,u=void 0,e.prev=3,d=t.transactions[Symbol.iterator]();case 5:if(a=(f=d.next()).done){e.next=27;break}for(p=f.value,h=!0,m=!1,v=void 0,e.prev=8,g=p.effects[Symbol.iterator]();!(h=(b=g.next()).done);h=!0)(x=b.value).is(wt)&&(r=x.value);e.next=16;break;case 12:e.prev=12,e.t0=e.catch(8),m=!0,v=e.t0;case 16:e.prev=16,e.prev=17,h||null==g.return||g.return();case 19:if(e.prev=19,!m){e.next=22;break}throw v;case 22:return e.finish(19);case 23:return e.finish(16);case 24:a=!0,e.next=5;break;case 27:e.next=33;break;case 29:e.prev=29,e.t1=e.catch(3),l=!0,u=e.t1;case 33:e.prev=33,e.prev=34,a||null==d.return||d.return();case 36:if(e.prev=36,!l){e.next=39;break}throw u;case 39:return e.finish(36);case 40:return e.finish(33);case 41:if(r){e.next=43;break}return e.abrupt("return");case 43:if(y=(0,M.Z)(n),w=t.state.doc,k=(0,V.s)(w,r),!y.isFindReferencesSupported){e.next=53;break}return e.next=50,n.request.findReferences(i,k,{includeDeclaration:!1});case 50:e.t2=e.sent,e.next=54;break;case 53:e.t2={result:null};case 54:if(E=e.t2,!y.isFindDefinitionSupported){e.next=61;break}return e.next=58,n.request.findDefinitions(i,k);case 58:e.t3=e.sent,e.next=62;break;case 61:e.t3={result:null};case 62:if(S=e.t3,!("error"in E)){e.next=65;break}throw new Error("Something went wrong fetching references: ".concat(E.error.message));case 65:if(!("error"in S)){e.next=67;break}throw new Error("Something went wrong fetching definition: ".concat(S.error.message));case 67:if(C=E.result,T=S.result,R=C&&C.length>0,_=T&&T.length>0,R||_){e.next=74;break}return Z(),e.abrupt("return");case 74:I=[],P=[],C&&C.length>0&&(D=I).push.apply(D,(0,o.Z)(C)),T&&T.length>0&&(A=P).push.apply(A,(0,o.Z)(T)),N=(0,o.Z)(I).concat((0,o.Z)(P)).map((function(e){return n.documentUriToPath(e.uri)})).filter((function(e){return e!==i})),U=(0,o.Z)(new Set(N)),j=w.toJSON().join("\n"),t.view.dispatch({effects:c.of({references:I,definitions:P,currentFile:i,currentFileContents:j,files:U})});case 82:case"end":return e.stop()}}),e,null,[[3,29,33,41],[8,12,16,24],[17,,19,23],[34,,36,40]])})));return function(t){return e.apply(this,arguments)}}()),u=X.QQ.define({create:function(){return null},update:function(e,t){var n=e,r=!0,i=!1,a=void 0;try{for(var o,l=t.effects[Symbol.iterator]();!(r=(o=l.next()).done);r=!0){var u=o.value;u.is(c)&&(n=u.value),u.is(s)&&(n=null)}}catch(d){i=!0,a=d}finally{try{r||null==l.return||l.return()}finally{if(i)throw a}}return n},provide:function(e){return H.hJ.compute([e],(function(n){var i=n.field(e);if(!i)return t(null),null;var o=n.selection.asSingle().main;return{pos:o.from,end:o.to,create:function(e){var n=document.createElement("div");return n.classList.add("cm-lsp-tooltip"),n.classList.add("replit-tooltip"),n.style.padding="0",t((0,a.tZ)(xt,(0,D.Z)((0,r.Z)({},i),{onClose:function(){e.dispatch({effects:s.of(null)})},dom:n}))),{dom:n}}}}))}});return[l,u]}({setDecoration:f("tooltip"),lspClient:n,path:i})),d.isRenameSupported&&p.push(function(e){var t=e.setDecoration,n=e.hook;return X.QQ.define({create:function(){return null},update:function(e,t){var n=e,r=!0,i=!1,a=void 0;try{for(var o,c=t.effects[Symbol.iterator]();!(r=(o=c.next()).done);r=!0){var s=o.value;s.is(It)&&(n=s.value)}}catch(l){i=!0,a=l}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return n},provide:function(e){return H.hJ.compute([e],(function(r){var i=r.field(e);if(null===i)return t(null),null;var o=r.wordAt(i);return o?{pos:i,create:function(){var e=document.createElement("div");e.classList.add("cm-lsp-rename-tooltip"),e.classList.add("replit-tooltip"),e.style.padding="0";var c=r.sliceDoc(o.from,o.to);return t((0,a.tZ)(Rt,{variable:c,dom:e,onRename:function(e){return n.onRename(e,i)},closeInput:n.closeRenameInput})),{dom:e}}}:null}))}})}({setDecoration:f("renameInput"),hook:s})),p}var Un=n(10129),jn=n(52071);function Bn(){return(Bn=(0,j.Z)(O().mark((function e(t){var n,r,a,o,c,s,l,u,d,f,p,h,m,v,g,b,x,Z;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.event,r=t.view,a=t.client,o=t.session,c=t.filePath,s=t.requestIdRef,(0,Un.j)(n)){e.next=3;break}return e.abrupt("return");case 3:if(r){e.next=5;break}throw new Error("Expected view");case 5:if(l=n.clientX,u=n.clientY,null!==(d=r.posAtCoords({x:l,y:u}))){e.next=9;break}return e.abrupt("return");case 9:if(a){e.next=11;break}throw new Error("Expected LSP Client");case 11:if(c){e.next=13;break}throw new Error("Expected filePath");case 13:if((0,M.Z)(a).isFindDefinitionSupported){e.next=16;break}return e.abrupt("return");case 16:return s.current&&a.notify.cancelRequest(s.current),s.current=a.generateId(),f=(0,V.s)(r.state.doc,d),e.next=21,a.request.findDefinitions(c,f,{id:s.current,tap:(0,jn.M)(r)});case 21:if(p=e.sent,s.current=null,!("error"in p)){e.next=25;break}throw new Error("Something went wrong fetching definition location: ".concat(p.error.message));case 25:if(h=p.result,!p.cancelled&&h&&0!==h.length){e.next=28;break}return e.abrupt("return");case 28:m=(0,i.Z)(h,1),v=m[0],g=v.uri,b=v.range,x=b.start,Z=a.documentUriToPath(g),o.updateDeeplink({path:Z,line:x.line+1,col:x.character});case 33:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function On(e){var t=e.view,n=e.filePath,r=e.isLoading,i=e.decorations,a=(0,F.Z)().preferences.codeIntelligence,o=(0,U.Z)().session,c=(0,L.Z)(n),s=z(c),d=(0,S.c)("flag-semantic-scrollbar"),f=d.enabled,p=d.loading,h=(0,S.c)("flag-highlight-active-word"),m=h.enabled,v=h.loading,g=function(e){var t=e.view,n=e.filePath,r=l.useRef(null),i=(0,U.Z)().fs,a=(0,L.Z)(n),o=l.useCallback(function(){var e=(0,j.Z)(O().mark((function e(o,c){var s,l,u;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("Expected view");case 2:if(a){e.next=4;break}throw new Error("Expected client");case 4:if(n){e.next=6;break}throw new Error("Expected non-null file path");case 6:if(null!=c){e.next=8;break}throw new Error("Expected rename input params");case 8:return r.current&&a.notify.cancelRequest(r.current),s=a.generateId(),r.current=s,e.next=13,a.request.rename(n,(0,V.s)(t.state.doc,c),o,{id:s,tap:(0,jn.M)(t)});case 13:if(l=e.sent,r.current=null,!("error"in l)){e.next=17;break}throw new Error("Something went wrong renaming ".concat(l.error.message));case 17:if(!l.cancelled){e.next=19;break}return e.abrupt("return");case 19:if(u=l.result){e.next=22;break}return e.abrupt("return");case 22:(0,Jt.w)({edit:u,fs:i,client:a}),t.dispatch({effects:[It.of(null)]});case 24:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[a,t,n,i]),c=l.useCallback((function(){if(!t)throw new Error("Expected view");t.dispatch({effects:[It.of(null)]}),t.focus()}),[t]);return l.useMemo((function(){return{onRename:o,closeRenameInput:c}}),[o,c])}({view:t,filePath:n}),b=r||!a||!t||!c||!s||!c.isSupportedFile(n)||(0,u.isMobile)()||p||v,x=(0,gn.Z)({view:t});l.useEffect((function(){if(!b){c.notify.didOpen(n,t.state.doc.toString());var e=s.isFindDefinitionSupported,r={current:null};return t.dispatch({effects:x.reconfigure([Nn({lspClient:c,path:n,decorations:i,rename:g,semanticScrollbarEnabled:f,highlightActiveWordEnabled:m}),e?H.tk.domEventHandlers({click:function(e){return function(e){Bn.apply(this,arguments)}({event:e,view:t,filePath:n,client:c,session:o,requestIdRef:r}),!1}}):[]])}),function(){c.getServerState()===G.a.INITIALIZED&&c.isOpen(n)&&c.notify.didClose(n),t.dispatch({effects:x.reconfigure([])}),i.unmount()}}}),[c,t,s,x,n,o,i,g,b,f,m])}var Gn=n(39571),Ln=new(function(e){(0,xe.Z)(n,e);var t=(0,ye.Z)(n);function n(){return(0,be.Z)(this,n),t.apply(this,arguments)}return n.prototype.toDOM=function(){return document.createTextNode("\u25cf")},n}(H.SJ)),Mn=X.Py.define({}),zn=X.Py.define({}),Fn=H.p.line({attributes:{class:"cm-debuggerLine"}}),Xn=X.Py.define({}),Wn=X.QQ.define({create:function(){return null},update:function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,o=t.effects[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var c=a.value;if(c.is(Xn))return c.value}}catch(s){r=!0,i=s}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return e}});function Hn(e){var t=new X.f_,n=e.state.field(Wn);if(null!==n&&n<=e.state.doc.lines){var r=e.state.doc.line(n);t.add(r.from,r.from,Fn)}return t.finish()}var Vn=H.lg.fromClass(function(){function e(t){(0,be.Z)(this,e),this.decorations=Hn(t)}return e.prototype.update=function(e){this.decorations=Hn(e.view)},e}(),{decorations:function(e){return e.decorations}});function $n(e,t){e.dispatch({effects:zn.of({pos:t})})}var qn=X.QQ.define({create:function(){return X.Xs.empty},update:function(e,t){e=e.map(t.changes);var n=!0,r=!1,i=void 0;try{for(var a,o=function(){var n=a.value;if(n.is(zn)){var r=!1;e.between(n.value.pos,n.value.pos+1,(function(){r=!0})),e=r?e.update({filter:function(e){return e!==n.value.pos}}):e.update({add:[Ln.range(n.value.pos)]})}n.is(Mn)&&(e=Yn(n.value.lines,t.state))},c=t.effects[Symbol.iterator]();!(n=(a=c.next()).done);n=!0)o()}catch(s){r=!0,i=s}finally{try{n||null==c.return||c.return()}finally{if(r)throw i}}return e}}),Qn=H.tk.baseTheme({".cm-breakpoint-gutter .cm-gutterElement":{color:p.TV.accentPrimaryDefault,paddingLeft:p.TV.space4,paddingRight:p.TV.space2,cursor:"default"},".cm-debuggerLine":{backgroundColor:p.TV.accentPrimaryDimmest,borderRadius:p.TV.borderRadius4,marginRight:p.TV.space4}});function Kn(e,t){var n;return e&&0!==e.length?null===t||(null===(n=e[0].source)||void 0===n?void 0:n.path)!==t?null:e[0].line:null}function Yn(e,t){var n=(0,o.Z)(new Set(e.filter((function(e){return e<=t.doc.lines})))).map((function(e){return Ln.range(t.doc.line(e).from)}));return X.Xs.of(n,!0)}var Jn=n(2916);function er(e){var t=e.view,n=e.debuggest,r=e.filePath,i=e.isLoading,a=(0,U.Z)().fs,o=(0,Jn.Z)(),c=(0,it.Z)(n.mainClient),s=(0,gn.Z)({view:t});l.useEffect((function(){if(!i&&o&&c&&t){var e=(0,Gn.ZF)("/home/runner/".concat(o.slug,"/").concat(r)),n=function(e,t,n,r){var i,a=[];a.push(t.breakpoints.subscribe((function(t){var r=t.get(n);e.dispatch({effects:Mn.of({lines:r?r.map((function(e){return e.line})):[]})})})));var o=H.tk.updateListener.of((function(i){i.transactions.forEach((function(i){i.effects.forEach((function(i){if(i.is(zn)){var a=(0,Gn.om)(n);if(!a)throw new Error("Expected relative path");t.toggleBreakpoint(n,{line:e.state.doc.lineAt(i.value.pos).number,otVersion:r.getOTVersion(a),otIndex:i.value.pos})}}))}))}));a.push(t.stackFrames.subscribe((function(t){var r=Kn(t,n);e.dispatch({effects:Xn.of(r)})})));var c=(0,H.v5)({class:"cm-breakpoint-gutter",markers:function(e){return e.state.field(qn)},initialSpacer:function(){return Ln},domEventHandlers:{mousedown:function(e,t){return $n(e,t.from),!0}}}),s=(null===(i=t.breakpoints.current.get(n))||void 0===i?void 0:i.map((function(e){return e.line})))||[],l=[X.Wl.highest(c),qn.init((function(e){return Yn(s,e)})),o,Wn.init((function(){return Kn(t.stackFrames.current,n)})),Vn,Qn];return{extensions:l,dispose:function(){return a.forEach((function(e){return e()}))}}}(t,c,e,a),l=n.extensions,u=n.dispose;return t.dispatch({effects:s.reconfigure(l)}),function(){t.dispatch({effects:s.reconfigure([])}),u()}}}),[c,t,o,r,i,a,s])}var tr=n(15519),nr=n(1879),rr=n(91513),ir=n(7297),ar=n(31230),or=n(46829);function cr(){var e=(0,ir.Z)(["\n  query ReplCodeExamples($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        deprecatedLanguageConfig {\n          id\n          mainFile\n          examples {\n            name\n            code\n          }\n        }\n      }\n    }\n  }\n"]);return cr=function(){return e},e}var sr={},lr=(0,ar.ZP)(cr());var ur=n(57263),dr=n(78244);function fr(e){var t=e.name,n=e.children,r=e.onClick;return(0,a.BX)(q.G7,{onClick:function(){return r()},css:[q.gU.nofill,q.l0.p(8)],children:[(0,a.tZ)(q.xv,{variant:"subheadDefault",css:q.l0.pb(16),children:t}),(0,a.tZ)(q.G7,{css:[q.l0.backgroundColor.backgroundDefault,q.l0.p(8),q.l0.borderRadius(8)],children:n})]})}var pr="@media (min-width: ".concat(ur.j.tabletMax,"px)"),hr=(0,At.iv)([q.l0.colWithGap(16),(0,ve.Z)({},pr,{width:"calc(50%  - 8px)",flex:"0 0 auto",gap:"16px"})]);function mr(e){var t=e.children;return(0,a.tZ)(q.G7,{css:[(0,ve.Z)({},pr,[q.l0.rowWithGap(16)])],children:t})}function vr(e){var t=e.mainFile,n=e.examples,r=e.onSelect;return(0,a.BX)(q.G7,{css:[q.l0.colWithGap(24)],children:[(0,a.tZ)(q.h4,{level:1,variant:"headerDefault",children:"Code examples"}),(0,a.tZ)(q.xv,{multiline:!0,children:"Get started with some program examples."}),(0,a.BX)(mr,{css:[q.l0.colWithGap(16)],children:[(0,a.tZ)(q.G7,{css:hr,children:n.slice(0,(n.length+1)/2).map((function(e){return(0,a.tZ)(fr,{name:e.name,onClick:function(){return r(e)},children:(0,a.tZ)(dr.Z,{hideGutter:!0,filePath:t,code:e.code,fontSize:12})},e.name)}))}),(0,a.tZ)(q.G7,{css:hr,children:n.slice((n.length+1)/2).map((function(e){return(0,a.tZ)(fr,{name:e.name,onClick:function(){return r(e)},children:(0,a.tZ)(dr.Z,{hideGutter:!0,filePath:t,code:e.code,fontSize:12})},e.name)}))})]})]})}function gr(e){var t=e.replId,n=e.onSelect,i=function(e){var t=(0,r.Z)({},sr,e);return or.useQuery(lr,t)}({variables:{replId:t}}),o=i.data,c=i.loading,s=i.error;if(c)return(0,a.tZ)(q.G7,{css:[q.l0.colWithGap(0),q.l0.justify.center,q.l0.align.center,q.l0.pt(32),q.l0.pb(32)],children:(0,a.tZ)(bt.Z,{})});if(s)return(0,a.tZ)(q.G7,{css:[q.l0.colWithGap(0),q.l0.justify.center,q.l0.align.center,q.l0.pt(32),q.l0.pb(32)],children:s.message});var l="Repl"===(null===o||void 0===o?void 0:o.repl.__typename)?o.repl:null;if(!l)return null;var u=l.deprecatedLanguageConfig,d=u.mainFile,f=u.examples;return(null===f||void 0===f?void 0:f.length)?(0,a.tZ)(vr,{mainFile:d,examples:f,onSelect:n}):(0,a.tZ)(q.G7,{css:[q.l0.colWithGap(0),q.l0.justify.center,q.l0.align.center,q.l0.pt(32),q.l0.pb(32)],children:(0,a.BX)(q.xv,{multiline:!0,children:["Sorry, this language doesn\u2019t have any examples. Want to add some? Contact us at ",(0,a.tZ)("a",{href:"mailto:support@replit.com",children:"support@replit.com"}),"!"]})})}var br=n(63377),xr=n(95901),Zr=n(43804);function yr(){var e=(0,ir.Z)(["\n  query GenerateCodeEnabled($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        hasGenerateCode\n      }\n    }\n  }\n"]);return yr=function(){return e},e}var wr={},kr=(0,ar.ZP)(yr());function Er(){var e=function(e){var t=(0,r.Z)({},wr,e);return or.useQuery(kr,t)}({variables:{replId:(0,br.Z)()}}).data;return"Repl"===(null===e||void 0===e?void 0:e.repl.__typename)&&e.repl.hasGenerateCode}function Sr(e){var t=e.onRequestClose,n=(0,xr.e)(Zr.H.Examples),r=(0,xr.e)(Zr.H.Editor),o=(0,i.Z)(l.useState(!1),2),c=o[0],s=o[1],u=(0,tn.Z)(),d=(0,rr.Z)(u),f=(0,br.Z)(),p=l.useRef(null===n||void 0===n?void 0:n.isActive),h=l.useRef();h.current=null===n||void 0===n?void 0:n.isActive;var m=l.useRef(null===n||void 0===n?void 0:n.goto);return m.current=null===n||void 0===n?void 0:n.goto,l.useEffect((function(){return function(){var e;h.current&&(null===(e=m.current)||void 0===e||e.call(m,Zr.H.Editor))}}),[]),l.useEffect((function(){(null===r||void 0===r?void 0:r.isActive)&&!p.current&&(c?r.goto(Zr.H.Examples):s(!0))}),[r,t,c]),l.useEffect((function(){(null===n||void 0===n?void 0:n.isActive)?p.current=!0:p.current&&t(null)}),[null===n||void 0===n?void 0:n.isActive]),d?(0,a.tZ)("div",{ref:null===n||void 0===n?void 0:n.delegateTooltip,children:(0,a.tZ)(gr,{replId:f,onSelect:function(e){d({code:e.code,insertAt:0}),t({exampleName:e.name})}})}):(0,a.tZ)("div",{children:"Please make sure you have a file open"})}var Cr=function(e){var t=e.onShowGenerateCodeModal,n=(0,Jn.Z)(),o=(0,i.Z)(l.useState(!1),2),c=o[0],d=o[1],f=Er(),p=(null===n||void 0===n?void 0:n.language)||"",h=tr.Z.getDocs(p),m=l.useCallback((function(e){(0,Ut.j)(Ut.U3.LANGUAGE_EXAMPLES_VIEWED,(0,r.Z)({language:null===n||void 0===n?void 0:n.language,replId:null===n||void 0===n?void 0:n.id},e)),d(!1)}),[n]);return(0,a.BX)("div",{className:"jsx-761223062c9d62b5 placeholder",children:[(0,a.tZ)(nr.Z,{maxWidth:872,isOpen:c,onRequestClose:function(){return m(null)},children:(0,a.tZ)(Sr,{onRequestClose:m})}),"Not sure what to do? Run some"," ",(0,a.tZ)("a",{"data-cy":"ws-editor-examples",onClick:function(){d(!0)},onKeyDown:function(){d(!0)},role:"button",tabIndex:0,className:"jsx-761223062c9d62b5 link",children:"examples"}),f&&!(0,u.isMobile)()?(0,a.BX)(a.HY,{children:[h?", ":" or ",(0,a.tZ)("a",{onClick:t,onKeyDown:t,role:"button",tabIndex:0,className:"jsx-761223062c9d62b5 link",children:"generate code"})]}):null,h&&(0,a.BX)(a.HY,{children:[", or view"," ",(0,a.tZ)("a",{target:"_blank",href:h,className:"jsx-761223062c9d62b5 link",children:"documentation"})]})," ","(start typing to dismiss)",(0,a.tZ)(s(),{id:"761223062c9d62b5",children:".placeholder.jsx-761223062c9d62b5{font-family:var(--font-family-code);color:var(--foreground-dimmest)}.link.jsx-761223062c9d62b5{cursor:pointer;pointer-events:all;color:var(--accent-primary-default);text-decoration:none}.link.jsx-761223062c9d62b5:hover{text-decoration:underline}"})]})};function Tr(e){var t=e.dom,n=e.onShowGenerateCodeModal;return A.createPortal((0,a.tZ)(Cr,{onShowGenerateCodeModal:n}),t)}var Rr=n(49892),_r=X.Py.define();var Ir=n(93160),Pr=n(40963),Dr=n(72806),Ar=n(96189);function Nr(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;if(!e.valid)return[];for(var r=[],i=e.getCursor(t),a=i.next();!a.done&&r.length<n;)r.push(a.value),a=i.next();return r}function Ur(e){return e>500?"large":e>350?"medium":"small"}var jr=(0,f.KD)("div");function Br(e){var t=e.view,n=function(){if(!t)throw new Error("Expected view");(0,Rr.g)(t);var e=t.state.selection.main;t.dispatch({effects:H.tk.scrollIntoView(e.from,{y:"center",x:"center"})}),U<=1||P((function(t){if(null===t){var n=T.findIndex((function(t){return t.from===e.from&&t.to===e.to}));return-1===n?1:n+1}return t>=U?1:t+1}))},r=function(){if(!t)throw new Error("Expected view");(0,Rr.a7)(t);var e=t.state.selection.main;t.dispatch({effects:H.tk.scrollIntoView(e.from,{y:"center",x:"center"})}),U<=1||P((function(t){if(null===t){var n=T.findIndex((function(t){return t.from===e.from&&t.to===e.to}));return-1===n?1:n+1}return t<=1?U||1:t-1}))},o=function(e){var n=e;return!!t&&(0,H.$1)(t,n,"search-panel")},c=(0,i.Z)(l.useState(!1),2),s=c[0],u=c[1],d=(0,i.Z)(l.useState(!1),2),h=d[0],m=d[1],v=(0,i.Z)(l.useState(!1),2),b=v[0],x=v[1],Z=(0,i.Z)(l.useState(""),2),y=Z[0],w=Z[1],k=(0,i.Z)(l.useState(""),2),E=k[0],S=k[1],C=(0,i.Z)(l.useState([]),2),T=C[0],R=C[1],_=(0,i.Z)(l.useState(null),2),I=_[0],P=_[1],D=(0,ln.Z)(),A=l.useRef(new Rr.Jb({search:""})),N=(0,tn.Z)(),U=T.length,j=l.useCallback((function(e){e.eq(A.current)||(w(e.search),S(e.replace),m(e.caseSensitive),x(e.regexp),A.current=e)}),[]),B=l.useCallback((function(){u(!0)}),[]),O=l.useCallback((0,g.Z)((function(e){D.current&&(R(Nr(A.current,e)),P(null))}),250),[]);l.useEffect((function(){return function(){return O.cancel()}}),[]),function(e){var t=e.view,n=e.onDocChanged,r=e.onSearchQuery,i=e.onExpandSearchPanel;l.useEffect((function(){t&&t.dispatch({effects:X.Py.appendConfig.of([H.tk.updateListener.of((function(e){e.transactions.forEach((function(e){e.effects.forEach((function(e){e.is(Rr.ql)&&r(e.value),e.is(_r)&&i()}))}))})),H.tk.updateListener.of((function(e){e.docChanged&&n(e.view.state.doc)}))])})}),[t,r,i])}({view:t,onSearchQuery:j,onExpandSearchPanel:B,onDocChanged:O}),l.useEffect((function(){if(t){var e=(0,Rr.uP)(t.state);w(e.search),S(e.replace),m(e.caseSensitive),x(e.regexp),A.current=e}}),[t]),l.useEffect((function(){if(t){var e=new Rr.Jb({search:y,replace:E,caseSensitive:h,regexp:b}),n=A.current;e.eq(n)||(A.current=e,t.dispatch({effects:Rr.ql.of(e)}),R(Nr(e,t.state.doc)),P(null))}}),[t,y,E,h,b]),l.useEffect((function(){t&&N&&O(t.state.doc)}),[t,N,O]);var G=(0,i.Z)(l.useState(Ur(0)),2),L=G[0],M=G[1],z=(0,Ar.Z)((function(e){e.width&&M(Ur(e.width))}));if(!t)return null;var F=U>0,W=F?"".concat(I||1," / ").concat(U):null,V=W?8*W.length:null,$=(0,a.BX)(f.ZP,{css:[p.l0.flex.row,p.l0.align.center,p.l0.rowWithGap(8)],children:[(0,a.tZ)(Dr.Z,{id:"Match case",name:"case",checked:h,onChange:function(){m((function(e){return!e}))}}),(0,a.tZ)(vt.x,{variant:"small",color:h?"default":"dimmer",children:"Match case"}),(0,a.tZ)(Dr.Z,{id:"Regexp",name:"re",checked:b,onChange:function(){x((function(e){return!e}))}}),(0,a.tZ)(vt.x,{variant:"small",color:b?"default":"dimmer",children:"Regexp"})]});return(0,a.tZ)(jr,{ref:z,onKeyDown:function(e){o(e)&&e.preventDefault()},children:(0,a.BX)(Ir.Z,{elevated:!0,css:[p.l0.rowWithGap(8),p.l0.px(4),p.l0.py(8),{borderBottom:"1px solid",borderColor:p.TV.outlineDimmest}],children:[(0,a.tZ)(f.ZP,{css:[p.l0.center,p.l0.height(32)],children:(0,a.tZ)(Ct.Z,{alt:s?"Close replace panel":"Show replace panel",onClick:function(){u((function(e){return!e}))},children:(0,a.tZ)(Nt.Z,{rotate:s?90:0,style:{transition:"200ms ease"}})})}),(0,a.BX)(f.ZP,{css:[p.l0.flex.growAndShrink(1),p.l0.colWithGap(16)],children:[(0,a.BX)(f.ZP,{css:["large"===L?p.l0.rowWithGap(16):p.l0.colWithGap(8)],children:[(0,a.BX)(f.ZP,{css:[p.l0.flex.growAndShrink(1),"small"===L?p.l0.colWithGap(8):[p.l0.rowWithGap(8),p.l0.align.center]],children:[(0,a.BX)(f.ZP,{css:[p.l0.flex.growAndShrink(1),p.l0.position.relative],children:[(0,a.tZ)(Pr.ZP,{css:[p.l0.p(4),V&&{paddingRight:V}],placeholder:"Find",value:y,name:"search","main-field":"true",onKeyDown:function(e){e.metaKey&&"f"===e.key?e.currentTarget.select():"enter"===e.key.toLowerCase()&&(o(e)||(e.preventDefault(),e.shiftKey?r():n()))},onChange:function(e){w(e.target.value)}}),F?(0,a.tZ)(f.ZP,{css:[p.l0.position.absolute,p.l0.top(0),p.l0.right(0),p.l0.height("100%"),p.l0.center,p.l0.pr(4)],children:(0,a.tZ)(vt.x,{variant:"small",color:"dimmest",children:W})}):null]}),(0,a.BX)(f.ZP,{css:[p.l0.rowWithGap(4),p.l0.align.center],children:[(0,a.tZ)(Ct.Z,{alt:"Previous",onClick:function(){r()},children:(0,a.tZ)(Nt.Z,{rotate:-90})}),(0,a.tZ)(Ct.Z,{alt:"Next",onClick:function(){n()},children:(0,a.tZ)(Nt.Z,{rotate:90})}),(0,a.tZ)(St.ZP,{small:!0,text:"Select all",onClick:function(){(0,Rr.i3)(t),t.focus()}})]})]}),$]}),s?(0,a.BX)(f.ZP,{css:["small"===L?p.l0.colWithGap(8):[p.l0.rowWithGap(8),p.l0.align.center,{marginRight:"large"===L?162:-19}]],children:[(0,a.tZ)(f.ZP,{css:[p.l0.flex.growAndShrink(1)],children:(0,a.tZ)(Pr.ZP,{css:[p.l0.p(4)],placeholder:"Replace",name:"replace",value:E,onKeyDown:function(e){"enter"===e.key.toLowerCase()&&(o(e)||(e.preventDefault(),(0,Rr.K9)(t)))},onChange:function(e){S(e.target.value)}})}),(0,a.BX)(f.ZP,{css:[p.l0.rowWithGap(4),p.l0.align.center],children:[(0,a.tZ)(St.ZP,{small:!0,text:"Replace",onClick:function(){(0,Rr.K9)(t)}}),(0,a.tZ)(St.ZP,{small:!0,text:"Replace all",onClick:function(){(0,Rr.ko)(t)}})]})]}):null]}),(0,a.tZ)(f.ZP,{css:[p.l0.center,p.l0.height(32)],children:(0,a.tZ)(Ct.Z,{alt:"Close Search Panel",tooltipHidden:!0,onClick:function(){(0,Rr.N$)(t)},children:(0,a.tZ)(pt.Z,{})})})]})})}function Or(e){var t=e.dom,n=e.view;return A.createPortal((0,a.tZ)(Br,{view:n}),t)}var Gr=n(48551),Lr=n(79500),Mr=n(7787),zr=n(90317);function Fr(){var e=(0,ir.Z)(["\n  query ExplainCode($code: String!, $language: String!, $replId: String) {\n    explainCode(code: $code, language: $language, replId: $replId) {\n      ... on ExplainCodeResult {\n        id\n        explanation\n      }\n      ... on UserError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n  }\n"]);return Fr=function(){return e},e}function Xr(){var e=(0,ir.Z)(["\n  mutation ExplainCodeCodexFeedback($input: CodexFeedback2Input!) {\n    giveCodexFeedback2(input: $input) {\n      ... on CodexFeedback2 {\n        __typename\n        id\n        feedback\n      }\n      ... on UnauthorizedError {\n        __typename\n      }\n      ... on NotFoundError {\n        __typename\n      }\n    }\n  }\n"]);return Xr=function(){return e},e}var Wr={},Hr=(0,ar.ZP)(Fr());var Vr=(0,ar.ZP)(Xr());var $r=n(58809),qr=function(){var e=(0,j.Z)(O().mark((function e(t){var n,r,i;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.code,r=t.language,e.next=3,null===$r.l||void 0===$r.l?void 0:$r.l.query({query:Hr,variables:{code:n,language:r}});case 3:if("ExplainCodeResult"!==(null===(i=e.sent)||void 0===i?void 0:i.data.explainCode.__typename)){e.next=6;break}return e.abrupt("return",i.data.explainCode.explanation);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function Qr(e){var t,n,a,o,c,s,u,d,f,p,h,m=e.language,v=e.code,g=(0,br.Z)(),b=function(e){var t=(0,r.Z)({},Wr,e);return or.useQuery(Hr,t)}({fetchPolicy:"no-cache",variables:{code:v,language:m,replId:g},skip:!m||!v,notifyOnNetworkStatusChange:!0});l.useEffect((function(){(0,Ut.j)(Ut.U3.CODEX_FEATURE_USED,{feature:"explanation",isRetry:!1,language:m})}),[]);var x=(0,i.Z)(function(e){var t=(0,r.Z)({},Wr,e);return or.useMutation(Vr,t)}(),2),Z=x[0],y=x[1],w=function(){var e=(0,j.Z)(O().mark((function e(t){var n,r;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("ExplainCodeResult"===(null===(n=b.data)||void 0===n?void 0:n.explainCode.__typename)&&!b.loading&&!y.loading){e.next=3;break}return e.abrupt("return");case 3:Z({variables:{input:{feedback:t,inferenceClass:zr.Sg.Explanation,inferenceId:null===(r=b.data)||void 0===r?void 0:r.explainCode.id}}}),(0,Ut.j)(Ut.U3.CODEX_FEEDBACK_SUBMITTED,{language:m,feedback:t,feature:"explanation"});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k="ExplainCodeResult"===(null===(t=b.data)||void 0===t||null===(n=t.explainCode)||void 0===n?void 0:n.__typename)?b.data.explainCode.explanation:void 0,E="UserError"===(null===(a=b.data)||void 0===a||null===(o=a.explainCode)||void 0===o?void 0:o.__typename)||"UnauthorizedError"===(null===(c=b.data)||void 0===c||null===(s=c.explainCode)||void 0===s?void 0:s.__typename)?b.data.explainCode.message:null,S="ExplainCodeResult"===(null===(u=b.data)||void 0===u||null===(d=u.explainCode)||void 0===d?void 0:d.__typename)&&"CodexFeedback2"===(null===(f=y.data)||void 0===f||null===(p=f.giveCodexFeedback2)||void 0===p?void 0:p.__typename)&&b.data.explainCode.id===(null===(h=y.data.giveCodexFeedback2)||void 0===h?void 0:h.id)?y.data.giveCodexFeedback2.feedback:null;return{getCodeExplanation:qr,loading:b.loading,explanation:k,errorMessage:E,refetchExplanation:(0,j.Z)(O().mark((function e(){return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,Ut.j)(Ut.U3.CODEX_FEATURE_USED,{feature:"explanation",isRetry:!0,language:m}),e.abrupt("return",b.refetch());case 2:case"end":return e.stop()}}),e)}))),giveCodexFeedback:w,codexFeedback:S}}var Kr=n(39);function Yr(){var e=(0,ir.Z)(["\n  query ExplainCodeEnabled($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        hasExplainCode\n      }\n    }\n  }\n"]);return Yr=function(){return e},e}var Jr={},ei=(0,ar.ZP)(Yr());function ti(e){var t=e.filePath,n=function(e){var t=(0,r.Z)({},Jr,e);return or.useQuery(ei,t)}({variables:{replId:e.replId}}).data,i=(0,Kr.eC)(t);return"Repl"===(null===n||void 0===n?void 0:n.repl.__typename)&&n.repl.hasExplainCode&&i}var ni=n(4158),ri=n(83117);var ii=function(e){var t=e.children,n=e.title,r=e.newInferenceAlt,i=e.learnMoreLink,o=e.width,c=e.onRequestClose,s=e.onRequestNewInference;return(0,a.BX)(Ir.Z,{background:"higher",css:[p.l0.borderRadius(8),p.l0.maxWidth("100%"),p.l0.width(o||320),{background:p.TV.backgroundHigher,boxShadow:p.TV.shadow1,borderWidth:1,borderColor:p.TV.backgroundHighest,borderStyle:"solid"}],children:[(0,a.BX)("div",{css:[p.l0.display.flex,p.l0.justify.spaceBetween,p.l0.flex.row,p.l0.rowWithGap(2),p.l0.p(8),{borderBottom:"1px solid",borderBottomColor:p.TV.backgroundHighest}],children:[(0,a.BX)("div",{css:[p.l0.display.grid,p.l0.align.center,{gridAutoFlow:"column",gridGap:p.TV.space8}],children:[(0,a.tZ)("div",{css:[{color:p.TV.foregroundDefault}],children:n}),i?(0,a.tZ)("a",{href:i,target:"_blank",css:p.l0.color.foregroundDefault,children:(0,a.tZ)(Ct.Z,{alt:"Learn more about AI at Replit",tooltipDelay:0,tooltipText:"This feature is powered by artificial intelligence. Click to learn more.",type:"button",children:(0,a.tZ)(ni.Z,{color:p.TV.foregroundDimmer})})}):null,s?(0,a.tZ)(Ct.Z,{alt:r||"Try again",onClick:s,type:"button",children:(0,a.tZ)(ri.Z,{})}):null]}),(0,a.tZ)("div",{className:"right",children:(0,a.tZ)(Ct.Z,{alt:"Close",tooltipHidden:!0,onClick:c,type:"button",children:(0,a.tZ)(pt.Z,{})})})]}),t]})},ai=n(24561);var oi=function(){return(0,a.tZ)("div",{css:[p.l0.p(16)],children:(0,a.BX)(ai.ZP,{viewBox:"0 0 100 10",backgroundColor:p.TV.backgroundHigher,foregroundColor:p.TV.backgroundHighest,speed:1.5,children:[(0,a.tZ)("rect",{x:"0",y:"0",rx:"2",ry:"2",width:"100",height:"4"}),(0,a.tZ)("rect",{x:"0",y:"6",rx:"2",ry:"2",width:"33",height:"4"})]})})},ci=n(39372),si=n(88961),li=n(62794),ui=n(10164);var di=function(e){var t=e.explanation,n=e.errorMessage,r=e.loading,i=e.codexFeedback,o=e.onRequestClose,c=e.onRequestExplainAgain,s=e.onExplainFail,l=e.onExplainSuccess,u=null;return u=r?(0,a.tZ)(oi,{}):t?(0,a.BX)("div",{css:[p.l0.p(8),p.l0.display.grid,{gridGap:p.TV.space8}],children:[(0,a.tZ)("pre",{css:{fontFamily:p.TV.fontFamilyCode,whiteSpace:"pre-wrap",lineHeight:p.TV.lineHeightDefault,fontSize:p.TV.fontSizeDefault,color:p.TV.foregroundDefault,backgroundColor:p.TV.backgroundHighest,padding:p.TV.space8,borderRadius:p.TV.borderRadius8},children:t}),r?null:(0,a.BX)(q.G7,{css:[p.l0.flex.row,p.l0.align.center,p.l0.width("100%"),p.l0.justify.spaceBetween],children:[i?(0,a.tZ)(q.zx,{disabled:!0,iconLeft:(0,a.tZ)(ci.Z,{}),small:!0,text:"Thanks for the feedback!"}):(0,a.BX)(q.G7,{css:[p.l0.align.center,p.l0.justify.start,p.l0.rowWithGap(8)],children:[(0,a.tZ)(q.xv,{variant:"small",color:"dimmer",children:"Is this a good explanation?"}),(0,a.tZ)(q.zx,{text:"Yes",onClick:l,small:!0,colorway:"positive",iconLeft:(0,a.tZ)(Tt.Z,{}),css:{backgroundColor:p.TV.backgroundHighest+" !important",":hover":{backgroundColor:p.TV.accentPositiveDimmest+" !important"}}}),(0,a.tZ)(q.zx,{text:"No",onClick:s,colorway:"negative",small:!0,iconLeft:(0,a.tZ)(pt.Z,{}),css:{backgroundColor:p.TV.backgroundHighest+" !important",":hover":{backgroundColor:p.TV.accentNegativeDimmest+" !important"}}})]}),(0,a.tZ)(q.G7,{css:[p.l0.fontSize(12)],children:(0,a.tZ)(li.Z,{feature:ui.l.AI})})]})]}):(0,a.tZ)(q.G7,{css:[p.l0.p(8)],children:(0,a.tZ)(q.E_,{colorway:"negative",icon:(0,a.tZ)(si.Z,{}),text:null!==n&&void 0!==n?n:"Oops! An unexpected error occurred. Please try again or contact support."})}),(0,a.tZ)(ii,{title:"Explain Code",newInferenceAlt:"Generate new explanation",learnMoreLink:"https://blog.replit.com/codex",onRequestNewInference:c,onRequestClose:o,width:420,children:u})},fi=X.Py.define({map:function(e,t){if(e)return e.map(t)}}),pi=H.tk.baseTheme({".explain-code-decoration":{background:q.TV.purpleDimmest}});function hi(e){var t=e.filePath,n=e.setExplainCodeParams,i=e.view,o=function(e){var n=e.getSelection,i=e.requestClose,o=e.onLayout;l.useLayoutEffect((function(){null===o||void 0===o||o()}),[o]);var s=Qr({code:n(),language:(0,Kr.UP)(t)}),u=s.explanation,d=s.errorMessage,f=s.loading,p=s.refetchExplanation,h=s.codexFeedback,m=s.giveCodexFeedback,v={explanation:u,errorMessage:d,loading:f,onRequestClose:i,onRequestExplainAgain:p,codexFeedback:h,onExplainFail:function(){return m(zr.TY.No)},onExplainSuccess:function(){return m(zr.TY.Yes)}};return A.createPortal((0,a.tZ)("div",{css:{left:"2em",position:"fixed"},children:(0,a.tZ)(di,(0,r.Z)({},v))}),c)},c=document.createElement("div");c.className="cm-explain-code-tooltip";var s={},u=X.QQ.define({create:function(){return null},update:function(e,t){var n=e;return(0,$.j)(t,fi,(function(e){n=e.value})),n&&!t.changes.empty&&(n=n.map(t.changes)),n},provide:function(e){return[H.hJ.compute([e],(function(t){var r=t.field(e);return r?{pos:r.from,end:r.to,create:function(){return function(e,t){var r=function(r){n({node:(0,a.tZ)(o,{getSelection:function(){return e.doc.sliceString(t.from,t.to)},requestClose:function(){i.dispatch({effects:[fi.of(null)]}),n(null)},onLayout:r})})};return r(),s.dom=c,s.update=function(e){r((function(){(0,H.E2)(e.view)}))},s}(t,r)}}:null})),H.tk.decorations.compute([e],(function(t){var n=t.field(e);return n?H.p.set(H.p.mark({class:"explain-code-decoration"}).range(n.from,n.to)):H.p.none}))]}});return[u,pi]}function mi(){var e=(0,ir.Z)(["\n  query TransformCodeEnabled($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        hasGenerateCode\n      }\n    }\n  }\n"]);return mi=function(){return e},e}var vi={},gi=(0,ar.ZP)(mi());function bi(){var e=function(e){var t=(0,r.Z)({},vi,e);return or.useQuery(gi,t)}({variables:{replId:(0,br.Z)()}}),t=e.data,n=e.loading;return{transformCodeEnabled:"Repl"===(null===t||void 0===t?void 0:t.repl.__typename)&&t.repl.hasGenerateCode,loading:n}}function xi(){var e=(0,ir.Z)(['\n  query SearchCodeEnabled($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        __typename\n      }\n    }\n    currentUser {\n      id\n      hasSearchCode: gate(feature: "flag-semantic-search-v1")\n    }\n  }\n']);return xi=function(){return e},e}var Zi={},yi=(0,ar.ZP)(xi());function wi(e){var t,n=function(e){var t=(0,r.Z)({},Zi,e);return or.useQuery(yi,t)}({variables:{replId:(0,br.Z)()}}).data,i=e.endsWith(".go")||e.endsWith(".js")||e.endsWith(".py");return"Repl"===(null===n||void 0===n?void 0:n.repl.__typename)&&((null===n||void 0===n||null===(t=n.currentUser)||void 0===t?void 0:t.hasSearchCode)&&i)}var ki=n(31557);function Ei(e){var t=e.activeFile,n=e.view,r=e.event,i=e.clipboardText,a=n.state.selection,o=function(){r||(a.main.empty?n.dispatch({changes:[{from:a.main.from,insert:i}]}):n.dispatch(n.state.replaceSelection(i||"")))};if(t&&"md"===(0,Gr.r6)(t))if(a.ranges.length>1)o();else if(a.main.from!==a.main.to)if(i&&(0,ki.Z)(i)){r&&r.preventDefault();var c=n.state.sliceDoc(a.main.from,a.main.to),s="[".concat(c,"](").concat(i,")");n.dispatch({changes:{from:a.main.from,to:a.main.to,insert:s}})}else o();else o();else o()}var Si=X.Py.define(),Ci=H.tk.baseTheme({".cm-tooltip.cm-generate-code-tooltip":{backgroundColor:"transparent",boxShadow:"none",border:"0 none",padding:"0px"},"& .cm-generate-code-tooltip .cm-content":{paddingBottom:"0px"}});function Ti(e){var t=e.view,n=e.setGenerateCodePortalProps,r=X.QQ.define({create:function(){return null},update:function(e,r){return(0,$.j)(r,Si,(function(i){e=i.value?function(e){return{pos:e.selection.main.head,above:!1,create:function(){var r=document.createElement("div");return r.className="cm-generate-code-tooltip",n({dom:r,onRequestClose:function(){t.dispatch({effects:Si.of(!1)})},selectedCode:e.doc.sliceString(e.selection.main.from,e.selection.main.to)}),{dom:r,offset:{x:-14,y:5}}}}}(r.state):null})),null==e||r.changes.empty||(e.pos=r.changes.mapPos(e.pos)),e},provide:function(e){return H.hJ.compute([e],(function(t){return t.field(e)}))}});return[r,Ci]}var Ri=X.Py.define(),_i=H.tk.baseTheme({".cm-tooltip.cm-transform-code-tooltip":{backgroundColor:"transparent",boxShadow:"none",border:"0 none",padding:"0px"},"& .cm-transform-code-tooltip .cm-content":{paddingBottom:"0px"}});function Ii(e){var t=e.view,n=e.setTransformCodePortalProps,r=X.QQ.define({create:function(){return null},update:function(e,r){return(0,$.j)(r,Ri,(function(i){e=i.value?function(e){return{pos:e.selection.main.head,above:!1,create:function(){var r=document.createElement("div");return r.className="cm-transform-code-tooltip",n({dom:r,onRequestClose:function(){t.dispatch({effects:Ri.of(!1)}),t.focus()},selectedCode:e.doc.sliceString(e.selection.main.from,e.selection.main.to),replaceCode:function(n){t.dispatch(e.replaceSelection(n))}}),{dom:r,offset:{x:-14,y:5}}}}}(r.state):null})),null==e||r.changes.empty||(e.pos=r.changes.mapPos(e.pos)),e},provide:function(e){return H.hJ.compute([e],(function(t){return t.field(e)}))}});return[r,_i]}var Pi=X.Py.define(),Di=H.tk.baseTheme({".cm-tooltip.cm-search-code-tooltip":{backgroundColor:"transparent",boxShadow:"none",border:"0 none",padding:"0px"},"& .cm-search-code-tooltip .cm-content":{paddingBottom:"0px"}});function Ai(e){var t=e.view,n=e.setSearchCodePortalProps,r=X.QQ.define({create:function(){return null},update:function(e,r){return(0,$.j)(r,Pi,(function(i){e=i.value?function(e){return{pos:e.selection.main.head,above:!1,create:function(){var r=document.createElement("div");return r.className="cm-search-code-tooltip",n({dom:r,onRequestClose:function(){t.dispatch({effects:Pi.of(!1)})},selectedCode:e.doc.sliceString(e.selection.main.from,e.selection.main.to),context:e.doc.toString()}),{dom:r,offset:{x:-14,y:5}}}}}(r.state):null})),null==e||r.changes.empty||(e.pos=r.changes.mapPos(e.pos)),e},provide:function(e){return H.hJ.compute([e],(function(t){return t.field(e)}))}});return[r,Di]}var Ni=n(55877),Ui=n.n(Ni),ji=X.Py.define(),Bi=X.Py.define(),Oi=X.Py.define(),Gi=X.Py.define(),Li=H.tk.baseTheme({".replit-thread-highlight":{background:q.TV.purpleDimmest}}),Mi=X.QQ.define({create:function(){return{}},update:function(e,t){var n=e;return(0,$.j)(t,ji,(function(e){n=e.value})),t.changes.empty?n:n=Object.values(n).map((function(e){return(0,D.Z)((0,r.Z)({},e),{indexStart:t.changes.mapPos(e.indexStart),indexEnd:t.changes.mapPos(e.indexEnd)})})).reduce((function(e,t){return e[t.id]=t,e}),{})}}),zi=X.QQ.define({create:function(){return null},update:function(e,t){var n=e;return(0,$.j)(t,Bi,(function(){var e=t.state,r=e.selection.main;n={id:Ui().v4(),indexStart:r.from,indexEnd:r.empty?Math.min(r.to+1,e.doc.length):r.to}})),(0,$.j)(t,Oi,(function(){n=null})),null!==n&&(0,$.j)(t,ji,(function(e){if(!n)throw new Error("expected newPlaceholder");e.value[n.id]&&(n=null)})),!t.changes.empty&&n&&(n=(0,D.Z)((0,r.Z)({},n),{indexStart:t.changes.mapPos(n.indexStart),indexEnd:t.changes.mapPos(n.indexEnd)})),n}}),Fi=n(67992),Xi=n(71171),Wi=n.n(Xi),Hi=n(25602);function Vi(e){var t=e.view,n=e.filePath,r=(0,L.Z)(n),a=l.useRef(null),o=l.useRef(0),c=(0,U.Z)(),s=c.anchorer,d=c.session,f=c.fs,p=(0,i.Z)(l.useState(null),2),h=p[0],m=p[1],v=(0,br.Z)(),g=ti({filePath:n,replId:v}),b=wi(n),x=bi().transformCodeEnabled,Z=(0,tn.Z)(),y=l.useCallback((function(){m(null)}),[]);l.useEffect((function(){var e=function(e){"Escape"===e.key&&m(null)};if(h)return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}),[h]),l.useEffect((function(){if(t&&h)return t.scrollDOM.addEventListener("scroll",y),function(){t.scrollDOM.removeEventListener("scroll",y)}}),[t,h,y]);var w=(0,Ar.Z)((function(){if(t&&h){var e=t.coordsAtPos(o.current);m((function(t){return e?{x:e.left,y:e.top}:t}))}}),{type:"throttle",wait:25}),k=l.useCallback(function(){var e=(0,j.Z)(O().mark((function e(o){var c,l,u,p,h,m,v,g,b,x,y,w,k,E,S,C;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h=function(e){return m.apply(this,arguments)},m=function(){return m=(0,j.Z)(O().mark((function e(o){var s,l,f,p,h,m,v,g,b;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r&&t){e.next=2;break}throw new Error("Expected client");case 2:return a.current&&r.notify.cancelRequest(a.current),a.current=r.generateId(),s=(0,V.s)(c.doc,u),e.next=7,o(n,s,{id:a.current,tap:(0,jn.M)(t)});case 7:if(l=e.sent,a.current=null,!("error"in l)){e.next=11;break}throw new Error("Something went wrong fetching location: ".concat(l.error.message));case 11:if(f=l.result,!l.cancelled&&f&&0!==f.length){e.next=14;break}return e.abrupt("return");case 14:p=(0,i.Z)(f,1),h=p[0],m=h.uri,v=h.range,g=v.start,b=r.documentUriToPath(m),d.updateDeeplink({path:b,line:g.line+1,col:g.character});case 19:case"end":return e.stop()}}),e)}))),m.apply(this,arguments)},t){e.next=4;break}throw new Error("Expected view");case 4:c=t.state,l=c.selection.main,u=l.head,p=function(){return{path:n,indexStart:l.from,indexEnd:l.empty?Math.min(l.to+1,c.doc.length):l.to,otVersion:f.getOTVersion(n)}},(0,Ut.j)(Ut.U3.EDITOR_CONTEXT_MENU_ACTION_RAN,{action:o}),e.t0=o,e.next=e.t0===en.D2.Cut?14:e.t0===en.D2.Copy?18:e.t0===en.D2.Paste?21:e.t0===en.D2.JumpToDefinition?34:e.t0===en.D2.JumpToTypeDefinition?39:e.t0===en.D2.JumpToImplementation?44:e.t0===en.D2.FindReferences?49:e.t0===en.D2.Rename?51:e.t0===en.D2.SelectAllOccurrences?53:e.t0===en.D2.CodeActions?61:e.t0===en.D2.ToggleBreakpoint?66:e.t0===en.D2.StartThread?69:e.t0===en.D2.ExplainCode?72:e.t0===en.D2.GenerateCode?74:e.t0===en.D2.TransformCode?76:e.t0===en.D2.SearchCode?78:e.t0===en.D2.CopyLinkToPos?80:84;break;case 14:return v=c.doc.sliceString(l.from,l.to),(0,Lr.Z)(v),t.dispatch(c.replaceSelection("")),e.abrupt("break",85);case 18:return g=c.doc.sliceString(l.from,l.to),(0,Lr.Z)(g),e.abrupt("break",85);case 21:return b="",e.prev=22,e.next=25,window.navigator.clipboard.readText();case 25:b=e.sent,e.next=32;break;case 28:return e.prev=28,e.t1=e.catch(22),Mr.kg.error("CodeMirror context menu paste failed",{message:e.t1.message}),e.abrupt("break",85);case 32:return Ei({activeFile:Z,view:t,clipboardText:b}),e.abrupt("break",85);case 34:if(r){e.next=36;break}throw new Error("Expected client");case 36:return e.next=38,h(r.request.findDefinitions);case 38:return e.abrupt("break",85);case 39:if(r){e.next=41;break}throw new Error("Expected client");case 41:return e.next=43,h(r.request.findTypeDefinitions);case 43:return e.abrupt("break",85);case 44:if(r){e.next=46;break}throw new Error("Expected client");case 46:return e.next=48,h(r.request.findImplementations);case 48:return e.abrupt("break",85);case 49:return t.dispatch({effects:[wt.of(u)]}),e.abrupt("break",85);case 51:return t.dispatch({effects:[It.of(u)]}),e.abrupt("break",85);case 53:if(!c.selection.main.empty){e.next=58;break}if(x=c.wordAt(u)){e.next=57;break}return e.abrupt("return");case 57:t.dispatch({selection:x});case 58:return(0,Rr.tm)(t),t.focus(),e.abrupt("break",85);case 61:if(y=t.coordsAtPos(u)){e.next=64;break}return e.abrupt("return");case 64:return t.dispatch({effects:[dn.of(y)]}),e.abrupt("break",85);case 66:return w=c.doc.lineAt(u),$n(t,w.from),e.abrupt("break",85);case 69:return s.createThread(p()),t.dispatch({effects:[Bi.of(null),Fi.UQ.of(Wi()())]}),e.abrupt("break",85);case 72:return t.dispatch({effects:fi.of(t.state.selection.main)}),e.abrupt("break",85);case 74:return t.dispatch({effects:Si.of(!0)}),e.abrupt("break",85);case 76:return t.dispatch({effects:Ri.of(!0)}),e.abrupt("break",85);case 78:return t.dispatch({effects:Pi.of(!0)}),e.abrupt("break",85);case 80:return k=(0,V.s)(c.doc,u),E=k.line,S=k.character,C=(0,Hi.dr)({path:n,line:E+1,col:S}),(0,Lr.Z)(C),e.abrupt("break",85);case 84:throw new Error("Unexpected action: ".concat(o));case 85:case"end":return e.stop()}}),e,null,[[22,28]])})));return function(t){return e.apply(this,arguments)}}(),[t,r,n,d,s,f,Z]),E=(0,i.Z)(l.useState(!1),2),S=E[0],C=E[1];(0,gn.Z)({view:t,initialExtension:H.tk.updateListener.of((function(e){e.transactions.some((function(e){return e.reconfigured}))&&C("undefined"!==typeof e.view.state.field(qn,!1))}))});var T=z(r),R=l.useMemo((function(){if(!t)return[];var e=[];return T&&(T.isFindDefinitionSupported&&e.push(en.D2.JumpToDefinition),T.isFindTypeDefinitionSupported&&e.push(en.D2.JumpToTypeDefinition),T.isFindImplementationSupported&&e.push(en.D2.JumpToImplementation),(T.isFindDefinitionSupported||T.isFindReferencesSupported)&&e.push(en.D2.FindReferences),T.isRenameSupported&&e.push(en.D2.Rename),T.isCodeActionsSupported&&e.push(en.D2.CodeActions)),e.push(en.D2.SelectAllOccurrences),e.push(en.JJ),e.push(en.D2.CopyLinkToPos),S&&e.push(en.D2.ToggleBreakpoint),e.push(en.D2.StartThread),g&&e.push(en.D2.ExplainCode),e.push(en.D2.GenerateCode),x&&e.push(en.D2.TransformCode),b&&e.push(en.D2.SearchCode),e.push(en.JJ),e.push(en.D2.Cut),e.push(en.D2.Copy),window.navigator.clipboard&&"readText"in window.navigator.clipboard&&e.push(en.D2.Paste),e}),[t,T,S,g,b,x]),_=(0,gn.Z)({view:t});return l.useEffect((function(){if(t){var e=R.filter((function(e){return!(0,en.s3)(e)})).filter((function(e){return"keyboardShortcut"in en.Wo[e]})).filter((function(e){return e!==en.D2.Cut&&e!==en.D2.Copy&&e!==en.D2.Paste})).map((function(e){var t=en.Wo[e].keyboardShortcut,n={key:t.key,preventDefault:!0,run:function(){return k(e),!0}};return t.altKey&&(n.key="Alt-".concat(n.key)),t.shiftKey&&(n.key="Shift-".concat(n.key)),t.cmdOrCtrlKey&&(n.key="Mod-".concat(n.key)),n}));return t.dispatch({effects:_.reconfigure(H.$f.of(e))}),function(){t.dispatch({effects:_.reconfigure([])})}}}),[t,k,R,_]),{onAction:k,actions:R,contextMenuCoords:h,onContextMenu:function(e){if(!(0,u.isMobile)({tablet:!1})&&t){e.preventDefault();var r=e.clientX,i=e.clientY,a=t.state.selection.main,c=t.posAtCoords({x:r,y:i}),s=t.state.doc.length,l=null===c?s:c;if(o.current=l,l<a.from||l>a.to){var d=X.jT.cursor(l);t.dispatch({selection:d})}var f=(0,Gr.r6)(n);(0,Ut.j)(Ut.U3.EDITOR_CONTEXT_MENU_OPENED,{ext:f}),m({x:r,y:i})}},closeMenu:y,resizeRef:w}}function $i(){var e=(0,ir.Z)(["\n  query DeprecatedLanguageConfig($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        deprecatedLanguageConfig {\n          id\n          mainFile\n        }\n      }\n    }\n  }\n"]);return $i=function(){return e},e}var qi={},Qi=(0,ar.ZP)($i());function Ki(e){var t=function(e){var t=(0,r.Z)({},qi,e);return or.useQuery(Qi,t)}({variables:{replId:e.replId}}).data;return"Repl"===(null===t||void 0===t?void 0:t.repl.__typename)?t.repl.deprecatedLanguageConfig:null}function Yi(e){var t=e.view,n=e.line,r=e.col,i=t.state.doc,a=Math.min(n,i.lines),o=i.line(a),c=o.to,s=o.from,l=r||0,u=Math.min(s+l,c),d=X.jT.cursor(u);t.dispatch({selection:d,scrollIntoView:!0}),t.focus()}var Ji=n(98403),ea=n(91131),ta=n(20934),na=H.tk.baseTheme({".replit-code-anchor":{background:"var(--accent-purple-dimmest)"}}),ra=X.Py.define(),ia=X.Py.define(),aa=X.Py.define(),oa=X.Py.define(),ca=function(e){var t={};return X.QQ.define({create:function(){return[]},update:function(e,t){t.changes.empty||(e=e.map((function(e){return(0,D.Z)((0,r.Z)({},e),{indexStart:t.changes.mapPos(e.indexStart),indexEnd:t.changes.mapPos(e.indexEnd)})})));var n=!0,i=!1,a=void 0;try{for(var c,s=function(){var t=c.value;if(t.is(ra))e=t.value;else if(t.is(ia))e=(0,o.Z)(e).concat((0,o.Z)(t.value.filter((function(t){return!e.find((function(e){return e.id===t.id}))}))));else if(t.is(aa)){var n=t.value.map((function(e){return e.id}));e=e.filter((function(e){return!n.includes(e.id)}))}else t.is(Ji.R)&&(e=(0,o.Z)(e))},l=t.effects[Symbol.iterator]();!(n=(c=l.next()).done);n=!0)s()}catch(u){i=!0,a=u}finally{try{n||null==l.return||l.return()}finally{if(i)throw a}}return e},provide:function(n){return[H.tk.decorations.compute([n],(function(e){var t=e.field(n);return H.p.set(t.map((function(e){return t=e.id,n=e.indexStart,r=e.indexEnd,n===r?null:H.p.mark({class:"replit-code-anchor ".concat(t),id:t}).range(n,r);var t,n,r})).filter((function(t){return null!==t&&t.from!==t.to&&t.from<=e.doc.length&&t.to<=e.doc.length})),!0)})),H.hJ.computeN([n],(function(r){return r.field(n).map((function(n){var r,i,a=n.id;return{pos:Math.min(n.indexStart,n.indexEnd),above:!0,create:(r=a,i=function(t){var r=document.createElement("div");r.classList.add("cm-anchor","cm-anchor-".concat(a));var i=document.createElement("div");i.classList.add("cm-anchor-portal"),i.style.position="absolute",r.appendChild(i);var o={id:a,dom:i,getEditorRight:function(){return t.dom.getBoundingClientRect().right},getContent:function(){return t.state.doc.sliceString(n.indexStart,n.indexEnd)}};return e.setAnchorPortal(o),{dom:r,update:function(){e.setAnchorPortal(o)}}},t[r]||(t[r]=i),t[r])}}))}))]}})};var sa=n(61134),la=n(11163),ua=n.n(la),da=n(50119),fa=n(15902);var pa=n(60523);function ha(e){var t=e.view,n=e.filePath,r=e.isLoading,i=function(){var e=(0,l.useContext)(pa.Z);if(!e)throw new Error("Expected codemirror state to be in codemirror state context");return e}(),a=(0,gn.Z)({view:t});(0,l.useEffect)((function(){if(t&&!r){var e,c=i.current.fileMap.get(n);if(c&&t.state.doc.eq(c.doc)){if(t.state.field(v.cE,!1))throw new Error("History was preconfigured on this view, if you want to use state cache, please make sure history is not already configured for this view");var s=[];c.foldedRanges.between(0,t.state.doc.length,(function(e,t){s.push(we.SW.of({from:e,to:t}))})),t.dispatch({effects:(0,o.Z)(s).concat([H.tk.scrollIntoView(c.scrollPos,{y:"start"})]),selection:c.selection}),e=[v.cE.init((function(){return c.history})),(0,v.m8)()]}else e=(0,v.m8)();var l=!1;return t.dispatch({effects:a.reconfigure([e,H.tk.updateListener.of((function(e){l||(l=!0,requestAnimationFrame((function(){var t;l&&(l=!1,t=e.view,i.current.fileMap.set(n,{history:t.state.field(v.cE,!1),foldedRanges:(0,we.q2)(t.state),scrollPos:ma(t),selection:t.state.selection,doc:t.state.doc}))})))}))])}),function(){l=!1,t.dispatch({effects:a.reconfigure([])})}}}),[t,n,i,r,a])}function ma(e){var t=e.scrollDOM.getBoundingClientRect().top+e.defaultLineHeight;return e.posAtCoords({x:0,y:t},!1)}var va=n(65456),ga=n(35256),ba=/\r\n?|\n/;function xa(e){return e.replace(new RegExp(ba,"g"),"\n")}function Za(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length;return e.slice(t,n+1).split(/\r\n/g).length-1}function ya(e,t){var n=t,r=0,i=0;do{i=Za(e,r,n),r=n,n+=i}while(i);return n}function wa(e,t){var n=[],r=t;return e.iterChanges((function(e,i,a,o,c){var s=[];a>0&&s.push(ya(r,a)),e<i&&s.push({d:ya(t,i)-ya(t,e)}),c.length&&s.push(c.sliceString(0)),r=(0,ga.apply)(r,s),n=(0,ga.compose)(n,s)})),n}function ka(e,t){var n=[],r=0,i=0,a=!0,o=!0,c=!1,s=void 0;try{for(var l,u=e[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var d=l.value;if("string"===typeof d){var f=d;if(d.endsWith("\r")&&"\n"===t.slice(r,r+1)&&0===(f=d.slice(0,-1)).length)continue;if(f=xa(f),a)n.push({from:i,insert:f});else{var p=n[n.length-1];p.insert=p.insert?p.insert+f:f}a=!1}else if("number"===typeof d){var h=Za(t,r,r+d);r+=d,i+=d-h,a=!0}else if("object"===typeof d&&"number"===typeof d.d){var m=d.d;if("\r\n"===t.slice(r-1,r+1)&&(i+=1,m-=1),(m-=Za(t,r,r+d.d))>0)if(a)n.push({from:i,to:i+m});else{var v=n[n.length-1];v.insert&&!v.to?v.to=i+m:v.to&&(v.to+=m)}r+=d.d,i+=m,a=!1}}}catch(g){c=!0,s=g}finally{try{o||null==u.return||u.return()}finally{if(c)throw s}}return n}var Ea=X.q6.define();function Sa(e,t){var n=t;return H.tk.updateListener.of((function(t){if(t.docChanged){var r=[],i=!0,a=!1,o=void 0;try{for(var c,s=t.transactions[Symbol.iterator]();!(i=(c=s.next()).done);i=!0){var l=c.value,u=wa(l.changes,n);n=(0,ga.apply)(n,u),l.annotation(X.YW.remote)||l.annotation(Ea)||(r=(0,ga.compose)(r,u))}}catch(d){a=!0,o=d}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}r.length&&e(r,n)}}))}var Ca=X.QQ.define({create:function(){return 0},update:function(e,t){var n=t.annotation(Ea);return n?n.version:e}}),Ta=n(58967);function Ra(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=n[0],i=n[n.length-1],a=new Set(n.map((function(e){return e.userId}))),o=new Map(n.map((function(e){return[e.userId,e.version]})));return{firstKnownOp:r,recentKnownOp:i,receivedLocalOp:e,receivedRemoteOp:t,clientKnownPlayers:a.size,hasPlayerZero:a.has(0),knownUserIds:a,recentVersionByUserId:o}}function _a(e){var t=e.view,n=e.fs,i=e.filePath,a=function(e,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(0,j.Z)(O().mark((function e(){return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{});case 1:case"end":return e.stop()}}),e)})));if(!h.current.has(i)&&t){var o=t.state.doc.toString(),c=e===o;c||(h.current.add(i),a().then((function(t){Mr.kg.error("Mismatch between otClient and codemirror",(0,r.Z)({otcrlf:e.indexOf("\r")>-1,ot:e,cm:o,path:i,changeSource:n},t))})).catch((function(e){an.Tb(e),Mr.kg.error("Mismatch between otClient and CodeMirror, but I swallowed up an error and lost all the metadata, sorry.",{err:e})})))}},o=(0,l.useState)(null),c=o[0],s=o[1],u=(0,ln.Z)(),d=(0,l.useRef)({local:0,codemirror:0,container:0}),f=(0,l.useRef)(Date.now()),p=(0,gn.Z)({view:t}),h=(0,l.useRef)(new Set),m=(0,Ta.Z)().trackTimeToLoadFileEnd,v=(0,l.useRef)("");(0,l.useEffect)((function(){if(t&&n&&i){var e=n.watchOtFile(i,{onChange:function(){var e=(0,j.Z)(O().mark((function e(t){var n;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.latestContent,v.current=n;case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()});return e}}),[t,i,n]);var g=(0,l.useRef)(),b=(0,l.useRef)();return(0,l.useEffect)((function(){if(t){var e="",o=n.watchOtFile(i,{onReady:function(o){var c=o.initialContent,l=o.fetchOps,u=o.writeOp,h=o.version;g.current=l,b.current=h,m(i),d.current.codemirror++,t.dispatch({changes:{from:0,to:t.state.doc.length,insert:xa(c.toString())},annotations:[X.YW.addToHistory.of(!1),X.YW.remote.of(!0)]}),t.dispatch({effects:p.reconfigure([Ca.init((function(){return h})),Sa((function(t,o){e=o,u(t),d.current.codemirror++,a(v.current,"CODEMIRROR",(0,j.Z)(O().mark((function e(){var a;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.getOTVersion(i),e.t0=r.Z,e.t1={origin:"view-writer",readyVersion:h,knownVersion:a,countOpsSinceLoad:d.current,timeInitialized:f.current},e.t2=Ra,e.t3=t,e.next=7,l(1,a);case 7:return e.t4=e.sent,e.t5=(0,e.t2)(e.t3,null,e.t4),e.abrupt("return",(0,e.t0)(e.t1,e.t5));case 10:case"end":return e.stop()}}),e)}))))}),c.toString())])}),e=c.toString(),s(i)},onChange:function(o){var c=o.op,s=o.changeSource,l=o.version,u=o.latestContent;t.dispatch(function(e){var t=e.op,n=e.version,r=e.changeSource;return{changes:ka(t,e.replitDoc),annotations:[X.YW.remote.of(r===va.Fl.Container),X.YW.addToHistory.of(r===va.Fl.Local),Ea.of({op:t,version:n,changeSource:r})]}}({op:c,changeSource:s,version:l,replitDoc:e})),e=u,"LOCAL"===s?d.current.local++:"CONTAINER"===s&&d.current.container++,a(u,s,(0,j.Z)(O().mark((function e(){var t;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.getOTVersion(i),e.t0=r.Z,e.t1={origin:"fs-change",changeVersion:l,readyVersion:b.current,knownVersion:t,countOpsSinceLoad:d.current,timeInitialized:f.current},e.t2=Ra,e.t3=c,!g.current){e.next=11;break}return e.next=8,g.current(1,t);case 8:e.t4=e.sent,e.next=14;break;case 11:return e.next=13,Promise.resolve([]);case 13:e.t4=e.sent;case 14:return e.t5=e.t4,e.t6=(0,e.t2)(null,e.t3,e.t5),e.abrupt("return",(0,e.t0)(e.t1,e.t6));case 17:case"end":return e.stop()}}),e)}))))},onError:function(){t.dispatch({effects:p.reconfigure([])})},onMoveOrDelete:function(){t.dispatch({effects:p.reconfigure([])})}});return function(){o(),t.dispatch({effects:[p.reconfigure([])]}),u.current&&s(null)}}}),[t,i,n,u,p]),{loadedFile:c}}var Ia=n(58502),Pa={"#1BC47D":"rgba(27, 196, 125, 0.2)","#EF5533":"rgba(239, 85, 51, 0.2)","#18A0FB":"rgba(24, 160, 251, 0.2)","#FFC700":"rgba(255, 199, 0, 1)","#907CFF":"rgba(144, 124, 255, 0.2)","#00B5CE":"rgba(0, 181, 206, 0.2)","#EE46D3":"rgba(238, 70, 211, 0.2)"};var Da=X.Py.define(),Aa=X.Py.define(),Na=X.Py.define();function Ua(e){return{pos:e.position,strictSide:!0,above:!0,create:e.createCursorTooltipFunction}}var ja=X.QQ.define({create:function(){return{}},update:function(e,t){if(!t.changes.empty){var n={},a=!0,o=!1,c=void 0;try{for(var s,l=Object.values(e)[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var u=s.value;n[u.id]=(0,D.Z)((0,r.Z)({},u),{position:t.changes.mapPos(u.position),selectionStart:t.changes.mapPos(u.selectionStart),selectionEnd:t.changes.mapPos(u.selectionEnd)})}}catch(g){o=!0,c=g}finally{try{a||null==l.return||l.return()}finally{if(o)throw c}}e=n}var d=!0,f=!1,p=void 0;try{for(var h,m=function(){var n=h.value;if(n.is(Ji.R)&&(e=(0,r.Z)({},e)),n.is(Da)&&n.value.position<=t.newDoc.length&&((e=(0,r.Z)({},e))[n.value.id]=(0,D.Z)((0,r.Z)({},n.value),{createCursorTooltipFunction:function(e){var t=n.value,r=document.createElement("div");r.textContent=t.username,r.style.backgroundColor=t.color.cursor,r.style.color="white",r.classList.add("multiplayer-label");var i=document.createElement("div");i.style.backgroundColor=t.color.cursor,i.classList.add("multiplayer-cursor");var a=document.createElement("div");return a.classList.add("multiplayer-tooltip"),a.appendChild(i),a.appendChild(r),{dom:a,overlap:!0,positioned:function(){i.style.height=e.defaultLineHeight+"px"}}}})),n.is(Aa)&&(e=(0,r.Z)({},e),n.is(Aa)&&delete e[n.value]),n.is(Na)){e=(0,r.Z)({},e);var a=!0,o=!1,c=void 0;try{for(var s,l=Object.entries(e)[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var u=(0,i.Z)(s.value,2),d=u[0];u[1].username===n.value&&delete e[d]}}catch(g){o=!0,c=g}finally{try{a||null==l.return||l.return()}finally{if(o)throw c}}}},v=t.effects[Symbol.iterator]();!(d=(h=v.next()).done);d=!0)m()}catch(g){f=!0,p=g}finally{try{d||null==v.return||v.return()}finally{if(f)throw p}}return e},provide:function(e){return[H.hJ.computeN([e],(function(t){return Object.values(t.field(e)).map(Ua)})),H.tk.decorations.computeN([e],(function(t){var n=t.field(e);return Object.values(n).map((function(e){var t=e.selectionStart<e.selectionEnd?e.selectionStart:e.selectionEnd,n=e.selectionStart>e.selectionEnd?e.selectionStart:e.selectionEnd;return t===n?null:H.p.set(H.p.mark({attributes:{style:"background-color: ".concat(e.color.selection,"; display: inline-block;")},cursor:e}).range(t,n))})).filter((function(e){return null!==e}))}))]}});function Ba(e){return H.tk.updateListener.of((function(t){var n=t.state.selection;n!==t.startState.selection&&(t.transactions.every((function(e){return e.annotation(X.YW.remote)}))||e(n.ranges.map((function(e){var n=t.state.doc.lineAt(e.head);return{position:e.head,line:n.number,column:e.head-n.from+1,selectionStart:e.from,selectionEnd:e.to}})),n.mainIndex))}))}function Oa(e){var t=e.view,n=e.presence,i=e.session,a=e.fs,o=e.filePath,c=(0,l.useState)(null),s=c[0],u=c[1],d=(0,Ia.Z)({presence:n}),f=(0,l.useRef)({}),p=(0,ln.Z)();(0,l.useEffect)((function(){var e=d.reduce((function(e,t){return t.username&&t.color?(0,D.Z)((0,r.Z)({},e),(0,ve.Z)({},t.username,t.color)):e}),{});f.current=e}),[d]);var h=(0,gn.Z)({view:t});return(0,l.useEffect)((function(){if(t){var e=n.onUserLeave((function(e){t.dispatch({effects:Na.of(e.username)})})),r=a.watchOtFile(o,{onReady:function(e){var n=e.updateSelections;t.dispatch({effects:h.reconfigure([ja,Ba((function(e,t){n(e);var r=e[t];r&&i.setCursorPosition({column:r.column,lineNumber:r.line,offset:r.position})}))])}),u(o)},onCursor:function(e){var n=function(e){var t,n=e.cursor,r=e.usernameColorsMap,i=null===(t=n.user)||void 0===t?void 0:t.name;if(i){var a,o=n.id,c=n.position,s=n.selectionStart,l=n.selectionEnd,u=r[i];if(u&&o&&"number"===typeof c&&"number"===typeof s&&"number"===typeof l)return Da.of({id:o,username:i,position:c,color:{cursor:u,selection:(a=u,Pa[a]||"")},selectionStart:s,selectionEnd:l})}}({cursor:e,usernameColorsMap:f.current});n&&t.dispatch({effects:n})},onRemoveCursor:function(e){t.dispatch({effects:Aa.of(e)})},onError:function(){t.dispatch({effects:h.reconfigure([])})},onMoveOrDelete:function(){t.dispatch({effects:h.reconfigure([])})}});return function(){e(),r(),t.dispatch({effects:h.reconfigure([])}),p.current&&u(null)}}}),[t,o,a,n,i,h]),{loadedFile:s}}var Ga=n(86601);function La(e){var t=e.view,n=e.presence,r=e.session,i=e.fs,a=e.filePath,o=_a({view:t,fs:i,filePath:a}).loadedFile,c=Oa({view:t,fs:i,filePath:a,presence:n,session:r}).loadedFile;!function(e){var t=e.view,n=(0,U.Z)().presence,r=(0,Ga.Z)(),i=(0,gn.Z)({view:t});l.useEffect((function(){if(r&&t){var e=function(){n.getFollowedUser()&&n.unfollowUser()};return t.dispatch({effects:i.reconfigure(H.tk.domEventHandlers({wheel:e,keydown:function(t){"Control"!==t.key&&"Meta"!==t.key&&e()},click:e}))}),function(){t.dispatch({effects:i.reconfigure([])})}}}),[r,t,n,i]);var a=(0,gn.Z)({view:t});l.useEffect((function(){var e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(t){var n=X.jT.cursor(e);t.dispatch({effects:[H.tk.scrollIntoView(n,{x:"center",y:"center"})]})}};if(t&&r){var n=t.state.field(ja,!1);if(n){var i=Object.values(n).find((function(e){return e.username===r.username}));i&&e(i.position)}return t.dispatch({effects:a.reconfigure(H.tk.updateListener.of((function(t){var n,i=!0,a=!1,o=void 0;try{for(var c,s=t.transactions[Symbol.iterator]();!(i=(c=s.next()).done);i=!0){var l=c.value,u=!0,d=!1,f=void 0;try{for(var p,h=l.effects[Symbol.iterator]();!(u=(p=h.next()).done);u=!0){var m=p.value;m.is(Da)&&m.value.username===r.username&&(n=m.value)}}catch(v){d=!0,f=v}finally{try{u||null==h.return||h.return()}finally{if(d)throw f}}}}catch(v){a=!0,o=v}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}n&&e(n.position)})))}),function(){t.dispatch({effects:a.reconfigure([])})}}}),[t,r,a])}({view:t});var s=a!==o||a!==c,u=(0,gn.Z)({view:t});return(0,l.useEffect)((function(){t&&t.dispatch({effects:u.reconfigure([H.tk.editable.of(!s),X.yy.readOnly.of(s)])})}),[t,s,u]),{isLoading:s}}var Ma=n(88812);var za=n(62808),Fa=n(65674);var Xa=n(88662),Wa=n(28067),Ha=n(32703),Va=RegExp("_(?<num>\\d+)$");function $a(e,t){return qa.apply(this,arguments)}function qa(){return qa=(0,j.Z)(O().mark((function e(t,n){var r,i,a,o;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,Gr.Il)(n),e.next=3,t.readDir(r||".");case 3:if(!(i=e.sent).error){e.next=6;break}return e.abrupt("return",n);case 6:return a=function(e){if(i.children.find((function(t){return"FILE"===t.type&&t.filename===e}))){var t,n=(0,Gr.eb)(e),r=(0,Gr.r6)(e),o=n.match(Va);if(null===o||void 0===o||null===(t=o.groups)||void 0===t?void 0:t.num){var c=Number(o.groups.num);return a("".concat(n.replace(Va,""),"_").concat(c+1,".").concat(r))}return a("".concat(n,"_2.").concat(r))}return e},o=a((0,Gr.UO)(n)),e.abrupt("return",r?r+"/"+o:o);case 9:case"end":return e.stop()}}),e)}))),qa.apply(this,arguments)}var Qa=n(58794),Ka=function(){var e=(0,j.Z)(O().mark((function e(t,n,r){var i,a,o,c,s,l;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=encodeURI(t.name),a=(0,Gr.Il)(r),e.next=4,$a(n,a?a+"/"+i:i);case 4:return o=e.sent,e.next=7,(0,Ha.pV)(t);case 7:return c=e.sent,e.next=10,n.writeFile(o,Qa.Z.from(c));case 10:return s=(0,Gr.eb)(t.name),l=(0,Gr.UO)(o),e.abrupt("return","![".concat(s,"](").concat(l,")"));case 13:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();var Ya=function(e){(0,xe.Z)(n,e);var t=(0,ye.Z)(n);function n(e,r){var i;return(0,be.Z)(this,n),(i=t.call(this)).src=e,i.pos=r,i}var r=n.prototype;return r.eq=function(e){return this.src===e.src&&this.pos===e.pos},r.toDOM=function(){var e=document.createElement("img");return e.src=this.src,e.dataset.pos=this.pos.toString(),e.style.maxHeight="64px",e.style.maxWidth="256px",e},r.ignoreEvent=function(){return!1},n}(H.l9),Ja=/"data:image\/\w+;base64,[^"\s]+"/g,eo=Number.MAX_VALUE,to=H.lg.define((function(e){var t=new H.Y1({regexp:Ja,decoration:function(e,t,n){if(void 0===e[0])throw new Error("Failed to match image");var r=e[0].substring(1,e[0].length-1);return H.p.replace({widget:new Ya(r,n)})},maxLength:eo});return{matcher:t,deco:t.createDeco(e),update:function(e){e.docChanged&&(this.deco=t.updateDeco(e,this.deco))}}}),{decorations:function(e){return e.deco},provide:function(e){return H.tk.atomicRanges.of((function(t){var n=t.plugin(e);return n?n.deco:H.p.none}))}});var no=n(73138),ro=n(99336);var io,ao=n(2236),oo=n(81896),co=n(8054);function so(e){var t=e.onComplete,n=e.onEscape,r=null,i=null;return H.tk.domEventHandlers({touchstart:function(e){i=null,r=e.targetTouches[0].clientX},touchmove:function(e){i=e.targetTouches[0].clientX},touchend:function(e,a){if(r&&i)return r-i<-50&&t(a),n(a),!0}})}function lo(e,t){var n=e.doc.lineAt(e.selection.main.head);if(e.doc.sliceString(e.selection.main.head,n.to).replace(/[\s)\]}"'`]/g,"").length)return io.Stop;var r="";return t.iterChanges((function(e,t,n,i,a){r=a.toString()})),r?[":","(","[","{",'"',"'"].includes(r[0])?io.Now:io.Enqueue:io.Stop}!function(e){e[e.Stop=0]="Stop",e[e.Enqueue=1]="Enqueue",e[e.Now=2]="Now"}(io||(io={}));var uo=X.Py.define(),fo=X.Py.define(),po=X.Py.define(),ho=X.Py.define();function mo(e,t){return H.p.widget({widget:new vo(e),side:1}).range(t)}var vo=function(e){(0,xe.Z)(n,e);var t=(0,ye.Z)(n);function n(e){var r;return(0,be.Z)(this,n),(r=t.call(this)).code=e,r}var r=n.prototype;return r.eq=function(e){return e.code===this.code},r.toDOM=function(){var e=document.createElement("span");return e.className="gray-text",e.innerText=this.code,e},r.updateDOM=function(e){return e.innerText=this.code,!0},r.ignoreEvent=function(){return!1},n}(H.l9),go=new Set(["Block","FunctionDeclaration","ClassBody","CatchClause"]),bo=new Set((0,o.Z)(go).concat(["ArgList","ArrayPattern","ArrayExpression","FormalParameters","ParamList","ParenthesizedExpression","String","JSXAttributeValue","JSXEndTag","JSXEscape","JSXOpenTag","ObjectExpression","TemplateString","TypeParamList","ArgumentList","ArrayInitializer","Dimension","InferredParameters","TypeParameters","CompoundStatement","LambdaCaptureSpecifier","ParameterList","PropertyName","SystemLibString","FieldDeclarationList"]));function xo(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(bo.has(e.type.name))return{start:{from:e.from,to:e.from+1},end:{from:e.to-1,to:e.to}};if(t){var n=e.parent();if(n)return xo(e)}}var Zo=new Set(["(","[","{","<","`",'"',"'"]);function yo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.selection.main.head,n=e.doc.sliceString(t-1,t),i=xo((0,we.qz)(e).cursorAt(t),!Zo.has(n));if(i)return(0,D.Z)((0,r.Z)({},i),{bracket:e.doc.sliceString(i.end.from,i.end.to)});var a=(0,we.Um)(e,t-1,1);return(null===a||void 0===a?void 0:a.end)?{start:a.start,end:a.end,bracket:e.doc.sliceString(a.end.from,a.end.to)}:void 0}function wo(e){return e.split("").reverse().join("")}function ko(e){if(!e[0]||1===e.length)return e[0]||"";for(var t=0;e[0][t]&&e.every((function(n){return n[t]===e[0][t]}));)t++;return e[0].substring(0,t)}function Eo(e){return wo(ko(e.map(wo)))}function So(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(e.length<1)return{halt:!1};for(var i=e[e.length-1],a=null!==r?i.split(r):e,o=1;o<=n;o++){var c=!1;if(a.length<o+t)break;for(var s=t;s>0;s--)if(a[a.length-s]!==a[a.length-s-o]){c=!0;break}if(!c)return{halt:!0,truncate:e.length-1}}return{halt:!1}}function Co(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;if(e.length<t)return{halt:!1};if(e[e.length-1].trim().length<n)return{halt:!1};var r=e[e.length-1]===e[e.length-t-1];return r?{halt:!0,truncate:e.length-t}:{halt:!1}}var To=function(e,t){return e.length<t.length},Ro=function(e,t){var n=""===e?1:parseInt(e,10),r=parseInt(t,10);return!isNaN(n)&&!isNaN(r)&&n+1===r};function _o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:To,a=e;if(a.length<t)return{halt:!1};var o=a.slice(-1*t),c=ko(o),s=Eo(o);if(c.length<n||s.length<r)return{halt:!1};for(var l=null,u=0;u<t;u++){var d=o[u].substring(c.length),f=d.substring(0,d.length-s.length);if(l&&!i(l,f))return{halt:!1};l=f}return{halt:!0,truncate:a.length-t}}var Io=[function(e){return function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=1;r<t;r++){var i=Co(e,r,n);if(i.halt)return i}return{halt:!1}}(e,8,3)},function(e){return _o(e,3,6,3,To)},function(e){return _o(e,3,6,1,Ro)},function(e){return So(e,12,12," ")},function(e){return So(e,8,16,"")}];function Po(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Io;return function(t){for(var n=t.split("\n"),r=n.slice(0,-1),i=0;i<e.length;i++){var a=e[i](n);if(a.halt)return{halt:!0,truncate:n.slice(0,a.truncate).join("\n")};var o=e[i](r);if(o.halt)return{halt:!0,truncate:r.slice(0,o.truncate).join("\n")}}return{halt:!1}}}function Do(e){var t;return(null===(t=e.match(/^\s*/))||void 0===t?void 0:t[0].length)||0}function Ao(e){return(e+"\n").slice(0,e.indexOf("\n"))}function No(e,t){var n=(0,we.qz)(e).resolveInner(t);return!!go.has(n.type.name)&&!e.sliceDoc(n.from+1,n.to-1).trim().length}function Uo(e,t){var n=e.split("\n").map((function(e,t,n){return e+(t===n.length-1?"":"\n")})),r=n.findIndex((function(e,n){return n>0&&Do(e)<t||0===n&&/^\s*[)\]};]+\n?$/.test(e)}));if(-1!==r)return r===n.length-1?e:n.slice(0,r+1).join("").slice(0,-1)}var jo=Po();function Bo(e,t){var n="",r=t.trimEnd().replace(/^\n*/,(function(e){return n=e,""}));n&&0===e.doc.lineAt(e.selection.main.head).text.trim().length&&(n=n.slice(1));var i=function(e,t){var n,r,i=e.selection.main.head,a=e.doc.lineAt(i),o=Do(a.text);return No(e,i)?null!==(n=Uo(t,o))&&void 0!==n?n:t:e.doc.sliceString(a.from,i).trim().length?Ao(t):null!==(r=Uo(t,o))&&void 0!==r?r:Ao(t)}(e,r).trimEnd(),a=jo(i),o=a.halt,c=a.truncate,s=i;return o&&c&&(s=c),s?n+s:""}var Oo=function(){function e(t){(0,be.Z)(this,e),Object.assign(this,t)}return e.prototype.update=function(t){return new e((0,r.Z)({},this,t))},e}(),Go=function(){function e(t){(0,be.Z)(this,e),Object.assign(this,t)}var t=e.prototype;return t.updateOnInput=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.selection.main.head,r=this,i=r.activeTextIndex,a=r.activeTextCursor,o=r.activeText,c=o.text.slice(a);if(o.text[a]===t[0]&&["()","[]","{}",'""',"''"].includes(t)){var s=t[1],l=e.update({changes:{from:n,insert:o.text.slice(a)}}),u=l.state,d=yo(u,n+1);if(!(null===d||void 0===d?void 0:d.end))return null;var f=d.end.to-o.startPos,p=[new Oo({text:o.text.slice(0,f-1),endBracket:s,startPos:o.startPos}),new Oo({text:o.text.slice(f),startPos:n+t.length,endBracket:o.endBracket})];return this.updateCursor((function(e){return e+1})).updateTexts((function(e,n){return n===i?p:n>i?e.update({startPos:e.startPos+t.length}):e}))}return c.startsWith(t)?this.updateCursor((function(e){return e+t.length})).updateTexts((function(e,n){return n>i?e.update({startPos:e.startPos+t.length}):e})):t?null:this},t.containsCursor=function(e){var t=this.activeText.startPos,n=t+this.activeText.text.length;return e>=t&&e<n},t.update=function(t){return new e((0,r.Z)({},this,t))},t.updateCursor=function(e){return this.update({activeTextCursor:e(this.activeTextCursor)})},t.updateTexts=function(t){return e.of((0,D.Z)((0,r.Z)({},this),{texts:this.texts.flatMap(t).filter(Boolean)}))},t.asEffect=function(){return e.set.of(this)},t.asSpec=function(){return{effects:[this.asEffect()]}},t.asDecoration=function(){var e=this,t=this.texts.map((function(t,n){var r=t.text,i=t.startPos;return n<e.activeTextIndex||!r?null:n===e.activeTextIndex?mo(r.slice(e.activeTextCursor),i+e.activeTextCursor):mo(r,i)})).filter(Boolean);return H.p.set(t)},e.of=function(t){var n=t.texts,i=(0,Ze.Z)(t,["texts"]);return(n=n.filter((function(e){return e.text.length}))).length?new e((0,D.Z)((0,r.Z)({},i),{texts:n})):null},e.fromCodeSuggestion=function(t){var n=t.inherits,i=void 0===n?{activeTextCursor:0,activeTextIndex:0,complete:!1}:n,a=t.editorState,o=t.codeSuggestion,c=t.cursor,s=void 0===c?a.selection.main.head:c,l=Bo(a,o),u=e.of((0,D.Z)((0,r.Z)({},i),{source:o,texts:[new Oo({text:l,startPos:s})]})),d=yo(a,s);if(!d)return u;var f=a.update({changes:{from:s,to:a.doc.length,insert:l}}).state,p=function(){var e=(0,we.Um)(f,d.start.from,1);if(['"',"'"].includes(d.bracket)&&!(null===e||void 0===e?void 0:e.end)){var t=function(e,t){var n=-1;for(;-1!==(n=e.indexOf(t,n+1));)if("\\"!==e[n-1])return n;return-1}(f.sliceDoc(s),d.bracket);return-1===t?void 0:{from:s+t,to:s+t+1}}return null===e||void 0===e?void 0:e.end}();if(!p)return u;var h=p.from-s;if(l.length===h+d.bracket.length)return e.of((0,D.Z)((0,r.Z)({},i),{source:o,texts:[new Oo({text:l.slice(0,h).trimEnd(),startPos:s,endBracket:d.bracket})]}));for(var m=l.slice(h+d.bracket.length),v=d.end.to;v<a.doc.length;v++){if(a.sliceDoc(v,v+1)!==m[0])break;m=m.slice(1)}return e.of((0,D.Z)((0,r.Z)({},i),{source:o,texts:[new Oo({text:l.slice(0,h),startPos:s,endBracket:d.bracket}),new Oo({text:m,startPos:v})]}))},(0,ke.Z)(e,[{key:"activeText",get:function(){return this.texts[this.activeTextIndex]}}]),e}();Go.set=X.Py.define(),Go.clearState=Go.set.of(null);var Lo,Mo=H.tk.baseTheme({".gray-text":{color:q.TV.foregroundDimmest}}),zo=X.QQ.define({create:function(){return null},update:function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,o=t.effects[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var c=a.value;c.is(Go.set)?e=c.value:c.is(fo)?e=null==c.value?null:Go.fromCodeSuggestion({editorState:t.state,codeSuggestion:c.value}):c.is(po)?e=(null===e||void 0===e?void 0:e.source)?Go.fromCodeSuggestion({inherits:e,editorState:t.state,codeSuggestion:e.source+c.value,cursor:e.texts[0].startPos}):null:c.is(ho)&&(e=e.update({complete:c.value}))}}catch(s){r=!0,i=s}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return e},provide:function(e){return H.tk.decorations.from(e,(function(e){return function(){return null!==(Lo=null===e||void 0===e?void 0:e.asDecoration())&&void 0!==Lo?Lo:H.p.none}}))}}),Fo=H.tk.updateListener.of((function(e){var t=e.view,n=t.state.field(zo),r=e.state.selection.main;r.empty&&(null===n||void 0===n?void 0:n.containsCursor(r.head))||(e.docChanged?t.dispatch({effects:[Go.set.of(null),uo.of(lo(t.state,e.changes))]}):e.selectionSet&&t.dispatch({effects:[Go.set.of(null),uo.of(io.Stop)]}))})),Xo=X.yy.transactionExtender.of((function(e){var t=[];if(e.isUserEvent("delete.backward")){var n=e.startState.field(zo);if(!n)return null;t.push(Go.set.of(function(e){var t=e.activeTextCursor,n=e.activeTextIndex,r=e.texts;return t>0?e.updateCursor((function(e){return e-1})).updateTexts((function(e,t){return t>n?e.update({startPos:e.startPos-1}):e})):0===n?null:e.update({activeTextIndex:n-1,activeTextCursor:e.texts[e.activeTextIndex-1].text.length}).updateTexts((function(e,t){return t<n-1?e:t===n-1?e.update({text:e.text+(e.endBracket||"")+r[n].text,endBracket:r[n].endBracket}):t===n?null:e.update({startPos:e.startPos-1})}))}(n)))}else if(e.isUserEvent("input")){var r=e.startState.field(zo);if(!r)return null;e.changes.iterChanges((function(n,i,a,o,c){if(r){var s=r.updateOnInput(e.state,c.toString(),a);s!==r?(t.push(Go.set.of(s)),r=s):null===s&&(t.push(Go.clearState,uo.of(io.Enqueue)),r=null)}}))}else e.docChanged&&!e.annotation(X.YW.remote)&&t.push(Go.clearState);return(t=t.filter(Boolean)).length?{effects:t}:null})),Wo=H.tk.inputHandler.of((function(e,t,n,r){var i=e.state.field(zo);if(!i)return!1;var a=i.activeTextIndex,o=i.activeTextCursor,c=i.texts[a];if(c.text.length===o&&r===c.endBracket){var s=i.update({activeTextCursor:0,activeTextIndex:a+1});e.dispatch({effects:s.activeTextIndex>=s.texts.length?Go.clearState:s.asEffect()})}return!1})),Ho=function(e){var t=e.state,n=e.dispatch,r=t.field(zo);return!!r&&(n(t.update({effects:[fo.of(null),!r.complete&&uo.of(io.Stop)].filter(Boolean)})),!0)},Vo=function(e){var t=e.state,n=e.dispatch,r=t.field(zo);if(!r)return!1;var i=r.activeTextIndex,a=r.activeTextCursor,o=r.texts[i].text.slice(a).match(/^\n\s*/);return!!o&&(n(t.update(t.replaceSelection(o[0]),r.updateCursor((function(e){return e+o[0].length})).updateTexts((function(e,t){return t>i?e.update({startPos:e.startPos+o[0].length}):e})).asSpec())),!0)};var $o,qo=n(48821),Qo=n(93058),Ko=n(35642),Yo=n(75597),Jo=function(e){var t=e.onClose,n=(0,Qo.Z)(),r=n.showNotice,o=n.hideMessage,c=(0,i.Z)(l.useState(!1),2),s=c[0],u=c[1];return(0,l.useEffect)((function(){var e=function(){u(!0),o(n)},n=r((0,a.BX)(q.G7,{css:[q.l0.rowWithGap(4),q.l0.align.center],children:[(0,a.tZ)(Yo.Info,{}),(0,a.BX)(q.xv,{css:{fontSize:"calc(".concat(q.TV.fontSizeSubheadDefault," - 1px)"),"@media (max-width: 768px)":q.l0.fontSize(14)},children:["Thanks for trying GhostWriter!",(0,a.tZ)("a",{role:"button",tabIndex:0,css:{color:"inherit",textDecoration:"underline",marginLeft:"3px"},onKeyPress:function(t){"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),e())},onClick:function(t){t.preventDefault(),e()},children:"Give feedback"})]}),(0,a.tZ)(q.hU,{onClick:function(){o(n),t()},alt:"close toast",tooltipHidden:!0,children:(0,a.tZ)(Yo.Close,{})})]}),0,{background:q.TV.accentPrimaryDimmest,border:"1px solid ".concat(q.TV.accentPrimaryDimmer),color:q.TV.accentPrimaryStrongest,fontWeight:q.TV.fontWeightRegular,padding:q.TV.space8})}),[o,r,t]),(0,a.tZ)(qo.b5,{children:(0,a.tZ)(q.u_,{isOpen:s,onRequestClose:function(){u(!1)},children:(0,a.tZ)(ui.Z,{setFeedbackFormOpen:u,feature:ui.l.GhostWriter})})})};!function(e){e.Acceptance="ghostWriter.acceptance",e.Rejection="ghostWriter.rejection"}($o||($o={}));function ec(e){var t=e.path,n=e.engine,r=e.suggestCode,i=e.decorations,o=function(){var e;return{abort:function(){null===e||void 0===e||e.abort()},requestSignal:function(){var t=new AbortController;return null===e||void 0===e||e.abort(),e=t,t.signal}}}(),c=(0,wn.debounce)(function(){var e=(0,j.Z)(O().mark((function e(i){var a,c,s,l,u,d,f,p,h,m,v,g,b,x,Z,y,w,k,E,S;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=i.state,s=c.doc,l=c.selection,0!==(u=l.main.head)){e.next=5;break}return e.abrupt("return");case 5:if(d=s.sliceString(u-1,u),![";",")","}","]","{"].includes(d)){e.next=8;break}return e.abrupt("return");case 8:if((f=s.sliceString(Math.max(0,u-4e3),u))&&!(f.length<4)){e.next=11;break}return e.abrupt("return");case 11:f=i.state.facet(we.c)+"\n"+f,p=s.lineAt(u),h=p.text.replace(/^\s+/,"").split(/\s+/).length,m=h>0?30-h:No(i.state,u)?125:30,v=null===(a=f.match(/[^\s]([ \t]+)$/))||void 0===a?void 0:a[1],e.prev=17,g=!0,b=!1,x=!1,e.prev=20,y=(0,ao.Z)(r({code:v?f.slice(0,-v.length):f,maxTokens:m,signal:o.requestSignal()}));case 22:return e.next=24,y.next();case 24:if(!(b=!(w=e.sent).done)){e.next=39;break}if(k=w.value,E=k,!g||!v){e.next=33;break}if(!E.startsWith(v)){e.next=32;break}E=E.slice(v.length),e.next=33;break;case 32:return e.abrupt("return");case 33:g&&(0,Ut.j)(Ut.U3.CODE_SUGGESTION_USED,{type:"suggestionPresented",language:(0,Kr.Sf)(t),engine:n}),i.dispatch({effects:g?fo.of(E):po.of(E)}),g=!1;case 36:b=!1,e.next=22;break;case 39:e.next=45;break;case 41:e.prev=41,e.t0=e.catch(20),x=!0,Z=e.t0;case 45:if(e.prev=45,e.prev=46,!b||null==y.return){e.next=50;break}return e.next=50,y.return();case 50:if(e.prev=50,!x){e.next=53;break}throw Z;case 53:return e.finish(50);case 54:return e.finish(45);case 55:(0,Ut.j)(Ut.U3.CODE_SUGGESTION_USED,{type:"suggestionCompletelyPresented",language:(0,Kr.Sf)(t),engine:n}),i.dispatch({effects:ho.of(!0)}),e.next=65;break;case 59:if(e.prev=59,e.t1=e.catch(17),"AbortError"!==(null===(S=e.t1)||void 0===S?void 0:S.name)){e.next=64;break}return e.abrupt("return");case 64:an.Tb(e.t1);case 65:case"end":return e.stop()}}),e,null,[[17,59],[20,41,45,55],[46,,50,54]])})));return function(t){return e.apply(this,arguments)}}(),225),s=function(e){var t=function(){e.update((function(e){return e.delete("feedback")}))},n=function(){var n,r,i=(null!==(n=Ko.Z.get("ghostWriter.acceptance","number"))&&void 0!==n?n:0)+(null!==(r=Ko.Z.get("ghostWriter.rejection","number"))&&void 0!==r?r:0);50===i||1200===i?e.update((function(e){return e.set("feedback",(0,a.tZ)(Jo,{onClose:t}))})):t()};return{recordAccept:function(){Ko.Z.update("ghostWriter.acceptance","number",(function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)+1})),n()},recordReject:function(){Ko.Z.update("ghostWriter.rejection","number",(function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)+1})),n()}}}(i),l=function(e){return!!function(e){var t=e.state.field(zo);if(!t)return!1;t.complete||e.dispatch({effects:uo.of(io.Stop)});var n=t.activeTextCursor,r=t.activeTextIndex,i=t.texts,a=e.state.changes(i.map((function(e,t){return t<r?null:t===r?{from:e.startPos+n,insert:e.text.slice(n)}:{from:e.startPos,insert:e.text}})).filter(Boolean)),o=0;return a.iterChangedRanges((function(e,t,n,r){o=r})),e.dispatch({changes:a,selection:{anchor:o},scrollIntoView:!0,sequential:!0,effects:fo.of(null)}),!0}(e)&&((0,Ut.j)(Ut.U3.CODE_SUGGESTION_USED,{type:"suggestionAccepted",language:(0,Kr.Sf)(t),engine:n}),s.recordAccept(),(0,W._B)(e),!0)};return[X.Wl.high(H.$f.of([{key:"Tab",run:l},{key:"Escape",run:function(e){return!!Ho(e)&&(o.abort(),(0,Ut.j)(Ut.U3.CODE_SUGGESTION_USED,{type:"suggestionDismissed",language:(0,Kr.Sf)(t),engine:n}),s.recordReject(),!0)}},{key:"Enter",run:Vo}])),H.tk.domEventHandlers({blur:function(e,t){setTimeout((function(){t.dispatch({effects:fo.of(null)})}),100)}}),H.tk.updateListener.of((function(e){(0,$.j)(e,uo,(function(t){var n,r;t.value?(n=e.view,r=t.value,o.abort(),c(n),r===io.Now&&c.flush()):o.abort()}))})),[Fo,Xo,zo,Mo,X.Wl.high(Wo)],so({onComplete:l,onEscape:Ho})]}var tc=n(59821),nc=function e(t,n){(0,be.Z)(this,e),this.next=null,this.prev=null,this.key=t,this.data=n},rc=function(){function e(){(0,be.Z)(this,e),this.size_=0,this.head=null,this.tail=null}var t=e.prototype;return t.addFront=function(e){this.tail||(this.tail=e),this.head&&(this.head.prev=e),e.next=this.head,this.head=e,this.size_++},t.popBack=function(){if(!this.tail)return null;var e=this.tail;return this.tail=e.prev,this.size_--,e.prev&&(e.prev.next=null,e.prev=null),e},t.moveToFront=function(e){this.head!==e&&(this.tail===e&&(this.tail=e.prev),e.next&&(e.next.prev=e.prev,e.next=null),e.prev&&(e.prev.next=e.next,e.prev=null),this.size_--,this.addFront(e))},(0,ke.Z)(e,[{key:"size",get:function(){return this.size_}}]),e}(),ic=function(){function e(t){(0,be.Z)(this,e),this.items=Object.create(null),this.evictList=new rc,this.maxSize=t}var t=e.prototype;return t.update=function(e,t){var n=this.items[e];if(n)return this.evictList.moveToFront(n),n.data=t(n.data),n.data;for(;this.evictList.size>=this.maxSize;){var r=this.evictList.popBack();if(!r)throw new Error("invariant violation: could not pop back of the list");delete this.items[r.key]}var i=new nc(e,t());return this.evictList.addFront(i),this.items[e]=i,i.data},t.getOrAdd=function(e,t){return this.update(e,(function(e){return null!==e&&void 0!==e?e:t}))},t.set=function(e,t){this.update(e,(function(){return t}))},t.get=function(e){var t=this.items[e];return t?t.data:null},t.has=function(e){return e in this.items},(0,ke.Z)(e,[{key:"size",get:function(){return this.evictList.size}}]),e}(),ac=function(){function e(){(0,be.Z)(this,e),this.cache=new ic(100)}var t=e.prototype;return t.has=function(e){return this.cache.has(e)},t.get=function(e){return this.cache.get(e)},t.set=function(e,t){this.cache.set(e,t)},t.setSuggestion=function(e,t){this.cache.set(e,JSON.stringify({text:t})+"\n")},e}(),oc=Po(),cc=new Set(["bash","c","css","c#","c++","go","haskell","java","javascript","json","kotlin","lisp","php","python","ruby","rust","typescript"]);function sc(e){return lc.apply(this,arguments)}function lc(){return lc=(0,co.Z)(O().mark((function e(t){var n,r,i,a;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.getReader(),e.prev=1;case 2:return e.next=5,(0,oo.Z)(n.read());case 5:if(r=e.sent,i=r.done,a=r.value,!i){e.next=10;break}return e.abrupt("break",14);case 10:return e.next=12,a;case 12:e.next=2;break;case 14:return e.prev=14,n.releaseLock(),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[1,,14,17]])}))),lc.apply(this,arguments)}var uc=n(90914),dc=n(8527),fc=n(86514);function pc(){var e=(0,ir.Z)(["\n  mutation AIFeedback($input: CodexFeedback2Input!) {\n    giveCodexFeedback2(input: $input) {\n      ... on CodexFeedback2 {\n        __typename\n      }\n      ... on UnauthorizedError {\n        __typename\n      }\n      ... on NotFoundError {\n        __typename\n      }\n    }\n  }\n"]);return pc=function(){return e},e}var hc={},mc=(0,ar.ZP)(pc());function vc(e){var t=e.inferenceId,n=e.language,o=e.inferenceClass,c=(0,i.Z)(function(e){var t=(0,r.Z)({},hc,e);return or.useMutation(mc,t)}(),2),s=c[0],l=c[1],u=l.data,d=l.error,f=l.called,p=function(e){o===zr.Sg.Generation?(0,Ut.j)(Ut.U3.CODEX_FEEDBACK_SUBMITTED,{feedback:e,language:n,feature:"generation"}):(0,Ut.j)(Ut.U3.SEMANTIC_SEARCH_FEEDBACK_SUBMITTED,{feedback:e,language:n,feature:"search"}),s({variables:{input:{feedback:e,inferenceClass:o,inferenceId:t}}})};return(0,a.tZ)(q.G7,{css:[q.l0.rowWithGap(16),q.l0.justify.start,q.l0.align.center,q.l0.pt(12),q.l0.flex.grow(1)],children:f&&"NotFoundError"!==(null===u||void 0===u?void 0:u.giveCodexFeedback2.__typename)&&"UnauthorizedError"!==(null===u||void 0===u?void 0:u.giveCodexFeedback2.__typename)&&!d?(0,a.tZ)(q.zx,{disabled:!0,iconLeft:(0,a.tZ)(ci.Z,{}),small:!0,text:"Thanks for the feedback!"}):(0,a.BX)(q.G7,{css:[q.l0.flex.row,q.l0.align.center,q.l0.width("100%"),q.l0.justify.spaceBetween],children:[(0,a.BX)(q.G7,{css:[q.l0.align.center,q.l0.justify.start,q.l0.rowWithGap(8)],children:[(0,a.tZ)(q.xv,{variant:"small",color:"dimmer",children:"Is this code valuable?"}),(0,a.BX)(q.G7,{css:[q.l0.rowWithGap(8),q.l0.justify.start,q.l0.align.center],children:[(0,a.tZ)(q.zx,{text:"Yes",onClick:function(){return p(zr.TY.Yes)},small:!0,colorway:"positive",iconLeft:(0,a.tZ)(Tt.Z,{}),css:{backgroundColor:q.TV.backgroundHighest+" !important",":hover":{backgroundColor:q.TV.accentPositiveDimmest+" !important"}}}),(0,a.tZ)(q.zx,{text:"No",onClick:function(){return p(zr.TY.No)},colorway:"negative",small:!0,iconLeft:(0,a.tZ)(pt.Z,{}),css:{backgroundColor:q.TV.backgroundHighest+" !important",":hover":{backgroundColor:q.TV.accentNegativeDimmest+" !important"}}})]})]}),(0,a.tZ)(q.G7,{css:[q.l0.fontSize(12)],children:(0,a.tZ)(li.Z,{feature:ui.l.AI})})]})})}var gc=n(63736),bc=n(77836),xc=n(8850),Zc=n(15882),yc=n(15315);function wc(e){var t=e.filePath,n=e.selectedCode,r=e.onRequestClose,o=(0,br.Z)(),c=(0,rr.Z)(t),s=(0,i.Z)(l.useState(n),2),u=s[0],d=s[1],f=(0,i.Z)(l.useState(""),2),p=f[0],h=f[1],m=(0,i.Z)(l.useState(!1),2),v=m[0],g=m[1],b=l.useRef(null),x=(0,i.Z)((0,uc.wB)({fetchPolicy:"no-cache"}),2),Z=x[0],y=x[1],w=y.called,k=y.data,E=y.error,S=y.loading,C=Er();l.useEffect((function(){setTimeout((function(){b.current&&b.current.focus()}))}),[b]);var T=(0,Kr.Sf)(t),R=(0,Qo.Z)().showConfirm;if(!C)return(0,a.tZ)(ii,{title:"Generate Code",newInferenceAlt:"Generate new code",onRequestClose:r,width:320,learnMoreLink:"https://blog.replit.com/generate-code",children:(0,a.BX)(q.G7,{css:[q.l0.colWithGap(12),q.l0.p(8)],children:[(0,a.tZ)(q.xv,{multiline:!0,children:"Generate Code and other AI-powered features are available to Hacker and Teams Pro subscribers only!"}),(0,a.tZ)(xc.Z,{context:"generate_code_modal",showHackerPrompt:!0,css:{alignSelf:"center"},colorway:"primary",outlined:!1})]})});var _=null,I=null===k||void 0===k?void 0:k.generateCode.__typename;if(S)_=(0,a.tZ)(oi,{});else if(E||"UserError"===I||"UnauthorizedError"===I){var P,D;_=(0,a.tZ)(q.G7,{children:(0,a.tZ)(q.E_,{colorway:"negative",icon:(0,a.tZ)(si.Z,{}),text:"UserError"!==I&&"UnauthorizedError"!==I||!(null===k||void 0===k||null===(P=k.generateCode)||void 0===P?void 0:P.message)?"Oops! An unexpected error occurred. Please try again or contact support.":null===k||void 0===k||null===(D=k.generateCode)||void 0===D?void 0:D.message})})}else if("GenerateCodeResult"===I&&null!=(null===k||void 0===k?void 0:k.generateCode)){var A,N=k.generateCode,U=N.code,j=N.id;if(null==U||""===U)_=(0,a.tZ)(q.G7,{children:(0,a.tZ)(q.E_,{colorway:"warning",icon:(0,a.tZ)(Yt.Z,{}),text:"That prompt gave us some trouble. Try re-wording it."})});else _=(0,a.BX)(q.G7,{children:[(0,a.BX)(q.Tg,{background:"default",css:[q.l0.py(8),q.l0.px(8),q.l0.borderRadius(8)],children:[(0,a.tZ)(q.G7,{css:[q.l0.maxHeight(300),q.l0.overflowY("auto")],children:(0,a.tZ)(dr.Z,{code:U,filePath:t,hideGutter:!0,hideIndentMarker:!0})}),(0,a.BX)(q.G7,{css:[q.l0.flex.row,q.l0.justify.spaceBetween,q.l0.align.center,q.l0.pt(8),q.l0.px(4)],children:[(0,a.BX)(q.G7,{css:[q.l0.rowWithGap(4),q.l0.align.center],children:[(0,a.tZ)(gc.Z,{path:t,size:16}),(0,a.tZ)(q.xv,{color:"dimmer",css:[{textTransform:"capitalize"},q.l0.fontSize(12)],children:T})]}),(0,a.BX)(q.G7,{css:q.l0.rowWithGap(8),children:[(0,a.tZ)(q.zx,{small:!0,iconLeft:(0,a.tZ)(dc.Z,{}),text:"Copy to clipboard",onClick:function(){(0,Lr.Z)(U).then((function(){R("Code copied to clipboard")})),(0,Ut.j)(Ut.U3.CODE_GENERATION_USED,{action:"copied-to-clipboard",language:T})}}),"function"===typeof c?(0,a.tZ)(q.zx,{small:!0,iconLeft:(0,a.tZ)(Zc.Z,{}),text:"Insert in editor",colorway:"primary",onClick:function(){c({code:U}),(0,Ut.j)(Ut.U3.CODE_GENERATION_USED,{action:"inserted-in-editor",language:T}),r()}}):null,(null===k||void 0===k||null===(A=k.currentUser)||void 0===A?void 0:A.isAdmin)?(0,a.tZ)(q.u,{tooltip:(0,a.tZ)(q.G7,{children:(0,a.tZ)("pre",{css:[{whiteSpace:"pre-wrap"}],children:JSON.stringify(JSON.parse(k.generateCode.metadata),null," ")})}),placement:"bottom",children:(0,a.tZ)(q.hU,{colorway:"warning",alt:"Debug metadata",tooltipHidden:!0,children:(0,a.tZ)(fc.Z,{})})}):null]})]})]}),(0,a.tZ)(q.G7,{css:[q.l0.flex.row,q.l0.align.center,q.l0.justify.spaceBetween],children:(0,a.tZ)(vc,{inferenceId:j,language:T,inferenceClass:zr.Sg.Generation})})]})}return(0,a.tZ)(ii,{title:"Generate Code",onRequestClose:r,width:500,learnMoreLink:"https://blog.replit.com/generate-code",children:(0,a.BX)(q.G7,{css:[q.l0.p(8),q.l0.colWithGap(8)],children:[(0,a.BX)(q.G7,{tag:"form",onSubmit:function(e){e.preventDefault(),function(){if(!S&&""!==u){var e=u===p;(0,Ut.j)(Ut.U3.CODEX_FEATURE_USED,{feature:"generation",isRetry:e,language:T}),e?(0,Ut.j)(Ut.U3.CODE_GENERATION_USED,{action:"refresh",language:T}):(0,Ut.j)(Ut.U3.CODE_GENERATION_USED,{action:"text-submitted",language:T}),h(u),Z({variables:{input:{language:T,prompt:u,replId:o}}})}}()},css:[q.l0.rowWithGap(8)],children:[(0,a.tZ)(q.II,{autoFocus:!0,placeholder:'Write a prompt (e.g. "draw a square")',value:u,onChange:function(e){return t=e.target.value,v||((0,Ut.j)(Ut.U3.CODE_GENERATION_USED,{action:"text-written",language:T}),g(!0)),void d(t);var t},ref:b,maxLength:1e3,onKeyDown:function(e){"Escape"===e.key&&r()}}),(0,a.tZ)(q.zx,{text:"Generate",colorway:"primary",disabled:S||""===u,type:"submit",iconRight:!S&&w?(0,a.tZ)(yc.Z,{}):(0,a.tZ)(bc.Z,{})})]}),_]})})}function kc(e){var t=e.dom,n=(0,Ze.Z)(e,["dom"]);return A.createPortal((0,a.tZ)(wc,(0,r.Z)({},n)),t)}function Ec(){var e=(0,ir.Z)(["\n  query TransformCode($input: TransformCodeInput!) {\n    currentUser {\n      id\n      isAdmin: hasRole(role: ADMIN)\n    }\n    transformCode(input: $input) {\n      ... on TransformCodeResult {\n        id\n        code\n        metadata\n      }\n      ... on UserError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on ServiceUnavailable {\n        message\n      }\n    }\n  }\n"]);return Ec=function(){return e},e}var Sc={},Cc=(0,ar.ZP)(Ec());var Tc=n(97795);function Rc(e){var t=e.filePath,n=e.selectedCode,o=e.onRequestClose,c=e.replaceCode,s=(0,br.Z)(),u=(0,Qo.Z)(),d=u.showError,f=u.showConfirm,p=(0,i.Z)(l.useState(""),2),h=p[0],m=p[1],v=(0,i.Z)(l.useState(""),2),g=v[0],b=v[1],x=(0,i.Z)(l.useState(!1),2),Z=x[0],y=x[1],w=l.useRef(null),k=l.useRef(!1),E=(0,i.Z)(function(e){var t=(0,r.Z)({},Sc,e);return or.useLazyQuery(Cc,t)}({fetchPolicy:"no-cache",onError:function(e){return d(e.message)}}),2),S=E[0],C=E[1],T=C.called,R=C.data,_=C.error,I=C.loading,P=bi(),D=P.transformCodeEnabled,A=P.loading,N=I||A;l.useEffect((function(){setTimeout((function(){w.current&&w.current.focus()}))}),[w]),l.useEffect((function(){if(k.current)return o();k.current=!0}),[t,o]);var U=(0,Kr.Sf)(t);if(!D&&!N)return(0,a.tZ)(ii,{title:"Transform Code",newInferenceAlt:"Transform your code",onRequestClose:o,width:320,learnMoreLink:"https://blog.replit.com/generate-code",children:(0,a.BX)(q.G7,{css:[q.l0.colWithGap(12),q.l0.p(8)],children:[(0,a.tZ)(q.xv,{multiline:!0,children:"Transform Code and other AI-powered features are available to Hacker and Teams Pro subscribers only!"}),(0,a.tZ)(xc.Z,{context:"generate_code_modal",showHackerPrompt:!0,css:{alignSelf:"center"},colorway:"primary",outlined:!1})]})});var j=null,B=null===R||void 0===R?void 0:R.transformCode.__typename;if(N)j=(0,a.tZ)(oi,{});else if(_||"UserError"===B||"UnauthorizedError"===B){var O,G;j=(0,a.tZ)(q.G7,{children:(0,a.tZ)(q.E_,{colorway:"negative",icon:(0,a.tZ)(si.Z,{}),text:"UserError"!==B&&"UnauthorizedError"!==B||!(null===R||void 0===R||null===(O=R.transformCode)||void 0===O?void 0:O.message)?"Oops! An unexpected error occurred. Please try again or contact support.":null===R||void 0===R||null===(G=R.transformCode)||void 0===G?void 0:G.message})})}else if("ServiceUnavailable"===B)j=(0,a.tZ)(q.G7,{children:(0,a.tZ)(q.E_,{colorway:"warning",icon:(0,a.tZ)(Yt.Z,{}),text:"That prompt gave us some trouble. Try re-wording it."})});else if("TransformCodeResult"===B&&null!=R){var L,M=R.transformCode,z=M.code,F=M.id;if(null==z||""===z)j=(0,a.tZ)(q.G7,{children:(0,a.tZ)(q.E_,{colorway:"warning",icon:(0,a.tZ)(Yt.Z,{}),text:"That prompt gave us some trouble. Try re-wording it."})});else j=(0,a.BX)(q.G7,{children:[(0,a.BX)(q.Tg,{background:"default",css:[q.l0.py(8),q.l0.px(4),q.l0.borderRadius(8)],children:[(0,a.tZ)(q.G7,{css:[q.l0.maxHeight(300),q.l0.overflowY("auto")],children:(0,a.tZ)(dr.Z,{code:z,filePath:t,hideGutter:!0})}),(0,a.BX)(q.G7,{css:[q.l0.flex.row,q.l0.justify.spaceBetween,q.l0.align.center,q.l0.pt(8),q.l0.px(4)],children:[(0,a.BX)(q.G7,{css:[q.l0.rowWithGap(4),q.l0.align.center],children:[(0,a.tZ)(gc.Z,{path:t,size:16}),(0,a.tZ)(q.xv,{color:"dimmer",css:[{textTransform:"capitalize"},q.l0.fontSize(12)],children:U})]}),(0,a.BX)(q.G7,{css:q.l0.rowWithGap(8),children:[(0,a.tZ)(q.zx,{iconLeft:(0,a.tZ)(dc.Z,{}),text:"Copy to clipboard",onClick:function(){(0,Lr.Z)(z).then((function(){f("Code copied to clipboard")})),(0,Ut.j)(Ut.U3.CODE_GENERATION_USED,{action:"copied-to-clipboard",isTransformation:!0,language:U})},small:!0}),(0,a.tZ)(q.zx,{iconLeft:(0,a.tZ)(Tc.Z,{}),text:"Replace selection",colorway:"primary",small:!0,onClick:function(){try{c(z)}catch(e){d("Couldn't replace code. Please make sure you don't edit your selection.")}(0,Ut.j)(Ut.U3.CODE_GENERATION_USED,{action:"replaced-selection-in-editor",isTransformation:!0,language:U}),o()}}),(null===R||void 0===R||null===(L=R.currentUser)||void 0===L?void 0:L.isAdmin)?(0,a.tZ)(q.u,{tooltip:(0,a.tZ)(q.G7,{children:(0,a.tZ)("pre",{css:[{whiteSpace:"pre-wrap"}],children:JSON.stringify(JSON.parse(R.transformCode.metadata),null," ")})}),placement:"bottom",children:(0,a.tZ)(q.hU,{colorway:"warning",alt:"Debug metadata",tooltipHidden:!0,children:(0,a.tZ)(fc.Z,{})})}):null]})]})]}),(0,a.tZ)(q.G7,{css:[q.l0.flex.row,q.l0.align.baseline,q.l0.justify.spaceBetween],children:(0,a.tZ)(vc,{inferenceId:F,language:U,inferenceClass:zr.Sg.Transformation})})]})}else N||_||(j=null);return(0,a.tZ)(ii,{title:"Transform Code",onRequestClose:o,width:500,learnMoreLink:"https://blog.replit.com/transform-code",children:(0,a.BX)(q.G7,{css:[q.l0.p(8),q.l0.colWithGap(8)],children:[(0,a.BX)(q.G7,{tag:"form",onSubmit:function(e){e.preventDefault(),function(){if(!N&&""!==h){var e=h===g;(0,Ut.j)(Ut.U3.CODEX_FEATURE_USED,{feature:"transformation",isRetry:e,language:U}),e?(0,Ut.j)(Ut.U3.CODE_GENERATION_USED,{action:"refresh",isTransformation:!0,language:U}):(0,Ut.j)(Ut.U3.CODE_GENERATION_USED,{action:"text-submitted",isTransformation:!0,language:U}),b(h),S({variables:{input:{input:n,language:U,prompt:h,replId:s}}})}}()},css:[q.l0.rowWithGap(8)],children:[(0,a.tZ)(q.II,{autoFocus:!0,placeholder:'Write a prompt (e.g. rename all variables to "foo")',value:h,onChange:function(e){return t=e.target.value,Z||((0,Ut.j)(Ut.U3.CODE_GENERATION_USED,{action:"text-written",isTransformation:!0,language:U}),y(!0)),void m(t);var t},ref:w,onKeyDown:function(e){"Escape"===e.key&&o()}}),(0,a.tZ)(q.zx,{text:"Transform",colorway:"primary",disabled:N||""===h,type:"submit",iconRight:!N&&T?(0,a.tZ)(yc.Z,{}):(0,a.tZ)(bc.Z,{})})]}),j]})})}function _c(e){var t=e.dom,n=(0,Ze.Z)(e,["dom"]);return A.createPortal((0,a.tZ)(Rc,(0,r.Z)({},n)),t)}function Ic(){var e=(0,ir.Z)(["\n  query SearchCode($input: SearchCodeInput!) {\n    currentUser {\n      id\n      isAdmin: hasRole(role: ADMIN)\n    }\n    searchCode(input: $input) {\n      ... on SearchCodeResult {\n        id\n        codes {\n          code\n          url\n        }\n        metadata\n      }\n      ... on UserError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n  }\n"]);return Ic=function(){return e},e}var Pc={},Dc=(0,ar.ZP)(Ic());var Ac=n(87653),Nc=n(37424),Uc=n(46702),jc=n(90725);function Bc(e){var t,n=e.filePath,o=e.selectedCode,c=e.context,u=e.onRequestClose,d=(0,br.Z)(),f=(0,Qo.Z)().showConfirm,p=(0,rr.Z)(n),h=(0,i.Z)(l.useState(o),2),m=h[0],v=h[1],g=(0,i.Z)(l.useState(!1),2),b=g[0],x=g[1],Z=(0,i.Z)(l.useState(!0),2),y=Z[0],w=Z[1],k=c,E=(0,i.Z)(l.useState(""),2),S=E[0],C=E[1],T=(0,i.Z)(l.useState(!1),2),R=T[0],_=T[1],I=(0,i.Z)(function(e){var t=(0,r.Z)({},Pc,e);return or.useLazyQuery(Dc,t)}({fetchPolicy:"no-cache"}),2),P=I[0],D=I[1],A=D.called,N=D.data,U=D.error,j=D.loading,B=(0,Nc.H)()("semanticSearchCheckboxRerank"),O=(0,Nc.H)()("semanticSearchCheckboxContextual"),G=(0,Kr.Sf)(n),L=null,M=null===N||void 0===N?void 0:N.searchCode.__typename;if(j)L=(0,a.tZ)(oi,{});else if(U||"UserError"===M||"UnauthorizedError"===M){var z,F;L=(0,a.tZ)(q.G7,{children:(0,a.tZ)(q.E_,{colorway:"negative",icon:(0,a.tZ)(si.Z,{}),text:"UserError"!==M&&"UnauthorizedError"!==M||!(null===N||void 0===N||null===(z=N.searchCode)||void 0===z?void 0:z.message)?"Oops! An unexpected error occurred. Please try again or contact support.":null===N||void 0===N||null===(F=N.searchCode)||void 0===F?void 0:F.message})})}else if("SearchCodeResult"===M&&null!=(null===N||void 0===N?void 0:N.searchCode)){var X=N.searchCode,W=X.codes,H=X.id;L=null==W?(0,a.tZ)(q.G7,{children:(0,a.tZ)(q.E_,{colorway:"warning",icon:(0,a.tZ)(Yt.Z,{}),text:"That prompt gave us some trouble. Try re-wording it to improve results."})}):(0,a.BX)(q.G7,{children:[(0,a.tZ)(q.Tg,{elevated:!0,css:[q.l0.borderRadius(8)],children:(0,a.tZ)(q.G7,{css:[q.l0.maxHeight(300),q.l0.overflowY("auto")],children:W.map((function(e,t){var r;return(0,a.BX)(q.Tg,{background:"default",css:[q.l0.p(8),q.l0.mb(16),q.l0.borderRadius(8)],children:[(0,a.tZ)(dr.Z,{code:e.code,filePath:n,hideGutter:!0}),(0,a.BX)(q.G7,{css:[q.l0.flex.row,q.l0.justify.spaceBetween,q.l0.align.center,q.l0.pt(8),q.l0.px(4)],children:[(0,a.BX)(q.G7,{css:[q.l0.rowWithGap(8),q.l0.align.center],children:[(0,a.tZ)(gc.Z,{path:n,size:16}),(0,a.tZ)(q.xv,{color:"dimmer",css:{textTransform:"capitalize"},children:G}),(0,a.tZ)(q.zx,{iconRight:(0,a.tZ)(Uc.Z,{}),text:"Source",small:!0,outlined:!0,onClick:function(){window.open(e.url,"_blank")}})]}),(0,a.BX)(q.G7,{css:q.l0.rowWithGap(8),children:[(0,a.tZ)(q.zx,{iconLeft:(0,a.tZ)(dc.Z,{}),text:"Copy",small:!0,onClick:function(){(0,Lr.Z)(e.code),f("Code copied to clipboard"),(0,Ut.j)(Ut.U3.SEMANTIC_SEARCH_USED,{action:"copied-to-clipboard",language:G})}}),"function"===typeof p?(0,a.tZ)(q.zx,{iconLeft:(0,a.tZ)(Zc.Z,{}),text:"Insert in editor",small:!0,colorway:"primary",onClick:function(){p({code:e.code}),(0,Ut.j)(Ut.U3.SEMANTIC_SEARCH_USED,{action:"inserted-in-editor",language:G}),u()}}):null,(null===N||void 0===N||null===(r=N.currentUser)||void 0===r?void 0:r.isAdmin)?(0,a.tZ)(q.u,{tooltip:(0,a.tZ)(q.G7,{children:"SearchCodeResult"===(null===N||void 0===N?void 0:N.searchCode.__typename)?(0,a.tZ)("pre",{css:[{whiteSpace:"pre-wrap"}],children:JSON.stringify(JSON.parse(null===N||void 0===N?void 0:N.searchCode.metadata),null," ")}):"No debug info available."}),placement:"bottom",children:(0,a.tZ)(q.hU,{colorway:"warning",alt:"Debug metadata",tooltipHidden:!0,children:(0,a.tZ)(fc.Z,{})})}):null]})]})]},t)}))})}),(0,a.tZ)(q.G7,{css:[q.l0.flex.row,q.l0.align.baseline,q.l0.justify.spaceBetween],children:(0,a.tZ)(vc,{inferenceId:H,language:G,inferenceClass:zr.Sg.Search})})]})}else j||U||(L=null);return(0,a.BX)(ii,{title:"Search for Code",onRequestClose:u,width:500,children:[(0,a.BX)(q.G7,{css:[q.l0.p(8),q.l0.colWithGap(8)],children:[(0,a.BX)(q.G7,{tag:"form",onSubmit:function(e){e.preventDefault(),j||""===m||(m===S?(0,Ut.j)(Ut.U3.SEMANTIC_SEARCH_USED,{action:"refresh",rerank:b,contextual:y,language:G}):(0,Ut.j)(Ut.U3.SEMANTIC_SEARCH_USED,{action:"query-submitted",rerank:b,contextual:y,language:G}),C(m),P({variables:{input:{language:G,rerank:b,contextual:y,codeContext:k,prompt:m,replId:d}}}))},css:[q.l0.rowWithGap(8)],children:[(0,a.tZ)(q.II,{autoFocus:!0,placeholder:"Search for examples, patterns, templates, and more",value:m,onChange:function(e){return t=e.target.value,R||((0,Ut.j)(Ut.U3.SEMANTIC_SEARCH_USED,{action:"query-written",language:G}),_(!0)),void v(t);var t}}),(null===N||void 0===N||null===(t=N.currentUser)||void 0===t?void 0:t.isAdmin)?(0,a.BX)(a.HY,{children:[(0,a.tZ)(q.G7,{css:[q.l0.pt(8)],children:(0,a.tZ)(q.xv,{color:"dimmer",children:"Rerank?"})}),(0,a.tZ)(q.XZ,{id:B,name:"Rerank?",checked:b,onChange:function(e){return t=e.target.checked,void x(t);var t}}),(0,a.tZ)(q.G7,{css:[q.l0.pt(8)],children:(0,a.tZ)(q.xv,{color:"dimmer",children:"Contextual?"})}),(0,a.tZ)(q.XZ,{id:O,name:"Contextual?",checked:y,onChange:function(e){return t=e.target.checked,void w(t);var t}})]}):null,(0,a.tZ)(q.zx,{iconLeft:(0,a.tZ)(Ac.Z,{}),iconRight:j?(0,a.tZ)(bt.Z,{}):A&&!j?(0,a.tZ)(yc.Z,{fill:q.TV.accentPrimaryStrongest}):void 0,text:"Search",colorway:"primary",disabled:j||""===m,type:"submit"})]}),L]}),(0,a.tZ)(s(),{id:jc.Q.__hash,children:jc.Q})]})}function Oc(e){var t=e.dom,n=(0,Ze.Z)(e,["dom"]);return A.createPortal((0,a.tZ)(Bc,(0,r.Z)({},n)),t)}var Gc=n(49630),Lc=n(24638);function Mc(e,t,n,i){var a=(0,Qo.Z)().showError,o=(0,br.Z)(),c=(0,Lc.eR)({variables:{replId:o,path:e},onError:function(e){a(e.message)},skip:!i||t}),s=l.useMemo((function(){var i;return t||c.loading||c.error||!c.data||"ThreadsByFileResult"!==(null===(i=c.data.threadsByFile)||void 0===i?void 0:i.__typename)?{}:c.data.threadsByFile.threads.filter((function(t){return t.path===e&&(!n||!t.isResolved)})).reduce((function(e,t){return(0,D.Z)((0,r.Z)({},e),(0,ve.Z)({},t.id,t))}),{})}),[c.loading,c.data,c.error,e,t,n]);return s}var zc=n(28898),Fc=n(65632),Xc=12;var Wc=function(e){var t=e.threadPreview,n=e.onClick;if(!t)throw new Error("expected thread preview");var r=t.unreadCount>0,i=t.participants,o="".concat(Xc,"px");return(0,a.BX)("div",{onClick:n,className:s().dynamic([["1b8974d2e0eed26f",[Xc]]])+" thread-preview",children:[(0,a.tZ)("div",{className:s().dynamic([["1b8974d2e0eed26f",[Xc]]])+" user-stack",children:i.slice(0,3).map((function(e){return e&&(0,a.tZ)(zc.Z,{url:e.image,size:"xs",style:{minWidth:o,minHeight:o,height:o,width:o}},e.id)}))}),t.messageCount>0&&(0,a.BX)("div",{className:s().dynamic([["1b8974d2e0eed26f",[Xc]]])+" comment-info",children:[(0,a.tZ)("div",{className:s().dynamic([["1b8974d2e0eed26f",[Xc]]])+" comment-count",children:t.messageCount}),(0,a.tZ)(Fc.Z,{size:Xc,unreadDot:r})]}),(0,a.tZ)(s(),{id:"1b8974d2e0eed26f",dynamic:[Xc],children:".thread-preview.__jsx-style-dynamic-selector{padding:4px;-webkit-border-radius:var(--border-radius-4);-moz-border-radius:var(--border-radius-4);border-radius:var(--border-radius-4);-webkit-border-top-right-radius:0;-moz-border-radius-topright:0;border-top-right-radius:0;-webkit-border-bottom-right-radius:0;-moz-border-radius-bottomright:0;border-bottom-right-radius:0;background-color:var(--background-default);color:var(--foreground-default);display:grid;grid-auto-flow:column;grid-column-gap:var(--space-8);-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;cursor:pointer;border:.5px solid var(--background-higher);-webkit-box-shadow:var(--shadow-1);-moz-box-shadow:var(--shadow-1);box-shadow:var(--shadow-1);-webkit-transition:width.2s,background-color.2s,-webkit-transform.1s;-moz-transition:width.2s,background-color.2s,-moz-transform.1s;-o-transition:width.2s,background-color.2s,-o-transform.1s;transition:width.2s,background-color.2s,-webkit-transform.1s;transition:width.2s,background-color.2s,-moz-transform.1s;transition:width.2s,background-color.2s,-o-transform.1s;transition:width.2s,background-color.2s,transform.1s;z-index:1}.thread-preview.__jsx-style-dynamic-selector:hover{-webkit-transform:translateX(-5%)scale(1.1);-moz-transform:translateX(-5%)scale(1.1);-ms-transform:translateX(-5%)scale(1.1);-o-transform:translateX(-5%)scale(1.1);transform:translateX(-5%)scale(1.1)}.user-stack.__jsx-style-dynamic-selector{display:grid;grid-auto-flow:column;grid-column-gap:var(--space-4)}.comment-info.__jsx-style-dynamic-selector{display:grid;grid-auto-flow:column;grid-gap:var(--space-4);-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center}.comment-count.__jsx-style-dynamic-selector{font-weight:var(--font-weight-medium);font-size:.8em;font-size:".concat(Xc,"px}")})]})},Hc=n(94184),Vc=n.n(Hc),$c=n(7842),qc=n(83223),Qc=n(722),Kc=n(27184),Yc=n(23038),Jc=n(89321),es=n(6801),ts=n(30827),ns=n(9583),rs=l.createContext({filePath:null,isLoading:!1,threads:{},view:null,placeholderId:null,openThreadId:null,setOpenThreadId:function(){}});function is(e){var t=e.children,n=(0,Ze.Z)(e,["children"]);return(0,a.tZ)(rs.Provider,{value:(0,r.Z)({},n),children:t})}var as=function(e){var t=e.threadId,n=e.onFinalizeMessage,c=void 0===n?function(){}:n,u=e.onChangeMessage,d=void 0===u?function(){}:u,f=e.onRequestClose,h=void 0===f?function(){}:f,m=e.style,v=e.width,g=function(e){var t=function(){if(!f)return null;var t=f.state.field(Mi)[e];if(!t)return null;var n=Math.min(t.indexStart,t.indexEnd),r=Math.max(t.indexStart,t.indexEnd),i=f.state.doc.lineAt(n),a=f.state.doc.lineAt(r),o=f.state.doc.sliceString(f.state.doc.line(Math.max(i.number-2,1)).from,n),c=f.state.doc.sliceString(r,f.state.doc.line(Math.min(a.number+2,f.state.doc.lines)).to);return{precode:o,code:f.state.doc.sliceString(n,r),postcode:c}},n=(0,Qo.Z)().showError,a=(0,br.Z)(),c=(0,S.c)("flag-typing-presence"),s=c.enabled,u=(c.loading,(0,ts.Z)().map((function(e){return e.username}))),d=l.useContext(rs),f=d.view,p=d.filePath,h=(0,U.Z)().fs,m=(0,Jc.GD)({variables:{id:e}}),v=m.data,g=m.error,b=m.loading,x=m.client,Z=!(!v||b||"AnnotationAnchor"===v.thread.__typename),y=l.useMemo((function(){return!v||b?null:"UserError"===v.thread.__typename?{id:e,__typename:"AnnotationAnchor",messages:[],isGeneral:!1,isResolved:!1}:"AnnotationAnchor"===v.thread.__typename?v.thread:null}),[v,e,b]),w=(0,i.Z)((0,Jc.tT)({onError:function(e){return n(e.message)},update:function(e,t){var r,i;t.errors?t.errors.forEach((function(e){return n(e.message)})):"UserError"!==(null===(r=t.data)||void 0===r||null===(i=r.createThread)||void 0===i?void 0:i.__typename)||n(t.data.createThread.message)}}),1),k=w[0],E=(0,i.Z)((0,Jc.AL)({onError:function(e){return n(e.message)},update:function(e,t){var r;if(t.errors)t.errors.forEach((function(e){return n(e.message)}));else{var i=null===(r=t.data)||void 0===r?void 0:r.createThreadMessage;i&&"UserError"===i.__typename&&n(i.message)}}}),1),C=E[0],T=(0,i.Z)((0,Jc.Y)({onError:function(e){return n(e.message)},update:function(e,t){var r;if(t.errors)t.errors.forEach((function(e){return n(e.message)}));else{var i=null===(r=t.data)||void 0===r?void 0:r.updateThread;i&&"UserError"===i.__typename&&n(i.message)}}}),1),R=T[0],_=(0,i.Z)((0,es.Hj)(),1)[0],I=function(){var e=null===v||void 0===v?void 0:v.currentUser;return e?{user:{__typename:"User",id:e.id,username:e.username,image:e.image}}:{}};return{thread:y,isPlaceholder:Z,error:g,loading:b,getHighlight:t,updateThread:function(e){var t,n=e.changes,i="AnnotationAnchor"===(null===v||void 0===v||null===(t=v.thread)||void 0===t?void 0:t.__typename)?v.thread:null;if(!i)throw new Error("expected thread");R({variables:{id:i.id,changes:n},optimisticResponse:{updateThread:(0,D.Z)((0,r.Z)({},i,n),{isResolved:"boolean"===typeof n.isResolved?n.isResolved:i.isResolved})}})},finalizeThreadMessage:function(n){var i,c=n.message,s=n.messageId,l={id:s,text:c,mentions:(0,ns.kW)(c,{users:(0,o.Z)(u).concat(["everyone"])}).mentions};if(Z&&f&&p){var d=f.state.field(zi),m={id:e,replId:a,indexStart:null===d||void 0===d?void 0:d.indexStart,indexEnd:null===d||void 0===d?void 0:d.indexEnd,otVersion:h.getOTVersion(p),path:p};k({variables:{thread:m,message:l},optimisticResponse:{__typename:"RootMutationType",createThread:(0,D.Z)((0,r.Z)({__typename:"AnnotationAnchor"},m,I()),{messages:[(0,D.Z)((0,r.Z)({id:s,timeCreated:Date.now(),currentUserIsAuthor:!0},I()),{content:{text:c,__typename:"TextMessageContentType"},anchor:{id:m.id,__typename:"AnnotationAnchor"},__typename:"AnnotationMessage",seen:!0})],isResolved:!1,isGeneral:!1})}}),x.writeQuery({query:Jc.VO,variables:{id:e},data:{thread:(0,D.Z)((0,r.Z)((0,D.Z)((0,r.Z)({},m),{isResolved:!1,isGeneral:!1}),I()),{messages:[(0,D.Z)((0,r.Z)({id:s,timeCreated:Date.now(),currentUserIsAuthor:!0},I()),{content:{text:c,__typename:"TextMessageContentType"},anchor:{id:m.id,__typename:"AnnotationAnchor"},__typename:"AnnotationMessage",seen:!0})],__typename:"AnnotationAnchor"}),currentUser:null===v||void 0===v?void 0:v.currentUser}});var g=x.readQuery({query:Lc.Jq,variables:{replId:a,path:p}});if(g){var b,y="ThreadsByFileResult"===(null===(b=g.threadsByFile)||void 0===b?void 0:b.__typename)?g.threadsByFile.threads:[],w=I().user;x.writeQuery({query:Lc.Jq,variables:{replId:a,path:p},data:{threadsByFile:{__typename:"ThreadsByFileResult",threads:(0,o.Z)(y).concat([(0,r.Z)({messageCount:1,unreadCount:0,__typename:"AnnotationAnchor",isGeneral:!1,user:w,isResolved:!1,participants:[w]},m)])}}})}}else{var E="AnnotationAnchor"===(null===v||void 0===v||null===(i=v.thread)||void 0===i?void 0:i.__typename)?v.thread:null;if(!E)throw new Error("expected thread");C({variables:{replId:a,threadId:E.id,threadMessage:l,highlight:t()},optimisticResponse:{createThreadMessage:(0,D.Z)((0,r.Z)({},E),{messages:(0,o.Z)(E.messages.filter((function(e){return!e.id.startsWith("chat-")}))).concat([(0,D.Z)((0,r.Z)({},I(),l),{content:{text:l.text,__typename:"TextMessageContentType"},anchor:{id:E.id,__typename:"AnnotationAnchor"},__typename:"AnnotationMessage",timeCreated:Date.now(),currentUserIsAuthor:!0,seen:!0})])})}})}},changeThreadMessage:function(t){var n=t.messageId,r=t.message;_({variables:{threadId:e,messageId:n,message:null!==s&&void 0!==s&&s?r:null}})}}}(t),b=g.thread,x=g.loading,Z=g.isPlaceholder,y=g.updateThread,w=g.changeThreadMessage,k=g.finalizeThreadMessage,E=(0,br.Z)(),T=l.useRef(null),R=l.useRef(null),_=(0,Qc.Z)(null===b||void 0===b?void 0:b.id),I=(0,i.Z)((0,Xa.L)({accept:[C.z.FileNode,C.z.FileHeaderTab],collect:function(e){var t,n=null===(t=e.getItem())||void 0===t?void 0:t.isFolder;return{isOver:e.isOver({shallow:!0})&&!n}},canDrop:function(e){return!e.isFolder},drop:function(e){e&&!e.isFolder&&B({messageId:Wi()(),message:"#".concat(e.path)})}}),2),P=I[0],A=I[1],N=(0,gt.Z)((function(e){var t,n=e.target;n.closest(".node-row")||n.closest(".file-header-tab")||""!==(null===(t=R.current)||void 0===t?void 0:t.value)||h()}),[]);(0,qc.Z)(b),l.useEffect((function(){var e=function(e){var t;"Escape"===e.key&&""===(null===(t=R.current)||void 0===t?void 0:t.value)&&h()};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}),[h]),l.useEffect((function(){T.current&&(T.current.scrollTop=T.current.scrollHeight)}),[null===b||void 0===b?void 0:b.messages]);var j=l.useMemo((function(){var e;if(!(null===b||void 0===b?void 0:b.messages))return[];var t=(0,o.Z)(b.messages).sort((function(e,t){return new Date(e.timeCreated).getTime()-new Date(t.timeCreated).getTime()}));return(e=t).push.apply(e,(0,o.Z)(_.filter((function(e){return!t.slice(-5).find((function(t){return t.id===e.id}))})))),(0,$c.Z)(t)}),[null===b||void 0===b?void 0:b.messages,_]),B=function(e){k(e),c(e),(0,Ut.j)(Ut.U3.MESSAGE_SENT,{replId:E,source:"threads",newThread:Z})};return b||x?(0,a.BX)("div",{style:m,ref:function(e){A(e),N.current=e},className:"jsx-".concat(jc.Q.__hash)+" "+s().dynamic([["45a65f77378283f9",[v]]])+" "+(Vc()("thread-group",{"is-over":P.isOver})||""),children:[x||!b?(0,a.tZ)("div",{css:[p.l0.p(16)],className:"jsx-".concat(jc.Q.__hash)+" "+s().dynamic([["45a65f77378283f9",[v]]]),children:(0,a.BX)(ai.ZP,{viewBox:"0 0 100 20",backgroundColor:p.TV.backgroundHigher,foregroundColor:p.TV.backgroundHighest,speed:1.5,children:[(0,a.tZ)("rect",{x:"0",y:"0",rx:"4",ry:"4",width:"100",height:"8",className:"jsx-".concat(jc.Q.__hash)+" "+s().dynamic([["45a65f77378283f9",[v]]])}),(0,a.tZ)("rect",{x:"0",y:"10",rx:"4",ry:"4",width:"33",height:"8",className:"jsx-".concat(jc.Q.__hash)+" "+s().dynamic([["45a65f77378283f9",[v]]])})]})}):(0,a.BX)(a.HY,{children:[j.length>0&&(0,a.tZ)("div",{ref:T,className:"jsx-".concat(jc.Q.__hash)+" "+s().dynamic([["45a65f77378283f9",[v]]])+" message-group-container",children:j.map((function(e){return(0,a.tZ)(Yc.ZP,{messageGroup:e},e.messages[0].id)}))}),(0,a.tZ)(Kc.Z,{annote:b,onChangeMessage:function(e){w(e),d(e)},onFinalizeMessage:B,ref:R}),(0,a.BX)("div",{className:"jsx-".concat(jc.Q.__hash)+" "+s().dynamic([["45a65f77378283f9",[v]]])+" floating-group",children:[Z?null:(0,a.tZ)("div",{className:"jsx-".concat(jc.Q.__hash)+" "+s().dynamic([["45a65f77378283f9",[v]]])+" delete show-on-hover",children:(0,a.tZ)(q.u,{tooltip:"Resolve",placement:"top",children:(0,a.tZ)("button",{"aria-label":"Resolve",onClick:function(){y({changes:{isResolved:!0}})},className:"jsx-".concat(jc.Q.__hash)+" "+s().dynamic([["45a65f77378283f9",[v]]])+" floating-button resolve",children:(0,a.tZ)(Tt.Z,{})})})}),(0,a.tZ)("div",{className:"jsx-".concat(jc.Q.__hash)+" "+s().dynamic([["45a65f77378283f9",[v]]])+" close",children:(0,a.tZ)(q.u,{tooltip:"Close",placement:"top",children:(0,a.tZ)("button",{"aria-label":"Close",onClick:h,className:"jsx-".concat(jc.Q.__hash)+" "+s().dynamic([["45a65f77378283f9",[v]]])+" floating-button close",children:(0,a.tZ)(pt.Z,{})})})})]})]}),(0,a.tZ)(s(),{id:jc.Q.__hash,children:jc.Q}),(0,a.tZ)(s(),{id:"45a65f77378283f9",dynamic:[v],children:".thread-group.__jsx-style-dynamic-selector{position:absolute;z-index:10;position:relative;display:grid;grid-row-gap:var(--space-16);-webkit-box-pack:stretch;-webkit-justify-content:stretch;-moz-box-pack:stretch;-ms-flex-pack:stretch;justify-content:stretch;background-color:var(--background-default);padding:var(--space-8);-webkit-border-radius:var(--border-radius-4);-moz-border-radius:var(--border-radius-4);border-radius:var(--border-radius-4);width:".concat(v,"px;-webkit-box-shadow:var(--shadow-2);-moz-box-shadow:var(--shadow-2);box-shadow:var(--shadow-2);border:.5px solid var(--background-higher)}.thread-group.is-over.__jsx-style-dynamic-selector{background-color:var(--background-root)}.thread-group.__jsx-style-dynamic-selector *.__jsx-style-dynamic-selector{-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s}.message-group-container.__jsx-style-dynamic-selector{display:grid;grid-row-gap:var(--space-16);max-height:275px;overflow-y:auto;padding:var(--space-8);padding-bottom:0;grid-template-columns:minmax(0,1fr)}.floating-group.__jsx-style-dynamic-selector{position:absolute;display:grid;grid-auto-flow:column;-webkit-box-pack:end;-webkit-justify-content:end;-moz-box-pack:end;-ms-flex-pack:end;justify-content:end;grid-column-gap:8px;top:-32px;left:0;right:0}.floating-group.__jsx-style-dynamic-selector .show-on-hover.__jsx-style-dynamic-selector{opacity:0}.thread-group.__jsx-style-dynamic-selector:hover>.floating-group.__jsx-style-dynamic-selector .show-on-hover.__jsx-style-dynamic-selector{opacity:1}.feedback.__jsx-style-dynamic-selector{position:absolute;text-decoration:none}.floating-button.__jsx-style-dynamic-selector{width:24px;height:24px;-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;background:var(--background-higher);color:var(--foreground-dimmer);border:1px solid var(--background-highest);display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;cursor:pointer;-webkit-box-shadow:var(--shadow-2);-moz-box-shadow:var(--shadow-2);box-shadow:var(--shadow-2)}.floating-button.__jsx-style-dynamic-selector:focus{outline:none}.floating-button.__jsx-style-dynamic-selector:hover{color:var(--foreground-default);background:var(--background-higher)}.floating-button.delete.__jsx-style-dynamic-selector:hover{color:var(--white);background:var(--accent-negative-default);border-color:var(--accent-negative-default)}.floating-button.resolve.__jsx-style-dynamic-selector:hover{color:var(--white);background:var(--accent-positive-default);border-color:var(--accent-positive-default)}.floating-button.__jsx-style-dynamic-selector:active{background:var(--background-highest)}")})]}):null};function os(e){var t=e.threadId,n=l.useContext(rs),r=n.threads,i=n.isLoading,o=n.placeholderId,c=n.openThreadId,s=n.setOpenThreadId,u=n.view,d=c===t,f=o===t,p="/replEnvironment2"===(0,la.useRouter)().pathname;if(!u)return null;var h=p?u.dom.getBoundingClientRect().width:u.dom.getBoundingClientRect().right;return i?null:r[t]||f?(0,a.tZ)(q.G7,{css:{position:"fixed",left:h,transform:"translateX(-100%)"},className:"thread-ui",children:d||f?(0,a.tZ)(as,{style:{transform:"translateX(100%)"},width:225,onRequestClose:function(){s(null),f&&u.dispatch({effects:[Oi.of(null)]})},threadId:t}):(0,a.tZ)(Wc,{threadPreview:r[t],onClick:function(){return s(t)}})}):null}function cs(e){var t=e.setThreadsTooltips,n=e.setPlaceholderThreadId,i=e.setOpenThreadId,c=e.view,s=function(e,n){var i=function(e){t((function(t){return(0,D.Z)((0,r.Z)({},t),(0,ve.Z)({},n,(0,a.tZ)(s,{onLayout:e})))}))},o=u[n];if(!o){var c=document.createElement("div");c.classList.add("cm-tooltip-thread"),o=u[n]={tooltip:{dom:c,update:function(e){e.viewportChanged&&i((function(){(0,H.E2)(e.view)}))}},Portal:function(e){var t=e.onLayout;return l.useLayoutEffect((function(){null===t||void 0===t||t()}),[t]),A.createPortal((0,a.tZ)(os,{threadId:n}),c)}}}var s=o.Portal;return i(),o.tooltip},u={};return[Li,Mi,zi,H.tk.decorations.compute([Mi,zi],(function(e){var t=e.field(Mi),n=e.field(zi);return H.p.set((0,o.Z)(Object.values(t)).concat((0,o.Z)(n?[n]:[])).map((function(e){return t=e.id,n=e.indexStart,r=e.indexEnd,n===r?null:H.p.mark({class:"replit-thread-highlight cm-thread-".concat(t),id:t}).range(n,r);var t,n,r})).filter((function(t){return null!==t&&t.from!==t.to&&t.from<=e.doc.length&&t.to<=e.doc.length})),!0)})),H.tk.updateListener.of((function(e){var t,r=null===(t=e.view.state.field(zi))||void 0===t?void 0:t.id;n(null!==r&&void 0!==r?r:null),r&&i(r)})),H.hJ.computeN([Mi,zi],(function(e){var t=e.field(Mi),n=Object.values(t).map((function(e){return{pos:Math.min(e.indexStart,e.indexEnd),above:!0,create:function(){return s(0,e.id)}}})),r=(0,o.Z)(n),i=e.field(zi);return i&&r.push({pos:Math.min(i.indexStart,i.indexEnd),above:!0,create:function(){return s(0,i.id)}}),r})),H.tk.updateListener.of((function(e){(0,$.j)(e,Gi,(function(t){var n=t.value,r=e.state.field(Mi)[n];r&&(null===c||void 0===c||c.dispatch({selection:{anchor:r.indexStart,head:r.indexStart},effects:[H.tk.scrollIntoView(r.indexStart,{x:"nearest",y:"nearest"})]}))}))}))]}function ss(e){var t=e.view,n=e.filePath,a=e.isLoading,o=e.enable,c=(0,i.Z)(l.useState({}),2),s=c[0],u=c[1],d=(0,i.Z)((0,ea.KO)(ta.Q),2),f=d[0],p=d[1];l.useEffect((function(){t&&f&&t.dispatch({effects:[Gi.of(f)]})}),[t,f]);var h=(0,i.Z)(l.useState(null),2),m=h[0],v=h[1],g=(0,gn.Z)({view:t});l.useEffect((function(){if(t&&o)return t.dispatch({effects:g.reconfigure(cs({view:t,setThreadsTooltips:u,setPlaceholderThreadId:v,setOpenThreadId:p}))}),function(){t.dispatch({effects:g.reconfigure([])})}}),[t,n,g,o]);var b=Mc(n,a,!0,o);return function(e,t,n,i){var a=(0,U.Z)().fs,o=(0,Gc.kL)(n),c=o.contentRef,s=o.loadedFile,u=o.transformSelectionRef;l.useEffect((function(){var o=!1,l=u.current,d=c.current;if(s&&l&&d&&!i&&t){var f=Object.values(e);0!==f.length?Promise.all(f.map((function(e){return(0,Gc.Ft)({anchor:e,version:a.getOTVersion(n),transformSelection:l,content:d})}))).then((function(e){if(!o){var n=e.filter((function(e){return Boolean(e)})).map((function(e){if(!e)throw new Error("expected resolved anchor");return(0,r.Z)({},e.anchor,null===e||void 0===e?void 0:e.newSelection)}));return t.dispatch({effects:ji.of(n.reduce((function(e,t){return e[t.id]=t,e}),{}))}),function(){o=!0,t&&t.dispatch({effects:ji.of({})})}}})):t.dispatch({effects:ji.of({})})}}),[e,t,s,a,u,c,n,i])}(b,t,n,a),{threadPreviews:b,setPlaceholderThreadId:v,placeholderThreadId:m,openThreadId:f,setOpenThreadId:p,threadsTooltips:s}}var ls=n(34528);function us(e){var t=e.view,n=e.filePath,a=e.enable,c=e.isLoading,s=function(e){return[X.Wl.highest((0,Fi.zj)(h)),Fi.cR,Fi.OQ,Fi.ZS,Fi.PQ,H.tk.decorations.compute([Fi.OQ,Fi.ZS,Fi.PQ],(function(e){var t=e.field(Fi.OQ),n=e.field(Fi.ZS),r=e.field(Fi.PQ),i=n||Object.values(t).find((function(e){return e.id===r}));return i?H.p.set([i].map((function(e){return t=e.id,n=e.indexStart,r=e.indexEnd,n===r?null:H.p.mark({class:"replit-thread-highlight cm-thread-".concat(t),id:t}).range(n,r);var t,n,r})).filter((function(t){return null!==t&&t.from!==t.to&&t.from<=e.doc.length&&t.to<=e.doc.length})),!0):H.p.none})),H.tk.decorations.compute([Fi.OQ,Fi.ZS,Fi.PQ],(function(e){var t=e.field(Fi.OQ),n=e.field(Fi.ZS),r=e.field(Fi.PQ),i=(0,o.Z)(Object.values(t)).concat((0,o.Z)(n?[n]:[])).filter(Boolean).find((function(e){return e.id===r}));return i?H.p.set([H.p.widget({widget:new Fi.nE(i.id,f),block:!0,side:1}).range(i.indexEnd)],!0):H.p.none})),H.tk.updateListener.of((function(e){(0,$.j)(e,Ji.R,(function(){var t=(0,o.Z)(e.view.dom.querySelectorAll(".cm-thread-portal-widget")),n=e.view.dom.querySelector(".cm-scroller"),r=e.view.dom.querySelector(".cm-gutters");if(t.length&&n&&r){var i=!0,a=!1,c=void 0;try{for(var s,l=t[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;(0,ls.L)(u,n,r)}}catch(d){a=!0,c=d}finally{try{i||null==l.return||l.return()}finally{if(a)throw c}}}}))})),H.tk.updateListener.of((function(e){(0,$.j)(e,Fi.eR,(function(n){var r=n.value,i=e.state.field(Fi.OQ)[r];i&&(null===t||void 0===t||t.dispatch({selection:{anchor:i.indexStart,head:i.indexStart},effects:[H.tk.scrollIntoView(i.indexStart,{x:"center",y:"center"})]}))}))}))]},u=(0,i.Z)(l.useState({}),2),d=u[0],f=u[1],p=(0,gn.Z)({view:t}),h=(0,or.useApolloClient)(),m=(0,ea.Dv)(ta.Q);l.useEffect((function(){t&&m&&t.dispatch({effects:[Fi.YM.of(m),Fi.eR.of(m)]})}),[t,m]),l.useEffect((function(){if(t&&a)return t.dispatch({effects:p.reconfigure(s())}),function(){t.dispatch({effects:p.reconfigure([])})}}),[t,n,p,a]);return function(e,t,n,i){var a=(0,U.Z)().fs,o=(0,Gc.kL)(n),c=o.contentRef,s=o.loadedFile,u=o.transformSelectionRef;l.useEffect((function(){var o=!1,l=u.current,d=c.current;if(s&&l&&d&&!i&&t){var f=Object.values(e);0!==f.length?Promise.all(f.map((function(e){return(0,Gc.Ft)({anchor:e,version:a.getOTVersion(n),transformSelection:l,content:d})}))).then((function(e){if(!o){var n=e.filter((function(e){return Boolean(e)})).map((function(e){if(!e)throw new Error("expected resolved anchor");return(0,r.Z)({},e.anchor,null===e||void 0===e?void 0:e.newSelection)}));return t.dispatch({effects:Fi.qi.of(n.reduce((function(e,t){return e[t.id]=t,e}),{}))}),function(){o=!0,t&&t.dispatch({effects:Fi.qi.of({})})}}})):t.dispatch({effects:Fi.qi.of({})})}}),[e,t,s,a,u,c,n,i])}(Mc(n,c,!0,a),t,n,c),{threadElements:d}}var ds=function(e){var t=e.source,n=(0,it.Z)(t);return(0,a.tZ)(a.HY,{children:Array.from(n,(function(e){var t=(0,i.Z)(e,2),n=t[0],r=t[1];return(0,a.tZ)(l.Fragment,{children:r},n)}))})},fs=n(53153),ps=n(79848);function hs(e){return{filePath:e,text:"",selections:[],hasFocus:!1}}function ms(e,t){return null==t?hs(e):{filePath:e,text:null!==(n=t.state.doc.toString())&&void 0!==n?n:"",selections:t.state.selection.ranges.map((function(e){var t=e.from;return{location:t,length:e.to-t}})),hasFocus:t.hasFocus};var n}function vs(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Wi()(),i=ms(e,t),a={messageType:fs.cF.TEXT_EDITOR_STATE,filePath:e,text:i.text,selections:i.selections,hasFocus:i.hasFocus,revisionId:n.revisionId};(0,ps.b)(a,r)}function gs(e,t,n,r,i){return r===e&&r===n.textEditorState.filePath&&(t===n.textEditorState.filePath&&i===n.revisionId)}function bs(e){var t=e.map((function(e){return X.jT.range(e.location,e.location+e.length)}));return X.jT.create(t)}function xs(e,t,n,r,i){var a=i.payload;if((0,fs.Se)(a))return function(e,t,n,r,i){if(!gs(e,t,r,i.filePath,i.revisionId))return!1;var a=bs(i.selections);return n.dispatch({selection:a,scrollIntoView:!0}),!0}(e,t,n,r,a);if((0,fs.m7)(a))return function(e,t,n,r,i){if(!gs(e,t,r,i.filePath,i.revisionId))return!1;var a=ms(e,n),o=bs(i.selections);return n.dispatch({changes:{from:0,to:a.text.length,insert:i.text},selection:o,scrollIntoView:!0}),!0}(e,t,n,r,a);if((0,fs.ac)(a))return function(e,t,n,r,i){if(!gs(e,t,r,i.filePath,i.revisionId))return!1;var a=i.insertionRange,o=bs(i.selections);return n.dispatch({changes:{from:a.location,to:a.location+a.length,insert:i.text},selection:o,scrollIntoView:!0}),!0}(e,t,n,r,a);if((0,fs.fz)(a))return function(e,t,n,r,i){return!!gs(e,t,r,i.filePath,i.revisionId)&&(n.dispatch(n.state.replaceSelection(i.text)),!0)}(e,t,n,r,a);if((0,fs.T$)(a))!function(e,t,n,r,i){!!gs(e,t,r,i.filePath,i.revisionId)&&Ei({activeFile:e,view:n,clipboardText:i.text})}(e,t,n,r,a);else{if(!(0,fs.aB)(a))throw new Error("Invalid payload.");switch(a.action){case fs.b9.REQUEST_BLUR:return function(e,t,n,r,i,a){if(!gs(e,t,r,i,a))return!1;n.contentDOM.blur()}(e,t,n,r,a.filePath,a.revisionId);case fs.b9.REQUEST_UNDO:return function(e,t,n,r,i,a){if(!gs(e,t,r,i,a))return!1;return(0,v.Yw)(n),!0}(e,t,n,r,a.filePath,a.revisionId);case fs.b9.REQUEST_REDO:return function(e,t,n,r,i,a){if(!gs(e,t,r,i,a))return!1;return(0,v.KX)(n),!0}(e,t,n,r,a.filePath,a.revisionId);case fs.b9.REQUEST_INDENT_SELECTION:return function(e,t,n,r,i){return!!gs(e,t,r,i.filePath,i.revisionId)&&(v.at(n),!0)}(e,t,n,r,a);case fs.b9.REQUEST_DEDENT_SELECTION:return function(e,t,n,r,i){return!!gs(e,t,r,i.filePath,i.revisionId)&&(v.xi(n),!0)}(e,t,n,r,a);case fs.b9.REQUEST_TOGGLE_COMMENT:return function(e,t,n,r,i){return!!gs(e,t,r,i.filePath,i.revisionId)&&(v.O8(n),!0)}(e,t,n,r,a);case fs.b9.REQUEST_FOCUS:return function(e){return e.focus(),!0}(n);default:throw new Error("Unknown BridgeTextEditorAction.")}}}function Zs(e){var t=e.view,n=e.filePath,r=(0,la.useRouter)().query,i=Boolean(r.mobileBridge),a=(0,l.useRef)({revisionId:Wi()(),textEditorState:hs(n)}),o=(0,l.useRef)(n),c=(0,gn.Z)({view:t});(0,l.useEffect)((function(){if(t&&i){var e=ms(n,t);a.current={revisionId:Wi()(),textEditorState:e},vs(n,t,a.current);return t.dispatch({effects:c.reconfigure(H.tk.updateListener.of((function(r){(r.docChanged||r.selectionSet||r.focusChanged)&&function(r){r.docChanged?(a.current={revisionId:Wi()(),textEditorState:e},vs(n,t,a.current)):(r.selectionSet||r.focusChanged)&&(a.current={revisionId:a.current.revisionId,textEditorState:e},vs(n,t,a.current))}(r)})))}),function(){t.dispatch({effects:c.reconfigure([])})}}}),[t,n,c,i]),(0,l.useEffect)((function(){if(t&&i){var e=function(e){vs(n,t,a.current,e.messageId)},r=function(r){xs(n,o.current,t,a.current,r)?e(r):(0,ps.p)(r.messageId)},c=function(r){xs(n,o.current,t,a.current,r)?e(r):(0,ps.p)(r.messageId)},s=function(){var t=(0,j.Z)(O().mark((function t(n){var i,a;return O().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,i=n.data,(0,fs.CF)(i)){t.next=4;break}return t.abrupt("return");case 4:if(i.protocolVersion===fs.Wj){t.next=6;break}return t.abrupt("return");case 6:a=i.payload,i.messageDirection===fs.s1.TO_NATIVE&&(0,fs.H7)(a)&&(o.current=a.activePaneFilePath),t.t0=a.messageType,t.next=t.t0===fs.cF.ERROR||t.t0===fs.cF.ACK?11:t.t0===fs.cF.WORKSPACE_STATE||t.t0===fs.cF.WORKSPACE_STATE_REQUEST||t.t0===fs.cF.WORKSPACE_REQUEST_ACTION||t.t0===fs.cF.TEXT_EDITOR_CLOSED||t.t0===fs.cF.RESET?12:t.t0===fs.cF.TEXT_EDITOR_STATE?13:t.t0===fs.cF.TEXT_EDITOR_STATE_REQUEST?14:t.t0===fs.cF.REQUEST_SET_SELECTION?16:t.t0===fs.cF.REQUEST_REPLACE_SELECTION?18:t.t0===fs.cF.REQUEST_SET_TEXT?20:t.t0===fs.cF.REQUEST_INSERT_TEXT?22:t.t0===fs.cF.REQUEST_PASTE_TEXT?24:t.t0===fs.cF.TEXT_EDITOR_REQUEST_ACTION?26:28;break;case 11:case 12:case 13:return t.abrupt("break",29);case 14:return e(i),t.abrupt("break",29);case 16:case 18:case 20:case 22:case 24:return r(i),t.abrupt("break",29);case 26:return c(i),t.abrupt("break",29);case 28:throw new Error("Unknown BridgeMessageType.");case 29:t.next=35;break;case 31:throw t.prev=31,t.t1=t.catch(0),new Error("Invalid message: ".concat(t.t1));case 35:case"end":return t.stop()}}),t,null,[[0,31]])})));return function(e){return t.apply(this,arguments)}}();return window.addEventListener("message",s),vs(n,t,a.current),function(){!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wi()(),n={messageType:fs.cF.TEXT_EDITOR_CLOSED,filePath:e};(0,ps.b)(n,t)}(n),window.removeEventListener("message",s)}}}),[t,n,i])}var ys=n(88512),ws=n(76818),ks=n(25245),Es=n(24949),Ss=function(e){var t=e.caretSize,n=void 0===t?[8,12]:t,i=(0,Ze.Z)(e,["caretSize"]);return(0,a.BX)("svg",(0,D.Z)((0,r.Z)({width:n[0],height:n[1],viewBox:"0 0 12 8",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i),{children:[(0,a.tZ)("mask",{id:"outline",fill:"white",children:(0,a.tZ)("path",{d:"M0 8L5.2 1.06667C5.6 0.533333 6.40033 0.533776 6.80033 1.06711C8.67223 3.56297 9.93719 5.24959 12 8H0Z"})}),(0,a.tZ)("path",{d:"M0 8L5.2 1.06667C5.6 0.533333 6.40033 0.533776 6.80033 1.06711C8.67223 3.56297 9.93719 5.24959 12 8H0Z",fill:"url(#gradient-fill)"}),(0,a.tZ)("path",{d:"M0 8L-0.8 7.4L-2 9H0V8ZM12 8V9H14L12.8 7.4L12 8ZM5.2 1.06667L4.4 0.466667L5.2 1.06667ZM6.80033 1.06711L6.00033 1.66711L6.80033 1.06711ZM12 7H0V9H12V7ZM0.8 8.6L6 1.66667L4.4 0.466667L-0.8 7.4L0.8 8.6ZM6.00033 1.66711C7.87223 4.16297 9.13719 5.84959 11.2 8.6L12.8 7.4C10.7372 4.64959 9.47223 2.96297 7.60033 0.467109L6.00033 1.66711ZM6 1.66667L6.00033 1.66711L7.60033 0.467109C6.80082 -0.598902 5.20049 -0.600655 4.4 0.466667L6 1.66667Z",fill:"#0079F2",mask:"url(#outline)"}),(0,a.tZ)("defs",{children:(0,a.BX)("linearGradient",{id:"gradient-fill",x1:"5.07692",y1:"0",x2:"5.07692",y2:"21.3333",gradientUnits:"userSpaceOnUse",children:[(0,a.tZ)("stop",{stopColor:"#57ABFF"}),(0,a.tZ)("stop",{offset:"1",stopColor:"#0079F2"})]})})]}))},Cs=n(2230),Ts=n(51593),Rs=n(16449),_s=n(1138),Is=n(95716),Ps=n(18332),Ds=n(96594);function As(){var e=(0,ir.Z)(["\n  query InlineThreadCurrentUser {\n    currentUser {\n      id\n    }\n  }\n"]);return As=function(){return e},e}var Ns={},Us=(0,ar.ZP)(As());var js=n(70804),Bs=n(19526),Os=n(1855),Gs=n(11731),Ls=function(e){var t=e.isCreating,n=e.threadId,r=e.filePath,i=e.isResolved,o=e.isLoading,c=e.isPlaceholder,s=e.caretPosition,u=e.onRequestClose,d=void 0===u?function(){}:u,f=e.onResolveThread,p=void 0===f?function(){}:f,h="Inbox",m="Next thread",v="Previous thread",g="Collapse",b=Mc(null===r?"":r,o,!0,!0),x=[12,8];switch((0,F.Z)().preferences.fontSize){case 10:x=[8,6];break;case 14:x=[10,6];break;case 18:x=[12,8];break;case 24:x=[14,10]}var Z=l.useMemo((function(){return Object.values(b).sort((function(e,t){return e.indexStart-t.indexStart}))}),[b]),y=l.useMemo((function(){return Z.findIndex((function(e){return e.id===n}))}),[Z,n]),w=(0,ea.b9)(ta.Q),k=(0,ea.b9)(ta.c),E=function(){var e=(0,j.Z)(O().mark((function e(){var t;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=y===Z.length-1?Z[0].id:Z[y+1].id,w(t);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=(0,j.Z)(O().mark((function e(){var t;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=0===y?Z[Z.length-1].id:Z[y-1].id,w(t);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),C=(0,ea.b9)(Gs.Bm);return(0,a.BX)(q.Tg,{background:"root",css:[q.l0.flex.row,q.l0.align.center,q.l0.justify.spaceBetween,q.l0.position.relative,q.l0.px(12),q.l0.py(8),{borderBottomWidth:q.TV.borderWidthDefault,borderBottomStyle:"solid",borderBottomColor:q.TV.outlineDimmest}],children:[null!==s&&(0,a.tZ)("span",{css:[q.l0.position.absolute,q.l0.top(-x[1]),q.l0.left(s),q.l0.height("fit-content"),q.l0.display.flex,q.l0.flex.row,q.l0.align.center],children:(0,a.tZ)(Ss,{caretSize:x})}),(0,a.tZ)(q.zx,{iconLeft:(0,a.tZ)(_s.Z,{}),onClick:function(){k(!0),C()},text:h,small:!0}),Z.length>1?(0,a.BX)(q.G7,{css:[q.l0.flex.row,q.l0.align.center,q.l0.rowWithGap(4)],children:[(0,a.tZ)(q.hU,{alt:v,onClick:S,children:(0,a.tZ)(ws.Z,{})}),(0,a.BX)(q.xv,{color:"dimmest",variant:"small",children:[y+1,"/",Z.length]}),(0,a.tZ)(q.hU,{alt:m,onClick:E,children:(0,a.tZ)(ys.Z,{})})]}):null,(0,a.BX)(q.G7,{css:[q.l0.flex.row,q.l0.align.center,q.l0.rowWithGap(4)],children:[t||i||c?null:(0,a.tZ)(q.zx,{onClick:p,text:"Resolve",small:!0,iconLeft:(0,a.tZ)(Tt.Z,{})}),!t&&i?(0,a.tZ)(q.DR,{text:"Resolved",colorway:"positive"}):null,(0,a.tZ)(q.zx,{onClick:d,text:g,small:!0,iconLeft:(0,a.tZ)(Ts.Z,{})})]})]})},Ms=function(e){var t,n,o,c=e.threadId,u=e.isResolved,d=e.onMessageChange,f=e.onMessageSubmit,p=e.isPlaceholder,h=e.onRequestClose,m=void 0===h?function(){}:h,v=(0,i.Z)(l.useState(""),2),g=v[0],b=v[1],x=(0,i.Z)(l.useState(Ui().v4()),2),Z=x[0],y=x[1],w=(0,Rs.Z)(),k=w.ref,E=w.update,S=l.useRef(null),C={placeholder:function(){return p?"Start a new thread\u2026 (Markdown is supported)":u?"Reply to re-open thread\u2026":"Reply\u2026 (Markdown is supported)"}},T="Post comment",R="Cancel",_=function(){var e=g.trim();0!==e.length&&(f({message:e,messageId:Z}),b(""),y(Ui().v4()))},I=null===(t=function(e){var t=(0,r.Z)({},Ns,e);return or.useQuery(Us,t)}().data)||void 0===t||null===(n=t.currentUser)||void 0===n?void 0:n.id,P=(0,ts.Z)(),A=(0,i.Z)((0,Ps.Z)({"@":function(){var e=(0,j.Z)(O().mark((function e(t){var n,r;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=P.filter((function(e){return e.id!==I})),t&&(r=t.toLowerCase(),n=n.filter((function(e){return e.username.toLowerCase().startsWith(r)}))),e.abrupt("return",n.slice(0,5).map((function(e){return{icon:(0,a.tZ)(zc.Z,{url:e.image,style:{height:"24px",width:"24px",minWidth:"24px",minHeight:"24px"}}),value:e.username}})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),2),N=A[0].suggestions,U=A[1],B=(0,Ds.Kb)({items:(null===N||void 0===N?void 0:N.results)||[],defaultHighlightedIndex:0,isOpen:(null!==(o=null===N||void 0===N?void 0:N.results.length)&&void 0!==o?o:0)>0,onSelectedItemChange:function(e){var t=e.selectedItem;if(N&&t){var n=N.applySuggestion({targetValue:g,suggestionValue:t.value}),r=n.fullValue,i=n.cursorIndex;b(r),setTimeout((function(){S.current&&(S.current.setSelectionRange(i,i),S.current.focus(),E())}))}}}),G=B.isOpen,L=B.getInputProps,M=B.getMenuProps,z=B.getItemProps,F=B.highlightedIndex,X=B.getComboboxProps;return l.useEffect((function(){var e="threads/drafts/".concat(c),t=Ko.Z.get(e,"string");t&&b(t);var n=S.current;return function(){if(n){var t=n.value;0!==t.length?Ko.Z.set(e,t):Ko.Z.remove(e)}}}),[c]),(0,a.BX)(q.Tg,{background:"root",css:[q.l0.px(12),q.l0.pb(8),q.l0.pt(8),{borderTop:"1px solid ".concat(q.TV.outlineDimmest)}],className:"inline-thread-input",children:[(0,a.BX)(q.G7,(0,D.Z)((0,r.Z)({css:[q.l0.flex.row,q.l0.align.start,q.l0.rowWithGap(8),q.l0.width("full")]},X()),{children:[p?(0,a.tZ)(q.zx,{text:R,onClick:m}):null,(0,a.BX)(js.Z,{isOpen:G,placement:"bottom-start",padding:0,children:[(0,a.tZ)(q.G7,{children:(0,a.tZ)(q.B,(0,r.Z)({},L({ref:function(e){S.current=e,k(e),U(e)},value:g,onChange:function(e){var t=e.target.value;b(t),d({message:t,messageId:Z})},onKeyDown:function(e){G||"Enter"!==e.key||e.shiftKey||(e.stopPropagation(),e.preventDefault(),_(),requestAnimationFrame((function(){E()})))},placeholder:C.placeholder(),css:[q.l0.height(32),q.l0.align.start,{resize:"vertical",width:"100%",flexGrow:1}],autoFocus:!0})))}),(0,a.tZ)("div",(0,D.Z)((0,r.Z)({},M({className:"mention-menu"})),{className:"jsx-45ff32690e481e34",children:null===N||void 0===N?void 0:N.results.map((function(e,t){return(0,l.createElement)(Bs.Ug,(0,D.Z)((0,r.Z)({},z({item:e,index:t,css:[F===t?q.l0.backgroundColor.backgroundHighest:null,q.l0.p(8)]})),{spacing:2,key:e.value,children:[e.icon,(0,a.tZ)("div",{className:"jsx-45ff32690e481e34",children:e.value})]}))}))}))]}),(0,a.tZ)(q.G7,{css:[q.l0.pt(4)],children:(0,a.tZ)(q.hU,{alt:T,onClick:_,children:(0,a.tZ)(ks.Z,{})})})]})),(0,a.tZ)(s(),{id:"45ff32690e481e34",children:".inline-thread-input .popover-control-container{-webkit-box-flex:1;-webkit-flex-grow:1;-moz-box-flex:1;-ms-flex-positive:1;flex-grow:1}"})]})};var zs=function(e){var t,n=e.threadId,r=e.isCreating,i=e.isResolved,c=void 0!==i&&i,s=e.onRequestClose,u=void 0===s?function(){}:s,d=e.view,f=e.filePath,p=(0,Cs.Z)(n,d,f),h=p.thread,m=p.loading,v=p.isPlaceholder,g=p.getLatestAnchor,b=p.updateThread,x=p.changeThreadMessage,Z=p.finalizeThreadMessage,y=(0,F.Z)().preferences.fontSize,w=(0,l.useRef)(null);(0,qc.Z)(h);var k=g(),E=d&&!m&&"number"===typeof(null===k||void 0===k?void 0:k.indexEnd)&&k.indexEnd<=d.state.doc.length?null===(t=d.coordsAtPos(k.indexEnd))||void 0===t?void 0:t.left:null,S=(null===d||void 0===d?void 0:d.dom.getBoundingClientRect().left)||null,C=E&&S?E-S-6:null,T=y;switch(y){case 10:T=13;break;case 14:T=19;break;case 18:T=25;break;case 24:T=34}var R=(0,Qo.Z)().showConfirm,_=(0,br.Z)(),I=(0,l.useRef)(null);l.useEffect((function(){setTimeout((function(){I.current&&(I.current.scrollTop=I.current.scrollHeight)}),0)}),[null===h||void 0===h?void 0:h.messages]);var P=l.useMemo((function(){return(null===h||void 0===h?void 0:h.messages)?(0,o.Z)(h.messages).sort((function(e,t){return Date.parse(e.timeCreated)-Date.parse(t.timeCreated)})):[]}),[null===h||void 0===h?void 0:h.messages]),D=function(e){var t=(0,l.useRef)(0);return(0,Ar.Z)((function(n){var r=n.height;r!==t.current&&(null===e||void 0===e||e.requestMeasure()),t.current=r}))}(d);return(0,a.BX)(q.G7,{innerRef:(0,Os.l)(w,D),css:[q.l0.font.default,{borderTopWidth:q.TV.borderWidthDefault,borderBottomWidth:q.TV.borderWidthDefault,borderStyle:"solid",borderColor:q.TV.accentPrimaryDefault}],children:[v||m?null:(0,a.tZ)(Ls,{isCreating:r,isResolved:c,isLoading:m,threadId:n,filePath:f,caretPosition:C,isPlaceholder:v,onRequestClose:u,onResolveThread:function(){b({changes:{isResolved:!0}}),R("Thread resolved. You can reopen it from the inbox.")}}),m?(0,a.tZ)(q.G7,{css:[q.l0.height(T)],children:(0,a.tZ)(ai.ZP,{viewBox:"0 0 400 21",backgroundColor:q.TV.accentPrimaryDimmest,backgroundOpacity:0,foregroundColor:q.TV.accentPrimaryDimmest,foregroundOpacity:.2,speed:1,children:(0,a.tZ)("rect",{x:"0",y:"0",width:"100%",height:"100%"})})}):(0,a.BX)(a.HY,{children:[!r&&P.length>0?(0,a.tZ)("div",{css:[q.l0.px(12),q.l0.py(12),q.l0.maxHeight(300),q.l0.overflowY("auto"),q.l0.colWithGap(16),q.l0.fontSize(y)],ref:I,children:P.map((function(e){return(0,a.tZ)(Es.Z,{thread:h,message:e},e.id)}))}):null,(0,a.tZ)(Ms,{threadId:n,isPlaceholder:v,isResolved:c,onRequestClose:u,onMessageChange:x,onMessageSubmit:function(e){Z(e),(0,Ut.j)(Is.U3.MESSAGE_SENT,{replId:_,source:"threads",newThread:v})}})]})]})};function Fs(e){var t=e.threadId,n=e.view,r=e.filePath;return(0,a.tZ)("div",{css:[q.l0.width("100%"),q.l0.backgroundColor.backgroundRoot],children:(0,a.tZ)(zs,{threadId:t,onRequestClose:function(){n.dispatch({effects:[Fi.YM.of(null)]})},view:n,filePath:r})})}var Xs=(0,At.iv)({position:"relative",overflowY:"auto",width:"100%",height:"100%",zIndex:3}),Ws=(0,At.iv)({position:"relative",overflowY:"auto",width:"100%",height:"100%",fontSize:"14px",backgroundColor:q.TV.backgroundDefault}),Hs=(0,At.iv)({display:"flex",alignItems:"stretch",width:"100%",height:"100%","& > .cm-editor":{flex:"1 1 auto",width:"100%"}}),Vs=(0,At.iv)({position:"absolute",left:0,top:0,height:"100%",width:"100%",overflow:"hidden",zIndex:5});function $s(e){var t=e.filePath,n=e.onType,o=e.onFocus,c=e.autoFocus,s=e.deeplink,d=(0,U.Z)(),f=d.fs,p=d.debuggest,h=d.presence,m=d.session,v="/replEnvironment2"===ua().pathname,g=(0,S.c)("flag-threads-2"),b=g.enabled,Z=g.loading,y=(0,sa.Z)({filePath:t,noHistory:!0,onException:function(e){(0,ro.xp)(e,{tags:{codemirror:!0}})}}),w=y.view,k=y.ref;(0,x.VD)(w);var E=La({view:w,presence:h,session:m,fs:f,filePath:t}).isLoading;!function(e){var t=e.view,n=e.isLoading,r=e.autoFocus;l.useEffect((function(){r&&t&&(n||t.focus())}),[t,n,r])}({view:w,autoFocus:c,isLoading:E}),ha({view:w,filePath:t,isLoading:E}),xn({view:w}),function(e){var t=e.view,n=function(e,t){var n=performance.now();Mr.kg.time(e,n-t)},r=(0,gn.Z)({view:t});l.useEffect((function(){if(t)return t.dispatch({effects:r.reconfigure(X.Wl.highest(H.tk.domEventHandlers({keydown:function(e){if(Math.random()<.001){var t=e.timeStamp;requestAnimationFrame((function(){n("editor input latency",t),"undefined"!==typeof requestIdleCallback?requestIdleCallback((function(){n("editor input latency after layout",t)})):setTimeout((function(){n("editor input latency after layout",t)}))}))}}})))}),function(){t.dispatch({effects:r.reconfigure([])})}}),[t,r])}({view:w}),function(e){var t=e.view,n=(0,U.Z)().session;l.useEffect((function(){if(t)return n.onEditorFocused((function(){t.focus()}))}),[n,t])}({view:w}),(0,no.Y)({view:w});var T=function(){var e=l.useRef((0,Dt.u)(new Map)).current,t=l.useCallback((function(t){var n=new Map(e.current);t(n),e.current=n}),[e]),n=l.useCallback((function(){e.current=new Map}),[e]);return(0,on.Z)((function(){return{observable:e,update:t,unmount:n}}),[t,e,n])}();!function(e){var t=e.view,n=(0,la.useRouter)(),r=(0,fa.V)(n),i=(0,gn.Z)({view:t});(0,l.useEffect)((function(){if(t&&!r)return t.dispatch({effects:i.reconfigure([(0,W.ys)({defaultKeymap:!1,icons:!1,addToOptions:[da.t]})])}),function(){t.dispatch({effects:i.reconfigure([])})}}),[t,i,r])}({view:w}),On({view:w,filePath:t,isLoading:E,decorations:T}),function(e){var t=e.view,n=e.filePath,r=e.isLoading,i=(0,U.Z)().anchorer,a=(0,ea.Dv)(ta.Q);l.useEffect((function(){t&&a&&t.dispatch({effects:[oa.of(a)]})}),[t,a]);var o=ca(i);(0,gn.Z)({view:t,initialExtension:[na,o,H.tk.updateListener.of((function(e){(0,$.j)(e,oa,(function(n){var r=n.value,i=e.state.field(o).find((function(e){return e.id===r}));i&&(null===t||void 0===t||t.dispatch({selection:{anchor:i.indexStart,head:i.indexStart},effects:[H.tk.scrollIntoView(i.indexStart,{x:"nearest",y:"nearest"})]}))}))}))]}),l.useEffect((function(){if(!r&&t&&n){var e=!1;i.getAnchors(n).then((function(n){if(e)return!0;t.dispatch({effects:[ra.of(n)]})}));var a=i.onAnchorsAdded((function(e){var r=e.filter((function(e){return e.path===n}));t.dispatch({effects:ia.of(r)})})),o=i.onAnchorsRemoved((function(e){t.dispatch({effects:aa.of(e)})}));return function(){e=!0,a(),o()}}}),[r,n,t])}({view:w,filePath:t,fs:f,isLoading:E}),er({view:w,debuggest:p,filePath:t,isLoading:E});var R=Vi({view:w,filePath:t}),_=R.onAction,I=R.actions,j=R.contextMenuCoords,B=R.onContextMenu,G=R.closeMenu,L=R.resizeRef,M=function(e){var t=e.view,n=e.filePath,r=e.isLoading,a=Ki({replId:(0,br.Z)()}),o=(0,i.Z)(l.useState(null),2),c=o[0],s=o[1],u=(0,gn.Z)({view:t});return l.useEffect((function(){if(t&&a&&!r&&n===a.mainFile){var e=document.createElement("div");return s(e),t.dispatch({effects:u.reconfigure((0,H.W$)(e))}),function(){t.dispatch({effects:u.reconfigure([])}),s(null)}}}),[t,a,n,r,u]),c}({view:w,filePath:t,isLoading:E}),z=function(e){var t=e.view,n=(0,i.Z)(l.useState(null),2),r=n[0],a=n[1],o=(0,gn.Z)({view:t});return l.useEffect((function(){if(t){var e=document.createElement("div");return a(e),t.dispatch({effects:o.reconfigure([(0,Rr.yC)({createPanel:function(){return{top:!0,pos:80,dom:e,mount:function(){var t=e.querySelector("[main-field]");t&&(t.focus(),t.select())}}}}),H.$f.of([{win:"Ctrl-h",linux:"Ctrl-h",preventDefault:!0,run:function(){return t.dispatch({effects:_r.of(null)}),(0,Rr.nx)(t)}}])])}),function(){t.dispatch({effects:o.reconfigure([])}),a(null)}}}),[t,o]),r}({view:w});!function(e){var t=e.filePath,n=e.view,r=e.isLoading,i=e.deeplink,a=(0,U.Z)().session;l.useEffect((function(){if(n&&!r&&i){var e=i.line,t=i.col;e&&Yi({view:n,line:e,col:t})}}),[n,r,i]),l.useEffect((function(){if(n&&!r)return a.onDeeplinkUpdated((function(e){var r=e.path,i=e.line,a=e.col;r===t&&i&&Yi({view:n,line:i,col:a})}))}),[a,n,t,r])}({filePath:t,view:w,isLoading:E,deeplink:s}),function(e){var t=e.view,n=e.onType,r=e.filePath,i=(0,gn.Z)({view:t});l.useEffect((function(){if(t&&n&&r)return t.dispatch({effects:i.reconfigure(H.tk.updateListener.of((function(e){e.docChanged&&(e.transactions.some((function(e){return e.annotation(X.YW.remote)}))||n((0,Gr.r6)(r)||r===Ma.l?Ma.l:""))})))}),function(){t.dispatch({effects:i.reconfigure([])})}}),[t,n,r,i])}({view:w,onType:n,filePath:t}),function(e){var t=e.view,n=e.onFocus,r=(0,gn.Z)({view:t});(0,l.useEffect)((function(){if(t&&n)return t.dispatch({effects:r.reconfigure(H.tk.updateListener.of((function(e){e.focusChanged&&e.view.hasFocus&&n(e.view)})))}),function(){t.dispatch({effects:r.reconfigure([])})}}),[t,n,r])}({view:w,onFocus:o}),function(e){var t=e.view,n=(0,gn.Z)({view:t}),r=(0,P.xZ)();l.useEffect((function(){if(t&&!(0,u.isMobile)({tablet:!0})){var e=r?[Fa.Gj,Fa._j,Fa.yK,Fa.gm,Fa.ZF]:[];return e.push(Fa.ZF),t.dispatch({effects:n.reconfigure((0,za.ZP)({rules:e}))}),function(){t.dispatch({effects:n.reconfigure([])})}}}),[t,n,r])}({view:w}),function(e){var t=e.view,n=(0,gn.Z)({view:t}),r=(0,U.Z)().fs,i=(0,tn.Z)(),a=(0,P.xZ)();l.useEffect((function(){if(t)return t.dispatch({effects:n.reconfigure(H.tk.domEventHandlers({paste:function(e){var n,o=null===e||void 0===e||null===(n=e.clipboardData)||void 0===n?void 0:n.files,c=function(e){var n=t.state.selection.main.head;t.dispatch({changes:{from:n,insert:e},selection:{anchor:n,head:n+e.length}})};if(o){var s=!0,l=!1,u=void 0;try{for(var d,f=o[Symbol.iterator]();!(s=(d=f.next()).done);s=!0){var p=d.value;a?(0,Ha.L0)(p).then((function(e){return c('"'+e+'"')})):i&&(0,Gr.gK)(i)&&Ka(p,r,i).then(c)}}catch(h){l=!0,u=h}finally{try{s||null==f.return||f.return()}finally{if(l)throw u}}}}}))}),function(){t.dispatch({effects:n.reconfigure([])})}}),[t,n,i,r,a])}({view:w}),function(e){var t=e.view,n=(0,gn.Z)({view:t}),r=(0,tn.Z)();l.useEffect((function(){if(t)return t.dispatch({effects:n.reconfigure(H.tk.domEventHandlers({paste:function(e){var n;Ei({activeFile:r,view:t,event:e,clipboardText:null===(n=e.clipboardData)||void 0===n?void 0:n.getData("Text")})}}))}),function(){t.dispatch({effects:n.reconfigure([])})}}),[t,n,r])}({view:w}),function(e){var t=e.view,n=(0,gn.Z)({view:t}),r=(0,P.f6)();l.useEffect((function(){if(t&&r)return t.dispatch({effects:n.reconfigure(to)}),function(){t.dispatch({effects:n.reconfigure([])})}}),[t,n,r])}({view:w}),function(e){var t=e.view,n=(0,gn.Z)({view:t}),r=(0,U.Z)().session;l.useEffect((function(){var e=function(){return r.setIsCommandBarOpen(!0),!0};if(t)return t.dispatch({effects:n.reconfigure(H.$f.of([{key:"Mod-Shift-p",run:e,preventDefault:!0},{key:"F1",run:e,preventDefault:!0}]))}),function(){t.dispatch({effects:n.reconfigure([])})}}),[t,r,n])}({view:w});var V=function(e){var t=e.view,n=(0,U.Z)().fs,r=(0,tn.Z)(),a=(0,P.xZ)();return(0,i.Z)((0,Xa.L)({accept:[C.z.Code,Wa.FILE],drop:function(e,i){if(t){var o=i.getClientOffset(),c=o?t.posAtCoords(o):null;if(null!==c){var s=function(e){t.focus(),t.dispatch({changes:{from:c,insert:e},selection:{anchor:c,head:c+e.length}})};if(e.type===C.z.Code)s(e.code);else{var l=!0,u=!1,d=void 0;try{for(var f,p=e.files[Symbol.iterator]();!(l=(f=p.next()).done);l=!0){var h=f.value;a?(0,Ha.L0)(h).then((function(e){return s('"'+e+'"')})):r&&(0,Gr.gK)(r)&&Ka(h,n,r).then(s)}}catch(m){u=!0,d=m}finally{try{l||null==p.return||p.return()}finally{if(u)throw d}}}}}}}),2)[1]}({view:w});!function(e){var t=e.filePath,n=e.view,r=e.decorations,i=(0,br.Z)(),a=(0,or.useApolloClient)(),o=(0,Kr.Sf)(t),c=(0,S.c)("flag-code-suggestion"),s=c.enabled,u=(c.loading,(0,F.Z)().preferences),d=(0,gn.Z)({view:n}),f=(0,on.Z)((function(){return new ac}),[o,t,i]),p=(0,on.Z)((function(){return new Set}),[]);(0,l.useEffect)((function(){return function(){p.forEach((function(e){return e.unsubscribe()}))}}),[p]),(0,l.useEffect)((function(){tc.C.toggle(Boolean(u.codeSuggestion))}),[u.codeSuggestion]),(0,l.useEffect)((function(){if(n&&s&&u.codeSuggestion&&cc.has(o)){var e=function(){var e=(0,co.Z)(O().mark((function e(n){var r,a,c,s,l,d,p,h,m,v,g,b,x,Z,y,w,k,E,S,C,T,R,_,I;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.code,a=n.signal,c=n.maxTokens,r){e.next=3;break}return e.abrupt("return");case 3:if((s=u.codeSuggestionEngine).includes("self-hosted")||(s="self-hosted-large"),l=Mr.kg.timeStart({language:o,engine:s,replid:i,codeLength:r.length}),d={language:o,code:r,replId:i,filePath:t,engine:s,maxTokens:c,stop:["\n\n"]},p=tc.C.add(d),a.addEventListener("abort",(function(){tc.C.abort(p)})),null==(m=f.get(r))){e.next=15;break}h=(0,co.Z)(O().mark((function e(){return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m;case 2:case"end":return e.stop()}}),e)}))),e.next=23;break;case 15:return e.next=17,(0,oo.Z)(fetch("/suggest_code",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},signal:a,body:JSON.stringify(d)}));case 17:if(v=e.sent,g=v.body){e.next=21;break}throw new Error("No body in response");case 21:b=new TextDecoder("utf-8"),h=(0,co.Z)(O().mark((function e(){var t,n,r,i,a,o,c;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=!1,n=!1,e.prev=1,i=(0,ao.Z)(sc(g));case 3:return e.next=5,(0,oo.Z)(i.next());case 5:if(!(t=!(a=e.sent).done)){e.next=13;break}return o=a.value,c=o,e.next=10,b.decode(c,{stream:!0});case 10:t=!1,e.next=3;break;case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(1),n=!0,r=e.t0;case 19:if(e.prev=19,e.prev=20,!t||null==i.return){e.next=24;break}return e.next=24,i.return();case 24:if(e.prev=24,!n){e.next=27;break}throw r;case 27:return e.finish(24);case 28:return e.finish(19);case 29:case"end":return e.stop()}}),e,null,[[1,15,19,29],[20,,24,28]])})));case 23:x="",Z="",y=!0,w=!1,k=!1,E=!1,e.prev=28,C=(0,ao.Z)(h());case 30:return e.next=32,(0,oo.Z)(C.next());case 32:if(!(k=!(T=e.sent).done)){e.next=51;break}R=T.value,Z+=R,_=void 0;case 37:if(-1===(_=Z.indexOf("\n"))){e.next=48;break}if(I=JSON.parse(Z.substring(0,_)).text,w){e.next=42;break}return e.next=42,I;case 42:y&&(l("code suggestion",{type:"success"}),y=!1),Z=Z.substring(_+1),oc(x+=I).halt&&(w=!0),e.next=37;break;case 48:k=!1,e.next=30;break;case 51:e.next=57;break;case 53:e.prev=53,e.t0=e.catch(28),E=!0,S=e.t0;case 57:if(e.prev=57,e.prev=58,!k||null==C.return){e.next=62;break}return e.next=62,C.return();case 62:if(e.prev=62,!E){e.next=65;break}throw S;case 65:return e.finish(62);case 66:return e.finish(57);case 67:if(x.trim().length&&!f.has(r)&&f.setSuggestion(r,x),w||!Z){e.next=71;break}return e.next=71,Z;case 71:tc.C.complete(p,{__typename:"SuggestCodeResult",id:Date.now().toString(),code:x});case 72:case"end":return e.stop()}}),e,null,[[28,53,57,67],[58,,62,66]])})));return function(t){return e.apply(this,arguments)}}();return n.dispatch({effects:d.reconfigure(ec({path:t,engine:u.codeSuggestionEngine,suggestCode:e,decorations:r}))}),function(){n.dispatch({effects:d.reconfigure([])})}}}),[n,f,s,d,t,a,o,i,p,r,u.codeSuggestion,u.codeSuggestionEngine])}({view:w,filePath:t,decorations:T});var q=function(e){var t=e.view,n=e.filePath,r=(0,i.Z)(l.useState(null),2),a=r[0],o=r[1],c=(0,gn.Z)({view:t});return l.useEffect((function(){if(t)return t.dispatch({effects:c.reconfigure(hi({setExplainCodeParams:o,view:t,filePath:n}))}),function(){t.dispatch({effects:c.reconfigure([])})}}),[t,c,n]),a}({view:w,filePath:t}),Q=function(e){var t=e.view,n=(0,i.Z)(l.useState(null),2),r=n[0],a=n[1],o=(0,gn.Z)({view:t}),c=l.useCallback((function(){if(!t)throw new Error("did not expect to be asked to open generate code modal without view");t.dispatch({effects:Si.of(!0)})}),[t]);return l.useEffect((function(){if(t)return t.dispatch({effects:o.reconfigure(Ti({view:t,setGenerateCodePortalProps:a}))}),function(){t.dispatch({effects:o.reconfigure([])})}}),[t,o]),{generateCodePortalProps:r,openGenerateCodeModal:c}}({view:w}),K=Q.generateCodePortalProps,Y=Q.openGenerateCodeModal,J=function(e){var t=e.view,n=(0,i.Z)(l.useState(null),2),r=n[0],a=n[1],o=(0,gn.Z)({view:t}),c=l.useCallback((function(){if(!t)throw new Error("did not expect to be asked to open transform code modal without view");t.dispatch({effects:Ri.of(!0)})}),[t]);return l.useEffect((function(){if(t)return t.dispatch({effects:o.reconfigure(Ii({view:t,setTransformCodePortalProps:a}))}),function(){t.dispatch({effects:o.reconfigure([])})}}),[t,o]),{transformCodePortalProps:r,openTransformCodeModal:c}}({view:w}).transformCodePortalProps,ee=function(e){var t=e.view,n=e.filePath,r=(0,i.Z)(l.useState(null),2),a=r[0],o=r[1],c=(0,gn.Z)({view:t}),s=wi(n);return l.useEffect((function(){if(t&&s)return t.dispatch({effects:c.reconfigure(Ai({view:t,setSearchCodePortalProps:o}))}),function(){t.dispatch({effects:c.reconfigure([])})}}),[t,c,s]),{searchCodePortalProps:a}}({view:w,filePath:t}).searchCodePortalProps,te=ss({view:w,filePath:t,isLoading:E,enable:v&&!Z&&!b}),ne=us({view:w,filePath:t,isLoading:E,enable:v&&!Z&&!!b});return Zs({view:w,filePath:t}),(0,a.BX)("div",{ref:L,css:Ws,"data-cy":E?"workspace-cm-editor-loading":"workspace-cm-editor-".concat(t),children:[E&&(0,a.tZ)("div",{css:Vs,children:(0,a.tZ)(N.Z,{})}),(0,a.tZ)("div",{ref:function(e){k(e),V(e)},onContextMenu:B,css:Hs}),j&&w?(0,a.tZ)(en.ZP,{view:w,coords:j,actions:I,closeMenu:G,onAction:_}):null,q?q.node:null,K?(0,a.tZ)(kc,(0,D.Z)((0,r.Z)({},K),{filePath:t})):null,J?(0,a.tZ)(_c,(0,D.Z)((0,r.Z)({},J),{filePath:t})):null,ee?(0,a.tZ)(Oc,(0,D.Z)((0,r.Z)({},ee),{filePath:t})):null,M?(0,a.tZ)(Tr,{dom:M,onShowGenerateCodeModal:Y}):null,z?(0,a.tZ)(Or,{dom:z,view:w}):null,(0,a.tZ)(ds,{source:T.observable}),w&&(0,a.tZ)(is,{view:w,filePath:t,isLoading:E,threads:te.threadPreviews,openThreadId:te.openThreadId,setOpenThreadId:te.setOpenThreadId,placeholderId:te.placeholderThreadId,children:Object.entries(te.threadsTooltips).map((function(e){var t=(0,i.Z)(e,2),n=t[0],r=t[1];return(0,a.tZ)(l.Fragment,{children:r},n)}))}),w&&(0,a.tZ)(a.HY,{children:Object.entries(ne.threadElements).map((function(e){var n=(0,i.Z)(e,2),r=n[0],o=n[1];return A.createPortal((0,a.tZ)(Fs,{threadId:r,view:w,filePath:t}),o)}))})]})}var qs=n(93705),Qs=n(61957),Ks=n(66421);function Ys(){var e=(0,Ks.IY)();return(0,l.useCallback)((function(t,n,i){e({error:t,tags:{source:"ws-history2",type:n},extras:(0,r.Z)({state:qs.BI.current()},i)})}),[e])}function Js(e){(0,Ut.j)(Is.U3.HISTORY_USED,{action:e,which:"ws"})}function el(e){var t=e.filePath,n=(0,i.Z)((0,qs.oQ)(),1)[0],r=(0,i.Z)((0,qs.bA)(),1)[0],o=Ys(),c=(0,l.useRef)({content:null,current:0,desired:0}),s=!n||n&&!r,u=(0,sa.Z)({filePath:t,noHistory:!0,readOnly:!0,onException:function(e){o(e,"viewer-codemirror",{displayState:c.current})}}),d=u.view,f=u.ref;return(0,x.VD)(d),xn({view:d}),(0,no.Y)({view:d}),(0,l.useEffect)((function(){try{var e=c.current;if(!d||!r||s)return e.content=null,e.current=0,void(e.desired=0);if(e.desired=r.version,null===e.content){var t=(0,Qs.ZK)("",0,e.desired+1,r.edits);e.content=t.content,e.current=e.desired,d.dispatch({changes:{from:0,to:d.state.doc.length,insert:e.content}})}if(e.current!==e.desired){var n=(0,Qs.ZK)(e.content,e.current+1,e.desired+1,r.edits),i=n.content,a=n.location;e.content=i,e.current=e.desired,d.dispatch({changes:{from:0,to:d.state.doc.length,insert:e.content},effects:a?H.tk.scrollIntoView(a,{yMargin:10}):void 0})}}catch(l){o(l,"viewer",{displayState:c.current})}}),[d,r,s,o]),(0,a.BX)("div",{css:Ws,children:[s&&(0,a.tZ)("div",{css:Vs,children:(0,a.tZ)(N.Z,{})}),r&&0!==r.count?(0,a.tZ)("div",{css:Ws,children:(0,a.tZ)("div",{ref:f,css:Hs})}):(0,a.tZ)(tl,{})]})}function tl(){return(0,a.tZ)("div",{css:[Ws,{display:"flex",alignItems:"center",justifyContent:"center"}],children:(0,a.tZ)("span",{children:"This file has no history."})})}var nl=n(50522);function rl(){var e,t,n,r,o=(0,i.Z)((0,qs.bA)(),2),c=o[0],s=o[1],u=(null!==(t=null===c||void 0===c||null===(e=c.edits)||void 0===e?void 0:e.length)&&void 0!==t?t:1)-1,d=null!==(n=null===c||void 0===c?void 0:c.version)&&void 0!==n?n:0,f=null!==(r=null===c||void 0===c?void 0:c.playing)&&void 0!==r&&r,p=!c||0===c.count,h=(0,nl.t)(d,(function(e){return s({version:e})}),u),m=h.isPlaying,v=h.start,g=h.stop;(0,l.useEffect)((function(){m&&!f?g():!m&&f&&v()}),[f,m,v,g]);var b="Loading...";return c&&(m?b="Pause":c.version===c.count-1?b="Play file history from beginning":0===c.version?b="Play file history":c.version>0&&(b="Play file history from here")),(0,a.tZ)(q.hU,{alt:b,size:32,disabled:p,onClick:function(){s(d===u?{version:0,playing:!0}:{playing:!f})},children:m?(0,a.tZ)(Yo.Pause,{}):(0,a.tZ)(Yo.Play,{})})}function il(){var e=(0,i.Z)((0,qs.bA)(),1)[0];return e&&0!==e.count?(0,a.BX)(q.G7,{css:[q.l0.rowWithGap(4),q.l0.justify.spaceBetween],children:[(0,a.tZ)(q.xv,{css:{minWidth:"4ch",textAlign:"center"},children:e.version+1}),(0,a.tZ)(q.xv,{css:{width:"1ch",textAlign:"center"},color:"dimmer",children:"/"}),(0,a.tZ)(q.xv,{css:{minWidth:"4ch",textAlign:"center"},color:"dimmer",children:e.count})]}):null}function al(){var e=(0,ir.Z)(["\n  query WorkspaceHistory2Users($ids: [Int!]!) {\n    currentUser {\n      id\n      username\n      image\n    }\n    usersByIds(ids: $ids) {\n      id\n      username\n      image\n    }\n  }\n"]);return al=function(){return e},e}var ol=(0,ar.ZP)(al());function cl(e,t,n){return new Promise((function(r,i){try{var a=e.watchOtFile(t,{onReady:function(){var e=(0,j.Z)(O().mark((function e(t){var o;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n(t);case 3:o=e.sent,r(o),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),i(e.t0);case 10:a();case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()})}catch(o){i(o)}}))}function sl(e,t){return cl(e,t,function(){var e=(0,j.Z)(O().mark((function e(t){var n,r;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.fetchOps,0!==(r=t.version)){e.next=3;break}return e.abrupt("return",[]);case 3:return e.t0=Qs.HJ,e.next=6,n(1,r);case 6:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}function ll(e,t){return ul.apply(this,arguments)}function ul(){return ul=(0,j.Z)(O().mark((function e(t,n){var r,i,a,c,s,l,u,d,f,p,h,m,v,g,b,x,Z,y;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=new Set,i=!0,a=!1,c=void 0,e.prev=2,s=n[Symbol.iterator]();case 4:if(i=(l=s.next()).done){e.next=12;break}if(0!==(u=l.value).userId){e.next=8;break}return e.abrupt("continue",9);case 8:r.add(u.userId);case 9:i=!0,e.next=4;break;case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(2),a=!0,c=e.t0;case 18:e.prev=18,e.prev=19,i||null==s.return||s.return();case 21:if(e.prev=21,!a){e.next=24;break}throw c;case 24:return e.finish(21);case 25:return e.finish(18);case 26:if(0!==r.size){e.next=28;break}return e.abrupt("return",{});case 28:return e.next=30,t.query({query:ol,variables:{ids:Array.from(r)}});case 30:if(d=e.sent,f=d.data,!(p=d.error)){e.next=35;break}throw p;case 35:for(h=f.currentUser?[f.currentUser].concat((0,o.Z)(f.usersByIds)):f.usersByIds,m={},v=!0,g=!1,b=void 0,e.prev=38,x=h[Symbol.iterator]();!(v=(Z=x.next()).done);v=!0)y=Z.value,m[y.id]={id:y.id,username:y.username,image:y.image};e.next=46;break;case 42:e.prev=42,e.t1=e.catch(38),g=!0,b=e.t1;case 46:e.prev=46,e.prev=47,v||null==x.return||x.return();case 49:if(e.prev=49,!g){e.next=52;break}throw b;case 52:return e.finish(49);case 53:return e.finish(46);case 54:return e.abrupt("return",m);case 55:case"end":return e.stop()}}),e,null,[[2,14,18,26],[19,,21,25],[38,42,46,54],[47,,49,53]])}))),ul.apply(this,arguments)}function dl(){return(dl=(0,j.Z)(O().mark((function e(t,n,r){var i,a;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,sl(t,r);case 2:return i=e.sent,e.next=5,ll(n,i);case 5:return a=e.sent,e.abrupt("return",{edits:i,users:a});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function fl(e,t,n){return cl(e,t,function(){var t=(0,j.Z)(O().mark((function t(r){var i,a,o,c;return O().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=r.fetchOps,a=r.writeOp,o=r.version,!(n>o)){t.next=3;break}throw new Error("Cannot restore to a version that does not exist");case 3:if(n!==o){t.next=5;break}return t.abrupt("return");case 5:return t.t0=Qs.HJ,t.next=8,i(1,o);case 8:return t.t1=t.sent,c=(0,t.t0)(t.t1),a((0,Qs.UK)(n,c),{isUnicode:!0}),t.next=13,e.flush();case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}var pl=n(23600);function hl(e){var t=e.showTimestamp,n=void 0===t||t,r=(0,i.Z)((0,qs.oQ)(),1)[0],o=(0,i.Z)((0,qs.bA)(),1)[0],c=(0,l.useMemo)((function(){return(0,a.tZ)(q.n5,{small:!0,src:"/public/images/logo-modern-small.png",username:"Your Repl",localRole:"Server Authored"})}),[]),s=(0,l.useMemo)((function(){return(0,a.tZ)(q.n5,{small:!0,src:"/public/images/ghost.svg",username:"Unknown Author"})}),[]);if(!r||!o)return null;if(0===o.count)return c;var u=o.edits[o.version],d=o.userElements[u.userId];return d||(d=u.timestamp>pl.p?c:s),(0,a.BX)(a.HY,{children:[d,n&&(0,a.BX)(a.HY,{children:[(0,a.tZ)("span",{children:"\u2022"}),(0,a.tZ)(q.EK,{dateFormat:"switch",date:u.timestamp,css:q.l0.mr(4)})]})]})}var ml=(0,At.iv)({display:"grid",gridTemplateColumns:"auto 1fr",rowGap:"0.5rem",columnGap:"1rem","> dt":{display:"flex",alignItems:"center",fontWeight:"bold"}});function vl(){var e=(0,l.useState)(!1),t=e[0],n=e[1],r=(0,l.useState)(!1),o=r[0],c=r[1],s=(0,U.Z)().fs,u=(0,i.Z)((0,qs.oQ)(),2)[1],d=(0,i.Z)((0,qs.bA)(),1)[0],f=Ys(),p="Restore",h=!0;function m(){return(m=(0,j.Z)(O().mark((function e(){var t,r;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d&&s&&!o){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,c(!0),Js("versionRestored"),t=d.filePath,r=d.version,e.next=8,fl(s,t,r+1);case 8:n(!1),c(!1),u(!1),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),f(e.t0,"restore");case 16:case"end":return e.stop()}}),e,null,[[2,13]])})))).apply(this,arguments)}return d?0===d.count?(p="No history",h=!0):o||t?(p="Restoring...",h=!0):d.playing?(p="Playing...",h=!0):d.version===d.count-1?(p="Viewing latest",h=!0):(p="Restore to ".concat(d.version+1),h=!1):(p="Loading...",h=!0),(0,a.BX)(a.HY,{children:[(0,a.tZ)(q.zx,{text:p,disabled:h,onClick:function(){return n(!0)}}),d&&0!==d.count&&(0,a.tZ)(q.u_,{isOpen:t,onRequestClose:function(){o||n(!1)},children:(0,a.BX)(q.G7,{css:q.l0.colWithGap(12),children:[(0,a.tZ)(q.h4,{variant:"headerDefault",level:2,children:"Restore file version"}),(0,a.tZ)(q.Tg,{elevated:!0,css:[q.l0.px(16),q.l0.py(12),q.l0.borderRadius(8)],children:(0,a.BX)("dl",{css:ml,children:[(0,a.tZ)("dt",{children:"File"}),(0,a.tZ)("dd",{children:d.filePath}),(0,a.tZ)("dt",{children:"Version"}),(0,a.BX)("dd",{children:[d.version+1,(0,a.BX)("span",{css:[q.l0.color.foregroundDimmest],children:[(0,a.tZ)("span",{css:q.l0.mx(8),children:"/"}),d.count]})]}),(0,a.tZ)("dt",{children:"Date"}),(0,a.tZ)("dd",{children:(0,a.tZ)(q.EK,{date:d.edits[d.version].timestamp,dateFormat:"absolute"})}),(0,a.tZ)("dt",{children:"Author"}),(0,a.tZ)("dd",{children:(0,a.tZ)(hl,{showTimestamp:!1})})]})}),(0,a.tZ)(q.E_,{icon:(0,a.tZ)(Yo.Info,{}),colorway:"positive",text:"Restoring is non-destructive. A new version will be added to the end of the file history with the restored content."}),(0,a.BX)(q.G7,{css:[q.l0.rowWithGap(8),q.l0.justify.end],children:[(0,a.tZ)(q.zx,{text:"Cancel",disabled:o,onClick:function(){return n(!1)}}),(0,a.tZ)(q.zx,{text:o?"Restoring...":"Restore",disabled:o,colorway:"primary",onClick:function(){return m.apply(this,arguments)}})]})]})})]})}var gl=new(function(){function e(){(0,be.Z)(this,e),this.map=new Map}var t=e.prototype;return t.getOrInit=function(e){var t=this.map.get(e);return t||(t=new Map,this.map.set(e,t)),t},t.add=function(e,t,n){this.getOrInit(e).set(t,n)},t.flush=function(){var e=!0,t=!1,n=void 0;try{for(var r,a=this.map[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var o=(0,i.Z)(r.value,2),c=o[0],s=o[1];if(c&&"current"in c&&(c=c.current),c){var l=!0,u=!1,d=void 0;try{for(var f,p=s[Symbol.iterator]();!(l=(f=p.next()).done);l=!0){var h=(0,i.Z)(f.value,2),m=h[0],v=h[1];c.style.setProperty(m,v)}}catch(g){u=!0,d=g}finally{try{l||null==p.return||p.return()}finally{if(u)throw d}}}}}catch(g){t=!0,n=g}finally{try{e||null==a.return||a.return()}finally{if(t)throw n}}this.map.clear()},e}()),bl=!1;function xl(e,t,n){if(null!==e){if("string"===typeof t){if(void 0===n)throw new Error("value is undefined when prop is string");gl.add(e,t,n)}else for(var r in t)gl.add(e,r,t[r]);bl||(bl=!0,requestAnimationFrame((function(){gl.flush(),bl=!1})))}}function Zl(e,t){var n=(0,i.Z)((0,qs.bA)(),1)[0],r=(0,l.useRef)(null);(0,l.useImperativeHandle)(t,(function(){return r.current})),n&&r.current&&(r.current.setAttribute("aria-valuemin","1"),r.current.setAttribute("aria-valuemax",String(n.count)),r.current.setAttribute("aria-valuenow",String(n.version+1)));var o=(0,l.useMemo)((function(){return(0,a.tZ)("div",{ref:r,role:"slider",tabIndex:0,css:{position:"absolute",top:"-6px",left:"calc((100% - 16px) * var(--scrubber-progress, 0))",width:"16px",height:"16px",backgroundColor:q.TV.accentPrimaryDefault,borderRadius:"100%",outline:"none",cursor:"pointer",transition:"left var(--scrubber-transition-time, 100ms) ease-out",willChange:"left, transition",":focus":{boxShadow:"0 0 0 1px ".concat(q.TV.foregroundDefault," inset")}}})}),[]);return n&&n.count>1?o:null}var yl=(0,l.forwardRef)(Zl);function wl(e,t){var n=(0,i.Z)((0,qs.bA)(),1)[0],r=(0,l.useMemo)((function(){return(0,a.BX)(a.HY,{children:[(0,a.tZ)("div",{ref:t,"aria-hidden":!0,css:{position:"relative",top:"-6px",width:"100%",height:"16px",margin:0,cursor:"pointer"}}),(0,a.tZ)("div",{"aria-hidden":!0,css:{position:"absolute",top:0,left:0,width:"100%",height:"4px",margin:0,backgroundColor:q.TV.backgroundHigher,pointerEvents:"none"}}),(0,a.tZ)("div",{"aria-hidden":!0,css:{position:"absolute",top:0,left:0,width:"100%",height:"4px",margin:0,backgroundColor:q.TV.accentPrimaryDefault,pointerEvents:"none",transformOrigin:"left",transform:"scaleX(var(--scrubber-progress, 0))",transition:"transform var(--scrubber-transition-time, 100ms) ease-out",willChange:"transform, transition"}})]})}),[t]),o=(0,l.useMemo)((function(){return(0,a.tZ)("div",{ref:t,"aria-hidden":!0,css:{position:"absolute",top:0,left:0,width:"100%",height:"4px",margin:0,backgroundColor:q.TV.backgroundHigher,pointerEvents:"none"}})}),[t]);return n&&n.count>1?r:o}var kl,El=(0,l.forwardRef)(wl),Sl=["ArrowLeft","ArrowRight","Home","End"];function Cl(){var e=(0,i.Z)((0,qs.bA)(),2),t=e[0],n=e[1],r=(0,l.useState)(!1),o=r[0],c=r[1],s=(0,l.useRef)(null),u=(0,l.useRef)(null),d=(0,l.useRef)(null),f=function(e){xl(s,"--scrubber-transition-time",e)},p=function(e){xl(s,"--scrubber-progress",e.toString())};if(t&&!o){var h=t.version/(t.count-1);p(h),t.playing?f("50ms"):f("100ms")}return(0,l.useEffect)((function(){if(t&&u.current&&d.current&&!o){var e=u.current,r=d.current,i=function(i){if(0===i.button){c(!0),r.focus();var a=e.getBoundingClientRect(),o=r.getBoundingClientRect(),s=a.width,l=o.width,u=i.target===e?l/2:i.clientX-o.left,d=null,h=function(e){var r=e-a.left-u,i=Math.max(0,Math.min(1,r/(s-l)));i!==d&&(d=i,p(i),n({version:Math.round(i*(t.count-1)),playing:!1}))};h(i.clientX);var m=function(e){f("0ms"),h(e.clientX),e.preventDefault(),e.stopPropagation()},v=function(){window.removeEventListener("pointermove",m),window.removeEventListener("pointerup",v),window.removeEventListener("pointercancel",v),f("100ms"),c(!1)};window.addEventListener("pointermove",m),window.addEventListener("pointerup",v),window.addEventListener("pointercancel",v),i.preventDefault(),i.stopPropagation()}};return e.addEventListener("pointerdown",i),r.addEventListener("pointerdown",i),function(){e.removeEventListener("pointerdown",i),r.removeEventListener("pointerdown",i)}}}),[t,n,o]),(0,l.useEffect)((function(){if(t&&d.current&&!o){var e=d.current,r=function(e){if(t&&Sl.includes(e.key)){var r=e.shiftKey?10:1,i=t.version,a=t.count-1,o=Math.max(0,i-r),c=Math.min(a,i+r),s=null;switch(e.key){case"ArrowLeft":s=o;break;case"ArrowRight":s=c;break;case"Home":s=0;break;case"End":s=a}null!==s&&(n({version:s,playing:!1}),e.preventDefault(),e.stopPropagation())}};return e.addEventListener("keydown",r),function(){e.removeEventListener("keydown",r)}}}),[t,n,o]),(0,l.useMemo)((function(){return(0,a.BX)(q.G7,{innerRef:s,css:{position:"absolute",top:0,left:0,width:"100%",margin:0,touchAction:"none","--scrubber-progress":1,"--scrubber-transition-time":"100ms",":hover, :focus-within":{filter:"brightness(1.1)"},":hover:focus-within":{filter:"brightness(1.2)"}},children:[(0,a.tZ)(El,{ref:u}),(0,a.tZ)(yl,{ref:d})]})}),[])}function Tl(e){var t=(0,l.useState)({data:null,loading:!0,error:null}),n=t[0],r=t[1],i=(0,U.Z)().fs,a=(0,or.useApolloClient)();return(0,l.useEffect)((function(){if(e){r({data:null,loading:!0,error:null});var t=!1;return function(e,t,n){return dl.apply(this,arguments)}(i,a,e).then((function(e){t||r({data:e,loading:!1,error:null})})).catch((function(e){t||((0,Ce.Z)(e,Error)||(e=new Error(e)),r({data:null,loading:!1,error:e}))})),function(){t=!0}}r({data:null,loading:!1,error:null})}),[e,i,a]),n}function Rl(e){var t=e.filePath,n=(0,l.useState)(t),r=n[0],o=n[1],c=(0,i.Z)((0,qs.oQ)(),2),s=c[0],u=c[1],d=(0,i.Z)((0,qs.bA)(),2)[1],f=Ys(),p=s&&t===r;t!==r&&(o(t),u(!1));var h=Tl(p?t:null),m=h.data,v=h.loading,g=h.error;return(0,l.useEffect)((function(){if(g)f(g,"history2-index",{filePath:t});else if(m&&!v)return d({filePath:t,edits:m.edits,users:m.users}),Js("historyLoaded"),function(){d(null)}}),[t,m,v,g,d,u,f]),p?(0,a.BX)(q.G7,{css:[q.l0.zIndex(3),q.l0.rowWithGap(16),q.l0.px(4),q.l0.pb(8),q.l0.pt(12),q.l0.align.center,q.l0.backgroundColor.backgroundDefault,{boxShadow:"rgba(2, 2, 3, 0.25) 0px -16px 32px 0px"}],children:[(0,a.tZ)(Cl,{}),(0,a.BX)(q.G7,{css:[q.l0.rowWithGap(16),q.l0.align.center,q.l0.justify.spaceBetween,q.l0.width("100%")],children:[(0,a.tZ)(_l,{justify:"flex-start",children:(0,a.tZ)(rl,{})}),(0,a.tZ)(_l,{justify:"center",children:(0,a.tZ)(il,{})}),(0,a.tZ)(_l,{justify:"flex-end",children:(0,a.tZ)(vl,{})})]})]}):null}function _l(e){var t=e.children,n=e.justify;return(0,a.tZ)("div",{css:{display:"flex",flexGrow:1,flexBasis:0,justifyContent:n},children:t})}function Il(){var e=(0,i.Z)((0,qs.oQ)(),2),t=e[0],n=e[1];return(0,a.BX)(a.HY,{children:[(0,a.tZ)(hl,{}),(0,a.tZ)(q.hU,{alt:t?"Close file history":"View file history",size:18,onClick:function(){n(!t),Js(t?"historyExplicitlyClosed":"historyOpened")},children:t?(0,a.tZ)(Yo.Close,{}):(0,a.tZ)(Yo.History,{color:q.TV.foregroundDimmest})})]})}function Pl(e){var t=e.selection;if(t.ranges.length>1){var n=t.ranges.reduce((function(e,t){return e+(t.to-t.from)}),0);return{count:t.ranges.length,length:n}}var r=t.ranges[0],i=e.doc.lineAt(r.head);return{line:i.number,col:r.head-i.from,length:r.to-r.from}}function Dl(){var e=(0,l.useState)(null),t=e[0],n=e[1],r=(0,x.uN)(),i=(0,gn.Z)({view:r});if((0,l.useEffect)((function(){if(r)return r.dispatch({effects:i.reconfigure(H.tk.updateListener.of((function(e){e.selectionSet&&n(Pl(e.state))})))}),n(Pl(r.state)),function(){r.dispatch({effects:i.reconfigure([])})}}),[r,i]),null===t)return null;var o="";return o="count"in t?"".concat(t.count," selections"):"Line ".concat(t.line," : Col ").concat(t.col+1),t.length>0&&(o+=" (".concat(t.length," chars)")),(0,a.tZ)(q.xv,{css:[q.l0.color.foregroundDimmest],children:o})}function Al(){var e=(0,l.useState)(null),t=e[0],r=e[1],i=(0,l.useState)(null),o=i[0],c=i[1],s=(0,x.uN)(),u=(0,gn.Z)({view:s}),d=(0,F.Z)().preferences,f=(0,l.useCallback)((function(){var e;if(s&&t){var n,r=t.getCM(s),i=null!==(n=null===(e=null===r||void 0===r?void 0:r.state.vim)||void 0===e?void 0:e.mode)&&void 0!==n?n:"normal";o!==i&&c(i)}}),[s,o,t]);return(0,l.useEffect)((function(){"vim"!==(null===d||void 0===d?void 0:d.keyboardHandler)||t||n.e(1972).then(n.bind(n,1226)).then((function(e){r(e),f()}))}),[d,t,f]),(0,l.useEffect)((function(){if(s&&"vim"===(null===d||void 0===d?void 0:d.keyboardHandler))return s.dispatch({effects:u.reconfigure(H.tk.updateListener.of((function(){return f()})))}),f(),function(){s.dispatch({effects:u.reconfigure([])})};c(null)}),[s,d,u,f]),(0,a.tZ)(a.HY,{children:o&&(0,a.tZ)(q.xv,{css:[q.l0.color.foregroundDimmest],children:"-- ".concat(o.toUpperCase()," --")})})}function Nl(e){var t=e.filePath,n="/replEnvironmentMobile"===(0,la.useRouter)().pathname?q.l0.borderRadius(0):q.l0.borderRadius(0,0,8,8);return(0,a.BX)(q.G7,{css:[{position:"relative"}],children:[(0,a.tZ)(Rl,{filePath:t}),(0,a.BX)(q.G7,{css:[q.l0.rowWithGap(16),q.l0.p(8),q.l0.align.center,q.l0.justify.spaceBetween,n,q.l0.backgroundColor.backgroundDefault,{borderTop:"1px solid ".concat(q.TV.backgroundHigher)}],children:[(0,a.BX)(Ul,{children:[(0,a.tZ)(Dl,{}),(0,a.tZ)(Al,{})]}),(0,a.tZ)(Ul,{children:(0,a.tZ)(Il,{})})]})]})}function Ul(e){var t=e.children;return(0,a.tZ)("div",{css:[{display:"flex"},q.l0.rowWithGap(8),q.l0.align.center],children:t})}!function(e){e.None="0ms",e.Normal="100ms",e.Fast="50ms"}(kl||(kl={}));var jl=n(34385),Bl=n(32027);function Ol(e){var t=(0,i.Z)((0,qs.oQ)(),1)[0],n=(0,Bl.Z)(),o=(0,P.xZ)(),c=(0,jl.Z)(Zr.H.Editor),s=(0,d.Z)(),l=(0,S.c)("flag-editor-statusbar"),u=l.enabled,f=!l.loading&&u,p=t&&f;return(0,a.BX)("div",{ref:c,css:{position:"relative",display:"flex",flexDirection:"column",overflowY:"hidden",height:"100%",width:"100%",boxShadow:"".concat(n?"0 3px 0 3px ".concat(n):"0")},children:[(0,a.tZ)("div",{css:Xs,children:p?(0,a.tZ)(el,(0,r.Z)({},e)):(0,a.BX)(a.HY,{children:[(0,a.tZ)($s,(0,r.Z)({},e)),o&&(0,a.tZ)(I,{})]})}),(0,a.tZ)("div",{css:{display:s?"none":"block"},children:f&&(0,a.tZ)(Nl,{filePath:e.filePath})}),p||e.hideMobileKeyboardToolbar?null:(0,a.tZ)(E,{filePath:e.filePath,isLoading:!1})]})}},76505:function(e,t,n){n.d(t,{Z:function(){return xe}});var r=n(47568),i=n(26042),a=n(69396),o=n(10253),c=n(34051),s=n.n(c),l=n(35944),u=n(67294),d=n(15519),f=n(94561),p=n(40963),h=n(1144),m=n(61756),v=n(7297),g=n(31230),b=n(46829);function x(){var e=(0,v.Z)(["\n  query ConfigReplLanguage($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        language\n      }\n    }\n  }\n"]);return x=function(){return e},e}function Z(){var e=(0,v.Z)(["\n  mutation ConfigUpdateRepl($input: UpdateReplInput!) {\n    updateRepl(input: $input) {\n      repl {\n        id\n      }\n    }\n  }\n"]);return Z=function(){return e},e}var y={},w=(0,g.ZP)(x());var k=(0,g.ZP)(Z());var E=n(99408),S=n(34193),C=n(19526),T=n(81255),R=n(44044),_=n(69346),I=n(30992),P=n(88961),D=n(88812),A=n(63377),N=n(68056),U=n(6625),j=n(16965),B=n(32951),O=n(87653),G=n(3218),L=n(96594);function M(e){var t,n=e.options,r=e.initialSelectedOption,c=e.inputRef,s=e.setInputValue,l=(0,o.Z)(u.useState(""),2),d=l[0],f=l[1],p=(t={options:n,filter:d},u.useMemo((function(){return t.filter?G.Z.filter(t.filter.toLowerCase(),t.options).map((function(e){return e.original})):t.options}),[t.options,t.filter])),h=(0,L.Kb)({items:p,initialHighlightedIndex:0,initialSelectedItem:r,stateReducer:function(e,t){var n,r,o=t.type,l=t.changes;(o===L.Kb.stateChangeTypes.ItemClick||o===L.Kb.stateChangeTypes.InputKeyDownEnter&&l.selectedItem)&&(null===(n=c.current)||void 0===n||n.blur());return o!==L.Kb.stateChangeTypes.InputBlur||l.selectedItem?o===L.Kb.stateChangeTypes.InputBlur&&l.selectedItem?(s(null!==(r=l.selectedItem)&&void 0!==r?r:""),l):l:(0,a.Z)((0,i.Z)({},l),{isOpen:!0})}});return{filteredOptions:p,combobox:h,setFilter:f,filter:d}}var z=n(33773),F=n(70917),X=n(25019),W=n(4306),H=(0,F.iv)([T.l0.py(8),T.l0.pl(8),T.l0.pr(32),{color:"inherit",outline:"0 none",border:"1px solid",fontSize:"inherit",lineHeight:T.TV.space16,display:"block",width:"100%","::placeholder, :disabled":{color:T.TV.foregroundDimmer,borderColor:"transparent"},cursor:"text"}]),V=(0,F.iv)([T.l0.reset.button,R.gU.listItem,T.l0.borderRadius(8),T.l0.center,{width:24,height:24}]),$=(0,_.KD)("button");function q(e){var t=e.id,n=e.onSelect,r=e.onInit,c=e.options,s=e.initialSelectedOption,d=e.placeholderText,f=e.autoFocus,m=e.disabled,v=u.useRef(null),g=(0,o.Z)(u.useState(null!==s&&void 0!==s?s:""),2),b=g[0],x=g[1],Z=M({options:c,initialSelectedOption:s,inputRef:v,setInputValue:x}),y=Z.filteredOptions,w=Z.filter,k=Z.combobox,E=Z.setFilter,S=(0,j.Z)(n),C=(0,j.Z)(r);return u.useEffect((function(){s&&(C.current(s),x(s),E(""))}),[s]),(0,B.Z)((function(){var e;k.selectedItem&&(null===(e=v.current)||void 0===e||e.blur(),S.current(k.selectedItem),x(k.selectedItem),E(""))}),[k.selectedItem,S]),u.useEffect((function(){s&&(k.selectItem(s),x(s),E(""))}),[s]),(0,l.BX)(_.ZP,{children:[(0,l.tZ)("div",(0,a.Z)((0,i.Z)({},k.getComboboxProps()),{children:(0,l.BX)(_.ZP,{css:[T.l0.flex.row,{position:"relative"}],children:[(0,l.tZ)(_.ZP,{css:[T.l0.flex.growAndShrink(1)],children:(0,l.tZ)(p.ZP,(0,a.Z)((0,i.Z)({},k.getInputProps({id:t,spellCheck:!1,autoFocus:f,onChange:function(e){E(e.currentTarget.value.toLowerCase()),x(e.currentTarget.value)},ref:v,onFocus:function(e){k.openMenu(),e.currentTarget.select()}})),{value:b,placeholder:null!==s&&void 0!==s?s:d,css:[H],disabled:m,dataCy:"import-config-entrypoint-input"}))}),m?null:(0,l.tZ)(_.ZP,{css:[{position:"absolute",top:0,right:0,height:"100%"},T.l0.center],children:(0,l.tZ)($,(0,a.Z)((0,i.Z)({},k.getToggleButtonProps()),{css:V,type:"button",children:k.inputValue&&!k.isOpen?(0,l.tZ)(z.Z,{}):(0,l.tZ)(O.Z,{})}))})]})})),(0,l.BX)("div",(0,a.Z)((0,i.Z)({},k.getMenuProps()),{css:{position:"relative"},children:[k.isOpen&&y.length?(0,l.tZ)(X.Z,{children:(0,l.tZ)("ul",{css:[T.l0.pt(4),T.l0.pb(8)],children:y.map((function(e,t){return(0,l.tZ)("li",(0,a.Z)((0,i.Z)({},k.getItemProps({item:e,index:t})),{children:(0,l.tZ)(W.Z,(0,a.Z)((0,i.Z)({},Q(e)),{filter:w,selected:k.selectedItem===e,highlighted:k.highlightedIndex===t}))}),e.toLowerCase())}))})}):null,w&&!y.length&&k.isOpen?(0,l.tZ)(X.Z,{children:(0,l.tZ)(_.ZP,{css:[T.l0.p(16),T.l0.colWithGap(4)],children:(0,l.BX)(h.x,{color:"dimmer",children:['No results for "',w,'"']})})}):null]}))]})}function Q(e){return{title:e,key:e.toLowerCase()}}var K,Y=n(93160),J=n(48551);!function(e){e.Unknown="UNKNOWN",e.Npm="NPM",e.Django="DJANGO",e.Rails="RAILS",e.DotNet="DOTNET",e.Cargo="CARGO",e.Make="MAKE",e.RegularRun="REGULAR_RUN"}(K||(K={}));var ee=new RegExp("((index)|(main)|(app)|(run)|(start)|(server))\\..+","i"),te=new RegExp("((node_modules)|(venv)|(bower_components)|(vendor)|(build)|(dist)|(target)|(\\.git)|(\\.vscode)|(\\.idea)).+$","i");function ne(e){var t=e.initRunCommand,n=e.isCompiled,r=e.allFiles,i=new Set(r);return i.has("Makefile")||i.has("makefile")?K.Make:i.has("package.json")?K.Npm:i.has("Cargo.toml")?K.Cargo:n?K.Unknown:i.has("config/application.rb")?K.Rails:function(e,t){return e.some((function(e){return(0,J.r6)(e)===t}))}(r,"csproj")?K.DotNet:i.has("manage.py")?K.Django:ee.test(t)?K.RegularRun:K.Unknown}function re(e,t){var n=t.initRunCommand,r=t.allFiles;switch(e){case K.Npm:return"npm run start";case K.RegularRun:var i=function(e){var t;return null!==(t=e.filter((function(e){return!te.test(e)})).find((function(e){return ee.test(e)})))&&void 0!==t?t:null}(r);return null==i?null:n.replace(ee,i);case K.Django:return"python3 manage.py runserver 0.0.0.0:3000";case K.Rails:return"bundle exec rails server --binding=0.0.0.0";case K.DotNet:return"dotnet run";case K.Cargo:return"cargo run";case K.Make:case K.Unknown:default:return null}}function ie(e){switch(e){case K.Make:return"make";case K.Cargo:case K.DotNet:case K.Npm:return"";default:return null}}function ae(e,t,n){if(0===n.length)return{projType:K.Unknown,runCommand:null,compileCommand:null};var r={initRunCommand:e,isCompiled:t,allFiles:n},i=ne(r);return{projType:i,runCommand:re(i,r),compileCommand:ie(i)}}var oe=n(86292),ce=n(67983),se=n(58482),le=n(48287);function ue(e,t,n,r){var i=[];return r?(i.push((0,le.xz)("interpreter")),i.push((0,le.xz)("entrypoint")),i.push((0,le.KQ)(e)),n?i.push((0,le.D3)(n)):i.push((0,le.xz)("compile"))):(i.push((0,le.xz)("run")),i.push((0,le.If)(t))),i}var de=n(40005),fe=n(96357),pe=n(4445),he=n(77365);function me(e){var t=e.children;return(0,l.BX)(Y.Z,{background:"default",css:[T.l0.borderRadius(8),{width:"100%",height:"calc(100% - var(--space-2))",backgroundColor:"var(--background-default)",overflowY:"auto",marginTop:"0px"}],children:[(0,l.tZ)(_.ZP,{children:(0,l.tZ)(h.x,{variant:"subheadDefault",css:[T.l0.color.foregroundDimmest,T.l0.pl(16),T.l0.pt(16)],children:".replit"})}),(0,l.tZ)(_.ZP,{css:[T.l0.p(16),T.l0.justify.center,T.l0.align.center,{flex:"1 1 auto"}],children:t})]})}function ve(e){var t,n=Boolean(e.hasInterpreter),r=e.initialRun,c=null!==(t=e.initialCompile)&&void 0!==t?t:"",s=e.isFrameworkRecommended,f=!!e.projType&&e.projType===K.Rails,v=e.isApplyingConfig,g=(0,o.Z)(u.useState("Unknown"===d.Z.get(e.initialLanguage).displayName?"bash":e.initialLanguage),2),b=g[0],x=(g[1],(0,I.Y)(e.initialRun,(function(e){if(!e)return{message:"Add a run command"}}))),Z=(0,o.Z)(u.useState(e.initialCompile),2),y=Z[0],w=Z[1];u.useEffect((function(){x.setValue(r)}),[r]),u.useEffect((function(){w(null!==c&&void 0!==c?c:"")}),[c]);var k=(0,I.Y)("",(function(e){if(!e)return{message:"Choose an entry point file"}})),E=(0,o.Z)(u.useState(Boolean(n&&!s)),2),D=E[0],A=E[1];u.useEffect((function(){A(Boolean(n&&!s))}),[n,s]);var j=(0,_.KD)("a"),B=(0,o.Z)(u.useState([]),2),O=B[0],G=B[1],L=(0,U.Z)(),M=(0,de.u)();return u.useEffect((function(){M&&L.current&&G(M)}),[L,M]),(0,l.BX)("form",{onSubmit:function(t){t.preventDefault(),e.setIsApplyingConfig(!0),x.value||D?e.onSubmit({run:x.value,compile:null!==y&&void 0!==y?y:"",entry:k.value,deleteInterp:!D,onDone:e.closeConfigPane,runChanged:x.value!==r,compileChanged:y!==c,projType:e.projType}):x.validate()},css:[T.l0.maxWidth(400),{width:"100%"}],children:[(0,l.BX)(_.ZP,{css:[T.l0.colWithGap(8)],children:[e.hasProcfile&&(0,l.tZ)(_.ZP,{css:[T.l0.colWithGap(8)],children:(0,l.BX)(h.x,{variant:"small",multiline:!0,css:[T.l0.mb(24)],children:["Looks like you came from Heroku!",(0,l.tZ)(j,{target:"_blank",href:"https://docs.replit.com/tutorials/import-heroku",rel:"noopener noreferrer",children:"Read more about Replit and Heroku here."})]})}),n?(0,l.tZ)(_.ZP,{css:[T.l0.pb(16)],children:(0,l.BX)(N.hE,{disabled:v,name:"interpreterView",value:D.toString(),row:!0,onChange:function(){return A((function(e){return!e}))},stretch:!0,primary:!0,children:[(0,l.tZ)(N.rK,{id:"interpreterFalse",value:"false",text:"Use run command"}),(0,l.tZ)(N.rK,{id:"interpreterTrue",value:"true",text:"Use default interpreter"})]})}):null,(0,l.BX)(_.ZP,{css:[T.l0.height(e.initialCompile?210:170),T.l0.colWithGap(8)],children:[D?null:(0,l.BX)(_.ZP,{css:[T.l0.maxWidth(400),T.l0.colWithGap(8)],children:[e.initialCompile?(0,l.BX)(_.ZP,{css:[T.l0.colWithGap(4)],children:[(0,l.tZ)("label",{htmlFor:"compile-sel",children:"Configure the Compile Command"}),(0,l.tZ)(h.x,{multiline:!0,variant:"small",color:"dimmest",children:"This is optional, and is executed before your run command."}),(0,l.tZ)(p.ZP,{disabled:v,id:"compile-sel",type:"text",value:y,placeholder:"Enter a command to compile the program",onChange:function(e){w(e.currentTarget.value)},css:{"&:disabled":{color:T.TV.foregroundDimmer}}})]}):null,(0,l.tZ)("label",{htmlFor:"run-sel",css:[T.l0.mt(4)],children:"Configure the Run Command"}),(0,l.tZ)(p.ZP,{disabled:v,id:"run-sel",type:"text",value:x.value,placeholder:"Enter a command to run the program",onChange:function(e){x.setValue(e.currentTarget.value)},css:[{"&:disabled":{color:T.TV.foregroundDimmer,cursor:"auto"},cursor:"text"}]}),f?(0,l.BX)(h.x,{multiline:!0,variant:"small",color:"dimmest",children:["We detected this is a Rails project. You will need",(0,l.BX)("a",{target:"_blank",rel:"noopener noreferrer",href:"https://docs.replit.com/misc/rails-on-replit",children:[" ","additional changes"," "]}),"to your config files to use all of Replit\u2019s features."]}):null,x.error||!x.value?(0,l.BX)(_.ZP,{css:[T.l0.color.accentNegativeDefault,T.l0.rowWithGap(4),T.l0.align.center],children:[(0,l.tZ)(P.Z,{size:12}),(0,l.tZ)(_.ZP,{children:x.error?x.error.message:"Add a run command"})]}):null]}),D?(0,l.BX)(_.ZP,{css:[{maxWidth:400},T.l0.colWithGap(8)],children:[(0,l.tZ)("label",{htmlFor:"entry-sel","data-cy":"import-config-entrypoint",children:"Configure entry point"}),(0,l.tZ)(h.x,{variant:"small",css:[T.l0.color.foregroundDimmest],multiline:!0,children:"The entry point is the file that\u2019s run by default and shown first."}),0!==O.length?(0,l.tZ)(q,(0,a.Z)((0,i.Z)({id:"config-selector",onSelect:k.setValue,onInit:k.setValue,options:O},O.length&&Boolean(M)&&{initialSelectedOption:O[0]}),{disabled:v})):(0,l.tZ)(p.ZP,{disabled:v,id:"entry-sel",type:"text",value:k.value,placeholder:"Choose entry point file",onChange:function(e){k.setValue(e.currentTarget.value)},css:[R.gU.filled,{cursor:"text"}]}),k.error?(0,l.BX)(_.ZP,{css:[{color:"var(--accent-negative-default)"},T.l0.rowWithGap(4),T.l0.align.center],children:[(0,l.tZ)(P.Z,{size:12}),(0,l.tZ)(_.ZP,{children:k.error.message})]}):null]}):null,(0,l.tZ)(j,{css:[T.l0.color.accentPrimaryStronger,{fontWeight:T.TV.fontWeightMedium}],target:"_blank",href:"https://docs.replit.com/programming-ide/running-github-repositories-replit",rel:"noopener noreferrer",children:"Not sure what to do?"}),(0,l.tZ)(_.ZP,{css:[T.l0.flex.row,T.l0.pt(16)],children:(0,l.tZ)(m.ZP,{colorway:"primary",outlined:!0,type:"submit",text:v?"Saving...":"Done",disabled:v||!D&&(Boolean(x.error)||!x.value),css:[R.gU.filledAndOutlined,{fontWeight:T.TV.fontWeightMedium,color:T.TV.accentPrimaryStronger}],dataCy:"import-config-done"})})]})]}),(0,l.tZ)(S.Z,{isOpen:!1,preventClose:!0,onRequestClose:function(){},children:(0,l.tZ)(_.ZP,{css:[T.l0.borderRadius(16),T.l0.p(32),{backgroundColor:"var(--background-default)"}],children:(0,l.BX)(C.gC,{align:"center",spacing:1,children:[(0,l.tZ)(he.Z,{size:32}),(0,l.BX)(h.x,{children:["Upgrading to ",d.Z.get(b).displayName]})]})})})]})}function ge(){return(0,l.BX)(_.ZP,{children:[(0,l.tZ)(_.ZP,{children:".replit looks a lil messed up :/"}),(0,l.tZ)("a",{css:[T.l0.pt(8),{fontSize:T.TV.fontSizeSmall}],target:"_blank",href:"https://docs.replit.com/programming-ide/configuring-repl",children:"View docs"})]})}function be(){return(0,l.tZ)(_.ZP,{children:(0,l.BX)("p",{children:["Initializing run configuration",(0,l.tZ)(f.Z,{style:{color:"var(--foreground-default)"}})]})})}var xe=function(e){var t,n=(0,A.Z)(),a=(0,E.Z)(),c=a.fs,d=a.dotReplit,f=(0,o.Z)(function(e){var t=(0,i.Z)({},y,e);return b.useMutation(k,t)}(),1)[0],p=(0,U.Z)(),h=function(e){var t=(0,i.Z)({},y,e);return b.useQuery(w,t)}({variables:{replId:n}}),m="Repl"===(null===(t=h.data)||void 0===t?void 0:t.repl.__typename)?h.data.repl:null,v=e.useReadFile(c,D.l),g=(0,o.Z)(u.useState(!1),2),x=g[0],Z=g[1],S=(0,o.Z)(u.useState(!1),2),C=S[0],T=S[1],R=v&&!v.error?v.content.toString("utf8"):"",_=(0,o.Z)(u.useState(""),2),I=_[0],P=_[1],N=(0,o.Z)(u.useState(""),2),j=N[0],B=N[1],O=(0,o.Z)(u.useState(!1),2),G=O[0],L=O[1],M=(0,o.Z)(u.useState(K.Unknown),2),z=M[0],F=M[1],X=(0,o.Z)(u.useState(!1),2),W=X[0],H=X[1];u.useEffect((function(){function e(){return e=(0,r.Z)(s().mark((function e(){var t,n,r,i,a,o,l,u,f,h,m,v,g,b,y,w;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.getConfig();case 2:if(t=e.sent,n=t.config,!t.error){e.next=7;break}return e.abrupt("return");case 7:return i=(0,fe.m)(null!==(r=n.run)&&void 0!==r?r:void 0),o=(0,fe.m)(null!==(a=n.compile)&&void 0!==a?a:void 0),l=Boolean(n.compile),u=Boolean(n.interpreter),e.next=15,c.listFiles();case 15:if(f=e.sent,p.current){e.next=18;break}return e.abrupt("return");case 18:if(null==f.error&&null!=f.files&&0!==f.files.length){e.next=20;break}return e.abrupt("return");case 20:h=f.files,m=ae(i,l,h),v=m.projType,g=m.runCommand,b=m.compileCommand,y=x?null!==i&&void 0!==i?i:g:null!==g&&void 0!==g?g:i,w=null!==b&&void 0!==b?b:o,Z(h.includes(pe.E)),P(y),B(w),L(v!==K.Unknown&&v!==K.RegularRun),F(v),H(u);case 31:case"end":return e.stop()}}),e)}))),e.apply(this,arguments)}R&&function(){e.apply(this,arguments)}()}),[R,p]),u.useEffect((function(){(0,oe.j)(oe.U3.NIX_GH_IMPORT_USED,{action:ce.D.ImportEnded,replId:n})}),[n]);var V=(0,se.Z)();u.useEffect((function(){V(!1)}),[]);var $=function(){var e=(0,r.Z)(s().mark((function e(t){var r,i,a,o,l,u,p,h,m,v;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.run,i=t.compile,a=t.entry,o=t.deleteInterp,l=t.onDone,u=t.runChanged,p=t.compileChanged,h=t.projType,(0,oe.j)(oe.U3.NIX_GH_IMPORT_USED,{action:ce.D.ConfigDone,interpUsed:!o,isCompiled:""!==i,runChanged:u,compileChanged:p,projType:h,replId:n}),m=ue(r,a,i,o),e.next=5,d.updateDotReplit(m);case 5:return e.next=7,c.flush();case 7:return e.next=9,c.persist({skipDebounce:!0});case 9:return v={id:n},e.next=12,f({variables:{input:v}});case 12:l();case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return m&&v?(null===v||void 0===v?void 0:v.error)?(0,l.tZ)(me,{children:(0,l.tZ)(ge,{})}):(0,l.tZ)(me,{children:(0,l.tZ)(ve,{initialLanguage:"",initialRun:I,initialCompile:j,hasInterpreter:W,fs:c,hasProcfile:x,isApplyingConfig:C,setIsApplyingConfig:T,onSubmit:$,isFrameworkRecommended:G,projType:z,closeConfigPane:e.closeConfigPane})}):(0,l.tZ)(me,{children:(0,l.tZ)(be,{})})}},45826:function(e,t,n){n.d(t,{Z:function(){return p},_:function(){return v}});var r=n(10253),i=n(35944),a=n(60536),o=n.n(a),c=n(67294),s=n(30019),l=n(19526),u=n(33773),d=n(6951),f=n(81255);function p(e){var t=(0,r.Z)(c.useState(!1),2),n=t[0],a=t[1],o=[],u=[];if(e.variables.length>0){var f=e.variables[0].parentVariableReference,p=!0,h=!1,m=void 0;try{for(var g,b=e.variables[Symbol.iterator]();!(p=(g=b.next()).done);p=!0){var x=g.value;x.parentVariableReference===f?o.push(x):u.push(x)}}catch(Z){h=!0,m=Z}finally{try{p||null==b.return||b.return()}finally{if(h)throw m}}}return(0,i.BX)(i.HY,{children:[(0,i.tZ)(s.Z,{truncate:!0,level:5,children:"Variables"}),(0,i.BX)(l.gC,{align:"stretch",constrainWidth:!0,children:[o.map((function(t){return(0,i.tZ)(v,{depth:0,variable:t,client:e.client},t.parentVariableReference+"/"+t.name)})),u.length>0&&(0,i.BX)(i.HY,{children:[(0,i.BX)(d.Z,{filled:!1,border:!1,onClick:function(){return a((function(e){return!e}))},children:["See ",n?"Less":"More"]}),n&&u.map((function(t){return(0,i.tZ)(v,{depth:0,variable:t,client:e.client},t.parentVariableReference+"/"+t.name)}))]})]})]})}function h(e){var t=e.variable,n=e.expanded;return t.variablesReference>0?(0,i.tZ)("div",{css:[f.l0.transition.snappy,{transform:"rotate(".concat(n?0:-90,"deg)")}],children:(0,i.tZ)(u.Z,{})}):null}function m(e){var t=e.expanded,n=e.depth,r=e.variable;return 0===n&&!("parentVariableReference"in r)?(0,i.tZ)(h,{expanded:t,variable:r}):(0,i.tZ)("div",{css:[f.l0.flex.grow(0),f.l0.flex.shrink(0),f.l0.width(f.TV.space16),f.l0.display.flex,f.l0.align.center,f.l0.justify.end],children:(0,i.tZ)(h,{expanded:t,variable:r})})}function v(e){var t=e.depth,n=e.variable,a=e.client,s=(0,r.Z)(c.useState(!1),2),u=s[0],d=s[1],f=(0,r.Z)(c.useState([]),2),p=f[0],h=f[1];return c.useEffect((function(){u&&a.fetchVariables(n.variablesReference).then((function(e){return h(e)}),(function(){return d(!1)}))}),[u,a,n.variablesReference]),(0,i.BX)(i.HY,{children:[(0,i.BX)("div",{onClick:function(){n.variablesReference>0&&d((function(e){return!e}))},className:o().dynamic([["d2db4fbc08fcf9b",[t]]])+" variable",children:[(0,i.tZ)(m,{expanded:u,variable:n,depth:t}),(0,i.BX)("div",{className:o().dynamic([["d2db4fbc08fcf9b",[t]]])+" label",children:[n.name,n.type&&(0,i.BX)("span",{className:o().dynamic([["d2db4fbc08fcf9b",[t]]])+" type",children:[" ",n.type]}),""!==n.value&&": "]}),(0,i.tZ)("div",{className:o().dynamic([["d2db4fbc08fcf9b",[t]]])+" label value",children:n.value})]}),u?(0,i.tZ)(l.gC,{align:"stretch",constrainWidth:!0,children:p.map((function(e){return(0,i.tZ)(v,{depth:t+1,variable:e,client:a},"parentVariableReference"in e?e.parentVariableReference+"/"+e.name:e.name)}))}):null,(0,i.tZ)(o(),{id:"d2db4fbc08fcf9b",dynamic:[t],children:".variable.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;max-width:100%;height:var(--space-32);min-height:var(--space-32);cursor:pointer;color:var(--foreground-dimmer);-webkit-border-radius:var(--border-radius-4);-moz-border-radius:var(--border-radius-4);border-radius:var(--border-radius-4);font-size:var(--font-size-default);padding-left:-webkit-calc(".concat(t," * var(--space-16));padding-left:-moz-calc(").concat(t," * var(--space-16));padding-left:calc(").concat(t," * var(--space-16));font-family:var(--font-family-code)}.variable.__jsx-style-dynamic-selector:hover{background-color:var(--background-higher);color:var(--foreground-default)}.label.__jsx-style-dynamic-selector{font-size:var(--font-size-default);padding-left:var(--space-8);padding-right:var(--space-8);overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;white-space:nowrap;-webkit-box-flex:1;-webkit-flex:1 0 auto;-moz-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto}.type.__jsx-style-dynamic-selector{opacity:.5}.value.__jsx-style-dynamic-selector{text-align:right;-webkit-flex-shrink:1;-ms-flex-negative:1;flex-shrink:1}")})]})}},52831:function(e,t,n){n.d(t,{Z:function(){return _}});var r=n(47568),i=n(26042),a=n(69396),o=n(10253),c=n(29815),s=n(34051),l=n.n(s),u=n(35944),d=n(67294),f=n(28173),p=n(67003),h=n(7297),m=n(31230),v=n(46829);function g(){var e=(0,h.Z)(["\n  query WorkspaceDrawCurrentUser {\n    currentUser {\n      id\n      username\n    }\n  }\n"]);return g=function(){return e},e}function b(){var e=(0,h.Z)(["\n  mutation sawDrawCtaToursSeen($name: String!) {\n    toursSeen(name: $name) {\n      name\n      success\n    }\n  }\n"]);return b=function(){return e},e}var x={},Z=(0,m.ZP)(g());b();var y=n(58502),w=n(86601),k=n(58794),E=function(e,t,n){var r;if(!e)return[];var i=t(e.getSceneElementsIncludingDeleted()),a=e.getAppState();return(r=n.reduce((function(e,t){var n,r,o;return t.id===(null===(n=a.editingElement)||void 0===n?void 0:n.id)||t.id===(null===(r=a.resizingElement)||void 0===r?void 0:r.id)||t.id===(null===(o=a.draggingElement)||void 0===o?void 0:o.id)||(i[t.id]&&i[t.id].version>t.version?(e.push(i[t.id]),delete i[t.id]):i[t.id]&&i[t.id].version===t.version&&i[t.id].versionNonce!==t.versionNonce?(i[t.id].versionNonce<t.versionNonce?e.push(i[t.id]):e.push(t),delete i[t.id]):(e.push(t),delete i[t.id])),e}),[])).concat.apply(r,(0,c.Z)(Object.values(i)))},S=function(){var e,t,n=new Promise((function(n,r){e=n,t=r}));return n.resolve=e,n.reject=t,n},C=n(69346),T=n(81255);function R(e){var t,s=e.fs,h=e.presence,m=e.broadcast,g=e.filePath,b=(0,d.useState)(void 0),R=b[0],_=b[1],I=(0,d.useRef)((function(e){return(0,c.Z)(e)})),P=(0,d.useRef)((function(e){return-1})),D=(0,d.useRef)((function(e){return{}})),A=(0,d.useRef)({readyPromise:S()}),N=(0,d.useRef)({promise:null});(0,d.useEffect)((function(){Promise.all([n.e(2738),n.e(4474)]).then(n.t.bind(n,74474,23)).then((function(e){I.current=e.getSyncableElements,P.current=e.getSceneVersion,D.current=e.getElementMap,_(e.default)}))}),[]);var U=function(){return A.current},j=function(e){var t=(0,i.Z)({},x,e);return v.useQuery(Z,t)}({ssr:!1}),B=j.data,O=j.loading,G=(null===B||void 0===B||null===(t=B.currentUser)||void 0===t?void 0:t.username)||"",L=(0,p.Fg)().isDarkColorScheme,M=(0,y.Z)({presence:h}),z=(0,w.Z)(),F=null===z||void 0===z?void 0:z.color,X=(0,d.useState)(new Map),W=X[0],H=X[1],V=(0,d.useState)(-1),$=V[0],q=V[1];(0,d.useEffect)((function(){function e(){return e=(0,r.Z)(l().mark((function e(){var t,n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(B&&B.currentUser){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,A.current.readyPromise;case 4:t=U().getAppState().collaborators,n=new Map,M.forEach((function(e){var r;if(e.username!==(null===B||void 0===B||null===(r=B.currentUser)||void 0===r?void 0:r.username)){var o=t.get(e.username)||{};n.set(e.username,(0,a.Z)((0,i.Z)({},o),{username:e.username,color:{background:e.color,foreground:e.color}}))}})),U().updateScene({collaborators:n});case 8:case"end":return e.stop()}}),e)}))),e.apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[B,M]);var Q=function(){var e=(0,r.Z)(l().mark((function e(t,n){var r,i,a,o,c,s;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n||(t=t.filter((function(e){return!W.has(e.id)||e.version>W.get(e.id)}))),r=!0,i=!1,a=void 0,e.prev=2,o=t[Symbol.iterator]();!(r=(c=o.next()).done);r=!0)s=c.value,W.set(s.id,s.version),H(new Map(W));e.next=10;break;case 6:e.prev=6,e.t0=e.catch(2),i=!0,a=e.t0;case 10:e.prev=10,e.prev=11,r||null==o.return||o.return();case 13:if(e.prev=13,!i){e.next=16;break}throw a;case 16:return e.finish(13);case 17:return e.finish(10);case 18:m.broadcastMessage({text:JSON.stringify({elements:t,path:g})});case 19:case"end":return e.stop()}}),e,null,[[2,6,10,18],[11,,13,17]])})));return function(t,n){return e.apply(this,arguments)}}();(0,d.useEffect)((function(){if(m){var e=m.onBroadcastReceived((function(e){var t=e.username,n=e.text,r=JSON.parse(n);if(r.path===g)if(r.collaborator&&A.current){var o=U().getAppState().collaborators;o.set(t,(0,a.Z)((0,i.Z)({},o.get(t),r.collaborator),{username:t})),U().updateScene({collaborators:o})}else if(r.elements){var c=E(U(),D.current,r.elements);q(P.current(c)),U().updateScene({elements:c})}}));return function(){e()}}}),[m,g]),(0,d.useEffect)((function(){function e(){return e=(0,r.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(g&&s){e.next=2;break}return e.abrupt("return");case 2:N.current.promise=new Promise(function(){var e=(0,r.Z)(l().mark((function e(t){var n,r,a,c,u;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=o.Z,e.next=3,Promise.all([s.readFile(g),A.current.readyPromise]);case 3:e.t1=e.sent,n=(0,e.t0)(e.t1,1),"content"in(r=n[0])&&(a=r.content.toString(),c=JSON.parse(a||"{}"),u=U().getAppState(),c.appState=(0,i.Z)({},u),c.scrollToContent=!0,t(c));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)}))),e.apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[g,s]);var K=(0,d.useCallback)((0,f.Z)(function(){var e=(0,r.Z)(l().mark((function e(t){var n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.filter((function(e){return!e.isDeleted})),!g){e.next=4;break}return e.next=4,s.writeFile(g,k.Z.from(JSON.stringify({elements:n})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),350),[g]);return(0,u.tZ)(C.ZP,{css:{position:"relative",height:"100%",width:"100%",flex:1,boxShadow:F?"0 3px 0 3px ".concat(F):"none",backgroundColor:T.TV.backgroundDefault,"& .excalidraw [title~=Library]":{display:"none"},"& .excalidraw .App-menu_top":{gridTemplateColumns:"0 auto 1fr !important",gridGap:"none !important"},"& .excalidraw .App-menu_bottom":{transform:"none !important",paddingLeft:"var(--space-4) !important"}},children:R&&!O&&(0,u.tZ)(R,{zenModeEnabled:!0,ref:A,isCollaborating:!0,theme:L?"dark":"light",initialData:N.current.promise,onPointerUpdate:function(e){var t=e.pointer;if(U().getAppState().collaborators.size>0){var n=U().getAppState().selectedElementIds||{};m.broadcastMessage({text:JSON.stringify({collaborator:{pointer:t,selectedElementIds:n},path:g})})}},onChange:function(e){U().getAppState().collaborators.size>0?function(e){P.current(e)>$&&($>-1&&Q(I.current(e),!1),q(P.current(e)))}(e):q(P.current(e)),P.current(e)>$&&K(e)},user:{name:G}})})}function _(e){var t=e.fs,n=e.presence,r=e.broadcast,i=e.filePath;return(0,u.tZ)(R,{fs:t,presence:n,broadcast:r,filePath:i},i)}},79985:function(e,t,n){n.d(t,{Z:function(){return me}});var r=n(47568),i=n(26042),a=n(69396),o=n(99534),c=n(10253),s=n(34051),l=n.n(s),u=n(35944),d=n(67294),f=n(70917),p=n(65456),h=n(58794),m=n(48506),v=n(6625),g=n(30019),b=n(64080),x=n(35642),Z=n(19353),y=n(15519),w=n(2916),k=n(19050),E=n(33773),S=n(7297),C=n(31230),T=n(46829);function R(){var e=(0,S.Z)(['\n  query EnvEditor {\n    currentUser {\n      id\n      seenIntro: tourSeen(name: "enveditorintro")\n    }\n  }\n']);return R=function(){return e},e}function _(){var e=(0,S.Z)(['\n  mutation EnvEditorIntroSeen {\n    toursSeen(name: "enveditorintro") {\n      success\n    }\n  }\n']);return _=function(){return e},e}var I={},P=(0,C.ZP)(R());var D=(0,C.ZP)(_());var A,N=n(86292),U=n(91513),j=n(48551),B=n(65975),O=n(92876),G=n(75597),L=n(61134),M=n(28519),z=N.U3.ENV_EDITOR_USED;function F(e){var t=e.secrets,n=e.update,i=(0,d.useState)(!1),a=i[0],o=i[1],c=(0,d.useState)(!1),s=c[0],f=c[1],p=(0,d.useState)(!1),h=p[0],m=p[1],v=(0,d.useState)(0),g=v[0],b=v[1],x=0===g,Z=(0,d.useRef)();Z.current||(Z.current=(0,M.ir)((function(e){var t=X(e.state.doc.toString());return b(t),0!==t?(0,N.j)(z,{action:"rawEditorUpdatedError"}):(0,N.j)(z,{action:"rawEditorUpdated"}),[]})));var y=(0,L.Z)({readOnly:s||h,hideGutter:!0,language:"json",extensions:[Z.current]}),w=y.view,k=y.ref,E=function(){s||o(!1)},S=function(){if(!w)return!1;var e=X(w.state.doc.toString());return b(e),0===e},C=function(){var e=(0,r.Z)(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(w){e.next=2;break}return e.abrupt("return");case 2:if(S()){e.next=4;break}return e.abrupt("return");case 4:return f(!0),e.prev=5,t=JSON.parse(w.state.doc.toString()),e.next=9,n(t);case 9:f(!1),m(!0),setTimeout((function(){E(),setTimeout((function(){m(!1)}),500)}),500),e.next=20;break;case 14:e.prev=14,e.t0=e.catch(5),O.Tb(e.t0),(0,N.j)(z,{action:"rawEditorUpdatedError"}),b(3),f(!1);case 20:case"end":return e.stop()}}),e,null,[[5,14]])})));return function(){return e.apply(this,arguments)}}();return(0,d.useEffect)((function(){if(w){var e=JSON.stringify(t,null,2);"{}"===e&&(e="{\n  \n}"),w.dispatch({changes:{from:0,to:w.state.doc.length,insert:e}}),w.dispatch({selection:{anchor:w.state.doc.length-2}}),w.focus()}}),[w,t]),(0,u.BX)(B.G7,{css:[B.l0.colWithGap(8)],children:[(0,u.tZ)(B.xv,{variant:"subheadDefault",children:"Edit raw JSON (advanced)"}),(0,u.tZ)(B.zx,{onClick:function(){return m(!1),o(!0),void(0,N.j)(z,{action:"rawEditorOpened"})},text:"Open raw editor"}),(0,u.tZ)(B.u_,{isOpen:a,onRequestClose:function(){return E()},children:(0,u.BX)(B.G7,{css:[B.l0.p(4),B.l0.colWithGap(8)],children:[(0,u.tZ)(B.h4,{level:2,children:"Raw Secrets Editor"}),(0,u.tZ)(B.xv,{multiline:!0,children:"Secrets are specified in JSON. Values must be strings."}),(0,u.tZ)(B.Tg,{css:[B.l0.borderRadius(4),B.l0.p(4)],elevated:!0,children:(0,u.tZ)("div",{ref:k})}),(0,u.BX)(B.G7,{css:[B.l0.rowWithGap(4),B.l0.justify.end],children:[!x&&(0,u.tZ)(B.E_,{icon:(0,u.tZ)(G.Exclamation,{}),colorway:"negative",text:W(g)}),(0,u.tZ)(B.zx,{iconLeft:(0,u.tZ)(G.Check,{}),big:!0,stretch:!0,colorway:h?"positive":"primary",text:h?"Saved!":"Save",disabled:!x||s||h,onClick:function(){return C()}})]})]})})]})}function X(e){try{var t=JSON.parse(e);for(var n in t){if("string"!==typeof n)return 2;if("string"!==typeof t[n])return 2}return 0}catch(r){return 1}}function W(e){switch(e){case 1:return"Make sure the data is valid JSON.";case 2:return"Make sure that all values are strings.";case 3:return"There was an error saving the secrets.";default:return""}}!function(e){e[e.VALID=0]="VALID",e[e.ERROR_PARSE=1]="ERROR_PARSE",e[e.ERROR_STRINGS=2]="ERROR_STRINGS",e[e.ERROR_SAVE=3]="ERROR_SAVE"}(A||(A={}));var H=n(77365),V=n(46241),$=n(37424),q=n(1855),Q=n(16449),K=n(8941),Y=N.U3.ENV_EDITOR_OPENED,J=N.U3.ENV_EDITOR_USED,ee=N.U3.ENV_EDITOR_INTRO_SKIPPED,te=N.U3.ENV_EDITOR_INSERT_USED;function ne(e){return function(t){t.stopPropagation(),e(t)}}function re(e,t){return e?e.trim()?t.includes(e)?"You already have a secret with this key":null:"The key must include a non-space character":"Please add a key for this secret"}function ie(e){return e?null:"Please add a value for this secret"}var ae,oe=(0,f.iv)([B.l0.height(B.TV.space32),{resize:"none"}]);function ce(e){var t=e.secret,n=e.otherKeys,r=e.onUpdateKey,i=e.onUpdateValue,a=e.onSave,o=e.onCancel,s=e.onDelete,l=(0,c.Z)(d.useState(),2),f=l[0],p=l[1],h=(0,c.Z)(d.useState(),2),m=h[0],v=h[1],g=d.useRef(null),b=d.useRef(null),x=function(){var e=re(t.key,n);if(e)return p(e),void(g.current&&g.current.focus());var r=ie(t.value);if(r)return v(r),void(b.current&&b.current.focus());a()};d.useEffect((function(){f&&(re(t.key,n)||p(null))}),[t.key,f,n]),d.useEffect((function(){m&&(ie(t.value)||v(null))}),[t.value,m]);var Z=ne((function(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),x())})),y=(0,$.H)(),w=y("key"),k=y("value"),E=(0,Q.Z)().ref;return(0,u.BX)(B.Tg,{elevated:!0,css:[B.l0.p(16),B.l0.borderRadius(8),B.l0.colWithGap(16)],children:[(0,u.tZ)(se,{id:w,label:"key",error:f,children:(0,u.tZ)(B.II,{id:w,autoFocus:!0,ref:g,name:"key",value:t.key,spellCheck:!1,onChange:function(e){r(e.currentTarget.value)},onKeyDown:Z})}),(0,u.tZ)(se,{id:k,label:"value",error:m,children:(0,u.tZ)(B.B,{css:oe,id:k,ref:(0,q.l)(E,b),name:"value",value:t.value,spellCheck:!1,onChange:function(e){i(e.currentTarget.value)},onKeyDown:Z})}),(0,u.BX)(B.G7,{css:[B.l0.rowWithGap(8),B.l0.justify.spaceBetween],children:[s?(0,u.tZ)(B.zx,{onClick:ne(s),colorway:"negative",text:"Delete"}):null,(0,u.BX)(B.G7,{css:B.l0.rowWithGap(8),children:[o?(0,u.tZ)(B.zx,{onClick:ne(o),text:"Cancel"}):null,(0,u.tZ)(B.zx,{colorway:"primary",onClick:ne(x),text:s?"Save":"Add new secret"})]})]})]})}function se(e){return(0,u.BX)(B.G7,{css:[B.l0.colWithGap(4)],children:[(0,u.tZ)("label",{htmlFor:e.id,children:(0,u.tZ)(B.xv,{variant:"small",color:"dimmer",children:e.label})}),e.children,e.error?(0,u.BX)(B.G7,{css:[B.l0.rowWithGap(2),B.l0.align.center],children:[(0,u.tZ)(V.Z,{}),(0,u.tZ)(B.xv,{variant:"small",css:B.l0.color.accentNegativeStrongest,children:e.error})]}):null]})}function le(e){var t=e.onAdd,n=e.otherKeys,r=(0,c.Z)(d.useState({key:"",value:""}),2),o=r[0],s=r[1];return(0,u.tZ)(ce,{secret:o,otherKeys:n,onUpdateKey:function(e){return s((function(t){return t?(0,a.Z)((0,i.Z)({},t),{key:e}):t}))},onUpdateValue:function(e){return s((function(t){return t?(0,a.Z)((0,i.Z)({},t),{value:e}):t}))},onSave:function(){s({key:"",value:""}),o.value&&o.key&&t(o)}})}function ue(e){var t=e.secret,n=e.otherKeys,r=e.onUpdateSecret,o=e.onDeleteSecret,s=(0,c.Z)(d.useState(null),2),l=s[0],f=s[1];return l?(0,u.tZ)(ce,{secret:l,otherKeys:n,onUpdateKey:function(e){return f((function(t){return t?(0,a.Z)((0,i.Z)({},t),{key:e}):t}))},onUpdateValue:function(e){return f((function(t){return t?(0,a.Z)((0,i.Z)({},t),{value:e}):t}))},onSave:function(){f(null),l.value&&l.key&&(l.value===t.value&&l.key===t.key||r(t.key,l))},onCancel:function(){return f(null)},onDelete:function(){return o(t.key)}}):(0,u.BX)(B.G7,{tag:"button",css:[B.gU.filled,B.l0.p(8),B.l0.rowWithGap(8),B.l0.align.center,B.l0.justify.spaceBetween,B.l0.borderRadius(8)],onClick:function(){f((0,i.Z)({},t))},children:[(0,u.BX)(B.G7,{css:[B.l0.rowWithGap(8),B.l0.align.center],children:[(0,u.tZ)(Z.Z,{size:24}),(0,u.tZ)(B.xv,{children:t.key})]}),(0,u.tZ)(b.Z,{})]})}function de(e){var t=e.secrets,n=e.onUpdateSecret,r=e.onDeleteSecret;return(0,u.tZ)(B.G7,{css:B.l0.colWithGap(8),children:Object.keys(t).sort().map((function(e){return(0,u.tZ)(ue,{otherKeys:Object.keys(t).filter((function(t){return t!==e})),secret:{key:e,value:t[e]},onUpdateSecret:n,onDeleteSecret:r},e)}))})}function fe(e){var t=e.secrets,n=e.language,r=e.activeFile,s=e.onInsertDone,l=(0,c.Z)(d.useState(Object.keys(t)[0]),2),f=l[0],p=l[1],h=(0,U.Z)(r),m=function(e,t){if(!e)return null;switch((0,j.r6)(e)){case"js":case"ts":case"jsx":case"tsx":return{import:null,access:"const mySecret = process.env['".concat(t,"']")};case"py":return{import:"import os",access:"my_secret = os.environ['".concat(t,"']")};case"go":return{import:'import "os"',access:'mySecret := os.Getenv("'.concat(t,'")')};case"java":case"scala":return{import:null,access:'System.getenv("'.concat(t,'")')};case"rb":return{import:null,access:'ENV["'.concat(t,'"]')};case"c":case"cpp":return{import:"#include <stdlib.h>",access:'char* mySecret = getenv("'.concat(t,'")')};case"cs":return{import:"using System;",access:'string mySecret = System.Environment.GetEnvironmentVariable("'.concat(t,'");')};case"sh":return{import:null,access:'"$'.concat(t,'"')};default:return null}}(r,f);return m&&h?(0,u.BX)(B.G7,{css:B.l0.colWithGap(16),children:[m.import?(0,u.BX)(B.G7,{css:B.l0.colWithGap(8),children:[(0,u.tZ)(B.xv,{multiline:!0,children:"Secrets will be available in your Repl as environment variables when you run and when you use the shell"}),(0,u.tZ)(B.xv,{variant:"subheadDefault",children:"1. Add the imports"}),(0,u.tZ)(B.Tg,{tag:"pre",elevated:!0,css:[B.l0.borderRadius(8),B.l0.p(8)],children:(0,u.tZ)(B.xv,{css:B.l0.font.code,children:m.access})}),(0,u.tZ)(B.zx,{onClick:function(){h({code:m.import,insertAt:0}),(0,N.j)(te)},text:"Insert",iconRight:(0,u.tZ)(K.Z,{})})]}):null,(0,u.BX)(B.G7,{css:B.l0.colWithGap(8),children:[(0,u.BX)(B.xv,{variant:"subheadDefault",children:[m.import?"2. ":"","Access the secret by key as an environment variable"]}),(0,u.tZ)(k.Z,{respectMaxWidth:!0,items:Object.keys(t),onClick:function(e){p(e)},renderAnchorComponent:function(e){var t=e.innerRef,n=(0,o.Z)(e,["innerRef"]);return(0,u.tZ)(B.zx,(0,a.Z)((0,i.Z)({ref:t},n),{filled:!1,iconOnRight:!0,text:f,iconRight:(0,u.tZ)(E.Z,{})}))},renderItemChildComponent:function(e){return(0,u.tZ)(B.xv,{children:e})}}),(0,u.tZ)(B.Tg,{tag:"pre",elevated:!0,css:[B.l0.borderRadius(8),B.l0.p(8)],children:(0,u.tZ)(B.xv,{css:B.l0.font.code,children:m.access})}),(0,u.tZ)(B.G7,{css:B.l0.flex.row,children:(0,u.tZ)(B.zx,{outlined:!0,onClick:function(){h({code:m.access}),s&&s(),(0,N.j)(te)},text:"Insert",iconRight:(0,u.tZ)(K.Z,{})})})]})]}):(0,u.BX)(B.G7,{css:B.l0.colWithGap(8),children:[(0,u.tZ)(B.xv,{multiline:!0,children:"Secrets will be available in your Repl as environment variables when you run and when you use the shell"}),h?null:(0,u.BX)(B.xv,{multiline:!0,children:["Select a $",y.Z.get(n).displayName," file to enable code inserter"]})]})}function pe(e){var t=e.language,n=e.secrets,r=e.activeFile,i=e.onAdd,a=e.onIntroDone,o=(0,c.Z)(d.useState(ae.What),2),s=o[0],l=o[1];return s===ae.What?(0,u.BX)(B.G7,{css:B.l0.colWithGap(8),children:[(0,u.tZ)(B.xv,{variant:"subheadDefault",children:"What\u2019s this?"}),(0,u.tZ)(B.xv,{multiline:!0,children:"Using this feature will allow you to hide secret information like passwords while still being able to use them in the Repl"}),(0,u.tZ)(B.zx,{colorway:"primary",onClick:function(){return l(ae.Add)},text:"Got it"})]}):s===ae.Add?(0,u.BX)(B.G7,{css:B.l0.colWithGap(8),children:[(0,u.tZ)(g.Z,{level:5,children:"Add your first secret!"}),(0,u.tZ)(B.xv,{children:'The "key" is what you will use in the code itself and will be visible to everyone'}),(0,u.tZ)(B.xv,{children:'The "value" is where you put the private or secret text, hit shift+enter to add new lines'}),(0,u.tZ)(le,{onAdd:function(e){i(e),l(ae.Use)},otherKeys:Object.keys(n)}),(0,u.tZ)(B.zx,{onClick:function(){var e=Object.keys(n).length>0?ae.Use:ae.End;l(e),(0,N.j)(ee,{step:ae.Add})},text:"Skip this step"})]}):s===ae.Use?(0,u.BX)(B.G7,{css:B.l0.colWithGap(8),children:[(0,u.tZ)(g.Z,{level:5,children:"Now let\u2019s use it in the Repl."}),(0,u.tZ)(fe,{secrets:n,language:t,onInsertDone:function(){return l(ae.End)},activeFile:r}),(0,u.tZ)(B.zx,{onClick:function(){l(ae.End),(0,N.j)(ee,{step:ae.Use})},text:"Skip this step"})]}):(0,u.BX)(B.G7,{css:B.l0.colWithGap(8),children:[(0,u.tZ)(B.xv,{children:"You\u2019re all set. You can add as many secrets as you want, we promise to keep them safe."}),(0,u.BX)(B.xv,{children:["You can always"," ",(0,u.tZ)("a",{href:"https://docs.replit.com/programming-ide/storing-sensitive-information-environment-variables",target:"_blank",children:"visit our docs"})," ","for more information."]}),(0,u.tZ)(B.xv,{children:"Please note, that people you invite as multiplayer collaborators will have access to these secrets."}),(0,u.tZ)(B.zx,{onClick:a,text:"Got it"})]})}function he(e,t){var n=(0,i.Z)({},e);return"add"===t.type?n[t.key]=t.value:"update"===t.type?(delete n[t.oldKey],n[t.key]=t.value):delete n[t.key],n}function me(e){var t,n=e.fs,o=e.activeFile,s=e.hideInserterAndIntro,f=(0,v.Z)(),g=(0,c.Z)(d.useState(null),2),b=g[0],Z=g[1],y=function(e){var t=(0,i.Z)({},I,e);return T.useQuery(P,t)}(),k=y.data,E=y.loading,S=y.updateQuery,C=(0,c.Z)(function(e){var t=(0,i.Z)({},I,e);return T.useMutation(D,t)}(),1)[0],R=(0,w.Z)();d.useEffect((function(){(0,N.Cn)(Y),x.Z.set("enveditortour",!0)}),[]),d.useEffect((function(){function e(){return(e=(0,r.Z)(l().mark((function e(){var t,r;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.readFile(".env");case 2:if((t=e.sent).error!==p.Df.NotFound){e.next=6;break}return f.current&&Z({}),e.abrupt("return");case 6:if(!t.error){e.next=8;break}throw new Error("Error getting .env");case 8:if(f.current){e.next=10;break}return e.abrupt("return");case 10:r=m.Z.parse(t.content.toString()),Z(r);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[n,Z,f]);var _=d.useRef(null),A=d.useRef([]),U=function(){var e=(0,r.Z)(l().mark((function e(t){var r,i,a,o,c;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b){e.next=2;break}throw new Error("trying to write secrets before loading");case 2:return r=he(b,t),Z(r),A.current.push(t),i=Math.random(),_.current=i,e.next=10,n.readFile(".env");case 10:if(o=e.sent,_.current===i){e.next=13;break}return e.abrupt("return");case 13:return o.error?a=r:(a=m.Z.parse(o.content.toString()),A.current.forEach((function(e){a=he(a,e)})),Z(a)),A.current=[],c=m.Z.serialize(a),e.next=18,n.writeFile(".env",h.Z.from(c));case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=(0,r.Z)(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,N.j)(J,{action:"created",multiline:t.value.includes("\n")}),U((0,i.Z)({type:"add"},t));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=(0,r.Z)(l().mark((function e(t,n){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,N.j)(J,{action:"updated",multiline:n.value.includes("\n")}),U((0,i.Z)({type:"update",oldKey:t},n));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),G=function(){var e=(0,r.Z)(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,N.j)(J,{action:"deleted"}),U({type:"delete",key:t});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();if(E||!b||!R)return(0,u.tZ)(B.G7,{css:[B.l0.center,B.l0.coverContainer],children:(0,u.tZ)(H.Z,{size:24})});if((null===k||void 0===k||null===(t=k.currentUser)||void 0===t?void 0:t.seenIntro)||s){var L=Object.keys(b);return(0,u.BX)(B.G7,{css:B.l0.colWithGap(32),children:[(0,u.BX)(B.G7,{css:B.l0.colWithGap(16),children:[(0,u.tZ)(de,{secrets:b,onUpdateSecret:O,onDeleteSecret:G}),(0,u.tZ)(le,{onAdd:j,otherKeys:L})]}),L.length>0&&!s?(0,u.tZ)(fe,{secrets:b,language:R.language,activeFile:o}):null,(0,u.tZ)(F,{secrets:b,update:function(){var e=(0,r.Z)(l().mark((function e(t){var r;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Z(t),r=m.Z.serialize(t),e.next=4,n.writeFile(".env",h.Z.from(r));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()})]})}return(0,u.tZ)(pe,{secrets:b,onAdd:j,activeFile:o,language:R.language,onIntroDone:function(){C(),S((function(e){return e.currentUser?(0,a.Z)((0,i.Z)({},e),{currentUser:(0,a.Z)((0,i.Z)({},e.currentUser),{seenIntro:!0})}):e}))}})}!function(e){e.What="What",e.Add="Add",e.Use="Use",e.End="End"}(ae||(ae={}))},18935:function(e,t,n){var r=n(35944),i=n(67294),a=n(41664),o=n.n(a),c=n(86292),s=n(197),l=n(40403),u=n(15335),d=n(99408),f=n(65456),p=n(75240),h=n(81255),m=n(1144),v=n(69346),g=n(70917),b=n(29163),x=n(40381),Z=n(25602),y=(0,g.F4)("0%,100%{opacity:1;}50%{opacity:0.25;}");function w(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"1";(0,c.j)(c.U3.HISTORY_USED,{action:"historyOpened",which:e})}var k=function(e){var t=e.repl,n=e.isSaving,i=(0,x.Z)(),a=i?(0,Z.YM)({path:i}):"",c="".concat(t.url,"/history2").concat(a);return(0,r.tZ)(o(),{prefetch:!1,href:{pathname:"/replHistory2",query:{slug:t.slug}},as:c,children:(0,r.tZ)("a",{role:"button",tabIndex:0,onClick:function(){return w("2")},onKeyDown:function(){return w("2")},children:(0,r.tZ)(v.ZP,{css:[h.l0.flex.row,h.l0.align.center,h.l0.color.foregroundDefault,n?(0,g.iv)({animation:"".concat(y," 2s infinite")}):null],children:(0,r.tZ)(b.Z,{size:28,alt:"Repl history",children:(0,r.tZ)(l.Z,{})})})})})},E=(0,g.iv)({color:h.TV.accentNegativeDefault}),S=function(){return(0,r.BX)(v.ZP,{css:[h.l0.flex.row],children:[(0,r.tZ)(b.Z,{size:18,disabled:!0,alt:"Reconnecting, changes will be synced when you\u2019re online",css:[E],children:(0,r.tZ)(s.Z,{})}),(0,r.tZ)(m.x,{css:[(0,g.iv)({"@media (hover: hover)":{display:"none"}}),h.l0.pl(4),E],children:"Offline"})]})};t.Z=function(e){var t=e.repl,n=function(){var e=(0,d.Z)().fs,t=(0,i.useState)(!1),n=t[0],r=t[1],a=(0,u.Z)(),o=(0,i.useState)(!1),c=o[0],s=o[1];return(0,i.useEffect)((function(){a===p.e.CONNECTED&&s(!0)}),[a]),(0,i.useEffect)((function(){return r(e.getStatus()===f.kO.Syncing),e.onStatusChange((function(e){r(e===f.kO.Syncing)}))}),[e]),c?{isSaving:n,isOffline:a!==p.e.CONNECTED}:{isSaving:!1,isOffline:!1}}(),a=n.isSaving,o=n.isOffline;return(0,r.tZ)(v.ZP,{css:[h.l0.flex.row,h.l0.align.center,h.l0.height("100%")],children:o?(0,r.tZ)(S,{}):(0,r.tZ)(k,{isSaving:a,repl:t})})}},34382:function(e,t,n){n.d(t,{z:function(){return On}});var r={};n.r(r),n.d(r,{Component:function(){return An},receiver:function(){return nt},reducer:function(){return it}});var i=n(10253),a=n(35944),o=n(67294),c=n(65975),s=n(51438),l=n(52951),u=n(14924),d=n(28668),f=n(26042),p=n(25171),h=n(92876);var m=function(e,t,n,r){return function(i){return function(a){return function(o){a(o);var c=i.getState();if(c){var s=c.plugins,l=Object.keys(s),u=!0,d=!1,f=void 0;try{for(var p,h=function(){var a=p.value;if(o.pud&&o.pud!==a)return"continue";var s=c.plugins[a];if(s.broken)return"continue";var l=s.type,u=n[l];if(u)try{var d=u(t,a,o);if(d){var f=e(a).dispatch(d);f&&"object"===typeof f&&"function"===typeof f.catch&&f.catch((function(e){i.dispatch({type:"PLUGIN_BROKE",pud:a,message:e.toString()}),r({error:e,pluginType:l,source:"receiver",pud:a})}))}}catch(h){i.dispatch({type:"PLUGIN_BROKE",pud:a,message:h.toString()}),r({error:h,pluginType:l,source:"receiver",pud:a})}},m=l[Symbol.iterator]();!(u=(p=m.next()).done);u=!0)h()}catch(v){d=!0,f=v}finally{try{u||null==m.return||m.return()}finally{if(d)throw f}}}}}}},v=n(69396),g=n(59637),b=n(29815),x=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(0===t.length)return e;var n=(0,g.Z)(t),r=n[0],i=n.slice(1);return x(e[r],i)},Z=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;if(0===t.length)return n;var r=(0,g.Z)(t),i=r[0],a=r.slice(1);return Array.isArray(e)?(e[i]=Z(e[i],a,n),e):(0,v.Z)((0,f.Z)({},e),(0,u.Z)({},i,Z(e[i],a,n)))};var y=function(e,t,n){var r=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;for(var a in r)if(!i.pud||i.pud===a){var o=r[a];if(!o.broken){var c=t[o.type];if(c)if("PLUGIN_BROKE"!==i.type){var s=void 0;try{s=c(o.state,(0,v.Z)((0,f.Z)({},i),{wid:e}))}catch(l){r=(0,v.Z)((0,f.Z)({},r),(0,u.Z)({},a,(0,v.Z)((0,f.Z)({},o),{broken:!0,errorMessage:l.toString()}))),n({error:l,pluginType:o.type,source:"reducer",pud:a});continue}s!==o.state&&(r=(0,v.Z)((0,f.Z)({},r),(0,u.Z)({},a,(0,v.Z)((0,f.Z)({},o),{state:s}))))}else r=(0,v.Z)((0,f.Z)({},r),(0,u.Z)({},a,(0,v.Z)((0,f.Z)({},o),{broken:!0,errorMessage:i.message})))}}return r},i=function(e,t){switch(t.type){case"UPDATE_LAYOUT":return(0,f.Z)({},e,Z(e,t.path.concat(t.property||[]),t.to));case"SET_ACTIVE_TAB":return(0,f.Z)({},e,Z(e,t.path.concat("active"),t.tabIndex));case"SET_SPLIT_POSITION":return(0,f.Z)({},e,Z(e,t.path.concat("position"),t.position));case"NEW_TAB":if("tabs"!==x(e,t.path.concat("type"))){var r=new Error("trying to add tab to non tab component");return n({error:r,pluginType:"layout",pud:null,source:"reducer"}),e}var i=(0,f.Z)({},e,Z(e,t.path.concat("tabs"),(0,b.Z)(x(e,t.path.concat("tabs"))).concat([t.layout])));if(!t.setActiveTab)return i;var a=x(i,t.path.concat("tabs")).findIndex((function(e){return e.pud===t.layout.pud}));return(0,f.Z)({},i,Z(i,t.path.concat("active"),a));case"CLOSE_TAB":var o=x(e,t.path.concat("tabs")),c=t.tabIndex||o.findIndex((function(e){return e.pud===t.tabPud}));if(!o[c]){var s=new Error("trying to remove nonexistent tab");return n({error:s,pluginType:"layout",pud:null,source:"reducer"}),e}var l=x(e,t.path.concat("active")),d=l===c?Math.max(l-1,0):l,p=(0,f.Z)({},e,Z(e,t.path.concat("active"),d));return(0,f.Z)({},p,Z(p,t.path.concat("tabs"),(0,b.Z)(o.slice(0,c).concat(o.slice(c+1)))));case"LOAD_PLUGIN":return(0,v.Z)((0,f.Z)({},e),{pluginTitles:(0,v.Z)((0,f.Z)({},e.pluginTitles),(0,u.Z)({},t.pluginPud,t.title))});default:return e}},a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{plugins:{},layout:{}},n=arguments.length>1?arguments[1]:void 0,a=r(e.plugins,n);a!==e.plugins&&(e=(0,v.Z)((0,f.Z)({},e),{plugins:a}));var o=i(e.layout,n);switch(o!==e.layout&&(e=(0,v.Z)((0,f.Z)({},e),{layout:o})),n.type){case"OPEN_FILE":return(0,v.Z)((0,f.Z)({},e),{activeFile:n.path});case"MOVE_FILE":return e.activeFile===n.path?(0,v.Z)((0,f.Z)({},e),{activeFile:n.to}):e;case"LOAD_PLUGIN":var c=t[n.pluginType];c||(c=function(e,t){});var s=n.initialState||{},l=c(void 0,{type:"@@INIT",initialState:s});return(0,v.Z)((0,f.Z)({},e),{plugins:(0,v.Z)((0,f.Z)({},e.plugins),(0,u.Z)({},n.pluginPud,{type:n.pluginType,state:l,isClosable:n.isClosable,isDraggable:n.isDraggable}))});case"UNLOAD_PLUGIN":return(0,v.Z)((0,f.Z)({},e),{plugins:Object.keys(e.plugins).reduce((function(t,r){return r!==n.pud?(0,v.Z)((0,f.Z)({},t),(0,u.Z)({},r,e.plugins[r])):t}),{})});default:return e}};return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_WORKSPACE":return t.state;case"CREATE_WORKSPACE":return{layout:t.layout,plugins:r(void 0,t),activeFile:t.activeFile};default:return a(e,t)}}},w=n(4111),k=n(15366);function E(e,t){if("split"===e.type){var n=E(e.left,t);if(n)return["left"].concat(n);var r=E(e.right,t);if(r)return["right"].concat(r)}else if("tabs"===e.type)for(var i=0;i<e.tabs.length;i++){var a=E(e.tabs[i],t);if(a)return["tabs",i].concat(a)}else if("pane"===e.type&&e.pud===t)return[];return null}function S(e,t){for(var n=0;n<e.floating.length;n++)if(e.floating[n]===t)return["floating",n];var r=E(e.tiling,t);return r?["tiling"].concat(r):null}function C(e,t){var n,r=S(e,t);if(!r)return{path:["tiling"],to:e.tiling};if("floating"===r[0]){var i=e.floating.indexOf(t);return{path:["floating"],to:e.floating.slice(0,i).concat(e.floating.slice(i+1))}}if("split"!==T(e,r.slice(0,-1)).type)throw new Error("remove only supports splits right now");return n="left"===r[r.length-1]?"right":"left",{path:r.slice(0,-1).map((function(e){return e.toString()})),to:T(e,r.slice(0,-1).concat(n))}}var T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(0===t.length)return e;var n=(0,g.Z)(t),r=n[0],i=n.slice(1);return T(e[r],i)};function R(e){return"tabs"===e.slice(0,-1).pop()}var _=function(e){var t={strokeMiterlimit:10,fill:"none",stroke:e.color,strokeWidth:1};return(0,a.tZ)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",children:(0,a.BX)("g",{children:[(0,a.tZ)("line",{style:t,x1:"3",y1:"3",x2:"13",y2:"13"}),(0,a.tZ)("line",{style:t,x1:"13",y1:"3",x2:"3",y2:"13"})]})})};var I=function(e){var t=e.onClick,n=e.onMouseDown,r=e.Icon,i=e.color,o=e.style;return(0,a.tZ)("button",{onClick:t,onMouseDown:n,style:(0,f.Z)({color:"var(--foreground-default)",backgroundColor:"transparent",border:"none",cursor:"pointer",margin:"0",outline:"none",padding:"0"},o),children:(0,a.tZ)(r,{color:i})})},P=function(e){var t=e.color;return(0,a.tZ)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 8.467 10.583",children:(0,a.tZ)("path",{d:"M4.233.684L2.988 1.93l.374.374.607-.607V3.97H1.697l.607-.607-.374-.374L.684 4.233 1.93 5.48l.374-.374-.607-.607H3.97V6.77l-.607-.607-.374.374 1.245 1.245L5.48 6.537l-.374-.374-.607.607V4.498H6.77l-.607.607.374.374 1.245-1.246-1.245-1.245-.374.374.607.607H4.498V1.697l.607.607.374-.374z",fill:t,"white-space":"normal",overflow:"visible"})})},D={height:"12px",width:"12px",margin:"0 4px"},A=function(e){var t=e.isTabbed,n=e.isClosable,r=e.isDraggable,i=e.HeaderPlugin,c=e.onClose,s=e.onDrag;return(0,a.BX)(o.Fragment,{children:[i,(0,a.BX)("div",{style:{alignItems:"center",display:"flex",height:"100%",marginLeft:"auto"},children:[r&&!t&&(0,a.tZ)(I,{Icon:P,onMouseDown:s,style:D}),n&&!t&&(0,a.tZ)(I,{Icon:_,onClick:c,style:D})]})]})},N=n(86292);var U=1e5,j=32,B={width:"100%",height:"100%"},O=function(e){return e.getBoundingClientRect()},G=function(e,t){var n=t.px,r=t.pc;return{px:e.px+(n||0),pc:e.pc+(r||0)}},L=function(e,t){return{px:e.px*t,pc:e.pc*t}},M={px:0,pc:0},z=function(e){return{px:e,pc:0}},F=function(e){return{px:0,pc:e}},X=function(e){var t=e.px,n=e.pc;return 0===t&&0===n},W=function(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{x:M,y:M,w:F(100),h:F(100),p:[]};if("tabs"===r.type){var o=r.active||0;n.push((0,v.Z)((0,f.Z)({},a),{h:z(j),tabs:r.tabs.map((function(e){return e.pud||e.type})),active:o}));for(var c=0;c<r.tabs.length;c++)W(e,t,n,(0,f.Z)({},r.tabs[c]),i,(0,v.Z)((0,f.Z)({},a),{p:(0,b.Z)(a.p).concat(["tabs",c.toString()]),y:G(a.y,z(j)),h:c===o?G(a.h,z(-32)):M,w:c===o?a.w:M}))}if("split"===r.type){var s=void 0===r.position?50:r.position,l=!1;if("undefined"!==typeof r.fixed?l=r.fixed:("undefined"!==typeof r.leftSize||"undefined"!==typeof r.rightSize)&&(l=!0),"undefined"!==typeof r.leftSize&&"undefined"!==typeof r.rightSize)throw new Error("Cannot have both leftSize and rightSize specified");var u=null;if(0===s?u="left":100===s&&(u="right"),r.stacked){var d=!X(a.h)&&!l,p=L(a.h,s/100);r.rightSize?p=G(a.h,z(-r.rightSize)):r.leftSize?p=z(r.leftSize):"left"===u||X(a.h)?p=M:"right"===u&&(p=G(p,z(-8))),W(e,t,n,r.left,i,(0,v.Z)((0,f.Z)({},a),{p:(0,b.Z)(a.p).concat(["left"]),h:p}));var h=G(a.y,L(a.h,s/100));r.rightSize?h=G(a.y,p):r.leftSize?h=G(a.y,z(r.leftSize)):"left"===u?h=a.y:"right"===u&&d&&(h=G(h,z(-8)));var m=L(a.h,(100-s)/100);r.rightSize?m=z(r.rightSize):r.leftSize?m=G(a.h,z(-r.leftSize)):("right"===u||X(a.h))&&(m=M),W(e,t,n,r.right,i,(0,v.Z)((0,f.Z)({},a),{p:(0,b.Z)(a.p).concat(["right"]),y:d?G(h,z(8)):h,h:d?G(m,z(-8)):m})),d&&t.push((0,v.Z)((0,f.Z)({},a),{y:h,snapped:u,h:z(8),stacked:r.stacked}))}else{var g=!X(a.w)&&!l,x=L(a.w,s/100);r.rightSize?x=G(a.w,z(-r.rightSize)):r.leftSize?x=z(r.leftSize):"left"===u||X(a.w)?x=M:"right"===u&&(x=G(x,z(-8))),W(e,t,n,r.left,i,(0,v.Z)((0,f.Z)({},a),{p:(0,b.Z)(a.p).concat(["left"]),w:x}));var Z=G(a.x,L(a.w,s/100));"left"===u?Z=a.x:r.rightSize?Z=G(a.x,x):r.leftSize?Z=G(a.x,z(r.leftSize)):"right"===u&&(Z=G(Z,z(-8)));var y=L(a.w,(100-s)/100);r.rightSize?y=z(r.rightSize):r.leftSize?y=G(a.w,z(-r.leftSize)):("right"===u||X(a.w))&&(y=M),W(e,t,n,r.right,i,(0,v.Z)((0,f.Z)({},a),{p:(0,b.Z)(a.p).concat(["right"]),x:g?G(Z,z(8)):Z,w:g?G(y,z(-8)):y})),g&&t.push((0,v.Z)((0,f.Z)({},a),{x:Z,snapped:u,w:z(8),stacked:r.stacked}))}}if("pane"===r.type){var w=r.header,k=r.pud,E=i[k]||{isDraggable:!1,isClosable:!1},S=R(a.p),C=w||!S&&(E.isClosable||E.isDraggable),T=C?w&&w.height||32:0;e.push({header:C&&{pud:w&&w.pud,p:(0,v.Z)((0,f.Z)({},a),{h:z(T)})},pud:k,p:(0,v.Z)((0,f.Z)({},a),{y:G(a.y,z(T)),h:G(a.h,z(-T))}),isDraggable:E.isDraggable,isClosable:E.isClosable})}},H=function(e){var t,n,r,o=e.stacked,c=e.onMouseDown,s=e.snapped,l=e.style,d=(0,i.Z)(J(),2),p=d[0],h=d[1],m=p?"var(--outline-default)":"var(--outline-dimmest)";s?(n="left"===s?o?"translate(0px, -2px) rotate(135deg)":"translate(-2px, 0px) rotate(45deg)":o?"translate(0px, 2px) rotate(-45deg)":"translate(2px, 0px) rotate(-135deg)",t={width:6,height:6,borderRight:"solid 1px ".concat(m),borderTop:"solid 1px ".concat(m),transition:"0.1s background-color",transform:n}):(r={backgroundColor:m,borderRadius:"var(--border-radius-4)"},(0,u.Z)(r,o?"height":"width",2),(0,u.Z)(r,o?"width":"height",25),(0,u.Z)(r,"transition","0.1s background-color"),t=r);return(0,a.tZ)("div",(0,v.Z)((0,f.Z)({},h),{onMouseDown:c,onTouchStart:c,style:(0,f.Z)({position:"absolute",display:"flex",justifyContent:"center",alignItems:"center",flex:"1 0 auto",overflow:"hidden",borderRadius:"var(--border-radius-4)",background:"var(--background-root)",cursor:o?"row-resize":"col-resize",zIndex:1},l),children:(0,a.tZ)("div",{style:t})}))},V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;if(0===t.length)return n;var r=(0,g.Z)(t),i=r[0],a=r.slice(1);return Array.isArray(e)?(e[i]=V(e[i],a,n),e):(0,v.Z)((0,f.Z)({},e),(0,u.Z)({},i,V(e[i],a,n)))},$=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(0===t.length)return e;var n=(0,g.Z)(t),r=n[0],i=n.slice(1);return $(e[r],i)},q=function(e){(0,d.Z)(n,e);var t=(0,p.Z)(n);function n(){var e;return(0,s.Z)(this,n),e=t.apply(this,arguments),(0,u.Z)((0,w.Z)(e),"state",{protectEvents:!1,newLayout:null,debug:!1,dragging:null,resizing:null,layout:e.props.store.getState().layout,plugins:e.props.store.getState().plugins}),(0,u.Z)((0,w.Z)(e),"getPluginComponent",(function(t,n){var r=e.state.plugins[n],i=e.props,o=i.pluginComponents,c=i.wid,s=null;return s=r?r.broken?(0,a.tZ)(K,{handleError:function(t){return e.handleError({error:t,pluginType:r.type,source:"component",pud:n})},message:r.errorMessage||"Plugin broken with no error :/"}):(s=o[r.type])?(0,a.tZ)(s,{wid:c,pud:n,dimensions:e.getPluginDims(n,{w:t.w,h:t.h}),style:B}):(0,a.tZ)(K,{handleError:function(t){return e.handleError({error:t,pluginType:r.type,source:"component",pud:n})},message:"No plugin component by the name ".concat(n)}):(0,a.tZ)(K,{handleError:function(t){return e.handleError({error:t,pluginType:"none",source:"component",pud:n})},message:"No known plugin by the name ".concat(n)})})),(0,u.Z)((0,w.Z)(e),"onResizerDown",(function(t,n,r){var i=t.target;e.setState({protectEvents:!0,resizing:{stacked:r}}),t.preventDefault(),t.stopPropagation();var a=0,o=function(t,n){if("pane"===t.type){var i=e.nodes[n.join(".")].ref;if(!i)return;a+=r?O(i).height:O(i).width}else if("split"===t.type)t.stacked===r?(o(t.left,(0,b.Z)(n).concat(["left"])),o(t.right,(0,b.Z)(n).concat(["right"]))):o(t.left,(0,b.Z)(n).concat(["left"]));else if("tabs"===t.type){var c=t.active||0;o(t.tabs[c],(0,b.Z)(n).concat(["tabs",c.toString()]))}};o($(e.state.layout,["tiling"].concat((0,b.Z)(n))),n),a+=8;var c=r?O(i).top:O(i).left,s=$(e.state.layout,["tiling"].concat((0,b.Z)(n),["position"]));"number"!==typeof s&&(s=50);var l=function(t){t.preventDefault(),t.stopPropagation();var i,o=t.touches?t.touches[0]:t,l=(r?o.pageY:o.pageX)-c,u=a*(s/100)+l;i=u>a-32?100:u<32?0:u/a*100,e.setState({newLayout:V(e.state.layout,["tiling"].concat((0,b.Z)(n),["position"]),i)})},u=function(){document.removeEventListener("touchmove",l),document.removeEventListener("mousemove",l),document.removeEventListener("touchend",u),document.removeEventListener("mouseup",u),e.setState({protectEvents:!1,resizing:null}),null!==e.state.newLayout&&(e.props.store.dispatch({type:"SET_SPLIT_POSITION",position:$(e.state.newLayout,["tiling"].concat((0,b.Z)(n),["position"])),path:["tiling"].concat((0,b.Z)(n))}),e.setState({newLayout:null}))};document.addEventListener("touchmove",l),document.addEventListener("mousemove",l),document.addEventListener("touchend",u),document.addEventListener("mouseup",u)})),(0,u.Z)((0,w.Z)(e),"onDrag",(function(t,n){t.stopPropagation(),t.preventDefault();var r=t.pageX,i=t.pageY,a=null,o=[];for(var c in e.nodes){var s=e.nodes[c];if(s.ref){var l=O(s.ref),u=l.top,d=l.left,p=l.width,h=l.height,m={p:s.p,x:d,y:u,w:p,h:h,pud:s.pud};s.pud===n?a=m:o.push(m)}}e.setState({protectEvents:!0});var v=function(t){t.preventDefault(),t.stopPropagation();var c=t.pageX,s=t.pageY,l={target:null,side:"bottom",left:c,top:s},u=!0,d=!1,p=void 0;try{for(var h,m=o[Symbol.iterator]();!(u=(h=m.next()).done);u=!0){var v=h.value;if((e.state.plugins[v.pud]||{}).isDraggable&&(c>v.x&&c<v.x+v.w&&s>v.y&&s<v.y+v.h)){var g=c-v.x,b=v.x+v.w-c,x=s-v.y,Z=v.y+v.h-s,y=Math.min(g,b,x,Z);l.target=v.pud,y===g?l.side="left":y===b?l.side="right":y===x&&(l.side="top");break}}}catch(E){d=!0,p=E}finally{try{u||null==m.return||m.return()}finally{if(d)throw p}}var w=c-r,k=s-i;l.left=a.x+w,l.top=a.y+k,e.setState({dragging:(0,f.Z)({pud:n,width:a.w,height:a.h},l)})},g=function(){e.state.dragging&&e.state.dragging.target&&e.props.store.dispatch(Q({pud:n,side:e.state.dragging.side,target:e.state.dragging.target})),e.setState({protectEvents:!1,dragging:null}),document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",g)};document.addEventListener("mousemove",v),document.addEventListener("mouseup",g)})),(0,u.Z)((0,w.Z)(e),"nodes",{}),(0,u.Z)((0,w.Z)(e),"dimMap",{}),(0,u.Z)((0,w.Z)(e),"getPluginDims",(function(t,n){var r=e.dimMap[t];return r&&r.h.pc===n.h.pc&&r.h.px===n.h.px&&r.w.pc===n.h.pc&&r.w.px===n.w.px?r:(e.dimMap[t]=n,n)})),e}return(0,l.Z)(n,[{key:"cancelContextMenuIntercept",value:function(e){e.shiftKey&&e.altKey&&e.preventDefault()}},{key:"componentDidMount",value:function(){this.isWeMounted=!0,this.subscribe(),document.addEventListener("contextmenu",this.cancelContextMenuIntercept)}},{key:"componentWillUnmount",value:function(){this.unsubscribe&&this.unsubscribe(),document.removeEventListener("contextmenu",this.cancelContextMenuIntercept),this.isWeMounted=!1}},{key:"subscribe",value:function(){var e=this,t=this.props.store;this.unsubscribe=t.subscribe((function(){var n=t.getState(),r=n.layout,i=n.plugins;e.isWeMounted&&e.setState((function(e){for(var t in e.plugins){if(!i[t])return{layout:r,plugins:i};if(i[t].broken!==e.plugins[t].broken)return{layout:r,plugins:i}}return e.layout===r?null:{layout:r,plugins:i}}))}))}},{key:"shouldComponentUpdate",value:function(e,t){if(this.state!==t)return!0;for(var n in this.props)if(this.props[n]!==e[n])return!0;return!1}},{key:"onMaybeDrag",value:function(e,t){var n=this.state.plugins[t]&&this.state.plugins[t].isDraggable;(e.altKey||e.shiftKey)&&n&&this.onDrag(e,t)}},{key:"closeTabbedPlugin",value:function(e){var t=e.path,n=e.tabIndex,r=e.activeTabIndex;return function(e,i){var a=i().layout,o=T(a,t).tabs,c=o[n].pud;if(e({type:"CLOSE_TAB",path:t,tabIndex:n}),o.length-1===0)e((0,f.Z)({type:"UPDATE_LAYOUT"},C({layout:a,nodePath:t})));else if(n<=r){e({type:"SET_ACTIVE_TAB",tabIndex:Math.max(r-1,0),path:t})}e({type:"PLUGIN_CLOSED",closedPud:c})}}},{key:"closePlugin",value:function(e){var t=e.pud;return function(e,n){var r=n().layout;e((0,f.Z)({type:"UPDATE_LAYOUT"},C({layout:r,pud:t}))),e({type:"PLUGIN_CLOSED",closedPud:t})}}},{key:"getPaneStyles",value:function(e,t){var n=X(t.w)||X(t.h),r=t.p.includes("tabs");return e?{opacity:.75,overflow:"hidden",visibility:n?"hidden":void 0,height:this.state.dragging.height,position:"absolute",left:0,top:0,transform:"translate(".concat(this.state.dragging.left,"px, ").concat(this.state.dragging.top-(t.h.px>0?t.h.px:0),"px)"),width:this.state.dragging.width,zIndex:99999,transition:"opacity 0.2s, max-width 0.2s, max-height 0.2s",maxWidth:"100vw",maxHeight:"100vh"}:{position:"absolute",visibility:n&&!r?"hidden":void 0,display:n&&r?"none":void 0,height:"calc(".concat(t.h.pc,"% + ").concat(t.h.px,"px)"),width:"calc(".concat(t.w.pc,"% + ").concat(t.w.px,"px)"),left:"calc(".concat(t.x.pc,"% + ").concat(t.x.px,"px)"),top:"calc(".concat(t.y.pc,"% + ").concat(t.y.px,"px)"),opacity:"1",transition:"opacity 0.2s, max-width 0.2s, max-height 0.2s",maxWidth:"100vw",maxHeight:"100vh"}}},{key:"render",value:function(){var e=this,t=this.state.newLayout||this.state.layout,n=t.tiling,r=t.floating,i=this.state.plugins,c=[],s=[],l=[];W(c,s,l,n,i);var u="default";return this.state.resizing?u=this.state.resizing.stacked?"row-resize":"col-resize":this.state.dragging&&(u="grabbing"),(0,a.BX)("div",{style:{height:"100%",width:"100%",position:"absolute"},children:[c.map((function(t){var n=t.pud,r=t.p,i=t.header,c=t.isClosable,s=t.isDraggable,l=e.state.plugins[n]||{},u=e.state.plugins[i&&i.pud]||{},d=i&&i.p.h.px,p=i&&i.pud&&(0,a.tZ)(K,{handleError:function(t){return e.props.handleError({error:t,pluginType:u.type,source:"component",pud:n})},message:u.broken?u.errorMessage:void 0,children:(0,a.tZ)(k.zt,{store:e.props.classicStoreFor(n),children:e.getPluginComponent(i.p,i.pud)})}),h=e.state.dragging&&e.state.dragging.pud===n;return(0,a.BX)(o.Fragment,{children:[i&&(0,a.tZ)("div",{className:"WHO AM I??",style:(0,v.Z)((0,f.Z)({},e.getPaneStyles(h,i.p)),{backgroundColor:"var(--background-default)",color:"var(--foreground-default)",height:"".concat(d,"px"),alignItems:"center",display:"flex",justifyContent:"spaceBetween"}),children:(0,a.tZ)(A,{HeaderPlugin:p,isClosable:c,isDraggable:s,isTabbed:R(r.p),onClose:function(){e.props.store.dispatch(e.closePlugin({pud:n}))},onDrag:function(t){return e.onDrag(t,n)}})}),(0,a.BX)("div",{ref:function(t){return e.nodes[r.p.join(".")]={ref:t,p:r,pud:n}},style:(0,v.Z)((0,f.Z)({},e.getPaneStyles(h,r)),{borderRadius:"var(--border-radius-4)",boxShadow:h?"var(--shadow-2)":"none"}),onMouseDown:function(t){return e.onMaybeDrag(t,n)},children:[e.state.debug?(0,a.BX)("div",{style:{backgroundColor:"hsl(".concat(n.split("").map((function(e){return e.charCodeAt(0)})).reduce((function(e,t){return e+t})),", 50%, 50%)"),width:"100%",height:"100%",border:"inset 5px"},children:[n,(0,a.BX)("pre",{children:["x: ","calc(".concat(r.x.pc,"% + ").concat(r.x.px,"px)"),(0,a.tZ)("br",{}),"y: ","calc(".concat(r.y.pc,"% + ").concat(r.y.px,"px)"),(0,a.tZ)("br",{}),"w: ","calc(".concat(r.w.pc,"% + ").concat(r.w.px,"px)"),(0,a.tZ)("br",{}),"h: ","calc(".concat(r.h.pc,"% + ").concat(r.h.px,"px)"),(0,a.tZ)("br",{}),"p: ",r.p.join(" ")]})]}):(0,a.tZ)(K,{handleError:function(t){return e.props.handleError({error:t,pluginType:l.type,source:"component",pud:n})},message:l.broken?l.errorMessage:void 0,children:(0,a.tZ)(k.zt,{store:e.props.classicStoreFor(n),children:e.getPluginComponent(r,n)})}),e.state.dragging&&e.state.dragging.target===n?(0,a.tZ)("div",{style:{position:"absolute",top:0,left:0,bottom:0,right:0,background:"rgba(127, 127, 127, 0.6)",transition:"transform 0.2s",transformOrigin:"top left",transform:"translate(".concat("right"===e.state.dragging.side?"50%":0,", ").concat("bottom"===e.state.dragging.side?"50%":0,") ").concat("left"===e.state.dragging.side||"right"===e.state.dragging.side?"scaleX(.5)":"scaleY(.5)")}}):null]})]},n)})),this.state.protectEvents&&(0,a.tZ)("div",{style:{zIndex:U,position:"absolute",top:0,bottom:0,left:0,right:0,cursor:u}}),s.map((function(t,n){var r=t.x,i=t.y,o=t.w,c=t.h,s=t.p,l=t.snapped,u=t.stacked;return(0,a.tZ)(H,{onMouseDown:function(t){return e.onResizerDown(t,s,u)},snapped:l,stacked:u,style:{left:"calc(".concat(r.pc,"% + ").concat(r.px,"px)"),top:"calc(".concat(i.pc,"% + ").concat(i.px,"px)"),width:"calc(".concat(o.pc,"% + ").concat(o.px,"px)"),height:"calc(".concat(c.pc,"% + ").concat(c.px,"px)")}},n)})),l.map((function(t,n){var r=t.x,i=t.y,o=t.w,c=t.h,s=t.p,l=t.tabs,u=t.active;return(0,a.tZ)(Y,{tabsMetadata:l.map((function(t){if("split"===t){var r=$(e.state.layout,["tiling"].concat((0,b.Z)(s),["tabs"]))[n];t=r.left.pud||r.right.pud}return{title:e.state.layout.pluginTitles[t]||"untitled",isClosable:e.state.plugins[t]&&e.state.plugins[t].isClosable}})),active:u,setActive:function(t){return e.props.store.dispatch((function(e,n){var r=n(),i=["tiling"].concat((0,b.Z)(s));"shell"===$(r.layout,i.concat("tabs"))[t].pud&&(0,N.j)(N.U3.SHELL_OPENED),e({type:"SET_ACTIVE_TAB",tabIndex:t,path:i})}))},close:function(t){var n=["tiling"].concat((0,b.Z)(s));e.props.store.dispatch(e.closeTabbedPlugin({path:n,tabIndex:t,activeTabIndex:u}))},style:{position:"absolute",left:"calc(".concat(r.pc,"% + ").concat(r.px,"px)"),top:"calc(".concat(i.pc,"% + ").concat(i.px,"px)"),width:"calc(".concat(o.pc,"% + ").concat(o.px,"px)"),height:"calc(".concat(c.pc,"% + ").concat(c.px,"px)")}},n)})),r.map((function(t){if(!e.state.plugins[t])return(0,a.tZ)(K,{handleError:function(n){return e.props.handleError({error:n,pluginType:e.state.plugins[t].type,source:"component",pud:t})},message:"No plugin by the name ".concat(t)},t);var n=e.props.pluginComponents[e.state.plugins[t].type];return n?(0,a.tZ)(K,{handleError:function(n){return e.props.handleError({error:n,pluginType:e.state.plugins[t].type,source:"component",pud:t})},children:(0,a.tZ)(k.zt,{store:e.props.classicStoreFor(t),children:(0,a.tZ)(n,{wid:e.props.wid,pud:t},t)})},t):(0,a.tZ)(K,{handleError:function(n){return e.props.handleError({error:n,pluginType:e.state.plugins[t].type,source:"component",pud:t})},message:"No component found for plugin by the name ".concat(t)},t)}))]})}}]),n}(o.Component);function Q(e){var t=e.pud,n=e.side,r=e.target;return function(e,i){var a=i().layout,o=S(a,t),c=T(a,o);e((0,f.Z)({type:"UPDATE_LAYOUT"},C({layout:a,pud:t})));var s=S(a=i().layout,r);if(s){R(s)&&(s=function(e){return e.slice(0,-1)}(s));var l="leftOf";"right"===n?l="rightOf":"top"===n?l="above":"bottom"===n&&(l="below"),e((0,f.Z)({type:"UPDATE_LAYOUT"},function(e,t,n,r,i){if("inside"===n){if(1!==r.length||"floating"!==r[0])throw new Error("position 'inside' should only be used for the path ['floating']");return i&&i.once&&e.floating.includes(t)?{path:["floating"],to:e.floating}:{path:["floating"],to:e.floating.concat(t)}}var a={type:"split"};if("undefined"!==typeof i?"undefined"!==typeof i.position?a=(0,v.Z)((0,f.Z)({},a),{fixed:!!i.fixed,position:i.position||50}):"undefined"!==typeof i.leftSize?a=(0,v.Z)((0,f.Z)({},a),{leftSize:i.leftSize}):"undefined"!==typeof i.rightSize&&(a=(0,v.Z)((0,f.Z)({},a),{rightSize:i.rightSize})):a=(0,v.Z)((0,f.Z)({},a),{fixed:!1,position:50}),"leftOf"===n)a=(0,v.Z)((0,f.Z)({},a),{stacked:!1,right:T(e,r),left:{type:"pane",pud:t}});else if("rightOf"===n)a=(0,v.Z)((0,f.Z)({},a),{stacked:!1,right:{type:"pane",pud:t},left:T(e,r)});else if("above"===n)a=(0,v.Z)((0,f.Z)({},a),{stacked:!0,left:{type:"pane",pud:t},right:T(e,r)});else{if("below"!==n)throw new Error("unsupported new plugin type");a=(0,v.Z)((0,f.Z)({},a),{stacked:!0,right:{type:"pane",pud:t},left:T(e,r)})}return{path:r.map((function(e){return e.toString()})),to:a}}(a,c.pud,l,s,{position:50})))}}}var K=function(e){(0,d.Z)(n,e);var t=(0,p.Z)(n);function n(){var e;return(0,s.Z)(this,n),e=t.apply(this,arguments),(0,u.Z)((0,w.Z)(e),"state",{hasError:!!e.props.message,error:new Error(e.props.message)}),e}return(0,l.Z)(n,[{key:"componentDidCatch",value:function(e,t){this.setState({hasError:!0,error:e,info:t}),this.props.handleError(e)}},{key:"render",value:function(){return this.state.hasError?(0,a.BX)("div",{style:{background:"red",color:"white",width:"100%",height:"100%",padding:"0",margin:"0",overflow:"hidden"},children:[(0,a.tZ)("h1",{children:"This Plugin Crashed!"}),this.state.info&&(0,a.tZ)("pre",{children:this.state.info.componentStack||JSON.stringify(this.state.info)}),this.state.error&&(0,a.tZ)("pre",{children:this.state.error.toString()})]}):this.props.children||null}}]),n}(o.Component);function Y(e){var t=e.active,n=void 0===t?0:t,r=e.setActive,i=void 0===r?function(){}:r,o=e.close,c=void 0===o?function(){}:o,s=e.tabsMetadata,l=e.style;return(0,a.tZ)("div",{style:l,children:(0,a.tZ)("div",{style:{height:j,fontFamily:"'IBM Plex Sans', sansSerif",backgroundColor:"var(--background-root)",display:"flex",alignItems:"flex-end",position:"relative",zIndex:2},children:s.map((function(e,t){return(0,a.tZ)(te,{title:e.title,isClosable:e.isClosable,onClose:function(){return c(t)},onClick:function(){return i(t)},isActive:t===n},t)}))})})}function J(){var e=(0,i.Z)(o.useState(!1),2),t=e[0],n=e[1];return[t,{onMouseEnter:function(){n(!0)},onMouseLeave:function(){n(!1)}}]}function ee(e){var t=e.isHovering,n=e.isActive;return(0,f.Z)({height:"100%",boxSizing:"border-box",display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",padding:"var(--space-8)",backgroundColor:"var(--background-root)",color:"var(--foreground-dimmer)",fontSize:"var(--font-size-default)",fontFamily:"var(--font-family-default)",borderTopRightRadius:"var(--border-radius-4)",borderTopLeftRadius:"var(--border-radius-4)",cursor:"pointer",transition:"0.2s background-color"},t?{backgroundColor:"var(--background-root)",color:"var(--foreground-default)"}:{},n?{backgroundColor:"var(--background-default)",color:"var(--foreground-default)"}:{})}function te(e){var t,n=e.isActive,r=e.onClick,o=e.title,c=e.isClosable,s=e.onClose,l=(0,i.Z)(J(),2),u=l[0],d=l[1];return(0,a.tZ)("div",(0,v.Z)((0,f.Z)({},d),{style:ee({isHovering:u,isActive:n}),onClick:r,children:(0,a.BX)("div",{style:{alignItems:"center",display:"flex",justifyContent:"space-between"},children:[(t=o,t?t[0].toUpperCase()+t.slice(1):t),c&&(0,a.tZ)(I,{onClick:function(e){e.stopPropagation(),s()},Icon:_,style:{height:"8px",width:"8px",padding:0,marginLeft:"7px"}})]})}))}var ne=q,re=n(25108),ie=function(e){return function(t){return function(n){return"function"===typeof n?n(e.dispatch,e.getState):t(n)}}},ae=["activeFile"],oe=function(){function e(){var t=this;(0,s.Z)(this,e),(0,u.Z)(this,"marshal",(function(){var e=t.store.getState();return JSON.stringify(e)})),(0,u.Z)(this,"unmarshal",(function(e){var n=JSON.parse(e);t.store.dispatch({type:"SET_WORKSPACE",state:n})})),(0,u.Z)(this,"bootstrap",(function(e){t.store.dispatch(function(e){var t=e.wid,n=e.config;return function(e){for(var r in e({wid:t,type:"CREATE_WORKSPACE",language:n.language,layout:n.layout,activeFile:n.activeFile}),n.plugins)e(se({wid:t,pluginPud:r,pluginType:n.plugins[r].type,title:n.plugins[r].title,initialState:n.plugins[r].state,isClosable:n.plugins[r].isClosable,isDraggable:n.plugins[r].isDraggable}))}}({config:e}))})),(0,u.Z)(this,"register",(function(e,n){t.reducers[e]=n.reducer,t.receivers[e]=n.receiver||n.receiver,t.components[e]=n.Component})),(0,u.Z)(this,"yikesInjectStore",(function(e){t.yikesExtraStore=e})),(0,u.Z)(this,"injectServices",(function(e){t.services=e})),(0,u.Z)(this,"handleError",(function(e){var n=e.error,r=e.pluginType,i=e.source,a=e.pud;if(0===t.errorHandlers.length)return re.error("Plugin with type ",r," errored in ",i," error is: "),void re.error(n);t.errorHandlers.forEach((function(e){return e({error:n,pluginType:r,source:i,pud:a})}))})),(0,u.Z)(this,"registerErrorHandler",(function(e){return t.errorHandlers.push(e),function(){t.errorHandlers=t.errorHandlers.filter((function(t){return t!==e}))}})),window.performance.clearMarks("create-workspace"),window.performance.mark("create-workspace"),this.wid=""+Math.random(),this.reducers={},this.receivers={},this.components={},this.pluginStores={},this.yikesExtraStore={getState:function(){return{}},subscribe:function(){return function(){}},dispatch:function(){}},this.errorHandlers=[];var n=[];this.classicStoreFor=function(e){var i={};if(t.pluginStores[e])return t.pluginStores[e];var a=t,s={getState:function(){return{get user(){return i.user=!0,a.yikesExtraStore.getState().user},get banners(){return i.banners=!0,a.yikesExtraStore.getState().banners},get replEnvironment(){return i.replEnvironment=!0,a.yikesExtraStore.getState().replEnvironment},get repls(){throw new Error("Please use repl shared reducer")},get replsByUrl(){throw new Error("Please use repl shared reducer")},get replsByUser(){throw new Error("Please use repl shared reducer")},get files(){throw new Error("Please use files shared reducer")},get messages(){return i.messages=!0,a.yikesExtraStore.getState().messages},get plans(){return i.plans=!0,a.yikesExtraStore.getState().plans},workspace:(0,u.Z)({},t.wid,t.store.getState()),get services(){return a.services}}},subscribe:function(n){var r={},a={},o=ae.reduce((function(e,n){return e[n]=t.store.getState()[n],e}),{});return t.store.subscribe((function(){var c=t.store.getState().plugins[e];if(c!==r)return r=c,void n();var s=!1,l=t.yikesExtraStore.getState();for(var u in i)l[u]!==a[u]&&(a[u]=l[u],s=!0);var d=t.store.getState();for(var f in o)d[f]!==o[f]&&(o[f]=d[f],s=!0);s&&n()}))},dispatch:function(i){if(i.type){var a={};i.path&&(a={path:i.path}),h.n_({category:"redux",message:"workspace action",data:(0,f.Z)({type:i?i.type:null},a)})}if(i.wid||"function"===typeof i){var s=ie(t.classicStoreFor(e))(r(c)(o))(i),l=!0,u=!1,d=void 0;try{for(var p,m=n[Symbol.iterator]();!(l=(p=m.next()).done);l=!0){p.value.cb()}}catch(v){u=!0,d=v}finally{try{l||null==m.return||m.return()}finally{if(u)throw d}}return s}return t.yikesExtraStore.dispatch(i)}};return t.pluginStores[e]=s,s};var r=m(this.classicStoreFor,this.wid,this.receivers,this.handleError),i=y(this.wid,this.reducers,this.handleError),a=i(void 0,{type:"@@INIT"}),o=function(e){a=i(a,e)},c={getState:function(){return a},subscribe:function(e){var t=function(){n=n.filter((function(e){return e.unsub!==t}))};return n.push({cb:e,unsub:t}),t},dispatch:function(e){if(e.type){var t={};e.path&&(t={path:e.path}),h.n_({category:"redux",message:"workspace action",data:(0,f.Z)({type:e?e.type:null},t)})}var i=ie(c)(r(c)(o))(e),a=!0,s=!1,l=void 0;try{for(var u,d=n[Symbol.iterator]();!(a=(u=d.next()).done);a=!0){u.value.cb()}}catch(p){s=!0,l=p}finally{try{a||null==d.return||d.return()}finally{if(s)throw l}}return i}};window.store=c,this.store=c}return(0,l.Z)(e,[{key:"component",value:function(){var e=this;return function(){return(0,a.tZ)(ce,{store:e.store,classicStoreFor:e.classicStoreFor,wid:e.wid,pluginComponents:e.components,handleError:e.handleError})}}}]),e}(),ce=function(e){(0,d.Z)(n,e);var t=(0,p.Z)(n);function n(){return(0,s.Z)(this,n),t.apply(this,arguments)}return(0,l.Z)(n,[{key:"componentDidMount",value:function(){this.props.store.dispatch({type:"WORKSPACE_MOUNTED"})}},{key:"componentWillUnmount",value:function(){this.props.store.dispatch({type:"WORKSPACE_WILL_UNMOUNT"})}},{key:"render",value:function(){return(0,a.tZ)("div",{style:{height:"100%",position:"relative",display:"flex"},children:(0,a.tZ)(ne,{wid:this.props.wid,store:this.props.store,classicStoreFor:this.props.classicStoreFor,pluginComponents:this.props.pluginComponents,handleError:this.props.handleError})})}}]),n}(o.Component);function se(e){var t=e.wid,n=e.pluginPud,r=e.pluginType,i=e.title,a=e.initialState,o=e.isClosable,c=void 0!==o&&o,s=e.isDraggable;return{type:"LOAD_PLUGIN",wid:t,pluginPud:n,pluginType:r,title:i,initialState:a,isClosable:c,isDraggable:void 0!==s&&s}}var le=n(47568),ue=n(34051),de=n.n(ue),fe=n(7297),pe=n(31230),he=n(46829);function me(){var e=(0,fe.Z)(["\n  fragment GitCurrentUser on CurrentUser {\n    id\n    fullName\n    username\n    gitHubInfo {\n      accessToken\n      installations {\n        id\n        type\n        name\n        avatarUrl\n      }\n      userInfo {\n        name\n        email\n        avatarUrl\n      }\n    }\n  }\n"]);return me=function(){return e},e}function ve(){var e=(0,fe.Z)(["\n  query GitHubRepoCreationModal($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        title\n        isPrivate\n        isRenamed\n        description\n      }\n    }\n  }\n"]);return ve=function(){return e},e}function ge(){var e=(0,fe.Z)(["\n  query GitCurrentUser {\n    currentUser {\n      id\n      ...GitCurrentUser\n    }\n  }\n  ","\n"]);return ge=function(){return e},e}var be={},xe=(0,pe.ZP)(me()),Ze=(0,pe.ZP)(ve());var ye=(0,pe.ZP)(ge(),xe);var we=n(92776),ke=n(30019);function Ee(e,t,n){var r=e.workspace[t].plugins[n];if("git"!==r.type)throw new Error("expected type to be git");return r.state}function Se(e,t,n){return[(0,k.v9)((function(n){return Ee(n,e,t)}),n),function(){throw new Error("Not implemented")}]}var Ce=n(16799),Te=n(67128),Re=n(25892),_e=n(54098),Ie=n.n(_e),Pe=n(92157),De="https://api.github.com",Ae=function(e){(0,d.Z)(n,e);var t=(0,p.Z)(n);function n(){var e;return(0,s.Z)(this,n),(e=t.call(this)).message="GitHub Auth Error",e}return n}((0,Re.Z)(Error)),Ne=function(e){(0,d.Z)(n,e);var t=(0,p.Z)(n);function n(){var e;return(0,s.Z)(this,n),(e=t.call(this)).message="GitHub Repo Already Exists",Error.captureStackTrace&&Error.captureStackTrace((0,w.Z)(e),n),e.name="GitHubRepoAlreadyExistsError",e}return n}((0,Re.Z)(Error));function Ue(e,t){return je.apply(this,arguments)}function je(){return(je=(0,le.Z)(de().mark((function e(t,n){var r,a,o,c,s,l;return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,i.Z)((0,Pe.JE)(n),2),a=r[0],o=r[1],c={cache:"no-store"},t&&(c.headers={Authorization:"Bearer ".concat(t)}),e.next=5,Ie()("".concat(De,"/repos/").concat(a,"/").concat(o),c);case 5:return s=e.sent,e.next=8,Ge(s);case 8:return l=e.sent,e.abrupt("return",(0,f.Z)({},l));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Be(e){return Oe.apply(this,arguments)}function Oe(){return(Oe=(0,le.Z)(de().mark((function e(t){var n,r,i,a,o;return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.token,r=t.owner,i=t.ownerType,a=t.repoData,n){e.next=3;break}throw new Error("Unable to create repository");case 3:if("User"!==i){e.next=10;break}return e.next=7,Ie()("".concat(De,"/user/repos"),{method:"POST",headers:{Authorization:"Bearer ".concat(n)},body:JSON.stringify(a)});case 7:o=e.sent,e.next=13;break;case 10:return e.next=12,Ie()("".concat(De,"/orgs/").concat(r,"/repos"),{method:"POST",headers:{Authorization:"Bearer ".concat(n),Accept:"application/vnd.github.nebula-preview+json"},body:JSON.stringify(a)});case 12:o=e.sent;case 13:return e.abrupt("return",Ge(o));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ge(e){return Le.apply(this,arguments)}function Le(){return(Le=(0,le.Z)(de().mark((function e(t){var n,r,i;return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.ok){e.next=2;break}return e.abrupt("return",t.json());case 2:return e.next=4,t.json();case 4:n=e.sent,r=new Error("Bad GitHub Response"),e.t0=t.status,e.next=401===e.t0||404===e.t0?9:422===e.t0?11:14;break;case 9:return r=new Ae,e.abrupt("break",14);case 11:return(null===n||void 0===n||null===(i=n.errors)||void 0===i?void 0:i.length)>0&&n.errors[0].message.startsWith("name already exists")&&(r=new Ne),e.abrupt("break",14);case 14:throw r;case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Me,ze=n(58809),Fe=new(function(){function e(){(0,s.Z)(this,e),this.map=new WeakMap}return(0,l.Z)(e,[{key:"getHandle",value:function(e){if(!e||"object"!==typeof e&&"function"!==typeof e)throw new Error("Only objects");var t={type:"handle",identity:e.constructor?Object.prototype.toString.call(e.constructor):Object.prototype.toString.call(e)};return this.map.set(t,e),t}},{key:"get",value:function(e){return this.map.get(e)}},{key:"safeGet",value:function(e){if(!e)throw new Error("Expected object handle to be truthy");var t=this.map.get(e);if(!t)throw new Error("Expected object handle to return object");return t}}]),e}());function Xe(){return We.apply(this,arguments)}function We(){return(We=(0,le.Z)(de().mark((function e(){var t;return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ze.l){e.next=2;break}throw new Error("Expected apollo");case 2:return e.next=4,ze.l.query({query:ye});case 4:if(null===(t=e.sent.data)||void 0===t?void 0:t.currentUser){e.next=7;break}throw new Error("Expected current user");case 7:return e.abrupt("return",t.currentUser);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function He(e){var t=e.cmd,n=e.args,r=void 0===n?[]:n,i=e.wid,a=e.pud,o=t.format,c=t.parse;return function(){var e=(0,le.Z)(de().mark((function e(n,s){var l,u,d,f,p,h;return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=Ee(s(),i,a),u=l.gitState,d=l.execer,f=l.isExecInProgress,p=l.execQueue,d){e.next=3;break}throw new Error("Expected execer to be registered");case 3:if(f){e.next=9;break}if(n({type:"SEND_GIT_EXEC_COMMAND",wid:i,pud:a}),h=Fe.get(d)){e.next=8;break}throw new Error("Expected exec handle to contain exec service");case 8:h.request({args:o.apply(void 0,[u].concat((0,b.Z)(r)))});case 9:if(0!==p.length&&!f){e.next=11;break}return e.abrupt("return",new Promise((function(e,o){n({type:"QUEUE_GIT_EXEC",cmd:t,args:r,parser:void 0!==c?c:function(e){return e},callback:e,wid:i,pud:a})})));case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}function Ve(e){var t=e.history,n=void 0!==t&&t,r=e.write,i=void 0!==r&&r,a=e.persist,o=void 0!==a&&a,c=e.prefer,s=void 0===c?null:c,l=e.wid,u=e.pud;return function(){var e=(0,le.Z)(de().mark((function e(t,r){var a,c,d,f,p,h,m,v,g,b,x,Z,y,w;return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=function(e,n){return t(He({cmd:e,wid:l,pud:u,args:n}))},e.next=4,a(Ce.bb);case 4:if(c=Ee(r(),l,u),d=c.gitState,f=d.isInitialized,p=d.remote,f){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,a(Ce.GE);case 9:return e.next=11,a(Ce.LO);case 11:if(!i||!p){e.next=40;break}if(null!==s){e.next=15;break}return e.next=15,a(Ce.kT);case 15:if(!Ee(r(),l,u).gitState.hasConflictsWithFetchedRemote&&null===s){e.next=34;break}if("remote"!==s){e.next=24;break}return e.next=20,a(Ce.cF);case 20:return e.next=22,a(Ce.VF);case 22:e.next=32;break;case 24:if("repl"!==s){e.next=31;break}return e.next=27,a(Ce.Ud);case 27:return e.next=29,a(Ce.VF);case 29:e.next=32;break;case 31:case 32:e.next=38;break;case 34:return e.next=36,a(Ce.jW);case 36:return e.next=38,a(Ce.VF);case 38:e.next=43;break;case 40:if(!n||!p){e.next=43;break}return e.next=43,a(Ce.jW);case 43:if(!(i||n||o)){e.next=53;break}return h=r().services.fs,t({type:"SET_GIT_LOADING_STATE",wid:l,isLoading:!0}),e.next=48,h.persist();case 48:if(e.sent.success){e.next=52;break}return e.next=52,h.persist();case 52:t({type:"SET_GIT_LOADING_STATE",wid:l,isLoading:!1});case 53:return m=Ee(r(),l,u),v=m.gitState,g=v.remote,b=!1,g&&(x=new Promise((function(e){setTimeout((function(){b=!0,e()}),3e4)})),Z=function(){var e=(0,le.Z)(de().mark((function e(t){var n,i;return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.deepen,!b){e.next=3;break}return e.abrupt("return",Promise.reject());case 3:return e.next=5,a(Ce.he,[n]);case 5:return e.next=7,a(Ce.cM);case 7:return e.next=9,a(Ce.zq);case 9:if(i=Ee(r(),l,u),i.gitState.hasMergeBaseWithFetchedRemote){e.next=13;break}return e.next=13,Z({deepen:!0});case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Promise.race([Z({deepen:!1}),x]).then((function(){var e=Ee(r(),l,u).gitState,n=e.hasMergeBaseWithFetchedRemote,i=e.badState,a=e.remote;n||t({type:"UPDATE_GIT_STATE",updates:{badState:i===Te.$U.None&&a?Te.$U.NoMergeBase:i},wid:l,pud:u})}))),a(Ce.Pz),a(Ce.cM),e.next=60,a(Ce.i7);case 60:return e.next=62,a(Ce.Hl);case 62:y=Ee(r(),l,u),w=y.gitState.branch,a(Ce.k6,[w]);case 64:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}function $e(e){var t=e.wid,n=e.pud,r=e.remote;return function(){var e=(0,le.Z)(de().mark((function e(i,a){var o,c,s,l,u,d,f,p,h,m;return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=function(e,r){return i(He({cmd:e,args:r,wid:t,pud:n}))},e.next=4,i({type:"START_GIT_CLONE",wid:t});case 4:return c=!!r.match(/^https?:\/\/github\.com/i),s=!!r.match(/^https?:\/\/api\.glitch\.com/i),e.next=8,Xe();case 8:if(l=e.sent,c)try{(null===(u=l.gitHubInfo)||void 0===u?void 0:u.accessToken)&&(h=l.gitHubInfo,i({type:"UPDATE_GIT_STATE",updates:{remoteToken:h.accessToken,gitHubName:null===(d=h.userInfo)||void 0===d?void 0:d.name,gitHubEmail:null===(f=h.userInfo)||void 0===f?void 0:f.email,gitHubAvatarUrl:null===(p=h.userInfo)||void 0===p?void 0:p.avatarUrl,installations:h.installations},wid:t,pud:n}))}catch(v){}return e.next=12,o(Ce.D6,[l]);case 12:return e.next=14,o(Ce.M7,[r]);case 14:return e.next=16,o(Ce.LO);case 16:return e.next=18,i({type:"START_CLONE_PROGRESS",wid:t,pud:n});case 18:return e.next=20,o(s?Ce.TE:Ce.he);case 20:return e.next=22,o(Ce.Di);case 22:return e.next=24,o(Ce.xY);case 24:return e.next=26,i({type:"END_CLONE_PROGRESS",wid:t,pud:n});case 26:if(s){e.next=31;break}return e.next=29,i(Ve({wid:t,pud:n,history:!0}));case 29:e.next=35;break;case 31:return e.next=33,o(Ce.i7);case 33:return e.next=35,new Promise((function(e){return setTimeout(e,1e3)}));case 35:m=function(){var e=Ee(a(),t,n),r=e.execQueue,o=e.isExecInProgress;0!==r.length||o?setTimeout(m,1e3):i({type:"END_GIT_CLONE",wid:t})},m();case 37:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}function qe(e,t){return function(){var n=(0,le.Z)(de().mark((function n(r){var i,a;return de().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=function(n,i){return r(He({cmd:n,args:i,wid:e,pud:t}))},n.next=4,Xe();case 4:return a=n.sent,n.next=7,i(Ce.Hl);case 7:return n.next=9,i(Ce.th,["Initial commit",a]);case 9:return n.next=11,r(Ve({wid:e,pud:t,write:!0}));case 11:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}function Qe(e,t){return function(){var n=(0,le.Z)(de().mark((function n(r){var i,a;return de().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=function(n,i){return r(He({cmd:n,args:i,wid:e,pud:t}))},n.next=4,Xe();case 4:return a=n.sent,n.next=7,i(Ce.GE);case 7:return n.next=9,i(Ce.th,["Initial commit",a,!0]);case 9:return n.next=11,i(Ce.Hl);case 11:return n.next=13,r(Ve({wid:e,pud:t,write:!0}));case 13:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}function Ke(e){var t=e.wid,n=e.pud;return function(){var e=(0,le.Z)(de().mark((function e(r,i){var a,o,c,s,l,u,d,f,p;return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(He({cmd:Ce.LO,wid:t,pud:n}));case 2:if(a=Ee(i(),t,n),o=a.gitState,c=o.remote,s=o.remoteToken,l=!1,!c||!s){e.next=19;break}return e.prev=5,e.next=8,Ue(s,c);case 8:return u=e.sent,d=u.permissions,f=u.id,p=u.owner,l=d&&d.push,e.next=15,r({type:"UPDATE_GIT_STATE",pud:n,wid:t,updates:{repoId:f,ownerId:p.id}});case 15:e.next=19;break;case 17:e.prev=17,e.t0=e.catch(5);case 19:r({type:"GIT_REMOTE_CHECKED",wid:t,canPush:l,remote:c});case 20:case"end":return e.stop()}}),e,null,[[5,17]])})));return function(t,n){return e.apply(this,arguments)}}()}!function(e){e.CHANNEL_OPENED="CHANNEL_OPENED",e.OUTPUT_RECEIVED="OUTPUT_RECEIVED",e.STATE_CHANGED="STATE_CHANGED"}(Me||(Me={}));var Ye=n(5133),Je=n(50055);function et(e){var t=e.container,n=(0,Ye.ZP)(),r=null;function i(){return a.apply(this,arguments)}function a(){return(a=(0,le.Z)(de().mark((function e(){return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=2;break}return e.abrupt("return",r);case 2:return e.abrupt("return",new Promise((function(e){n.once(Me.CHANNEL_OPENED,(function(t){e(t)}))})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var o="";return t.openChannel({service:"exec"},(function(e){var t=e.error,i=e.channel;if(!t){if(!i)throw new Error("Expected channel");var a=!1;return i.onCommand((function(e){if(null!=e.output)o+=e.output,n.emit(Me.OUTPUT_RECEIVED,e.output);else if(null!=e.state){if(!a)return void(a=!0);n.emit(Me.STATE_CHANGED,{state:e.state,outputBuffer:o}),e.state===Je.api.State.Stopped&&(o="")}})),r=i,n.emit(Me.CHANNEL_OPENED,i),function(){r=null}}})),{request:function(){var e=(0,le.Z)(de().mark((function e(t){var n,r,a;return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.env,r=t.args,e.next=3,i();case 3:return a=e.sent,e.abrupt("return",a.request({exec:{env:n,args:r,blocking:!0}}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),onOutput:function(e){return n.on(Me.OUTPUT_RECEIVED,e),function(){n.off(Me.OUTPUT_RECEIVED,e)}},onStateChanged:function(e){return n.on(Me.STATE_CHANGED,e),function(){n.off(Me.STATE_CHANGED,e)}},getStatus:function(){return r?r.status:"closed"}}}var tt=n(75240);function nt(e,t,n){switch(n.type){case"WORKSPACE_MOUNTED":return function(){var n=(0,le.Z)(de().mark((function n(r,i){var a,o,c;return de().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=function(e){return c.apply(this,arguments)},c=function(){return c=(0,le.Z)(de().mark((function n(o){var c,s,l,u;return de().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o===tt.e.CONNECTED){n.next=2;break}return n.abrupt("return");case 2:if(c=Ee(i(),e,t),s=c.gitState,(l=et({container:a})).onOutput((function(n){Ee(i(),e,t).shouldDisplayCloneLogs})),l.onStateChanged((function(n){var a=n.state,o=n.outputBuffer,c=Ee(i(),e,t).execQueue;a===Je.api.State.Stopped&&0!==c.length&&r({type:"EXIT_GIT_EXEC_COMMAND",output:o,wid:e})})),r({type:"REGISTER_EXECER_SERVICE_HANDLE",execer:Fe.getHandle(l),wid:e,pud:t}),s.remoteToken){n.next=10;break}return n.next=10,r(Ke({wid:e,pud:t}));case 10:if(u=s.remote){n.next=13;break}return n.abrupt("return");case 13:return n.next=15,r(He({cmd:Ce.bb,wid:e,pud:t}));case 15:Ee(i(),e,t).gitState.isInitialized||((0,N.j)(N.U3.VERSION_CONTROL_FEATURE_USED,{action:"cloned"}),r($e({remote:u,wid:e,pud:t})));case 17:case"end":return n.stop()}}),n)}))),c.apply(this,arguments)},(a=i().services.container).getConnectionState()===tt.e.CONNECTED?o(tt.e.CONNECTED):a.onConnectionStateChanged(o);case 6:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}();case"FILE_CLEAN":return function(n,r){var i=Ee(r(),e,t),a=i.gitState,o=i.hasOpened;a.isInitialized&&o&&n(He({cmd:Ce.i7,wid:e,pud:t}))};case"EXIT_GIT_EXEC_COMMAND":return function(){var r=(0,le.Z)(de().mark((function r(i,a){var o,c,s,l,u,d;return de().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=Ee(a(),e,t),c=o.execQueue[0],s=Fe.safeGet(c.parser),l=Fe.safeGet(c.callback),r.next=6,i({type:"DEQUEUE_GIT_EXEC",wid:e,pud:t});case 6:return r.next=8,i({type:"UPDATE_GIT_STATE",updates:(0,f.Z)({},s(o.gitState,n.output)),wid:e,pud:t});case 8:l(),(u=Ee(a(),e,t)).execQueue.length>0&&(d=u.execQueue[0],i(He({cmd:d.cmd,args:d.args,wid:e,pud:t})));case 11:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}();case"START_GIT_CLONE":return function(){var t=(0,le.Z)(de().mark((function t(n){return de().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"LOCK_WORKSPACE",showSpinner:!0,reason:"Cloning",wid:e});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();case"END_GIT_CLONE":return function(){var n=(0,le.Z)(de().mark((function n(r){return de().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r({type:"UNLOCK_WORKSPACE",wid:e}),n.next=3,r(Ke({wid:e,pud:t}));case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();case"GITHUB_REPOSITORY_CREATED":case"CHECK_GIT_REMOTE":return function(){var n=(0,le.Z)(de().mark((function n(r){return de().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r(Ke({wid:e,pud:t}));case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();default:return null}}var rt,it=function(e,t){switch(t.type){case"@@INIT":return{gitState:{isInitialized:!1,hasConflictsWithFetchedRemote:!1,hasMergeBaseWithFetchedRemote:!0,authError:Te.l4.NONE,badState:Te.$U.None,remote:t.initialState.gitRemoteUrl||"",repoId:null,branch:"",defaultBranch:"main",branches:[],installations:[],changedFiles:[],commits:[],commitsAhead:null,commitsBehind:null,remoteToken:null,gitHubName:null,ownerId:null,gitHubAvatarUrl:null,gitHubEmail:null},hasOpened:!1,isSidebarVisible:!1,isCloneInProgress:!1,shouldDisplayCloneLogs:!1,isExecInProgress:!1,isLoading:!0,execQueue:[],execer:null};case"REGISTER_EXECER_SERVICE_HANDLE":return(0,v.Z)((0,f.Z)({},e),{execer:t.execer});case"SEND_GIT_EXEC_COMMAND":return(0,v.Z)((0,f.Z)({},e),{isExecInProgress:!0,isLoading:!0});case"EXIT_GIT_EXEC_COMMAND":return(0,v.Z)((0,f.Z)({},e),{isExecInProgress:!1});case"QUEUE_GIT_EXEC":var n=Fe.getHandle(t.parser),r=Fe.getHandle(t.callback);return(0,v.Z)((0,f.Z)({},e),{execQueue:e.execQueue.concat({cmd:t.cmd,args:t.args,parser:n,callback:r})});case"DEQUEUE_GIT_EXEC":return(0,v.Z)((0,f.Z)({},e),{execQueue:e.execQueue.slice(1)});case"START_GIT_CLONE":return(0,v.Z)((0,f.Z)({},e),{isCloneInProgress:!0});case"START_CLONE_PROGRESS":return(0,v.Z)((0,f.Z)({},e),{shouldDisplayCloneLogs:!0});case"END_CLONE_PROGRESS":return(0,v.Z)((0,f.Z)({},e),{shouldDisplayCloneLogs:!1});case"END_GIT_CLONE":return(0,v.Z)((0,f.Z)({},e),{isCloneInProgress:!1});case"SET_GIT_LOADING_STATE":return(0,v.Z)((0,f.Z)({},e),{isLoading:t.isLoading});case"UPDATE_GIT_STATE":return(0,v.Z)((0,f.Z)({},e),{gitState:(0,f.Z)({},e.gitState,t.updates),isLoading:(t.updates.badState!==Te.$U.None||t.updates.authError!==Te.l4.NONE)&&(e.execQueue.length>0||e.isCloneInProgress)});case"SET_GIT_SIDEBAR_VISIBILITY":return(0,v.Z)((0,f.Z)({},e),{isSidebarVisible:t.isSidebarVisible,hasOpened:!0});default:return e}},at=n(60536),ot=n.n(at),ct=n(6951),st=n(40381),lt=n(64375),ut=n(93373),dt=function(e,t){var n=(0,Pe.mJ)(t),r="";switch(e){case Te.l4.PUSH:r="push to ".concat(n);break;case Te.l4.FETCH:r="fetch from ".concat(n);break;case Te.l4.CLONE:r="clone from ".concat(n);break;case Te.l4.GITHUB_CREATE:case Te.l4.GITHUB_GET_INFO:default:r="create new repositories"}return"Please grant Replit permission to access GitHub on your behalf. As well, confirm that "+(e===Te.l4.FETCH?"".concat(n," exists and you have permission to fetch from it."):"you have permission to ".concat(r,"."))},ft=function(e){var t=e.repoId,n=e.ownerId,r=e.wid,s=e.pud,l=e.authError,u=e.onAuth,d=(0,k.I0)(),f=(0,k.v9)((function(e){return Ee(e,r,s)})).gitState,p="Connect to GitHub";f.remote&&(p="Unable to connect to this repository");var h=(0,lt.v)({suggestedRepoId:t,ownerId:n,onAuth:(0,le.Z)(de().mark((function e(){return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:g(!1),u(),d({type:"UPDATE_GIT_STATE",updates:{authError:Te.l4.NONE,badState:Te.$U.None},wid:r,pud:s});case 3:case"end":return e.stop()}}),e)})))}),m=(0,i.Z)(o.useState(!0),2),v=m[0],g=m[1];return(0,a.tZ)(c.u_,{onRequestClose:function(){g(!1),l!==Te.l4.FETCH?d({type:"UPDATE_GIT_STATE",updates:{authError:Te.l4.NONE},wid:r,pud:s}):d({type:"UPDATE_GIT_STATE",updates:{badState:Te.$U.AuthFetchError},wid:r,pud:s})},isOpen:v,children:(0,a.BX)(c.G7,{css:[c.l0.colWithGap(24)],children:[(0,a.tZ)(c.h4,{level:1,variant:"headerDefault",children:p}),(0,a.BX)(c.G7,{css:[c.l0.colWithGap(8)],children:[(0,a.tZ)(c.xv,{multiline:!0,children:dt(l,f.remote)}),(0,a.BX)(c.xv,{multiline:!0,children:["See"," ",(0,a.tZ)("a",{href:"https://docs.replit.com/programming-ide/github-auth-errors",target:"_blank",rel:"noreferrer",children:"our docs"})," ","for more help with GitHub authentication errors."]})]}),(0,a.tZ)(c.G7,{css:[c.l0.rowWithGap(12),c.l0.justify.end],children:(0,a.tZ)(c.zx,{colorway:"primary",onClick:h,text:"Connect Replit to your GitHub Account",iconLeft:(0,a.tZ)(ut.Z,{})})})]})})},pt=n(30992),ht=n(94561),mt=n(27206),vt=n(34193),gt=function(e){return e.trim().split(" ").join("-")},bt=function(e){var t=e.isOpen,n=e.isCreatingBranch,r=e.onClose,i=e.currentBranch,o=e.branches,c=e.successHandler;if(!t)return null;var s=(0,pt.Y)("",(function(e){return e?o.includes(gt(e))?{message:"* this branch name already exists"}:void 0:{message:"* branch names cannot be blank"}})),l=function(){var e=(0,le.Z)(de().mark((function e(t){return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!s.validate()){e.next=4;break}return e.abrupt("return");case 4:c(gt(s.value));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,a.tZ)(vt.Z,{onRequestClose:r,isOpen:!0,children:(0,a.BX)("div",{className:"jsx-4a406bdd6aef82a6 container",children:[(0,a.BX)("form",{onSubmit:l,autoComplete:"off",className:"jsx-4a406bdd6aef82a6",children:[(0,a.tZ)("h1",{className:"jsx-4a406bdd6aef82a6",children:"Create a new branch"}),(0,a.tZ)("h2",{className:"jsx-4a406bdd6aef82a6",children:n?"Creating your new branch":"This branch will be created from ".concat(i)}),(0,a.tZ)("div",{className:"jsx-4a406bdd6aef82a6 creation-error",children:s.error&&s.error.message}),(0,a.tZ)("div",{className:"jsx-4a406bdd6aef82a6 section",children:(0,a.tZ)(mt.ZP,{value:s.value,type:"text",autoFocus:!0,name:"branch-name",autoComplete:"off",onChange:function(e){s.setValue(e.currentTarget.value)},placeholder:"name your branch (required)",onFocus:function(e){return e.target.select()}})}),(0,a.tZ)(ct.Z,{type:"submit","data-testid":"git-confirm-github-repo",color:"primary",filled:!0,children:n?(0,a.BX)("span",{className:"jsx-4a406bdd6aef82a6",children:["creating",(0,a.tZ)(ht.Z,{style:{fontSize:"20px",padding:"1px"}})]}):"create"})]}),(0,a.tZ)(ot(),{id:"4a406bdd6aef82a6",children:".container.jsx-4a406bdd6aef82a6{font-size:1rem;width:510px;padding:60px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:start;-webkit-align-items:flex-start;-moz-box-align:start;-ms-flex-align:start;align-items:flex-start;height:100%;color:var(--foreground-default)}.container.jsx-4a406bdd6aef82a6 form.jsx-4a406bdd6aef82a6{width:90%}.container.jsx-4a406bdd6aef82a6 h1.jsx-4a406bdd6aef82a6{font-size:23px;margin-bottom:10px;font-weight:normal}.container.jsx-4a406bdd6aef82a6 h2.jsx-4a406bdd6aef82a6{color:var(--foreground-dimmer);font-size:16px;margin-bottom:15px;font-weight:normal}.creation-error.jsx-4a406bdd6aef82a6{min-height:16px;margin:10px;color:var(--accent-negative-default)}.section.jsx-4a406bdd6aef82a6{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;padding-bottom:25px;width:100%}"})]})})},xt=n(92002),Zt=function(e){var t=e.checkoutBranch,n=e.gitState,r=e.isLoading,i=(0,o.useState)(!1),s=i[0],l=i[1];(0,o.useEffect)((function(){!r&&s&&l(!1)}),[r,l]);var u,d,f=(u=n.branches,d=n.defaultBranch,0===u.length?[]:u.sort((function(e){return e===d?-1:0})).map((function(e){return{title:e}})));return(0,a.BX)(c.G7,{css:[c.l0.rowWithGap(8),c.l0.align.center],children:[(0,a.tZ)(c.G7,{css:[c.l0.flex.growAndShrink(1)],children:(0,a.tZ)(c.Ph,{items:f,selectedItem:f.find((function(e){return e.title===n.branch})),onChange:function(e){e.title!==n.branch&&t(e.title)}})}),(0,a.tZ)(c.hU,{onClick:function(){l(!0)},alt:"Create new branch",children:(0,a.tZ)(xt.Z,{})}),(0,a.tZ)(bt,{branches:n.branches,currentBranch:n.branch,isCreatingBranch:s&&r,isOpen:s,onClose:function(){return l(!1)},successHandler:function(e){t(e)}})]})},yt=n(61756),wt=n(1144),kt=n(1879),Et=n(69346),St=n(81255),Ct=n(57704),Tt=n(99408),Rt=n(97648),_t=n(70931),It=function(e){var t=(0,Tt.Z)().container,n=(0,_t.J)(e.remote),r=n?"".concat(n.username,"/").concat(n.repository):e.remote,i=(0,we.I)();return(0,a.BX)(Et.ZP,{css:[St.l0.colWithGap(16)],children:[(0,a.BX)(wt.h,{variant:"headerDefault",level:2,children:["Remove ",r," as a remote?"]}),(0,a.BX)(wt.x,{multiline:!0,children:["Are you sure you want to remove ",r,"?"]}),(0,a.BX)(wt.x,{multiline:!0,children:["This can be undone by re-connecting to the repository in the Git sidebar or running ",(0,a.BX)(Rt.Z,{children:["git remote add origin ",e.remote]})," ","in the Shell."]}),(0,a.BX)(Et.ZP,{css:[St.l0.rowWithGap(12),St.l0.justify.end],children:[(0,a.tZ)(c.zx,{text:"Cancel",onClick:e.hideModal}),(0,a.tZ)(c.zx,{iconLeft:(0,a.tZ)(Ct.Z,{}),onClick:function(){var n;(n=t).exec.apply(n,(0,b.Z)(Ce.rO.format(Te.Xe))),i(Ve({wid:e.wid,pud:e.pud})),e.hideModal()},text:"Yes, remove ".concat(r),colorway:"negative"})]})]})},Pt=n(29163),Dt=n(75301),At=n(38630);function Nt(e){var t=e.count,n=e.message;return(0,a.BX)(wt.x,{children:[(0,a.tZ)(wt.x,{css:St.l0.fontWeight.bold,children:t})," ",(0,a.tZ)(wt.x,{color:"dimmer",children:n})]})}!function(e){e.RemoveRemote="RemoveRemote",e.ConnectExistingRemote="ConnectExistingRemote"}(rt||(rt={}));var Ut=function(e){var t=e.branch,n=e.commitsBehind;return e.isLoading?(0,a.tZ)(wt.x,{children:" checking latest changes... "}):t?null===n?null:n&&1===n?(0,a.tZ)(Nt,{count:1,message:"commit behind ".concat(t)}):n&&n>1?(0,a.tZ)(Nt,{count:n,message:"commits behind ".concat(t)}):(0,a.BX)(wt.x,{children:["up to date with ",t]}):(0,a.tZ)(wt.x,{children:"could not find a default branch - try adding some commits!"})},jt=function(e){var t=e.gitState,n=e.isLoading,r=e.pull,c=e.setExistingRepoConnectionIsOpen,s=e.setGitHubCreationModalOpen,l=e.wid,u=e.pud,d=""!==t.remote,f=(0,i.Z)(o.useState(null),2),p=f[0],h=f[1];return(0,a.BX)(Et.ZP,{css:[St.l0.colWithGap(16)],children:[d?(0,a.BX)(Et.ZP,{css:[St.l0.rowWithGap(8),St.l0.justify.spaceBetween,St.l0.align.center,St.l0.width("100%")],children:[(0,a.BX)(Et.ZP,{css:[St.l0.rowWithGap(8),St.l0.align.center,St.l0.flex.growAndShrink(1)],title:"Repository origin: ".concat(t.remote),children:[(0,a.tZ)(ut.Z,{size:16}),(0,a.tZ)(Et.ZP,{tag:"a",css:[St.l0.truncate,St.l0.flex.growAndShrink(1)],href:t.remote,target:"_blank",rel:"noreferrer noopener",children:(0,Pe.mJ)(t.remote)})]}),(0,a.tZ)(Pt.Z,{alt:"Remove remote",colorway:"negative",onClick:function(){return h(rt.RemoveRemote)},children:(0,a.tZ)(Ct.Z,{})})]}):(0,a.BX)(Et.ZP,{css:[St.l0.rowWithGap(8),St.l0.align.center,St.l0.maxWidth("100%"),St.l0.width("100%")],children:[(0,a.tZ)(yt.ZP,{stretch:!0,onClick:function(){s(!0)},iconLeft:(0,a.tZ)(ut.Z,{}),text:t.remoteToken?"New repo":"Connect to GitHub",css:[St.l0.flex.grow(1)]}),t.remoteToken?(0,a.tZ)(yt.ZP,{stretch:!0,text:"Existing repo",onClick:function(){return c(!0)},iconLeft:(0,a.tZ)(Dt.Z,{}),css:[St.l0.flex.grow(1)]}):null]}),d&&(0,a.BX)(Et.ZP,{css:[St.l0.flex.row,St.l0.flex.wrap,St.l0.justify.spaceBetween],children:[(0,a.tZ)(Ut,{branch:t.branch,commitsBehind:t.commitsBehind,isLoading:n}),!!t.commitsBehind&&t.commitsBehind>0&&(0,a.tZ)(yt.ZP,{colorway:"warning",onClick:r,text:"Pull",iconRight:(0,a.tZ)(At.Z,{})})]}),(0,a.tZ)(kt.Z,{isOpen:p===rt.RemoveRemote,onRequestClose:function(){return h(null)},maxWidth:512,children:(0,a.tZ)(It,{remote:t.remote,hideModal:function(){return h(null)},wid:l,pud:u})})]})},Bt=n(61927),Ot=n(16449),Gt=n(94158),Lt=n(9517),Mt=n(75444),zt=n(37552),Ft=n(66060);function Xt(e){var t=e.gitCommit,n=e.gitPush,r=e.gitAddAll,i=e.hasRemote,o=e.hasChangedFiles,c=e.hasStagedFiles,s=[];return c||s.push("commit"),i||s.push("push"),(0,a.BX)(Et.ZP,{css:[St.l0.rowWithGap(4)],children:[(0,a.tZ)(yt.ZP,{css:[St.l0.flex.growAndShrink(1)],disabled:!o,iconRight:(0,a.tZ)(Lt.Z,{}),onClick:function(){r(),t(),n()},text:"Commit All"+(i?" & Push":""),outlined:!0}),(0,a.BX)(zt.ZE,{onAction:function(e){switch(e){case"commit":t();break;case"push":n()}},disabledKeys:s,children:[(0,a.tZ)(zt.ck,{children:(0,a.BX)(Ft.ZP,{tooltip:"You must stage some files using the plus icon beside a file before you can commit",placement:"right",isDisabled:c,children:[(0,a.tZ)(wt.x,{variant:"subheadDefault",css:c?[]:[St.l0.color.foregroundDimmest],children:"Commit"}),(0,a.tZ)(wt.x,{variant:"text",css:c?[]:[St.l0.color.foregroundDimmest],children:"Locally save your staged changes"})]})},"commit"),(0,a.tZ)(zt.ck,{children:(0,a.BX)(Ft.ZP,{tooltip:"Push is only available if you have a GitHub repository connected",placement:"right",isDisabled:i,children:[(0,a.tZ)(wt.x,{variant:"subheadDefault",css:i?[]:[St.l0.color.foregroundDimmest],children:"Push"}),(0,a.tZ)(wt.x,{variant:"text",css:i?[]:[St.l0.color.foregroundDimmest],children:"Update remote repo with newest commits"})]})},"push")]})]})}var Wt=n(77365),Ht=n(46241),Vt=function(e){switch(e.change){case Te.pD.UNTRACKED:return"new";case Te.pD.MODIFIED:return"modified";case Te.pD.MOVED:return"renamed";case Te.pD.DELETED:return"deleted";default:return""}},$t=function(e){var t,n,r=e.file,i=e.active,o=e.handleChangedFileClick,s=e.isStaged,l=e.gitRestore,u=e.gitAdd,d=!1;if(r.targetPath.endsWith("/")){d=!0;var f=r.targetPath.substr(0,r.targetPath.length-1).split("/");t=f[f.length-1]+"/",n=f.slice(0,f.length-1).join("/")}else{var p=r.targetPath.split("/");t=p[p.length-1],n=p.slice(0,p.length-1).join("/")}var h=Vt(r),m=h.substr(0,1).toUpperCase(),v=["changedFileItem"];return i&&v.push("active"),d||r.change===Te.pD.DELETED||v.push("showable"),(0,a.BX)("div",{onClick:function(){d||r.change===Te.pD.DELETED||o(r.targetPath)},className:"jsx-efd6f34434320e10 "+(v.join(" ")||""),children:[(0,a.tZ)(ot(),{id:"efd6f34434320e10",children:".changedFileItem.jsx-efd6f34434320e10{-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;border:1px solid var(--background-highest);-webkit-border-radius:2.5px;-moz-border-radius:2.5px;border-radius:2.5px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;margin-bottom:5px;padding:6px 12px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:100%}.showable.changedFileItem.jsx-efd6f34434320e10{cursor:pointer}.changedFileItem.jsx-efd6f34434320e10:hover{background-color:var(--accent-primary-dimmer)}.changedFileItem.jsx-efd6f34434320e10:hover .changeModeBadge.jsx-efd6f34434320e10 .letter.jsx-efd6f34434320e10{display:none}.changedFileItem.jsx-efd6f34434320e10:hover .changeModeBadge.jsx-efd6f34434320e10 .word.jsx-efd6f34434320e10{display:block}.changedFileItem.active.jsx-efd6f34434320e10{background-color:var(--accent-primary-default);border-color:transparent;color:var(--white)}.showable.jsx-efd6f34434320e10 .fileName.jsx-efd6f34434320e10:hover{text-decoration:underline}.fileName.jsx-efd6f34434320e10,.dirs.jsx-efd6f34434320e10,.changeMode.jsx-efd6f34434320e10{display:block;white-space:nowrap}.changeMode.jsx-efd6f34434320e10{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0}.fileName.jsx-efd6f34434320e10{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;margin-right:8px;max-width:60%;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis}.changeMode.jsx-efd6f34434320e10{margin-left:8px}.dirs.jsx-efd6f34434320e10{-webkit-flex-shrink:1;-ms-flex-negative:1;flex-shrink:1;margin-right:auto;opacity:.7;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;white-space:nowrap}.changeModeBadge.jsx-efd6f34434320e10{-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;background:#999;-webkit-border-radius:2.5px;-moz-border-radius:2.5px;border-radius:2.5px;color:#fff;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;height:24px;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;min-width:24px;padding:2px 4px;-webkit-transition:width.1s;-moz-transition:width.1s;-o-transition:width.1s;transition:width.1s}.changeModeBadge.jsx-efd6f34434320e10 .word.jsx-efd6f34434320e10{display:none}.changedFileItem.active.jsx-efd6f34434320e10 .changeModeBadge.jsx-efd6f34434320e10,.changedFileItem.active.jsx-efd6f34434320e10:hover .new.jsx-efd6f34434320e10,.changedFileItem.active.jsx-efd6f34434320e10:hover .modified.jsx-efd6f34434320e10,.changedFileItem.active.jsx-efd6f34434320e10:hover .deleted.jsx-efd6f34434320e10{background-color:var(--background-default);color:var(--foreground-dimmer);border:transparent}.new.jsx-efd6f34434320e10{background:var(--accent-positive-dimmest);border:1px solid var(--accent-positive-default);color:var(--accent-positive-default)}.modified.jsx-efd6f34434320e10{background:var(--accent-orange-dimmest);border:1px solid var(--accent-orange-default);color:var(--accent-orange-default)}.deleted.jsx-efd6f34434320e10{background:var(--accent-negative-dimmest);border:1px solid var(--accent-negative-default);color:var(--accent-negative-stronger)}.deleted.jsx-efd6f34434320e10:hover{cursor:not-allowed}.changedFileItem.jsx-efd6f34434320e10:hover .new.jsx-efd6f34434320e10{background:var(--accent-positive-default);color:var(--foreground-default)}.changedFileItem.jsx-efd6f34434320e10:hover .modified.jsx-efd6f34434320e10{background:var(--accent-orange-default);color:var(--foreground-default)}.changedFileItem.jsx-efd6f34434320e10:hover .deleted.jsx-efd6f34434320e10{background:var(--accent-negative-default);color:var(--foreground-default)}.renamed.jsx-efd6f34434320e10{background:var(--accent-primary-dimmer)}"}),(0,a.tZ)(c.hU,{css:[c.l0.mr(4)],alt:s?"Unstage":"Stage",onClick:(0,le.Z)(de().mark((function e(){return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s?l(r.targetPath,!0):u(r.targetPath);case 1:case"end":return e.stop()}}),e)}))),children:s?(0,a.tZ)(Gt.Z,{}):(0,a.tZ)(xt.Z,{})}),s?null:(0,a.tZ)(c.hU,{css:[c.l0.mr(4)],alt:"Restore",onClick:(0,le.Z)(de().mark((function e(){return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l(r.targetPath,!1);case 1:case"end":return e.stop()}}),e)}))),children:(0,a.tZ)(Mt.Z,{})}),(0,a.tZ)("div",{title:t,className:"jsx-efd6f34434320e10 fileName",children:t}),(0,a.tZ)("div",{title:n,className:"jsx-efd6f34434320e10 dirs",children:n}),(0,a.tZ)("div",{className:"jsx-efd6f34434320e10 changeMode",children:(0,a.BX)("div",{className:"jsx-efd6f34434320e10 "+("changeModeBadge "+h||0),children:[(0,a.tZ)("div",{className:"jsx-efd6f34434320e10 letter",children:m}),(0,a.tZ)("div",{className:"jsx-efd6f34434320e10 word",children:m+h.substr(1)})]})})]})},qt=function(e){var t=e.changedFiles,n="changed files or folders";if(1===t.length){var r=Vt(t[0])||"changed";n="".concat(r," file or folder")}return(0,a.tZ)(Nt,{count:t.length,message:n})},Qt=function(e){var t=e.stagedFiles,n="staged files or folders";return 1===t.length&&(n="staged file or folder"),(0,a.tZ)(Nt,{count:t.length,message:n})},Kt=function(e){var t=e.branch,n=e.commitsAhead,r="commit ahead of";return n&&n>1&&(r="commits ahead of"),(0,a.tZ)(Nt,{count:n,message:"".concat(r," ").concat(t)})},Yt=function(e){var t=e.disabled,n=e.onClick;return(0,a.tZ)(c.zx,{disabled:t,onClick:n,text:"Push",iconRight:(0,a.tZ)(Lt.Z,{}),outlined:!0})},Jt=function(e){var t=e.activeFile,n=e.branch,r=e.changedFiles,i=e.commits,s=e.commitsAhead,l=e.commitsBehind,u=e.isLoading,d=e.remote,f=e.gitCommit,p=e.gitPush,h=e.gitAddAll,m=e.gitRestore,v=e.gitAdd,g=function(){var e=Z.trim();""!==e?(f(e),y(""),E(!1)):E(!0)},b=function(e){R.openFile(e)},x=(0,o.useState)(""),Z=x[0],y=x[1],w=(0,o.useState)(!1),k=w[0],E=w[1],S=(0,o.useState)(!1),C=S[0],T=S[1],R=(0,Tt.Z)().session,_=r.filter((function(e){return e.isStaged})),I=r.filter((function(e){return!e.isStaged})),P=_.slice(0,C?_.length:3),D=I.slice(0,C?I.length:Math.max(3-P.length,0)),A=(0,Ot.Z)().ref,N=r.length>0,U=null!==s,j=null!==l,B=!!s&&s>0,O=!!l&&l>0;return u&&!N?(0,a.tZ)(c.G7,{css:[c.l0.center,c.l0.p(16)],children:(0,a.tZ)(Wt.Z,{})}):N||B||O||!U||!j?(0,a.BX)(c.G7,{css:[c.l0.colWithGap(16)],children:[B&&U&&(0,a.tZ)(Kt,{branch:n,commitsAhead:s}),!N&&(B||!U)&&(0,a.tZ)(c.G7,{css:[c.l0.mb(16),c.l0.position.relative],children:(0,a.tZ)(c.u,{placement:"right",tooltip:"You do not have a remote repository to push to. Connect a remote github repository to push.",isDisabled:Boolean(d),children:(0,a.tZ)(Yt,{disabled:!d,onClick:p})})}),N&&(0,a.BX)(c.G7,{css:[c.l0.colWithGap(8)],children:[(0,a.tZ)(c.B,{css:{resize:"vertical"},ref:A,required:!0,name:"commitAuthorInput",disabled:0===r.length,placeholder:i.length>0?"What did you change?":"What did you add?",value:Z,onChange:function(e){y(e.target.value),E(""===e.target.value)},onKeyDown:function(e){(0,Bt.b)(e),"Enter"===e.key&&(e.metaKey||e.ctrlKey)&&g()}}),k?(0,a.BX)(c.G7,{css:[c.l0.rowWithGap(2),c.l0.align.center],children:[(0,a.tZ)(Ht.Z,{}),(0,a.tZ)(c.xv,{variant:"small",css:c.l0.color.accentNegativeStrongest,children:"Add a commit message"})]}):null,(0,a.tZ)(Xt,{gitAddAll:h,gitCommit:g,gitPush:p,hasRemote:Boolean(d),hasChangedFiles:r.length>0,hasStagedFiles:_.length>0})]}),_.length?(0,a.BX)(c.G7,{css:c.l0.colWithGap(8),children:[(0,a.tZ)(Qt,{stagedFiles:_}),(0,a.tZ)(c.G7,{children:P.map((function(e){return(0,a.tZ)($t,{file:e,handleChangedFileClick:b,active:Boolean(t)&&t.endsWith(e.targetPath),isStaged:e.isStaged,gitRestore:m,gitAdd:v},e.targetPath)}))})]}):null,I.length?(0,a.BX)(c.G7,{css:c.l0.colWithGap(8),children:[(0,a.tZ)(qt,{changedFiles:I}),(0,a.BX)(c.G7,{children:[D.map((function(e){return(0,a.tZ)($t,{file:e,handleChangedFileClick:b,active:Boolean(t)&&t.endsWith(e.targetPath),isStaged:e.isStaged,gitRestore:m,gitAdd:v},e.targetPath)})),r.length>3&&(0,a.tZ)(c.zx,{css:[c.l0.backgroundColor.backgroundDefault,c.l0.color.foregroundDefault,c.l0.cursor.pointer,{textDecoration:"underline"},c.l0.width("100%")],onClick:function(){return T(!C)},text:C?"show fewer":"show all"})]})]}):null]}):(0,a.tZ)(c.xv,{color:"dimmer",children:"Your file changes will appear here."})},en=n(7055),tn=n(30791),nn=n(70917),rn={root:(0,nn.iv)([c.l0.py(8),c.l0.pl(24),c.l0.position.relative]),line:(0,nn.iv)([c.l0.position.absolute,c.l0.top(22),c.l0.left(8),c.l0.height("100%"),c.l0.width(1),c.l0.backgroundColor.outlineDimmest]),dot:(0,nn.iv)([c.l0.position.absolute,c.l0.top(0),c.l0.left(0),c.l0.height(12),c.l0.width(12),c.l0.borderRadius("full"),{transform:"translateX(-50%)",border:"1px solid",borderColor:c.TV.outlineDimmest}])},an=function(e){var t=e.children,n=e.renderDot,r=void 0===n||n;return(0,a.BX)(c.G7,{tag:"li",css:rn.root,children:[(0,a.tZ)(c.G7,{css:rn.line,children:r?(0,a.tZ)(c.Tg,{css:rn.dot}):null}),(0,a.tZ)(c.G7,{children:t})]})},on={root:(0,nn.iv)([c.l0.borderRadius(8),c.l0.colWithGap(8),c.l0.p(8),{border:"1px solid",borderColor:c.TV.outlineDimmer}]),author:(0,nn.iv)([c.l0.colWithGap(4)]),commitHash:(0,nn.iv)([c.l0.rowWithGap(8),c.l0.align.center,{"& a":c.l0.color.foregroundDimmer,"& a:hover":c.l0.color.foregroundDefault}])},cn=function(e){var t=e.commit,n=e.handleRevertToCommit,r=e.displayTimeSinceUnix,i=e.gitHubLink;return(0,a.tZ)(an,{children:(0,a.BX)(c.G7,{css:on.root,children:[(0,a.tZ)(sn,{message:t.message}),(0,a.BX)(c.G7,{css:on.author,children:[(0,a.BX)(c.xv,{children:[t.authorName," \u2022"," ",(0,en.Z)(t.authorDate,r,{addSuffix:!0})]}),(0,a.tZ)(c.xv,{variant:"small",color:"dimmer",title:t.authorEmail,children:t.authorEmail})]}),(0,a.BX)(c.G7,{css:on.commitHash,title:t.hash,children:[(0,a.tZ)(c.xv,{css:c.l0.font.code,variant:"small",children:t.hash.substring(0,9)}),null!==i?(0,a.tZ)(c.u,{tooltip:"See on GitHub",children:(0,a.tZ)(c.G7,{tag:"a",href:i,target:"_blank",rel:"noopener noreferer",children:(0,a.tZ)(ut.Z,{})})}):null]}),(0,a.tZ)(c.G7,{css:c.l0.flex.row,children:(0,a.tZ)(yt.ZP,{outlined:!0,colorway:"warning",small:!0,onClick:function(){return n(t)},text:"Revert to here"})})]})})},sn=function(e){var t=e.message,n=(0,g.Z)(t.split("\n").filter((function(e){return Boolean(e.trim())})).map((function(e){return e.replace(/:[\w\-+]+:/g,(function(e){return tn.$M[e.slice(1,-1)]||e}))}))),r=n[0],i=n.slice(1),s=i.length?i.join("\n"):null,l=(0,o.useState)(!1),u=l[0],d=l[1];return(0,a.BX)(c.G7,{children:[(0,a.tZ)(c.xv,{multiline:!0,children:r}),u?(0,a.tZ)(c.xv,{color:"dimmer",multiline:!0,children:s}):null,u&&(0,a.tZ)("a",{href:"#",className:"more-link",onClick:function(){return d(!1)},children:"see less"},"more"),!u&&s&&(0,a.tZ)("a",{href:"#",className:"more-link",onClick:function(){return d(!0)},children:"see more"},"more")]})},ln=function(e){var t=e.gitState,n=e.handleRevertToCommit,r=e.fetchMoreCommits,i=t.commits[t.commits.length-1],s=Boolean(i&&""!==i.parentHash),l=(0,o.useState)(Date.now()),u=l[0],d=l[1];(0,o.useEffect)((function(){d(Date.now())}),[t.commits]);var f=t.commitsAhead||0;return 0===t.commits.length?null:(0,a.BX)(c.G7,{css:c.l0.colWithGap(8),children:[(0,a.tZ)(c.h4,{level:2,variant:"subheadDefault",children:"Previous Commits"}),(0,a.BX)(c.G7,{children:[(0,a.tZ)(c.G7,{tag:"ul",children:t.commits.map((function(e,r){return(0,a.tZ)(cn,{handleRevertToCommit:n,commit:e,displayTimeSinceUnix:u,gitHubLink:""!==t.remote&&r>=f?(0,Pe.cW)(t.remote,e.hash):null},e.hash)}))}),s?(0,a.tZ)(an,{renderDot:!1,children:(0,a.tZ)(yt.ZP,{onClick:r,text:"Load more commits"})}):null]})]})};function un(e){var t=e.wid,n=e.pud,r=e.gitState,c=(0,we.I)(),s=function(){c({type:"UPDATE_GIT_STATE",wid:t,pud:n,updates:{hasConflictsWithFetchedRemote:!1}})},l=(0,i.Z)(o.useState(null),2),u=l[0],d=l[1],f=(0,i.Z)(o.useState(!0),2),p=f[0],h=f[1],m="Confirm",v=["conflictChoices"];return"repl"===u?(v.push("chosen-repl"),m="Confirm keep Replit"):"remote"===u&&(v.push("chosen-remote"),m="Confirm overwrite from GitHub"),p||v.push("invalid"),(0,a.BX)(vt.Z,{isOpen:!0,onRequestClose:s,children:[(0,a.tZ)(ot(),{id:"5da074ca0af64a21",children:".conflictChoices.jsx-5da074ca0af64a21{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.conflictPreference.jsx-5da074ca0af64a21{width:48%;border:1px solid var(--foreground-default);cursor:pointer;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px;overflow:hidden;-webkit-transition:-webkit-transform.2s;-moz-transition:-moz-transform.2s;-o-transition:-o-transform.2s;transition:-webkit-transform.2s;transition:-moz-transform.2s;transition:-o-transform.2s;transition:transform.2s}.conflictPreference.jsx-5da074ca0af64a21:hover{-webkit-transform:translate(0,-3px);-moz-transform:translate(0,-3px);-ms-transform:translate(0,-3px);-o-transform:translate(0,-3px);transform:translate(0,-3px)}.conflictPreference.jsx-5da074ca0af64a21 .header.jsx-5da074ca0af64a21{padding:8px 12px;font-weight:bold;background:var(--background-root)}.conflictPreference.jsx-5da074ca0af64a21 .body.jsx-5da074ca0af64a21{padding:8px 12px;line-height:1.4em}.chosen-repl.jsx-5da074ca0af64a21 .replPreference.jsx-5da074ca0af64a21 .header.jsx-5da074ca0af64a21,.chosen-remote.jsx-5da074ca0af64a21 .remotePreference.jsx-5da074ca0af64a21 .header.jsx-5da074ca0af64a21{color:var(--background-default);background:var(--foreground-default)}.chosen-repl.jsx-5da074ca0af64a21 .remotePreference.jsx-5da074ca0af64a21,.chosen-remote.jsx-5da074ca0af64a21 .replPreference.jsx-5da074ca0af64a21{border-color:var(--foreground-dimmer)}"}),(0,a.BX)(Et.ZP,{css:[St.l0.maxWidth(600),St.l0.px(16),St.l0.py(24),St.l0.color.foregroundDefault,St.l0.backgroundColor.backgroundDefault],children:[(0,a.tZ)(wt.x,{css:[St.l0.mb(16)],variant:"headerDefault",children:"Conflicting Changes"}),(0,a.BX)(wt.x,{css:[St.l0.mb(24)],multiline:!0,children:["There are changes from the remote (",(0,a.tZ)("a",{href:r.remote,target:"_blank",rel:"nofererer noopener",className:"jsx-5da074ca0af64a21",children:r.remote}),") that have been made since your changes on Replit that conflict with each other. Which version would you like to keep?"]}),(0,a.BX)("div",{className:"jsx-5da074ca0af64a21 "+(v.join(" ")||""),children:[(0,a.BX)("div",{onClick:function(){return d("remote")},className:"jsx-5da074ca0af64a21 remotePreference conflictPreference",children:[(0,a.tZ)("div",{className:"jsx-5da074ca0af64a21 header",children:"Keep version on GitHub"}),(0,a.tZ)("div",{className:"jsx-5da074ca0af64a21 body",children:"Permanently delete any changes in your Repl that are not on GitHub."})]}),(0,a.BX)("div",{onClick:function(){return d("repl")},className:"jsx-5da074ca0af64a21 replPreference conflictPreference",children:[(0,a.tZ)("div",{className:"jsx-5da074ca0af64a21 header",children:"Keep version on Replit"}),(0,a.tZ)("div",{className:"jsx-5da074ca0af64a21 body",children:"Permanently delete any changes in your GitHub repository that are not on Replit"})]})]}),(0,a.BX)(Et.ZP,{css:[St.l0.mt(24),St.l0.flex.row,St.l0.justify.end],children:[(0,a.tZ)(ct.Z,{css:[St.l0.ml(8)],onClick:s,children:"Cancel"}),(0,a.tZ)(Ft.ZP,{tooltip:"You must choose a preference to continue",placement:"right",isDisabled:Boolean(u),children:(0,a.tZ)(ct.Z,{color:"negative",css:[St.l0.ml(8)],disabled:!u,onClick:function(){null!==u?(c(Ve({write:!0,prefer:u,wid:t,pud:n})),s()):h(!1)},children:m})})]})]})]})}function dn(e){var t=e.actionDescription,n=e.onConfirm,r=e.onCancel,i={marginLeft:8};return(0,a.BX)("div",{className:"jsx-a6b618bf6ea164ac gitRevertConfirmModal",children:[(0,a.tZ)(ot(),{id:"a6b618bf6ea164ac",children:".gitRevertConfirmModal.jsx-a6b618bf6ea164ac{max-width:600px;padding:20px 24px;background:var(--background-default);color:var(--foreground-default)}h2.jsx-a6b618bf6ea164ac{margin-bottom:16px}p.jsx-a6b618bf6ea164ac{margin-bottom:24px;line-height:1.4em}.buttonGroup.jsx-a6b618bf6ea164ac{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:end;-webkit-justify-content:flex-end;-moz-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center}"}),(0,a.tZ)("h2",{className:"jsx-a6b618bf6ea164ac",children:"Overwrite existing changes?"}),(0,a.BX)("p",{className:"jsx-a6b618bf6ea164ac",children:["You have some changes that are not committed yet. ",t," ","will overwrite any un-committed changes. Overwrite and continue?"]}),(0,a.BX)("div",{className:"jsx-a6b618bf6ea164ac buttonGroup",children:[(0,a.tZ)(ct.Z,{style:i,onClick:r,autoFocus:!0,children:"Cancel"}),(0,a.tZ)(ct.Z,{color:"negative",style:i,onClick:n,children:"Overwrite and continue"})]})]})}var fn=function(e){var t=e.wid,n=e.pud,r=e.isLoading,c=e.currentUser,s=e.refetchUser,l=e.setGitHubCreationModalOpen,u=e.setExistingRepoConnectionModalOpen,d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.history,i=void 0!==r&&r,a=e.write,o=void 0!==a&&a,c=e.persist,s=void 0!==c&&c;p(Ve({history:i,write:o,persist:s,wid:t,pud:n}))},f=function(e,r){return p(He({cmd:e,args:r,wid:t,pud:n}))},p=(0,we.I)(),h=(0,st.Z)(),m=(0,i.Z)(Se(t,n),1)[0].gitState,v=m.hasConflictsWithFetchedRemote&&(0,a.tZ)(un,{wid:t,pud:n,gitState:m}),g=(0,i.Z)(o.useState(null),2),b=g[0],x=g[1],Z=null!==b&&(0,a.tZ)(vt.Z,{isOpen:!0,onRequestClose:function(){return x(null)},children:(0,a.tZ)(dn,{actionDescription:"Reverting to this previous version",onConfirm:(0,le.Z)(de().mark((function e(){return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:x(null),f(Ce.y6),f(Ce.CU,[b.hash]),d({persist:!0});case 4:case"end":return e.stop()}}),e)}))),onCancel:function(){return x(null)}})}),y=(0,i.Z)(o.useState(null),2),w=y[0],k=y[1],E=null!==w&&(0,a.tZ)(vt.Z,{isOpen:!0,onRequestClose:function(){return k(null)},children:(0,a.tZ)(dn,{actionDescription:"Checking out branch ".concat(w),onConfirm:(0,le.Z)(de().mark((function e(){return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k(null),f(Ce.y6),e.next=4,f(Ce.JE,[w]);case 4:d({persist:!0});case 5:case"end":return e.stop()}}),e)}))),onCancel:function(){return k(null)}})});function S(){return(S=(0,le.Z)(de().mark((function e(t){return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,N.j)(N.U3.VERSION_CONTROL_FEATURE_USED,{action:"reverted"}),!(m.changedFiles.length>0)){e.next=4;break}return x(t),e.abrupt("return");case 4:f(Ce.CU,[t.hash]),d({persist:!0});case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(){return(C=(0,le.Z)(de().mark((function e(t){return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==m.branch){e.next=2;break}return e.abrupt("return");case 2:if((0,N.j)(N.U3.VERSION_CONTROL_FEATURE_USED,{action:"checkedOut"}),!(m.changedFiles.length>0&&m.branches.includes(t))){e.next=6;break}return k(t),e.abrupt("return");case 6:return e.next=8,f(Ce.JE,[t]);case 8:d({persist:!0});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,a.BX)(Et.ZP,{css:St.l0.colWithGap(32),children:[(0,a.BX)(Et.ZP,{css:St.l0.colWithGap(8),children:[(0,a.tZ)(jt,{gitState:m,isLoading:r,pull:function(){(0,N.j)(N.U3.VERSION_CONTROL_FEATURE_USED,{action:"pulled"}),d({history:!0})},setGitHubCreationModalOpen:function(){m.remoteToken&&m.installations.length>0?l(!0):p({type:"UPDATE_GIT_STATE",wid:t,pud:n,updates:{authError:Te.l4.GITHUB_GET_INFO}})},wid:t,pud:n,setExistingRepoConnectionIsOpen:u}),(0,a.tZ)(Zt,{isLoading:r,gitState:m,checkoutBranch:function(e){return C.apply(this,arguments)}})]}),(0,a.tZ)(Jt,{branch:m.branch,changedFiles:m.changedFiles,commits:m.commits,isLoading:r,commitsAhead:m.commitsAhead,commitsBehind:m.commitsBehind,activeFile:h||"",remote:m.remote,gitAddAll:function(){f(Ce.Hl)},gitCommit:function(){var e=(0,le.Z)(de().mark((function e(t){return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,N.j)(N.U3.VERSION_CONTROL_FEATURE_USED,{action:"committed"}),e.next=3,f(Ce.th,[t,c]);case 3:d({persist:!0});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),gitPush:function(){d({write:!0})},gitRestore:function(){var e=(0,le.Z)(de().mark((function e(t,n){return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f(Ce.sh,[t,n]);case 2:return e.next=4,f(Ce.i7);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),gitAdd:function(){var e=(0,le.Z)(de().mark((function e(t){return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f(Ce.N2,[t]);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),(0,a.tZ)(ln,{gitState:m,handleRevertToCommit:function(e){return S.apply(this,arguments)},fetchMoreCommits:function(){m.remote&&f(Ce.he,[!0]),f(Ce.cM,[!0])}}),Z,E,v,m.authError!==Te.l4.NONE&&(m.authError!==Te.l4.FETCH||m.remote)&&(0,a.tZ)(ft,{wid:t,pud:n,repoId:m.repoId,ownerId:m.ownerId,authError:m.authError,onAuth:s})]})},pn=function(e){var t=e.onInit,n=e.onConnect,r=e.isLoggedIn;return(0,a.BX)(c.G7,{css:[c.l0.colWithGap(32),c.l0.justify.spaceBetween,c.l0.align.center,c.l0.justify.center,c.l0.maxWidth(200),c.l0.pt(16),{margin:"0 auto"}],children:[(0,a.BX)(c.G7,{css:[c.l0.colWithGap(16)],children:[(0,a.tZ)(c.G7,{css:[c.l0.flex.column,c.l0.align.center],children:(0,a.BX)(c.xv,{multiline:!0,children:["Track and rollback changes to your Repl."," ",(0,a.tZ)("a",{href:"https://docs.replit.com/programming-ide/git-with-replit",target:"_blank",rel:"noopener noreferrer",onClick:function(e){e.preventDefault(),window.open(e.target.href,"_blank")},children:"Learn more here."})]})}),(0,a.tZ)(c.G7,{children:r?(0,a.BX)(c.G7,{css:[c.l0.colWithGap(8),{width:"100%"}],children:[(0,a.tZ)(c.zx,{colorway:"primary",onClick:t,text:"Create a Git repo",iconLeft:(0,a.tZ)(xt.Z,{})}),(0,a.tZ)(c.zx,{onClick:n,text:"Existing Git repo?",outlined:!0})]}):(0,a.BX)(c.G7,{children:[(0,a.tZ)("a",{href:"/signup",children:"Create an account"})," to use version control with Replit!"]})})]}),(0,a.tZ)(c.G7,{css:[c.l0.maxWidth(200)],children:(0,a.tZ)("img",{src:"/public/images/gitart.png",alt:"Robot lifting C+ box with git octocat using winch"})})]})},hn=n(25675),mn=n.n(hn),vn=n(61029),gn=function(e){var t=e.wid,n=e.pud,r=e.badState,i=e.remote,o=(0,Tt.Z)().container,s=(0,k.I0)(),l=function(){switch(r){case Te.$U.NoMergeBase:return(0,a.BX)(wt.x,{multiline:!0,children:["We couldn\u2019t find commits in common with that GitHub repository. Try"," ",(0,a.tZ)("a",{href:"/github/"+i,target:"_blank",rel:"noreferrer noopener",children:"importing the repo"})," ","into a new Repl instead, or connecting the remote via the Git sidebar again."]});case Te.$U.AuthFetchError:return(0,a.BX)(wt.x,{multiline:!0,children:["We couldn\u2019t find that repository on GitHub. Try connecting your GitHub account in your"," ",(0,a.tZ)("a",{href:"/account",target:"_blank",rel:"noreferrer noopener",children:"Account Settings"}),"."]});case Te.$U.IndexFilesCorrupted:return(0,a.tZ)(wt.x,{multiline:!0,children:"Your Git index files were corrupted. Try resetting your index file to restore your repository."});default:return(0,a.tZ)(wt.x,{multiline:!0,children:"We ran into an error trying to sync your repository."})}},u=function(){s({type:"UPDATE_GIT_STATE",wid:t,pud:n,updates:{remote:"",commitsAhead:0,commitsBehind:0,repoId:null,ownerId:null,badState:Te.$U.None,authError:Te.l4.NONE}})};return(0,a.BX)(Et.ZP,{css:[St.l0.p(8),St.l0.colWithGap(8)],children:[(0,a.tZ)(wt.x,{variant:"subheadDefault",multiline:!0,children:"There\u2019s something wrong with this repository..."}),(0,a.tZ)(l,{}),r!==Te.$U.IndexFilesCorrupted?(0,a.BX)(a.HY,{children:[(0,a.tZ)(wt.x,{multiline:!0,children:"You can also try disconnecting this repository from GitHub and trying again."}),(0,a.tZ)(c.zx,{colorway:"negative",text:"Disconnect repo",iconLeft:(0,a.tZ)(vn.Z,{}),css:[St.l0.mt(12),St.l0.mb(16)],onClick:function(){var e;(e=o).exec.apply(e,(0,b.Z)(Ce.rO.format(Te.Xe))),u()}})]}):(0,a.tZ)(c.zx,{colorway:"negative",text:"Reset index",iconLeft:(0,a.tZ)(Mt.Z,{}),css:[St.l0.mt(12),St.l0.mb(16)],onClick:function(){o.exec("bash","-c","rm .git/index; git reset HEAD ."),u()}}),(0,a.tZ)(mn(),{src:"/images/gitart.png",alt:"GitHub integration decoration art.",layout:"responsive",width:1694,height:3543,css:[St.l0.maxWidth(200)]})]})},bn=n(82670),xn=n(63377),Zn=n(33319),yn=n(82893),wn=n(37424),kn=(0,c.KD)("a"),En=function(e){var t=e.authToken,n=e.onClose,r=e.onConnect,s=e.pud,l=e.successHandler,u=e.wid,d=(0,wn.H)(),p=function(e){var t=(0,f.Z)({},be,e);return he.useQuery(Ze,t)}({variables:{replId:(0,xn.Z)()}}),m=p.data;if(p.loading)return null;if("Repl"!==(null===m||void 0===m?void 0:m.repl.__typename))return(0,a.tZ)(c.u_,{onRequestClose:n,isOpen:!0,children:(0,a.BX)(c.G7,{css:[c.l0.colWithGap(24)],children:[(0,a.tZ)(c.h4,{variant:"headerDefault",level:1,children:"Something went wrong."}),(0,a.tZ)(c.xv,{children:"Please try again later."})]})});var v=m.repl,g=(0,i.Z)(o.useState(!1),2),b=g[0],x=g[1],Z=(0,i.Z)(o.useState(v.isPrivate),2),y=Z[0],w=Z[1],E=(0,i.Z)(o.useState(null),2),S=E[0],C=E[1],T=(0,we.I)(),R=(0,k.v9)((function(e){return Ee(e,u,s)})).gitState,_=(0,pt.Y)(v.isRenamed?v.title:"",(function(e){return e&&e.length>100?{message:"* GitHub repository names cannot exceed 100 characters"}:e?void 0:{message:"* Repository name is required"}})),I=(0,pt.Y)((v.description||"").replace(/(\r\n|\n|\r)/gm," "),(function(e){if(e&&e.length>140)return{message:"* GitHub descriptions cannot exceed 140 characters"}})),P=function(){var e=(0,le.Z)(de().mark((function e(n){var r,i,a,o;return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(C(null),n.preventDefault(),x(!0),r=_.validate(),i=I.validate(),!r&&!i){e.next=8;break}return x(!1),e.abrupt("return");case 8:return a={name:_.value,description:I.value,private:y},R.commits.length||T(Qe(u,s)),e.prev=10,e.next=13,Be({token:t,repoData:a,owner:j.value,ownerType:j.type});case 13:o=e.sent,l(o.html_url),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(10),(0,bn.Z)(e.t0,Ae)?T({type:"UPDATE_GIT_STATE",wid:u,pud:s,updates:{authError:Te.l4.GITHUB_CREATE}}):(0,bn.Z)(e.t0,Ne)?C("Another GitHub repository with the same name already exists"):(h.$e((function(t){t.setTag("source","git"),h.Tb(e.t0)})),C("Unable to create a GitHub repository"));case 20:x(!1);case 21:case"end":return e.stop()}}),e,null,[[10,17]])})));return function(t){return e.apply(this,arguments)}}(),D=!(!_.error&&!I.error),A=R.installations,N=A.find((function(e){return"User"===e.type}))||A[0],U=(0,i.Z)(o.useState({value:N.name,label:N.name,avatar:N.avatarUrl,type:N.type}),2),j=U[0],B=U[1],O=A.map((function(e){return{value:e.name,title:e.name,icon:(0,a.tZ)(c.G7,{css:[c.l0.mr(8)],children:(0,a.tZ)(mn(),{src:e.avatarUrl,alt:"".concat(e.name,"'s profile photo"),layout:"fixed",width:16,height:16,css:[c.l0.borderRadius(8)]})})}}));return(0,a.tZ)(c.u_,{onRequestClose:n,isOpen:!0,children:(0,a.tZ)("form",{onSubmit:P,style:{opacity:b?.6:1},autoComplete:"off",children:(0,a.BX)(c.G7,{css:[c.l0.colWithGap(24)],children:[(0,a.tZ)(c.h4,{variant:"headerDefault",level:1,children:"Create a new GitHub repository"}),(0,a.tZ)(c.xv,{children:(0,a.tZ)(kn,{onClick:function(){n(),r()},children:"Connect an existing repository instead."})}),(0,a.tZ)(c.xv,{multiline:!0,css:{marginTop:-12},children:"You can always edit this information on GitHub."}),(0,a.BX)(c.G7,{css:[c.l0.rowWithGap(8),c.l0.align.center],children:[(0,a.BX)(c.G7,{css:[c.l0.colWithGap(4)],children:[(0,a.tZ)("label",{htmlFor:d("owner"),children:(0,a.tZ)(c.xv,{color:"dimmer",variant:"small",children:"Owner"})}),(0,a.tZ)(c.Ph,{items:O,initialSelectedItem:O.length?O[0]:void 0,placeholder:"Select a user",disabled:A.length<=1||b,onChange:function(e){B(e)},css:[c.l0.height(48),c.l0.flex.grow(1),{flexBasis:"50%"},c.l0.minWidth(225)],id:d("owner")})]}),(0,a.tZ)("span",{className:"slash",css:[c.l0.fontSize(20),c.l0.mt(16)],children:"/"}),(0,a.BX)(c.G7,{css:[c.l0.colWithGap(4),{flexShrink:1}],children:[(0,a.tZ)("label",{htmlFor:d("name"),children:(0,a.tZ)(c.xv,{color:"dimmer",variant:"small",children:"Title"})}),(0,a.tZ)(c.G7,{css:[c.l0.height(35)],children:(0,a.tZ)(c.II,{name:"title",placeholder:"Name your repo",disabled:b,value:_.value,onChange:function(e){_.setValue(e.currentTarget.value),C(null)},onFocus:function(e){return e.target.select()},onBlur:_.handleBlur,css:[{flexBasis:"50%"},c.l0.minWidth(225)],id:d("name")})}),_.error?(0,a.tZ)(c.xv,{variant:"small",css:[c.l0.color.accentNegativeStronger],multiline:!0,children:_.error.message}):null]})]}),(0,a.BX)(c.G7,{css:[c.l0.colWithGap(8)],children:[(0,a.BX)(c.G7,{css:[c.l0.colWithGap(4)],children:[(0,a.tZ)("label",{htmlFor:d("description"),children:(0,a.tZ)(c.xv,{color:"dimmer",variant:"small",children:"Repo description (optional)"})}),(0,a.tZ)(c.B,{name:"description",value:I.value,disabled:b,placeholder:I.value||"What does this repo do?",onChange:function(e){I.setValue(e.target.value),C(null)},onBlur:I.handleBlur,css:[c.l0.minHeight(64),c.l0.maxHeight(96),{resize:"vertical"}],id:d("description")})]}),I.error?(0,a.tZ)(c.xv,{variant:"small",css:[c.l0.color.accentNegativeStronger],children:I.error.message}):null]}),(0,a.BX)(c.G7,{css:[c.l0.colWithGap(8)],children:[(0,a.BX)(c.G7,{css:[c.l0.colWithGap(4)],children:[(0,a.tZ)("label",{htmlFor:d("github-privacy"),children:(0,a.tZ)(c.xv,{color:"dimmer",variant:"small",children:"GitHub privacy"})}),(0,a.BX)(c.hE,{name:d("github-privacy"),value:(!y).toString(),onChange:function(e){return w(e)},row:!0,stretch:!0,primary:!0,disabled:b,children:[(0,a.tZ)(c.rK,{id:d("github-repo-creation-modal-true"),value:!0,text:"Public",icon:(0,a.tZ)(Zn.Z,{})}),(0,a.tZ)(c.rK,{id:d("github-repo-creation-modal-false"),value:!1,text:"Private",icon:(0,a.tZ)(yn.Z,{})})]})]}),(0,a.tZ)(c.xv,{css:[c.l0.color.foregroundDimmer],children:(y?"You choose who can see this repo":"Anyone can see this repo")+", and you choose who can commit."})]}),(0,a.BX)(c.G7,{css:[c.l0.rowWithGap(12),c.l0.justify.end],children:[(0,a.tZ)(c.zx,{disabled:b,"data-testid":"git-confirm-github-repo",text:"Cancel",onClick:n}),(0,a.tZ)(c.zx,{colorway:"primary",disabled:b||D,type:"submit","data-testid":"git-confirm-github-repo",text:b?"Creating repository...":"Create repository",iconLeft:(0,a.tZ)(xt.Z,{})})]}),S&&(0,a.BX)(c.xv,{multiline:!0,css:[c.l0.color.accentNegativeStronger],children:[S,(0,a.tZ)("br",{}),"Let us know if there is an issue by opening up the sidebar and submitting a ticket via the get help button."]})]})})})},Sn=n(68757),Cn=n(83971),Tn=n(62187),Rn=n(88961),_n=(0,Et.KD)("a"),In=function(e){var t=(0,Tt.Z)().container,n=(0,Cn.Z)(t),r=(0,we.I)(),s=(0,i.Z)(o.useState(null),2),l=s[0],u=s[1],d=(0,i.Z)(o.useState(!1),2),p=d[0],h=d[1],m=function(){var t=(0,le.Z)(de().mark((function t(){var n;return de().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(l){t.next=2;break}return t.abrupt("return");case 2:h(!0),e.gitState.commits.length||r(Qe(e.wid,e.pud)),n="https://github.com/".concat(l.nameWithOwner),r(He({cmd:Ce.M7,args:[n],wid:e.wid,pud:e.pud})),r(Ve({wid:e.wid,pud:e.pud})),e.hideModal();case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),g=function(){var t=(0,le.Z)(de().mark((function t(){var i,a,o,c,s;return de().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(l){t.next=2;break}return t.abrupt("return");case 2:return h(!0),i="https://github.com/".concat(l.nameWithOwner),t.next=6,Xe();case 6:if(a=t.sent,e.gitState.isInitialized){t.next=10;break}return t.next=10,n({args:Ce.D6.format(e.gitState,a)});case 10:if(e.gitState.commits.length){t.next=19;break}return t.next=13,n({args:Ce.M7.format(e.gitState,i)});case 13:return t.next=15,n({args:Ce.GE.format(e.gitState)});case 15:return t.next=17,n({args:Ce.th.format(e.gitState,"Initial commit",a,!0)});case 17:return t.next=19,n({args:Ce.Hl.format(e.gitState)});case 19:return t.next=21,n({args:Ce.hU.format(e.gitState)});case 21:return t.next=23,n({args:Ce.M7.format(e.gitState,i)});case 23:return t.next=25,n({args:Ce.he.format((0,v.Z)((0,f.Z)({},e.gitState),{remote:i}),!1)});case 25:return t.next=27,n({args:Ce.Di.format((0,v.Z)((0,f.Z)({},e.gitState),{remote:i}))});case 27:if(o=t.sent,Ce.Di.parse){t.next=30;break}return t.abrupt("return");case 30:return c=Ce.Di.parse(e.gitState,null===o.error?o.output:"HEAD branch: main"),s=c.defaultBranch,t.next=33,n({args:Ce.Z$.format(e.gitState,a,s)});case 33:return t.next=35,n({args:Ce.eg.format(e.gitState)});case 35:r(Ve({wid:e.wid,pud:e.pud})),e.hideModal();case 37:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return(0,a.BX)(Et.ZP,{css:[St.l0.colWithGap(16)],children:[(0,a.tZ)(wt.h,{variant:"headerDefault",level:2,children:"Connect an existing repository"}),(0,a.tZ)(wt.x,{children:(0,a.tZ)(_n,{onClick:function(){e.setGitHubCreationModalOpen(!0),e.hideModal()},children:"Create a new GitHub repository instead."})}),(0,a.tZ)("label",{htmlFor:"git-sidebar-existing-repo-connection",css:{marginBottom:8},children:"Choose a repository to import."}),(0,a.tZ)(Sn.Z,{id:"git-sidebar-existing-repo-connection",onRepoSelect:u,onInputValueChange:function(){},isPrivate:!1}),e.gitState.remoteToken?null:(0,a.BX)(wt.x,{multiline:!0,css:[St.l0.color.accentNegativeStronger,{marginTop:-12}],children:[(0,a.tZ)(Rn.Z,{})," Please connect your GitHub account to connect existing repositories."]}),(0,a.BX)(wt.x,{multiline:!0,css:{marginTop:-8},children:["This will set ",l?l.nameWithOwner:"this repository"," as the remote",e.fromEmptyState?" and pull in changes.":". Optionally, you can also pull in any changes from the repository, which will reflect this Repl's changes in the case of conflicts."]}),(0,a.BX)(wt.x,{multiline:!0,children:["This can be undone by removing the repository in the Git sidebar or running ",(0,a.tZ)(Rt.Z,{children:"git remote remove origin"})," in the Shell."]}),(0,a.BX)(Et.ZP,{css:[St.l0.rowWithGap(12),St.l0.justify.end,{flexWrap:"wrap",marginTop:"-8px"}],children:[(0,a.tZ)(c.zx,{text:"Cancel",onClick:e.hideModal,css:[St.l0.mt(8)],disabled:p}),e.fromEmptyState?null:(0,a.tZ)(c.zx,{iconLeft:(0,a.tZ)(Dt.Z,{}),onClick:m,text:p?"Connecting...":"Connect"+(l?" "+l.nameWithOwner:""),colorway:"primary",outlined:!0,css:[St.l0.mt(8)],disabled:p||!l}),(0,a.tZ)(c.zx,{iconLeft:(0,a.tZ)(Tn.Z,{}),onClick:g,text:p?"Connecting...":"Pull changes"+(l?" from "+l.nameWithOwner:""),colorway:"primary",css:[St.l0.mt(8)],disabled:p||!l})]})]})},Pn=n(65456),Dn=(0,n(37053).Z)(function(){var e=(0,le.Z)(de().mark((function e(t){return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t();case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{wait:1e3});function An(e){var t=e.wid,n=e.pud,r=(0,we.I)(),s=(0,Tt.Z)(),l=s.container,u=s.fs,d=(0,i.Z)(Se(t,n),1)[0],p=d.gitState,h=d.isLoading,m=d.isCloneInProgress,v=function(e){var t=(0,f.Z)({},be,e);return he.useQuery(ye,t)}(),g=v.data,b=v.loading,x=v.refetch;o.useEffect((function(){var e,i,a,o,c;if("GitHubInfo"===(null===g||void 0===g||null===(e=g.currentUser)||void 0===e||null===(i=e.gitHubInfo)||void 0===i?void 0:i.__typename)){var s=g.currentUser.gitHubInfo;s.accessToken&&r({type:"UPDATE_GIT_STATE",updates:{remoteToken:s.accessToken,gitHubName:null===(a=s.userInfo)||void 0===a?void 0:a.name,gitHubEmail:null===(o=s.userInfo)||void 0===o?void 0:o.email,gitHubAvatarUrl:null===(c=s.userInfo)||void 0===c?void 0:c.avatarUrl,installations:s.installations},wid:t,pud:n})}}),[g]);var Z=(0,i.Z)(function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=(0,o.useState)(t),r=n[0],i=n[1],a=(0,o.useRef)();return(0,o.useEffect)((function(){return a.current&&clearTimeout(a.current),a.current=setTimeout((function(){i(e)}),250),function(){a.current&&clearTimeout(a.current)}}),[e]),[r||e,i]}(h||b,!0),2),y=Z[0],w=Z[1];(0,o.useEffect)((function(){return m||b||(w(!0),r(Ve({history:!1,write:!1,persist:!1,wid:t,pud:n}))),r({type:"SET_GIT_SIDEBAR_VISIBILITY",isSidebarVisible:!0,wid:t}),function(){r({type:"SET_GIT_SIDEBAR_VISIBILITY",isSidebarVisible:!1,wid:t})}}),[b,l]),u.onStatusChange((function(e){e===Pn.kO.Clean&&Dn((function(){r(Ve({history:!1,write:!1,persist:!1,wid:t,pud:n}))}))}));var k=(0,i.Z)(o.useState(!1),2),E=k[0],S=k[1],C=(0,i.Z)(o.useState(!1),2),T=C[0],R=C[1],_=null;return b||y&&!p.isInitialized?_=(0,a.tZ)(c.G7,{css:[c.l0.center,c.l0.flex.growAndShrink(1)],children:(0,a.tZ)(Wt.Z,{size:24})}):p.remote||p.isInitialized?p.badState!==Te.$U.None?_=(0,a.tZ)(gn,{wid:t,pud:n,badState:p.badState,remote:p.remote}):(null===g||void 0===g?void 0:g.currentUser)&&(_=(0,a.tZ)(fn,{wid:t,pud:n,isLoading:y,currentUser:g.currentUser,refetchUser:x,setExistingRepoConnectionModalOpen:R,setGitHubCreationModalOpen:S})):_=(0,a.tZ)(pn,{isLoggedIn:Boolean(null===g||void 0===g?void 0:g.currentUser),onInit:function(){r(function(e,t){return function(){var n=(0,le.Z)(de().mark((function n(r){var i,a;return de().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=function(n,i){return r(He({cmd:n,args:i,wid:e,pud:t}))},(0,N.j)(N.U3.VERSION_CONTROL_FEATURE_USED,{action:"initialized"}),n.next=5,Xe();case 5:return a=n.sent,n.next=8,i(Ce.D6,[a]);case 8:return n.next=10,r(qe(e,t));case 10:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}(t,n))},onConnect:function(){return R(!0)}}),(0,a.BX)(c.G7,{css:c.l0.height("100%"),children:[(0,a.tZ)(c.G7,{css:[c.l0.p(8)],children:(0,a.tZ)(ke.Z,{truncate:!0,level:4,children:"Version control"})}),(0,a.tZ)(c.G7,{css:[c.l0.flex.growAndShrink(1),c.l0.px(8),c.l0.overflowY("auto"),y&&p.badState===Te.$U.None&&{pointerEvents:"none",opacity:.5}],children:_}),(0,a.tZ)(Nn,{}),(0,a.tZ)(kt.Z,{isOpen:T,onRequestClose:function(){return R(!1)},maxWidth:600,children:(0,a.tZ)(In,{gitState:p,hideModal:function(){return R(!1)},setGitHubCreationModalOpen:S,fromEmptyState:!p.remote&&!p.isInitialized,wid:t,pud:n})}),E?(0,a.tZ)(En,{authToken:p.remoteToken,onClose:function(){return S(!1)},onConnect:function(){return R(!0)},successHandler:function(e){r(function(e){var t=e.remote,n=e.wid,r=e.pud;return function(){var e=(0,le.Z)(de().mark((function e(i){var a;return de().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=function(e,t){return i(He({cmd:e,args:t,wid:n,pud:r}))},e.next=4,a(Ce.M7,[t]);case 4:return e.next=6,a(Ce.LO);case 6:return e.next=8,a(Ce.VF);case 8:return e.next=10,i({type:"GITHUB_REPOSITORY_CREATED",wid:n,pud:r});case 10:return e.next=12,i(Ve({wid:n,pud:r,persist:!0}));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}({wid:t,pud:n,remote:e})),S(!1)},wid:t,pud:n}):null]})}function Nn(){return(0,a.tZ)(c.G7,{css:c.l0.p(8),children:(0,a.tZ)("a",{className:"feedbackLink",href:"https://replit.com/talk/announcements/Feedback-for-git-support-the-new-GitHub-integration/21631",target:"_blank",rel:"noopener",children:"Send feedback"})})}var Un=n(91131),jn=n(16965),Bn=(0,Un.cn)(null);function On(){var e=(0,Tt.Z)(),t=e.container,n=e.fs,s=(0,i.Z)((0,Un.KO)(Bn),2),l=s[0],u=s[1],d=(0,jn.Z)(l),f=(0,k.oR)();return o.useEffect((function(){if(!d.current){var e=new oe;return e.yikesInjectStore(f),e.injectServices({container:t,fs:n}),e.register("git",r),e.bootstrap({plugins:{git:{type:"git"}},layout:{tiling:{type:"pane",pud:"git"},floating:[]}}),e.store.dispatch({type:"WORKSPACE_MOUNTED"}),u({Component:e.component()}),function(){u(null)}}}),[d,t,n,u,f]),(null===l||void 0===l?void 0:l.Component)?(0,a.tZ)(c.Tg,{background:"default",css:c.l0.flex.growAndShrink(1),id:"workspace-root",children:(0,a.tZ)(l.Component,{})}):null}},16799:function(e,t,n){n.d(t,{CU:function(){return L},D6:function(){return g},Di:function(){return B},GE:function(){return M},Hl:function(){return D},JE:function(){return j},LO:function(){return R},M7:function(){return _},N2:function(){return A},Pz:function(){return X},TE:function(){return k},Ud:function(){return C},VF:function(){return Z},Z$:function(){return V},bb:function(){return z},cF:function(){return S},cM:function(){return P},eg:function(){return H},hU:function(){return W},he:function(){return y},i7:function(){return x},jW:function(){return T},k6:function(){return b},kT:function(){return E},lR:function(){return G},rO:function(){return I},sh:function(){return N},th:function(){return U},xY:function(){return O},y6:function(){return F},zq:function(){return w}});var r=n(26042),i=n(69396),a=n(10253),o=n(59637),c=n(67128),s=n(92157),l='[ "git remote get-url origin" ]',u="git symbolic-ref HEAD --short",d="git log -0 2>/dev/null && ".concat(u," || echo 'HEAD'");function f(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return["bash","-c",t.join("&&")]}function p(e){return"if ! (( $(busybox ps -o comm | grep git) )) ; then rm -rf .git/index.lock; fi ; ".concat(e)}function h(e){var t=e.remote,n=void 0===t?"":t,r=e.remoteToken;if(!r)return n;var i=(0,a.Z)(n.match(/(https:\/\/)(.*)/)||["","",""],3),o=i[1],c=i[2];return"".concat(o).concat(r||"",":x-oauth-basic@").concat(c)}function m(e){return null!==new RegExp(/(^|\n)fatal: Authentication failed/g).exec(e)||null!==new RegExp(/(^|\n)fatal: unable to access/g).exec(e)||null!==new RegExp(/(^|\n)fatal: repository.*not found/g).exec(e)||null!==new RegExp(/(^|\n)fatal: could not read Username/g).exec(e)||null!==new RegExp(/(^|\n)fatal: Could not read from remote repository/g).exec(e)}function v(e){var t=e.split(/ /g);if("1"===t[0]){var n=t[1],r=t.slice(8).join(" "),i=function(e){var t=e.startsWith(".")?e[1]:e[0],n=!e.startsWith(".");switch(t){case"M":case"T":return{changeMode:c.pD.MODIFIED,isStaged:n};case"D":return{changeMode:c.pD.DELETED,isStaged:n};case"A":return{changeMode:c.pD.UNTRACKED,isStaged:n};default:throw new Error("Unknown change type: ".concat(e))}}(n);return{change:i.changeMode,targetPath:r,origPath:r,isStaged:i.isStaged}}if("2"===t[0]){var o=t.slice(9).join(" "),s=(0,a.Z)(o.split("\t"),2),l=s[0],u=s[1];return{change:c.pD.MOVED,targetPath:l,origPath:u,isStaged:!0}}if("?"===t[0]){var d=t.slice(1).join(" ");return{change:c.pD.UNTRACKED,targetPath:d,origPath:null,isStaged:!1}}if("u"===t[0]){var f=t[2];return{change:c.pD.MODIFIED,targetPath:f,origPath:f,isStaged:!1}}throw new Error("Unrecognized git status entry: ".concat(e))}var g={format:function(e,t){return f('[ ! -d ".git" ]',"git init","git checkout -b main",'git config user.name "'.concat(t.username||"Replit user",'"'),'git config user.email "<>"',"touch .git/branches/.keep","touch .git/info/.keep","touch .git/objects/.keep","touch .git/refs/.keep")}},b={format:function(e,t){return["git","rev-list","--left-right","--count","".concat(t,"...origin/").concat(t)]},parse:function(e,t){if(t.startsWith("fatal"))return(0,i.Z)((0,r.Z)({},e),{commitsAhead:null,commitsBehind:null});var n=(0,a.Z)(t.split(/\s+/),2),o=n[0],c=n[1];return(0,i.Z)((0,r.Z)({},e),{commitsAhead:parseInt(o)||0,commitsBehind:parseInt(c)||0})}},x={format:function(e){return["git","status","--branch","--porcelain=v2"]},parse:function(e,t){if(t.startsWith("fatal"))return e;if(t.includes("index file corrupt")||t.includes("error: index file"))return(0,i.Z)((0,r.Z)({},e),{badState:c.$U.IndexFilesCorrupted});if(""===t.trim())return(0,i.Z)((0,r.Z)({},e),{changedFiles:[]});var n=t.split("\n").filter((function(e){return""!==e.trim()})),o=e.branch,s=e.defaultBranch,l=!0,u=[],d=!0,f=!1,p=void 0;try{for(var h,m=n[Symbol.iterator]();!(d=(h=m.next()).done);d=!0){var g=h.value;if(g.startsWith("#")){var b=(0,a.Z)(g.split(/\s+/),3),x=(b[0],b[1]),Z=b[2];switch(x){case"branch.head":o=Z;break;case"branch.oid":l=!Z.includes("(initial)")}}else u.push(v(g))}}catch(y){f=!0,p=y}finally{try{d||null==m.return||m.return()}finally{if(f)throw p}}return l||(s=o,o=""),(0,i.Z)((0,r.Z)({},e),{branch:o,defaultBranch:s,changedFiles:u})}},Z={format:function(e){var t=h(e);return f("git push ".concat(t," $(").concat(u,")"))},parse:function(e,t){return m(t)?(0,i.Z)((0,r.Z)({},e),{authError:c.l4.PUSH}):e}},y={format:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=h(e);return f("git fetch ".concat(n,t?" --progress --deepen=10":" +refs/heads/*:refs/remotes/origin/* --progress --depth=10"))},parse:function(e,t){return m(t)?(0,i.Z)((0,r.Z)({},e),{authError:c.l4.FETCH}):e}},w={format:function(e){return 0===e.commits.length?["echo true"]:f(l,"git merge-base origin/$(".concat(u,") $(").concat(u,")"))},parse:function(e,t){return(0,i.Z)((0,r.Z)({},e),{hasMergeBaseWithFetchedRemote:Boolean(t.length)})}},k={format:function(){return f("git fetch origin --progress")},parse:function(e,t){return m(t)?(0,i.Z)((0,r.Z)({},e),{authError:c.l4.FETCH}):e}},E={format:function(e){if(0===e.commits.length)return["true"];var t=["git merge-tree $(git merge-base origin/$(".concat(u,") $(").concat(u,")) origin/$(").concat(u,") $(").concat(u,")"),"grep '^changed in both'","wc -l"].join(" | ");return f(l,t)},parse:function(e,t){return(0,i.Z)((0,r.Z)({},e),{hasConflictsWithFetchedRemote:0!==e.commits.length&&!isNaN(+t.trim())&&"0"!==t.trim()})}},S={format:function(e){return f("git reset --hard origin/$(".concat(u,")"))}},C={format:function(e){var t=h(e);return["git push ".concat(t," $(").concat(u,") --force")]}},T={format:function(){return f(l,"git merge origin/$(".concat(u,")"))},parse:function(e,t){return null!==new RegExp(/(^|\n)error: Your local changes to the following files would be overwritten by merge/g).exec(t)?(0,i.Z)((0,r.Z)({},e),{hasConflictsWithFetchedRemote:!0}):e}},R={format:function(e){return["git","remote","get-url","origin"]},parse:function(e,t){return t.includes("No such remote")||t.startsWith("fatal")?(0,i.Z)((0,r.Z)({},e),{remote:""}):(0,i.Z)((0,r.Z)({},e),{remote:t.trim()})}},_={format:function(e,t){return e.remote?f("git remote remove origin; git remote add origin ".concat(t)):f("git remote add origin ".concat(t))}},I={format:function(e){return f("git rev-parse 2>/dev/null && for i in $(git remote); do git remote remove $i; done")}},P={format:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,r="HEAD";t&&e.commits.length>0&&(r=e.commits[e.commits.length-1].hash);var i=["%D","%H","%an","%ae","%aI","%cn","%ce","%cI","%P","%B"];return["git","log","--pretty=".concat(i.join("%x00"),"%x00%x00"),"-".concat(n+1),r,"--"]},parse:function(e,t){if(t.startsWith("fatal"))return(0,i.Z)((0,r.Z)({},e),{commits:[]});if(t.startsWith("error: index file"))return(0,i.Z)((0,r.Z)({},e),{badState:c.$U.IndexFilesCorrupted});var n=t.split("\0\0\n").filter((function(e){return""!==e})).map((function(e){return e.split("\0")})),a=!!n[0][0];n.map((function(e){return e.shift()}));var s=!1;0===e.commits.length||a||e.commits[e.commits.length-1].hash!==n[0][0]||(s=!0,n.shift());var l=s?e.commits:[];return l=l.concat(n.map((function(e){var t=(0,o.Z)(e),n=t[0],r=t[1],i=t[2],a=t[3],c=t[4],s=t[5],l=t[6];return{hash:n,parentHash:t[7],message:t.slice(8).join("\n"),authorName:r,authorEmail:i,authorDate:new Date(a.trim()),committerName:c,committerEmail:s,committerDate:new Date(l.trim())}}))),(0,i.Z)((0,r.Z)({},e),{commits:l})}},D={format:function(){return f(p("git add -A"))},parse:function(e,t){if(t.startsWith("fatal"))return(0,i.Z)((0,r.Z)({},e),{hasConflictsWithFetchedRemote:!0});var n=e.changedFiles.map((function(e){return(0,i.Z)((0,r.Z)({},e),{isStaged:!0})}));return(0,i.Z)((0,r.Z)({},e),{changedFiles:n})}},A={format:function(e,t){return f("git add ".concat(t," && echo done: ").concat(t))},parse:function(e,t){if(!t.startsWith("fatal")){var n=t.split(" ")[1].trim(),a=e.changedFiles.map((function(e){return e.targetPath===n?(0,i.Z)((0,r.Z)({},e),{isStaged:!0}):e}));return(0,i.Z)((0,r.Z)({},e),{changedFiles:a})}return e}},N={format:function(e,t,n){return f("git restore ".concat(n?"--staged":""," ").concat(t," && echo done: ").concat(t))},parse:function(e,t){if(!t.startsWith("fatal")){var n=t.split(" ")[1].trim();return(0,i.Z)((0,r.Z)({},e),{changedFiles:e.changedFiles.map((function(e){return e.targetPath===n?(0,i.Z)((0,r.Z)({},e),{isStaged:!1}):e}))})}return e}},U={format:function(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];r=e.gitHubName?e.gitHubName:n.fullName||n.username;var a=e.gitHubEmail||"<>",o='-c user.name="'.concat(r,'" -c user.email="').concat(a,'"'),c=t.replace(/'/g,"'\"'\"'");return f(p("git ".concat(o," commit -m '").concat(c,"'").concat(i?" --allow-empty":"")))}},j={format:function(e,t){return e.branches.includes(t)?["git","checkout",t,"--"]:["git","checkout","-b",t,"--"]}},B={format:function(e){var t=h(e);return f("git remote show ".concat(t," | grep 'HEAD branch'"))},parse:function(e,t){var n=(0,a.Z)(t.split(":"),2),o=(n[0],n[1].trim());return(0,i.Z)((0,r.Z)({},e),{defaultBranch:o})}},O={format:function(e){return f("git checkout ".concat(e.defaultBranch))}},G={format:function(e){return f("git checkout -f ".concat(e.defaultBranch))}},L={format:function(e,t){return f("git revert ".concat(t,"..$(").concat(d,") --no-commit"))}},M={format:function(e){return f(p("git reset $(".concat(d,") --")))}},z={format:function(e){return f("git rev-parse --is-inside-work-tree")},parse:function(e,t){return(0,i.Z)((0,r.Z)({},e),{isInitialized:t.startsWith("true")})}},F={format:function(e){return f("git add -A","git reset --hard $(".concat(d,") --"))}},X={format:function(e){return["git","branch","-a","--no-color"]},parse:function(e,t){if(t.startsWith("fatal"))return e;var n=t.split("\n").filter((function(e){return!!e.trim()})).map((function(e){return e.startsWith("* ")?e.replace(/^\*\s+/,""):e})).map((function(e){return e.trim()})).map(s.iF);return(0,i.Z)((0,r.Z)({},e),{branches:Array.from(new Set(n))})}},W={format:function(e){return f("git stash -u")}},H={format:function(e){return f("git checkout stash -- .")}},V={format:function(e,t,n){var r;r=e.gitHubName?e.gitHubName:t.fullName||t.username;var i=e.gitHubEmail||"<>",a='-c user.name="'.concat(r,'" -c user.email="').concat(i,'"');return f("git ".concat(a," merge -Xtheirs --allow-unrelated-histories --no-edit origin/").concat(n))}}},67128:function(e,t,n){var r,i,a;n.d(t,{$U:function(){return i},Xe:function(){return o},l4:function(){return r},pD:function(){return a}}),function(e){e[e.NONE=0]="NONE",e[e.PUSH=1]="PUSH",e[e.CLONE=2]="CLONE",e[e.FETCH=3]="FETCH",e[e.GITHUB_CREATE=4]="GITHUB_CREATE",e[e.GITHUB_GET_INFO=5]="GITHUB_GET_INFO"}(r||(r={})),function(e){e.None="NONE",e.NoMergeBase="NO_MERGE_BASE",e.AuthFetchError="AUTH_FETCH_ERROR",e.IndexFilesCorrupted="INDEX_FILES_CORRUPTED"}(i||(i={})),function(e){e[e.UNTRACKED=0]="UNTRACKED",e[e.MODIFIED=1]="MODIFIED",e[e.MOVED=2]="MOVED",e[e.DELETED=3]="DELETED"}(a||(a={}));var o={isInitialized:!1,hasConflictsWithFetchedRemote:!1,hasMergeBaseWithFetchedRemote:!0,authError:r.NONE,badState:i.None,remote:"",repoId:null,branch:"",defaultBranch:"main",branches:[],installations:[],changedFiles:[],commits:[],commitsAhead:null,commitsBehind:null,remoteToken:null,gitHubName:null,ownerId:null,gitHubAvatarUrl:null,gitHubEmail:null}},92157:function(e,t,n){n.d(t,{JE:function(){return a},cW:function(){return o},iF:function(){return c},mJ:function(){return i}});var r=n(10253);function i(e){if(!e)return"";var t=(0,r.Z)(a(e),2),n=t[0],i=t[1];return n&&i?"".concat(n,"/").concat(i):e}function a(e){if(!e)return["",""];var t=e.match(/^https:\/\/github\.com\/(.+)\/(.+)/);if(null!==t){var n=(0,r.Z)(t,3);return[n[1],n[2]]}return["",""]}function o(e,t){return"".concat(e,"/commit/").concat(t)}function c(e){return e.startsWith("remotes/origin/HEAD ->")?e.split("/").reverse()[0]:(e.startsWith("remotes/origin/")&&(e=e.replace("remotes/origin/","")),e.includes(" -> ")&&(e=e.split(" -> ")[0]),e.trim())}},93705:function(e,t,n){n.d(t,{BI:function(){return p},bA:function(){return v},oQ:function(){return g}});var r,i,a,o=n(26042),c=n(35944),s=n(82378),l=n(65975),u=n(2581),d=n(91131),f=(0,d.cn)(!1),p=(0,s.u)((function(){return null})),h=(0,d.cn)(null),m=(0,d.cn)((function(e){return e(h)}),(function(e,t,n){if(null===n)t(h,null);else{var s=e(h),u=s?(0,o.Z)({},s,n):(0,o.Z)({},n);if(!u.filePath||!u.edits||!u.users)throw new Error('"filePath", "edits", "users" required when initializing history state');p.set((function(){return u}));var d,f,m,v=u.edits.length;if(0===v)return u.users={},u.version=0,u.playing=!1,u.count=0,u.userElements={},void t(h,u);if(null!==(d=(r=u).count)&&void 0!==d||(r.count=v),null!==(f=(i=u).version)&&void 0!==f||(i.version=v-1),null!==(m=(a=u).playing)&&void 0!==m||(a.playing=!1),(null===s||void 0===s?void 0:s.edits)&&u.edits!==s.edits&&(u.count=v,u.version=Math.min(u.version,v-1),u.playing=!1),n.users||!u.userElements)for(var g in u.userElements={},u.users){var b=u.users[g];u.userElements[g]=(0,c.tZ)(l.n5,{small:!0,src:b.image,username:b.username})}u.version===v-1&&(u.playing=!1),t(h,u)}}));function v(){return(0,d.KO)(m,u.d8)}function g(){return(0,d.KO)(f,u.d8)}},22942:function(e,t,n){n.d(t,{Z:function(){return J}});var r=n(35944),i=n(40705),a=n(26042),o=n(69396),c=n(99534),s=n(10253),l=n(60536),u=n.n(l),d=n(67294),f=n(94184),p=n.n(f),h=n(67629),m=n(24888),v=n(33773),g=n(99408),b=n(6951),x=n(6625),Z=n(12215),y=n(47568),w=n(34051),k=n.n(w),E=n(86292);function S(e,t){return t.some((function(t){var n,r;return(null===(n=t.name)||void 0===n?void 0:n.toLowerCase())===(null===(r=e.name)||void 0===r?void 0:r.toLowerCase())}))}var C=n(92876),T=n(24351);function R(e){var t=e.searchPackagesFn,n=e.query,r=e.packagerType,i=(0,d.useState)([]),a=i[0],o=i[1],c=(0,d.useState)(),s=c[0],l=c[1],u=(0,d.useState)(!1),f=u[0],p=u[1],h=(0,T.Z)(n,400);return(0,d.useEffect)((function(){if(l(null),""===h)return p(!1),void o([]);p(!0),(0,E.j)(E.U3.PACKAGE_MANAGER_USED,{action:"searched",query:h,packagerType:r});var e=!1;return t(h).then((function(t){e||o(t)})).catch((function(t){C.Tb(t),e||l(t)})).finally((function(){e||p(!1)})),function(){e=!0}}),[t,h,r]),{searchResults:a,isLoading:f,error:s}}var _=n(87653);function I(e){var t=e.combobox,n=e.inputValue,i=e.setInputValue,c=e.isLoading,l=e.isDisplayingInstalledPackages,f=(0,s.Z)(d.useState(!1),2),h=f[0],m=f[1];return(0,r.BX)("div",(0,o.Z)((0,a.Z)({},t.getComboboxProps()),{className:"jsx-8087f2542bfae7ac "+(p()("pkgsearch-search-bar",{focused:h})||""),children:[(0,r.tZ)("input",(0,o.Z)((0,a.Z)({},t.getInputProps({type:"text",placeholder:"search to install packages",value:n,onFocus:function(){m(!0)},onBlur:function(){m(!1)},onChange:function(e){i(e.currentTarget.value)},autoFocus:!0})),{className:"jsx-8087f2542bfae7ac"})),(0,r.tZ)("div",{className:"jsx-8087f2542bfae7ac pkgsearch-search-bar-icon",children:(0,r.tZ)(P,{onXIcon:function(){return i("")},isDisplayingInstalledPackages:l,isSearchLoading:c})}),(0,r.tZ)(u(),{id:"8087f2542bfae7ac",children:".pkgsearch-search-bar.jsx-8087f2542bfae7ac{width:-webkit-calc(100% - 24px);width:-moz-calc(100% - 24px);width:calc(100% - 24px);margin:0 12px 12px 12px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;overflow:hidden;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;border:1px solid var(--foreground-dimmest);-webkit-border-radius:var(--border-radius-4);-moz-border-radius:var(--border-radius-4);border-radius:var(--border-radius-4)}.pkgsearch-search-bar.focused.jsx-8087f2542bfae7ac{border-color:var(--accent-primary-default)}.pkgsearch-search-bar.jsx-8087f2542bfae7ac input.jsx-8087f2542bfae7ac::-webkit-input-placeholder{color:var(--foreground-dimmer)}.pkgsearch-search-bar.jsx-8087f2542bfae7ac input.jsx-8087f2542bfae7ac:-moz-placeholder{color:var(--foreground-dimmer)}.pkgsearch-search-bar.jsx-8087f2542bfae7ac input.jsx-8087f2542bfae7ac::-moz-placeholder{color:var(--foreground-dimmer)}.pkgsearch-search-bar.jsx-8087f2542bfae7ac input.jsx-8087f2542bfae7ac:-ms-input-placeholder{color:var(--foreground-dimmer)}.pkgsearch-search-bar.jsx-8087f2542bfae7ac input.jsx-8087f2542bfae7ac::-ms-input-placeholder{color:var(--foreground-dimmer)}.pkgsearch-search-bar.jsx-8087f2542bfae7ac input.jsx-8087f2542bfae7ac::placeholder{color:var(--foreground-dimmer)}.pkgsearch-search-bar.jsx-8087f2542bfae7ac input.jsx-8087f2542bfae7ac{padding:var(--space-8);font-size:var(--font-size-default);border:0;-webkit-box-flex:1;-webkit-flex-grow:1;-moz-box-flex:1;-ms-flex-positive:1;flex-grow:1;outline:none;background-color:transparent;color:var(--foreground-default);-o-text-overflow:ellipsis;text-overflow:ellipsis;white-space:nowrap;width:100%}.pkgsearch-search-bar-icon.jsx-8087f2542bfae7ac{padding-right:var(--space-8);margin-bottom:4px;margin-right:8px;width:14px;height:14px;vertical-align:middle}"})]}))}function P(e){var t=e.isDisplayingInstalledPackages,n=e.isSearchLoading,i=e.onXIcon;return n?(0,r.BX)("div",{className:"jsx-72a78eaf553adb92",children:[(0,r.tZ)("div",{className:"jsx-72a78eaf553adb92 pkgsearch-search-loading"}),(0,r.tZ)(u(),{id:"72a78eaf553adb92",children:".pkgsearch-search-loading.jsx-72a78eaf553adb92{display:block;width:14px!important;height:14px!important;background-image:url(/public/images/loading_dots.gif);background-position:center center;background-repeat:no-repeat;-webkit-background-size:contain;-moz-background-size:contain;-o-background-size:contain;background-size:contain}"})]}):t?(0,r.tZ)(_.Z,{color:"var(--foreground-dimmer)",style:{display:"block"}}):(0,r.BX)("div",{onClick:i,className:"jsx-a8c1e8780f7b9ee0",children:[(0,r.tZ)(h.Z,{color:"var(--foreground-dimmer)",style:{display:"block"}}),(0,r.tZ)(u(),{id:"a8c1e8780f7b9ee0",children:"div.jsx-a8c1e8780f7b9ee0{cursor:pointer}"})]})}var D=n(92002),A=n(57704),N=n(77365),U=n(88075);function j(e){var t=e.focused,n=e.searching,i=e.onActionClick,a=e.actionAltText,o=e.isAlreadyInstalled,c=e.isPackagerRunning,l=e.isIconLoading,f=e.statusComponent,h=e.itemName,m=e.itemDescription,g=void 0===m?"This package has no description.":m,x=e.itemVersion,Z=e.itemHomepageURL,y=e.itemLicense,w=e.itemAuthor,k=e.itemDependencies,E=e.htmlItem,S=void 0!==E&&E,C=(0,s.Z)(d.useState(!1),2),T=C[0],R=C[1];return(0,r.BX)("div",{className:"jsx-209430e794998c42 "+(p()("pkgsearch-details",t&&"pkgsearch-details-hover")||""),children:[(0,r.BX)("div",{className:"jsx-209430e794998c42 pkgsearch-details-header",children:[(0,r.BX)("div",{onClick:function(){return R(!T)},className:"jsx-209430e794998c42 pkgsearch-details-header-title",children:[(0,r.tZ)("div",{className:"jsx-209430e794998c42 pkgsearch-details-libname",children:h}),x&&!T&&!n&&(0,r.tZ)("div",{className:"jsx-209430e794998c42 pkgsearch-details-header-version",children:x}),T&&(0,r.tZ)(b.Z,{border:!1,className:"collapse",textColor:"var(--foreground-dimmer)",backgroundColor:"var(--background-default)","aria-label":"Collapse","data-microtip-position":"bottom",role:"tooltip",onClick:function(){return R(!T)},children:(0,r.tZ)(v.Z,{})})]}),(0,r.tZ)("div",{className:"jsx-209430e794998c42 pkgsearch-details-cta",children:(0,r.tZ)(b.Z,{border:!1,"aria-label":a,className:"add-button",textColor:"var(--foreground-dimmer)",backgroundColor:"var(--background-default)","data-microtip-position":"bottom-left",role:"tooltip",onClick:function(e){e.currentTarget.blur(),i()},children:(0,r.tZ)(B,{isAlreadyInstalled:o,isPackagerRunning:c,isIconLoading:l,isHtmlItem:S})})})]}),f,(0,r.BX)("div",{className:"jsx-209430e794998c42 pkgsearch-details-metadata",children:[(0,r.BX)("div",{onClick:function(){n&&!T&&R(!0)},className:"jsx-209430e794998c42 "+("details-meta-item "+(T?"":"closed ")+(n?"show-in-search ":"")||0),children:[x&&(0,r.BX)("div",{className:"jsx-209430e794998c42 label",children:["version ",x]}),(0,r.tZ)("div",{className:"jsx-209430e794998c42 value",children:c&&!g?"loading...":g})]}),Z&&(0,r.BX)("div",{className:"jsx-209430e794998c42 "+("details-meta-item "+(T?"":"closed ")||0),children:[(0,r.tZ)("div",{className:"jsx-209430e794998c42 label",children:"Website"}),(0,r.tZ)("div",{className:"jsx-209430e794998c42 value",children:(0,r.tZ)("a",{href:Z,rel:"noreferer noopener",target:"_blank",className:"jsx-209430e794998c42",children:Z})})]}),y&&(0,r.BX)("div",{className:"jsx-209430e794998c42 "+("details-meta-item "+(T?"":"closed ")||0),children:[(0,r.tZ)("div",{className:"jsx-209430e794998c42 label",children:"License"}),(0,r.tZ)("div",{className:"jsx-209430e794998c42 value",children:y})]}),w&&(0,r.BX)("div",{className:"jsx-209430e794998c42 "+("details-meta-item "+(T?"":"closed ")||0),children:[(0,r.tZ)("div",{className:"jsx-209430e794998c42 label",children:"Author"}),(0,r.tZ)("div",{className:"jsx-209430e794998c42 value",children:w})]}),k&&k.length>0?(0,r.BX)("div",{className:"jsx-209430e794998c42 "+("details-meta-item pkgsearch-details-deps"+(T?"":"closed ")||0),children:[(0,r.BX)("div",{className:"jsx-209430e794998c42 label",children:[k.length," dependencies"]}),(0,r.tZ)("div",{className:"jsx-209430e794998c42 value",children:(0,r.tZ)("ul",{className:"jsx-209430e794998c42 pkgsearch-details-deps-list",children:k.map((function(e){return(0,r.tZ)("li",{className:"jsx-209430e794998c42",children:e},e||"")}))})})]}):null]}),(0,r.tZ)(u(),{id:"209430e794998c42",children:".pkgsearch-details.jsx-209430e794998c42{padding:var(--space-8)var(--space-8)var(--space-8)12px;height:100%;-webkit-flex-shrink:1;-ms-flex-negative:1;flex-shrink:1;overflow:visible;color:var(--foreground-dimmer);cursor:pointer;border-top:1px solid var(--background-highest);position:relative}.pkgsearch-details-hover.jsx-209430e794998c42{z-index:99}.pkgsearch-details-header.jsx-209430e794998c42{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center}.pkgsearch-details-header-title.jsx-209430e794998c42{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-flex:2;-webkit-flex-grow:2;-moz-box-flex:2;-ms-flex-positive:2;flex-grow:2;height:32px;-webkit-box-pack:start;-webkit-justify-content:flex-start;-moz-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center}.pkgsearch-details-libname.jsx-209430e794998c42{color:var(--foreground-default);font-size:var(--font-size-small);font-weight:var(--font-weight-medium);word-wrap:break-word}.pkgsearch-details-header-version.jsx-209430e794998c42{padding-left:4px;vertical-align:text-bottom;color:var(--foreground-dimmer);font-size:var(--font-size-small)}.pkgsearch-details-metadata.jsx-209430e794998c42:not(:empty){}.details-meta-item.jsx-209430e794998c42{padding:var(--space-8)0;width:100%}.details-meta-item.closed.jsx-209430e794998c42{display:none}.details-meta-item.closed.show-in-search.jsx-209430e794998c42{display:block;padding:var(--space-8)0}.details-meta-item.jsx-209430e794998c42 .label.jsx-209430e794998c42{margin-bottom:4px;color:var(--foreground-dimmer);font-size:var(--font-size-small)}.details-meta-item.jsx-209430e794998c42 .value.jsx-209430e794998c42{line-height:20px;word-wrap:break-word;font-size:var(--font-size-default);color:var(--foreground-default);overflow:hidden}.pkgsearch-details-deps-list.jsx-209430e794998c42{list-style:none}.pkgsearch-search-result-li.jsx-209430e794998c42{overflow:visible;position:relative;z-index:99}"})]})}function B(e){var t=e.isPackagerRunning,n=e.isAlreadyInstalled,i=e.isIconLoading,a=e.isHtmlItem;return i?(0,r.BX)("div",{className:"jsx-465bfe593a07b572 loadingIconRotate",children:[(0,r.tZ)(N.Z,{}),(0,r.tZ)(u(),{id:"465bfe593a07b572",children:".loadingIconRotate.jsx-465bfe593a07b572{-webkit-animation:rotate 1s linear infinite;-moz-animation:rotate 1s linear infinite;-o-animation:rotate 1s linear infinite;animation:rotate 1s linear infinite}@-webkit-keyframes rotate{from{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes rotate{from{-moz-transform:rotate(0deg);transform:rotate(0deg)}to{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes rotate{from{-o-transform:rotate(0deg);transform:rotate(0deg)}to{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes rotate{from{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}"})]}):n?a?(0,r.tZ)(U.Z,{}):t?(0,r.tZ)(A.Z,{color:"var(--foreground-dimmest)"}):(0,r.tZ)(A.Z,{}):t?(0,r.tZ)(D.Z,{color:"var(--foreground-dimmest)"}):(0,r.tZ)(D.Z,{})}var O=n(96594),G=n(87251),L=n(69346),M=n(81255);function z(e){var t=e.filesAffected,n=(0,s.Z)(d.useState(""),2),i=n[0],c=n[1],l=(0,g.Z)(),f=l.packager,p=l.session,h=function(e){var t=e.packager,n=(0,s.Z)(d.useState(!1),2),r=n[0],i=n[1],a=(0,s.Z)(d.useState(!1),2),o=a[0],c=a[1],l=(0,s.Z)(d.useState("package name"),2),u=l[0],f=l[1],p=(0,s.Z)(d.useState([]),2),h=p[0],m=p[1];d.useEffect((function(){i(!0);var e=!1;return t.listSpecfile().then((function(t){e||(t.error?m([]):t.packages&&m(t.packages),i(!1))})),function(){e=!0}}),[t]);var v=d.useCallback(function(){var e=(0,y.Z)(k().mark((function e(n){var a,o,c;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=2;break}return e.abrupt("return");case 2:if((0,E.j)(E.U3.PACKAGE_MANAGER_USED,{action:"installed",packageId:n.name}),n.name){e.next=5;break}throw new Error("Package has no name");case 5:if(!S(n,h)){e.next=7;break}return e.abrupt("return");case 7:return i(!0),e.next=10,t.addPackages([{name:n.name}]);case 10:return e.next=12,t.listSpecfile();case 12:a=e.sent,o=a.packages,c=a.error,o&&m(o),c&&m([]),i(!1);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[t,h,r]),g=d.useCallback(function(){var e=(0,y.Z)(k().mark((function e(n){var a,o,s;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=2;break}return e.abrupt("return");case 2:if(n.name){e.next=4;break}return e.abrupt("return");case 4:if(S(n,h)){e.next=6;break}return e.abrupt("return");case 6:return(0,E.j)(E.U3.PACKAGE_MANAGER_USED,{action:"removed",packageId:n.name}),i(!0),e.next=10,t.removePackages([n.name]);case 10:return e.next=12,t.listSpecfile();case 12:a=e.sent,o=a.packages,s=a.error,o&&(m(o),c(!0),f(n.name)),s&&m([]),i(!1);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[t,h,r]),b=d.useCallback((function(e){return S(e,h)}),[h]);return{install:v,uninstall:g,installedPackages:h,isInstalled:b,isRunning:r,showDeletedTooltip:o,packageDeletedName:u,setDeletedTooltip:c}}({packager:f}),v=R({searchPackagesFn:f.searchPackages,query:i,packagerType:"upm"}),x=v.searchResults,w=v.isLoading,C=""===i,T=C?h.installedPackages:x,_=(0,O.Kb)({inputValue:i,items:T,defaultHighlightedIndex:0,itemToString:function(e){return(null===e||void 0===e?void 0:e.name)?e.name:""}}),P=(0,Z.Z)("packager","show_packager_about_tooltip"),D=P.shouldDisplay,A=P.register,N=P.dismiss;d.useEffect((function(){A()}),[A]);var U=(0,Z.Z)("packager","show_packager_import_tooltip"),j=U.shouldDisplay,B=U.register,z=U.dismiss;d.useEffect((function(){B()}),[B]);return(0,r.BX)("div",{className:"jsx-97a1ea8580a20cde pkgsearch-search",children:[(0,r.tZ)(I,{combobox:_,inputValue:i,setInputValue:c,isLoading:w,isDisplayingInstalledPackages:C}),h.showDeletedTooltip&&(0,r.tZ)(L.ZP,{css:M.l0.p(8),children:(0,r.tZ)(G.Z,{colorway:"positive",closable:!0,closeAction:function(){return h.setDeletedTooltip(!1)},text:"Uninstalled "+h.packageDeletedName+"."})}),(0,r.BX)("div",{className:"jsx-97a1ea8580a20cde pkgsearch-installed-header",children:[w?"Working\u2026":C?0===T.length?"No packages installed.":"Installed packages":""!==i?0===T.length?"No packages found":T.length+" packages found":" ",C&&T.length>0&&t.length>0&&(0,r.tZ)(b.Z,{border:!1,Icon:m.Z,className:"package-button",textColor:"var(--foreground-dimmer)",backgroundColor:"var(--background-default)","aria-label":"Open "+t[0],"data-microtip-position":"bottom-left",role:"tooltip",onClick:function(){p.openFile(t[0])}})]}),C&&0===T.length&&(0,r.BX)("div",{className:"jsx-97a1ea8580a20cde no-packages-text",children:["You don\u2019t have any packages installed. Try searching for a package to install, or ","",(0,r.tZ)("a",{href:"https://docs.replit.com/programming-ide/installing-packages",className:"jsx-97a1ea8580a20cde",children:"learn more about packages here."})]}),(0,r.tZ)("div",(0,o.Z)((0,a.Z)({},_.getMenuProps()),{className:"jsx-97a1ea8580a20cde",children:T.length>0&&(0,r.tZ)("ul",{className:"jsx-97a1ea8580a20cde "+("pkgsearch-search-result "+(!C&&"pkgsearch-search-result-searching")||0),children:T.map((function(e,n){return(0,r.tZ)("li",(0,o.Z)((0,a.Z)({},_.getItemProps({item:e,index:n})),{className:"jsx-97a1ea8580a20cde",children:(0,r.tZ)(F,{packager:f,pkg:e,filesAffected:t,focused:_.highlightedIndex===n,searching:!C,isPackagerRunning:h.isRunning,isAlreadyInstalled:h.isInstalled(e),installPackage:h.install,uninstallPackage:h.uninstall})}),e.name||"Unknown"+n)}))})})),D&&""===i&&(0,r.BX)(X,{title:"What are Packages?",expandable:!0,expanded:!1,needsMargin:!0,backgroundColor:"var(--background-default)",foregroundColor:"var(--foreground-default)",strokeColor:"var(--foreground-dimmest)",onClose:function(){return N()},children:["Packages are collections of code that can extend the functionality of your programs. For example, you could add a package to make adding image carousels easier on websites, or a package to manage currency comparisons."," ",(0,r.tZ)("a",{href:"https://docs.replit.com/programming-ide/installing-packages",className:"jsx-97a1ea8580a20cde",children:"Learn more about packages"})]}),C&&j&&""===i&&(0,r.tZ)(X,{title:"Tip\u2014Auto Import",expandable:!0,expanded:!1,needsMargin:!0,backgroundColor:"var(--background-default)",foregroundColor:"var(--foreground-default)",strokeColor:"var(--foreground-dimmest)",onClose:function(){return z()},children:"If you know which packages you want to use, you can just import and use them in your files as if they were already installed, and they will be installed automatically the next time you run the repl."}),(0,r.tZ)(u(),{id:"97a1ea8580a20cde",children:".pkgsearch-search.jsx-97a1ea8580a20cde{position:relative;width:100%;height:100%;overflow-y:scroll;min-height:0;color:var(--foreground-default)}.no-packages-text.jsx-97a1ea8580a20cde{margin:0 12px;font-size:var(--font-size-default);line-height:20px}.pkgsearch-installed-header.jsx-97a1ea8580a20cde{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;padding:0px var(--space-8)12px 12px;font-size:var(--font-size-subhead-default);font-weight:var(--font-weight-medium)}.pkgsearch-search-result.jsx-97a1ea8580a20cde{list-style:none;position:relative;overflow:visible;z-index:2;border-bottom:1px solid var(--background-highest);-webkit-overflow-scrolling:touch;-webkit-flex-shrink:1;-ms-flex-negative:1;flex-shrink:1;min-height:0}.pkgsearch-search-result-searching.jsx-97a1ea8580a20cde{overflow:scroll}"})]})}function F(e){var t=e.isPackagerRunning,n=e.isAlreadyInstalled,i=e.installPackage,a=e.uninstallPackage,o=e.packager,l=e.focused,u=e.searching,f=e.filesAffected,p=(0,c.Z)(e,["isPackagerRunning","isAlreadyInstalled","installPackage","uninstallPackage","packager","focused","searching","filesAffected"]),h=function(e){var t=e.packager,n=e.pkg,r=(0,s.Z)(d.useState(!1),2),i=r[0],a=r[1],o=(0,s.Z)(d.useState(null),2),c=o[0],l=o[1];return d.useEffect((function(){if(n.name){var e=!1;return t.fetchPackageInfo(n.name).then((function(t){e||(l(t||null),a(!1))})),function(){e=!0}}l(null)}),[t,n.name]),{isLoading:i,packageInfo:c}}({packager:o,pkg:p.pkg}).packageInfo,m=(0,x.Z)(),v=(0,s.Z)(d.useState(!1),2),g=v[0],b=v[1],Z=(0,s.Z)(d.useState(!1),2),y=Z[0],w=Z[1],k=h||p.pkg,E=function(){if(t)return{colorway:void 0,text:"Packager is working on "+k.name+". Check the Console tab for details",status:"Working\u2026"};if(n){var e=f[0];return{colorway:"positive",text:"".concat(k.name," was successfully installed").concat(e?" to ".concat(e):""),status:"Remove Package"}}return{colorway:"negative",text:k.name+" was not installed. There may have been an error \u2014\xa0check the Console tab for details.",status:"Install Package"}},S=y?(0,r.tZ)(G.Z,{colorway:E().colorway,closable:!0,closeAction:function(){return w(!1)},text:E().text}):null,C="dependencies"in k&&k.dependencies&&k.dependencies.length>0?k.dependencies.map((function(e){return e.name})):null;return(0,r.tZ)(j,{focused:l,searching:u,onActionClick:function(){t||(w(!0),b(!0),n?a(k).then((function(){m.current&&(b(!1),w(!1))})):i(k).then((function(){m.current&&(b(!1),w(!0))})))},actionAltText:E().status,isAlreadyInstalled:n,isPackagerRunning:t,isIconLoading:g,statusComponent:S,itemName:k.name,itemDescription:k.description,itemVersion:k.version,itemHomepageURL:k.homepageURL,itemLicense:k.license,itemAuthor:k.author,itemDependencies:C})}function X(e){var t=e.title,n=e.children,i=e.expanded,a=e.expandable,o=e.needsMargin,c=e.backgroundColor,l=e.strokeColor,f=e.foregroundColor,m=e.onClose,g=(0,s.Z)(d.useState(i),2),b=g[0],x=g[1];return(0,r.BX)("div",{style:{backgroundColor:c},className:u().dynamic([["e80852547c20a24e",[l,f,f]]])+" "+(p()("pkgsearch-tooltip",o&&"needs-margin")||""),children:[(0,r.BX)("div",{className:u().dynamic([["e80852547c20a24e",[l,f,f]]])+" pkgsearch-tooltip-header",children:[(0,r.BX)("div",{onClick:function(){a&&x(!b)},className:u().dynamic([["e80852547c20a24e",[l,f,f]]])+" "+(p()("pkgsearch-tooltip-title",a&&"expandable")||""),children:[(0,r.tZ)("span",{className:u().dynamic([["e80852547c20a24e",[l,f,f]]])+" pkgsearch-tooltip-title-text",children:t}),a&&(0,r.tZ)(v.Z,{color:f,rotate:b?0:-90})]}),(0,r.tZ)("div",{className:u().dynamic([["e80852547c20a24e",[l,f,f]]])+" pkgsearch-tooltip-close",children:(0,r.tZ)(h.Z,{onClick:m,color:f})})]}),b&&(0,r.tZ)("p",{className:u().dynamic([["e80852547c20a24e",[l,f,f]]])+" pkgsearch-tooltip-content",children:n}),(0,r.tZ)(u(),{id:"e80852547c20a24e",dynamic:[l,f,f],children:".pkgsearch-tooltip.__jsx-style-dynamic-selector{-webkit-border-radius:var(--border-radius-4);-moz-border-radius:var(--border-radius-4);border-radius:var(--border-radius-4);-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;width:-webkit-calc(100%);width:-moz-calc(100%);width:calc(100%);padding:var(--space-8);margin:var(--space-4)0;border:1px solid ".concat(l,"}.pkgsearch-tooltip.needs-margin.__jsx-style-dynamic-selector{width:-webkit-calc(100% - 24px);width:-moz-calc(100% - 24px);width:calc(100% - 24px);margin:12px}.pkgsearch-tooltip-header.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:top;-webkit-align-items:top;-moz-box-align:top;-ms-flex-align:top;align-items:top}.pkgsearch-tooltip-title.__jsx-style-dynamic-selector{font-size:var(--font-size-small);font-weight:var(--font-weight-medium);-webkit-box-flex:1;-webkit-flex-grow:1;-moz-box-flex:1;-ms-flex-positive:1;flex-grow:1;opacity:.85}.expandable.__jsx-style-dynamic-selector{cursor:pointer}.pkgsearch-tooltip-title-text.__jsx-style-dynamic-selector{padding-right:4px;color:").concat(f,"}.pkgsearch-tooltip-close.__jsx-style-dynamic-selector{cursor:pointer;opacity:.7;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;padding-left:8px}.pkgsearch-tooltip-content.__jsx-style-dynamic-selector:not(:empty){padding-top:var(--space-8);line-height:20px;font-size:var(--font-size-default);color:").concat(f,";opacity:.85}")})]})}var W,H=n(29815),V=n(54098),$=n.n(V),q=n(65456),Q="index.html";function K(){var e=(0,g.Z)(),t=e.fs,n=e.session,i=(0,d.useState)(""),c=i[0],l=i[1],f=(0,d.useState)(!1),p=f[0],h=f[1],m=""===c,v=function(e){var t=e.fs,n=e.session,r=(0,s.Z)(d.useState([]),2),i=r[0],a=r[1],o=(0,s.Z)(d.useState(!1),2),c=o[0],l=o[1],u=(0,s.Z)(d.useState([]),2),f=u[0],p=u[1],h=d.useCallback(function(){var e=(0,y.Z)(k().mark((function e(t){return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",$()("/data/cdnjs/search/".concat(encodeURIComponent(t)),{credentials:"same-origin",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){return e.json()})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]);d.useEffect((function(){var e=!1;l(!0);var n=function(){var n=(0,y.Z)(k().mark((function n(){var r,i;return k().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.stat(Q);case 2:if(n.sent.exists&&!e){n.next=6;break}return l(!1),n.abrupt("return");case 6:r=[],i=t.watchOtFile(Q,{onReady:function(e){var t=e.initialContent.toString("utf8"),n=!0,i=!1,a=void 0;try{for(var o,c=t.split("\n")[Symbol.iterator]();!(n=(o=c.next()).done);n=!0){var s=o.value;if(s.includes('<script src="https')){var u=s.match(/[^/]*(?=\.js)/);u&&r.push(u[0])}}}catch(d){i=!0,a=d}finally{try{n||null==c.return||c.return()}finally{if(i)throw a}}p(r),l(!1)},onError:function(){l(!1),i()}});case 8:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return n(),function(){e=!0}}),[t,n]),d.useEffect((function(){l(!0);var e=!1,t=function(){var t=(0,y.Z)(k().mark((function t(){var n,r,i,o,c,s,u,d;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=2;break}return t.abrupt("return");case 2:n=[],r=!0,i=!1,o=void 0,t.prev=4,c=f[Symbol.iterator]();case 6:if(r=(s=c.next()).done){t.next=15;break}return u=s.value,t.next=10,h(u);case 10:(d=t.sent).length>0&&n.push(d[0]);case 12:r=!0,t.next=6;break;case 15:t.next=21;break;case 17:t.prev=17,t.t0=t.catch(4),i=!0,o=t.t0;case 21:t.prev=21,t.prev=22,r||null==c.return||c.return();case 24:if(t.prev=24,!i){t.next=27;break}throw o;case 27:return t.finish(24);case 28:return t.finish(21);case 29:a(n),l(!1);case 31:case"end":return t.stop()}}),t,null,[[4,17,21,29],[22,,24,28]])})));return function(){return t.apply(this,arguments)}}();return t(),function(){e=!0}}),[f,h]);var m=d.useCallback((function(e){return i.includes(e)}),[i]);function v(){return v=(0,y.Z)(k().mark((function e(r){var o;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=r.lib,e.abrupt("return",new Promise(function(){var e=(0,y.Z)(k().mark((function e(r){var c;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.stat(Q);case 2:if(e.sent.exists){e.next=5;break}return e.abrupt("return",r(W.IndexNotFound));case 5:c=t.watchOtFile(Q,{onReady:function(e){var s=e.initialContent,l=e.writeOp;if(!o.include)return c(),void r(W.InvalidLib);var u='<script src="'.concat(o.include,'"><\/script>'),d=s.toString("utf8");if(i.includes(o))return c(),void r(W.AlreadyInstalled);var f=d.indexOf("<script");-1===f&&(f=d.indexOf("</body>"));var p=[u+"\n"];f>0&&p.unshift(f),l(p),t.flush().then((function(){a((0,H.Z)(i).concat([o])),r(W.Success)})).catch((function(){r(W.UnknownError)})).finally((function(){c(),n.openFile(Q)}))},onError:function(e){r(e.code===q.Df.NotFound?W.IndexNotFound:W.UnknownError)}});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e)}))),v.apply(this,arguments)}return{installedPackages:i,loadingPackages:c,searchLibs:h,installLib:function(e){return v.apply(this,arguments)},isInstalled:m}}({fs:t,session:n}),b=R({searchPackagesFn:v.searchLibs,query:c,packagerType:"html"}),x=b.searchResults,Z=b.isLoading,w=b.error,E=m?v.installedPackages:x,S=(0,O.Kb)({inputValue:c,items:E,defaultHighlightedIndex:0,itemToString:function(e){return(null===e||void 0===e?void 0:e.name)?e.name:""}});return(0,r.BX)("div",{className:"jsx-cccac1ca9eaa7559 pkgsearch-search",children:[(0,r.tZ)(I,{combobox:S,inputValue:c,setInputValue:l,isLoading:Z,isDisplayingInstalledPackages:!0}),(0,r.tZ)("div",{className:"jsx-cccac1ca9eaa7559 pkgsearch-installed-header",children:Z||v.loadingPackages?"Working\u2026":m?0===E.length?"No packages installed.":"Installed packages":""!==c?w?"Sorry, there was a problem searching. Try again.":0===E.length?"No packages found":E.length+" packages found":" "}),(0,r.tZ)("div",(0,o.Z)((0,a.Z)({},S.getMenuProps()),{className:"jsx-cccac1ca9eaa7559",children:E.length>0&&(0,r.tZ)("ul",{className:"jsx-cccac1ca9eaa7559 pkgsearch-search-result pkgsearch-search-result-searching",children:E.map((function(e,t){return(0,r.tZ)("li",(0,o.Z)((0,a.Z)({},S.getItemProps({key:e.name||"Unknown"+t,item:e,index:t})),{className:"jsx-cccac1ca9eaa7559",children:(0,r.tZ)(Y,{lib:e,focused:S.highlightedIndex===t,install:(0,y.Z)(k().mark((function t(){return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return h(!0),t.abrupt("return",v.installLib({lib:e}).finally((function(){h(!1)})));case 2:case"end":return t.stop()}}),t)}))),isInstalling:p,isAlreadyInstalled:v.isInstalled(e)})}))}))})})),(0,r.tZ)(u(),{id:"cccac1ca9eaa7559",children:".pkgsearch-search.jsx-cccac1ca9eaa7559{position:relative;width:100%;height:100%;overflow-y:scroll;min-height:0;color:var(--foreground-default)}.pkgsearch-installed-header.jsx-cccac1ca9eaa7559{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;padding:0px var(--space-8)12px 12px;font-size:var(--font-size-subhead-default);font-weight:var(--font-weight-medium)}.pkgsearch-search-result.jsx-cccac1ca9eaa7559{list-style:none;position:relative;overflow:visible;z-index:2;border-bottom:1px solid var(--background-highest);-webkit-overflow-scrolling:touch;-webkit-flex-shrink:1;-ms-flex-negative:1;flex-shrink:1;min-height:0}.pkgsearch-search-result-searching.jsx-cccac1ca9eaa7559{overflow:scroll}"})]})}function Y(e){var t=e.lib,n=e.focused,i=e.install,a=e.isInstalling,o=e.isAlreadyInstalled,c=(0,d.useState)(null),s=c[0],l=c[1],u=(0,d.useState)(!1),f=u[0],p=u[1],h=(0,x.Z)(),m=s?(0,r.tZ)("div",{children:s}):null,v=function(){var e=(0,y.Z)(k().mark((function e(){return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:p(!0),i(t).then((function(e){h.current&&(e===W.Success?l("".concat(t.name," was successfully added to index.html")):e===W.IndexNotFound?l("".concat(t.name," was not added. There is no index.html file.")):e===W.AlreadyInstalled?l("".concat(t.name," was already added to index.html.")):l("".concat(t.name," was not added. Try adding it manually.")))})).catch((function(e){C.Tb(e),h.current&&l("".concat(t.name," was not added. Try adding it manually."))})).finally((function(){p(!1)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,r.tZ)(j,{focused:n,searching:!0,onActionClick:function(){a||f||(o?l("".concat(t.name," is already installed.")):v())},actionAltText:o?"Library Added":"Add Library",isAlreadyInstalled:o,isPackagerRunning:a,isIconLoading:f,statusComponent:m,itemName:t.name,itemDescription:t.description,itemVersion:t.version,itemHomepageURL:t.link,htmlItem:!0})}function J(){var e=(0,i.x)();return e?"html"===e.language?(0,r.tZ)(K,{}):(0,r.tZ)(z,{filesAffected:e.packagerFiles}):null}!function(e){e[e.Success=0]="Success",e[e.IndexNotFound=1]="IndexNotFound",e[e.AlreadyInstalled=2]="AlreadyInstalled",e[e.InvalidLib=3]="InvalidLib",e[e.UnknownError=4]="UnknownError"}(W||(W={}))},40705:function(e,t,n){n.d(t,{x:function(){return m}});var r=n(26042),i=n(69396),a=n(67294),o=n(62991),c=n.n(o),s=n(15519),l=n(2916),u=n(25497),d=n(99408),f={nodejs:["package.json","package-lock.json","yarn.lock","node_modules"],python:["poetry.lock","pyproject.toml","requirements.txt",".venv/",".local"],ruby:["Gemfile","Gemfile.lock"],java:["pom.xml","target"]};function p(e){return["python3_classroom","python3_classroom_beta","python3","python3_beta","pygame","pygame_beta"].includes(e)?"python":["nodejs","nodejs_beta","nodejs_prybar","nodejs_prybar_beta","reason_nodejs","nodejs_static"].includes(e)?"nodejs":["ruby","ruby_beta","ruby_classroom","ruby_classroom_beta","rails","rails_beta"].includes(e)?"ruby":s.Z.supportsPackager3(e)?e:null}function h(e){return(0,i.Z)((0,r.Z)({},e),{packagerFiles:f[e.language]||[]})}function m(){var e=(0,a.useState)(null),t=e[0],n=e[1],r=(0,l.Z)(),i=(0,d.Z)().dotReplit;return(0,a.useEffect)((function(){if(r)if("html"!==r.language&&"html_beta"!==r.language){var e=p(r.language);if(e)n(h({language:e,packageSearch:!0,guessImports:!0}));else if(("nix"===r.language||"nix_beta"===r.language)&&r.flagOwnerDotReplitPackager)return i.watch((function(e){e.error?e.error===u.Yt.NotFound&&n(null):n((function(t){var n,r,i;if(!(null===(n=e.config.packager)||void 0===n?void 0:n.language))return null;var a=e.config.packager.language,o=h({language:p(a)||a,guessImports:Boolean(null===(r=e.config.packager.features)||void 0===r?void 0:r.guessImports),packageSearch:Boolean(null===(i=e.config.packager.features)||void 0===i?void 0:i.packageSearch)});return c()(t,o)?t:o}))}))}else n(h({language:"html",packageSearch:!0,guessImports:!1}))}),[r,i]),t}},12088:function(e,t,n){n.d(t,{Z:function(){return B}});var r=n(29815),i=n(35944),a=n(67294),o=n(15589),c=n(4158),s=n(26224),l=n(93160),u=n(81255),d=n(69346),f=n(1144),p=n(70804),h=n(86292),m=n(37424);function v(e){var t=e.id,n=e.title,r=e.children,o=(0,m.H)()(t);return(0,i.BX)(d.ZP,{css:[u.l0.colWithGap(8)],children:[(0,i.tZ)(d.ZP,{tag:"label",htmlFor:o,children:"string"===typeof n?(0,i.tZ)(f.x,{children:n}):n}),a.cloneElement(r,{id:o})]})}var g=n(14924),b=n(61193),x=new Set(["self-hosted-small","self-hosted-medium","self-hosted-large","self-hosted-small-python"]),Z=n(65975),y=[{title:"enabled",value:!0},{title:"disabled",value:!1}],w=Array.from(x,(function(e){return{title:e,value:e}}));function k(){var e=(0,b.c)("flag-code-suggestion"),t=e.enabled,n=(e.loading,(0,b.c)("flag-code-suggestion-engine")),r=n.enabled,a=(n.loading,(0,s.Z)()),l=a.preferences,u=a.update,d=function(e,t){u((0,g.Z)({},e,t)),(0,h.j)(h.U3.SETTINGS_TOGGLED,{settingChanged:e,updatedValue:t})};return t?(0,i.BX)(i.HY,{children:[(0,i.tZ)(v,{id:"codeSuggestionToggle",title:(0,i.BX)("div",{css:[Z.l0.flex.row,Z.l0.rowWithGap(4),Z.l0.center,Z.l0.justify.start],children:[(0,i.tZ)("div",{children:"Replit GhostWriter"}),(0,i.tZ)("a",{href:"https://docs.replit.com/programming-ide/GhostWriter-FAQ",target:"_blank",css:Z.l0.color.foregroundDefault,children:(0,i.tZ)(Z.hU,{alt:"Learn more",tooltipDelay:0,tooltipText:"This feature is powered by Replit AI. Click to read more.",type:"button",children:(0,i.tZ)(c.Z,{color:Z.TV.foregroundDefault})})})]}),children:(0,i.tZ)(o.Z,{initialSelectedItem:y.find((function(e){return e.value===l.codeSuggestion})),onChange:function(e){return d("codeSuggestion",null===e||void 0===e?void 0:e.value)},items:y})}),r?(0,i.tZ)(v,{id:"codeSuggestionEngine",title:(0,i.tZ)(f.x,{children:"Code suggestion engine"}),children:(0,i.tZ)(o.Z,{initialSelectedItem:w.find((function(e){return e.value===l.codeSuggestionEngine})),onChange:function(e){return d("codeSuggestionEngine",null===e||void 0===e?void 0:e.value)},items:w})}):null]}):null}var E=n(83117),S=n(95642),C=n(77365),T=[{value:"side-by-side",title:"side-by-side"},{value:"stacked",title:"stacked"}],R=[{value:10,title:"tiny"},{value:14,title:"normal"},{value:18,title:"large"},{value:24,title:"huge"}],_=[{value:"spaces",title:"spaces"},{value:"tabs",title:"tabs"}],I=[{value:2,title:"2"},{value:4,title:"4"},{value:8,title:"8"}],P=[{value:"default",title:"default"},{value:"emacs",title:"emacs"},{value:"vim",title:"vim"}],D=[{value:"none",title:"none"},{value:"soft",title:"soft wrap"}],A=[{value:"disabled",title:"disabled"},{value:"enabled",title:"enabled"}],N=[{value:"disabled",title:"disabled"},{value:"enabled",title:"enabled"}],U=(0,d.KD)("div");function j(){var e=(0,a.useState)(!1),t=e[0],n=e[1],r=(0,a.useState)(!1),o=r[0],s=r[1],l=(0,a.useRef)(!1);return(0,a.useEffect)((function(){l.current=!0;var e=setTimeout((function(){s(t)}),200);return function(){clearTimeout(e)}}),[t]),(0,i.BX)(d.ZP,{css:[u.l0.rowWithGap(8),u.l0.justify.start],onMouseEnter:function(){return n(!0)},onMouseLeave:function(){return n(!1)},children:[(0,i.tZ)(f.x,{children:"Code intelligence"}),(0,i.BX)(p.Z,{isOpen:o,onClickOutside:function(){return s(!1)},padding:8,children:[(0,i.tZ)(U,{children:(0,i.tZ)(c.Z,{})}),(0,i.tZ)(d.ZP,{css:[u.l0.maxWidth(240)],children:(0,i.BX)(f.x,{multiline:!0,children:["Code intelligence gives you autocomplete, helpful info, and hints as you type. See more"," ",(0,i.tZ)("a",{href:"https://replit.com/site/blog/intel",target:"_blank",rel:"noreferrer noopener",children:"here."})]})})]})]})}function B(e){var t=e.onBeforePreferencesUpdate,n=e.hideLayoutControl,a=e.className,c=(0,s.Z)(),p=c.preferences,m=c.update,g=(0,S.d)(),b=function(e){t&&t(e),Object.keys(e).forEach((function(t){var n=e[t];(0,h.j)(h.U3.SETTINGS_TOGGLED,{settingChanged:t,updatedValue:n})})),m(e)};return p?(0,i.BX)(l.Z,{className:a,background:"default",css:[u.l0.p(16),u.l0.colWithGap(32),{paddingBottom:"5em"}],children:[n?null:(0,i.tZ)(v,{id:"layout",title:"Default layout",children:(0,i.BX)(d.ZP,{css:[u.l0.colWithGap(8)],children:[(0,i.tZ)(o.Z,{initialSelectedItem:T.find((function(e){return p.isLayoutStacked?"stacked"===e.value:"side-by-side"===e.value})),onChange:function(e){var t="stacked"===(null===e||void 0===e?void 0:e.value);b({isLayoutStacked:t})},items:(0,r.Z)(T)}),(0,i.tZ)(Z.zx,{iconLeft:g.reseting?(0,i.tZ)(C.Z,{}):(0,i.tZ)(E.Z,{}),text:"Reset layout",onClick:function(){g.reset()}})]})}),(0,i.tZ)(v,{id:"fontSize",title:"Font size",children:(0,i.tZ)(o.Z,{initialSelectedItem:R.find((function(e){return e.value===p.fontSize})),onChange:function(e){var t="number"===typeof(null===e||void 0===e?void 0:e.value)?e.value:14;b({fontSize:t})},items:(0,r.Z)(R)})}),(0,i.tZ)(v,{id:"indentType",title:"Indent type",children:(0,i.tZ)(o.Z,{initialSelectedItem:_.find((function(e){return e.value===(p.indentIsSpaces?"spaces":"tabs")})),onChange:function(e){var t="spaces"===(null===e||void 0===e?void 0:e.value);b({indentIsSpaces:t})},items:(0,r.Z)(_)})}),(0,i.tZ)(v,{id:"indentSize",title:"Indent size",children:(0,i.tZ)(o.Z,{initialSelectedItem:I.find((function(e){return e.value===p.indentSize})),onChange:function(e){var t="number"===typeof(null===e||void 0===e?void 0:e.value)?e.value:2;b({indentSize:t})},items:(0,r.Z)(I)})}),(0,i.tZ)(v,{id:"keybinds",title:"Keybinds",children:(0,i.tZ)(o.Z,{initialSelectedItem:P.find((function(e){return["vim","emacs"].includes(e.value)?e.value===p.keyboardHandler:"default"===e.value&&!p.keyboardHandler})),onChange:function(e){var t=["vim","emacs"].includes(e.value)?e.value:null;b({keyboardHandler:t})},items:(0,r.Z)(P)})}),(0,i.tZ)(v,{id:"wrapping",title:"Wrapping",children:(0,i.tZ)(o.Z,{initialSelectedItem:D.find((function(e){return e.value===(p.wrapping?"soft":"none")})),onChange:function(e){var t="soft"===(null===e||void 0===e?void 0:e.value);b({wrapping:t})},items:(0,r.Z)(D)})}),(0,i.tZ)(v,{id:"codeIntelligence",title:(0,i.tZ)(j,{}),children:(0,i.tZ)(o.Z,{initialSelectedItem:A.find((function(e){return e.value===(p.codeIntelligence?"enabled":"disabled")})),onChange:function(e){var t="enabled"===(null===e||void 0===e?void 0:e.value);b({codeIntelligence:t})},items:(0,r.Z)(A)})}),(0,i.tZ)(k,{}),(0,i.tZ)(v,{id:"accessibleTerminal",title:(0,i.BX)(i.HY,{children:[(0,i.tZ)(f.x,{children:"Accessible Terminal Output"}),(0,i.tZ)(f.x,{multiline:!0,children:"enable this setting to use a screen reader. Warning: this can affect performance."})]}),children:(0,i.tZ)(o.Z,{initialSelectedItem:N.find((function(e){return e.value===(p.accessibleTerminal?"enabled":"disabled")})),onChange:function(e){var t="enabled"===(null===e||void 0===e?void 0:e.value);b({accessibleTerminal:t})},items:(0,r.Z)(N)})}),(0,i.tZ)(f.x,{multiline:!0,children:"Themes now apply across the whole site. Switch themes using the sun/moon icon in the site sidebar."})]}):null}},40577:function(e,t,n){n.d(t,{eT:function(){return D},HX:function(){return T},zu:function(){return P},U5:function(){return A},Bj:function(){return B},ap:function(){return F},BZ:function(){return _},pr:function(){return W},vN:function(){return V},NB:function(){return q},cr:function(){return G},gF:function(){return U},vi:function(){return M}});var r=n(26042),i=n(7297),a=n(31230),o=n(16092),c=n(6695),s=n(88954),l=n(28433);function u(){var e=(0,i.Z)(["\n  fragment PublishReleaseFormRepl on Repl {\n    id\n    title\n    description\n    ...PublishedReplShareInfoReplData\n    deployment {\n      id\n      activeRelease {\n        id\n      }\n    }\n    releases {\n      items {\n        id\n        timeCreated\n        description\n      }\n    }\n  }\n  ","\n"]);return u=function(){return e},e}var d=(0,a.ZP)(u(),l.B),f=n(15764),p=n(46829);function h(){var e=(0,i.Z)(["\n  fragment WorkspaceHeaderReplInfoRepl on Repl {\n    id\n    title\n    rawTemplateLabel: templateLabel(disableFallbackToTitle: true)\n    description\n    isPrivate\n    isRenamed\n    url\n    slug\n    workspaceCta\n    isAlwaysOn\n    isBoosted\n    hasGpu\n    guaranteedProvisioningSku\n    lastPublishedAt\n    publishedAs\n    currentUserPermissions {\n      containerAttach\n      changeIconUrl\n      changeTemplateLabel\n      changeTitle\n      changeDescription\n      changePrivacy\n      delete\n      changeAlwaysOn\n      publish\n      fork\n    }\n    user {\n      id\n      image\n      ...UserLinkUser\n    }\n    ...WorkspaceHeaderReplMetadataRepl\n    ...ReplEnvironmentWebviewRepl\n    ...PublishReleaseFormRepl\n  }\n  ","\n  ","\n  ","\n  ","\n"]);return h=function(){return e},e}function m(){var e=(0,i.Z)(["\n  query WorkspaceHeaderReplInfo($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        ...WorkspaceHeaderReplInfoRepl\n      }\n    }\n  }\n  ","\n"]);return m=function(){return e},e}function v(){var e=(0,i.Z)(['\n  query CurrentUserStates {\n    currentUser {\n      __typename\n      ... on CurrentUser {\n        id\n        isHacker\n        hasGpuAvailableGate: gate(feature: "flag-gpus")\n        hasGuaranteedProvisioningAvailableGate: gate(\n          feature: "flag-guaranteed-provisioning"\n        )\n      }\n    }\n  }\n']);return v=function(){return e},e}function g(){var e=(0,i.Z)(["\n  query ReplPowerUpCosts($replId: String!) {\n    currentUser {\n      __typename\n      ... on CurrentUser {\n        id\n        powerUpCosts {\n          ... on UserPowerUpCostsType {\n            private {\n              cycles\n              explanation\n            }\n          }\n        }\n      }\n    }\n    repl(id: $replId) {\n      __typename\n      ... on Repl {\n        id\n        powerUpCosts {\n          ... on PowerUpCostsType {\n            boost {\n              cycles\n              explanation\n            }\n            alwaysOn {\n              cycles\n              explanation\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return g=function(){return e},e}function b(){var e=(0,i.Z)(["\n  mutation WorkspaceHeaderReplInfoUnpublishTemplate(\n    $input: DeleteReplDeploymentInput!\n  ) {\n    deleteReplDeployment(input: $input) {\n      ... on Repl {\n        id\n        ...PublishReplData\n      }\n    }\n  }\n  ","\n"]);return b=function(){return e},e}function x(){var e=(0,i.Z)(["\n  mutation WorkspaceHeaderReplInfoBoostRepl($replId: String!) {\n    boostRepl(replId: $replId) {\n      ... on ReplBoost {\n        id\n        repl {\n          id\n          ...WorkspaceHeaderReplInfoRepl\n        }\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return x=function(){return e},e}function Z(){var e=(0,i.Z)(["\n  mutation WorkspaceHeaderReplInfoUnboostRepl($replId: String!) {\n    unboostRepl(replId: $replId) {\n      ... on ReplBoost {\n        id\n        repl {\n          id\n          ...WorkspaceHeaderReplInfoRepl\n        }\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return Z=function(){return e},e}function y(){var e=(0,i.Z)(["\n  mutation WorkspaceHeaderReplInfoUpdateRepl($input: UpdateReplInput!) {\n    updateRepl(input: $input) {\n      repl {\n        id\n        ...WorkspaceHeaderReplInfoRepl\n      }\n    }\n  }\n  ","\n"]);return y=function(){return e},e}function w(){var e=(0,i.Z)(["\n  mutation WorkspaceHeaderReplInfoDeleteRepl($id: String!) {\n    deleteRepl(id: $id) {\n      id\n    }\n  }\n"]);return w=function(){return e},e}function k(){var e=(0,i.Z)(["\n  mutation WorkspaceHeaderReplInfoSetAlwaysOn(\n    $replId: ID!\n    $enabled: Boolean!\n  ) {\n    setAlwaysOn(replId: $replId, enabled: $enabled) {\n      ... on Repl {\n        id\n        ...WorkspaceHeaderReplInfoRepl\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return k=function(){return e},e}function E(){var e=(0,i.Z)(["\n  mutation WorkspaceHeaderReplInfoSetGpu($replId: ID!, $enabled: Boolean!) {\n    setGpu(replId: $replId, enabled: $enabled) {\n      ... on Repl {\n        id\n        ...WorkspaceHeaderReplInfoRepl\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return E=function(){return e},e}function S(){var e=(0,i.Z)(["\n  mutation WorkspaceHeaderReplInfoSetGuaranteedProvisioningSku(\n    $replId: ID!\n    $sku: SKU!\n  ) {\n    setGuaranteedProvisioningSku(\n      replId: $replId\n      guaranteedProvisioningSku: $sku\n    ) {\n      ... on Repl {\n        id\n        ...WorkspaceHeaderReplInfoRepl\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return S=function(){return e},e}var C={},T=(0,a.ZP)(h(),o._,c.s,s.sY,d),R=(0,a.ZP)(m(),T);function _(e){var t=(0,r.Z)({},C,e);return p.useQuery(R,t)}var I=(0,a.ZP)(v());function P(e){var t=(0,r.Z)({},C,e);return p.useQuery(I,t)}var D=(0,a.ZP)(g());function A(e){var t=(0,r.Z)({},C,e);return p.useQuery(D,t)}var N=(0,a.ZP)(b(),f.FW);function U(e){var t=(0,r.Z)({},C,e);return p.useMutation(N,t)}var j=(0,a.ZP)(x(),T);function B(e){var t=(0,r.Z)({},C,e);return p.useMutation(j,t)}var O=(0,a.ZP)(Z(),T);function G(e){var t=(0,r.Z)({},C,e);return p.useMutation(O,t)}var L=(0,a.ZP)(y(),T);function M(e){var t=(0,r.Z)({},C,e);return p.useMutation(L,t)}var z=(0,a.ZP)(w());function F(e){var t=(0,r.Z)({},C,e);return p.useMutation(z,t)}var X=(0,a.ZP)(k(),T);function W(e){var t=(0,r.Z)({},C,e);return p.useMutation(X,t)}var H=(0,a.ZP)(E(),T);function V(e){var t=(0,r.Z)({},C,e);return p.useMutation(H,t)}var $=(0,a.ZP)(S(),T);function q(e){var t=(0,r.Z)({},C,e);return p.useMutation($,t)}},55966:function(e,t,n){n.d(t,{Z:function(){return ht}});var r=n(47568),i=n(14924),a=n(26042),o=n(69396),c=n(10253),s=n(34051),l=n.n(s),u=n(35944),d=n(60536),f=n.n(d),p=n(67294),h=n(92876),m=n(57263),v=n(56919),g=n(11163),b=n(57208),x=n(90317),Z=n(40577),y=n(30439),w=n(9614),k=n(65975),E=n(60368),S=n(93058),C=n(57704),T=n(74591),R=n(17556),_=n(18757),I=n(88046),P=n(33319),D=n(82893),A=n(64184),N=n(37424),U=n(6625),j=n(59369),B=n(83074),O=n(59292),G=n(71471),L=n(64080),M=n(77365),z=n(60459),F=n(19526),X=n(49619),W=n(62722),H=n(7657);function V(e){var t=p.useRef(null),n=(0,c.Z)(p.useState(e.value),2),r=n[0],i=n[1],a=(0,c.Z)(p.useState(null),2),o=a[0],s=a[1],l=(0,z.Z)({onUpload:function(t){var n=t.url;e.onChange(n)},onUploadPreview:function(e){var t=e.dataUrl;i(t)},onError:function(e){s(e.message)}});p.useEffect((function(){i(e.value)}),[e.value]);var d=null===r||void 0===r?void 0:r.startsWith("data:"),h=32;return(0,u.BX)(F.gC,{spacing:"var(--space-4)",children:[(0,u.BX)("div",{onClick:function(){var e;null===(e=t.current)||void 0===e||e.click()},"aria-label":r?"Change icon":"Upload an icon","data-microtip-position":"right",role:"tooltip",className:f().dynamic([["5de27f185cb9bc33",[h,h]]])+" "+((r?"update-icon":"add-icon")||""),children:[r?(0,u.BX)(u.HY,{children:[(0,u.tZ)(G.Z,{iconUrl:r,size:h,alt:"icon"}),d?(0,u.tZ)("div",{className:f().dynamic([["5de27f185cb9bc33",[h,h]]])+" loading-state",children:(0,u.tZ)("div",{className:f().dynamic([["5de27f185cb9bc33",[h,h]]])+" loading-icon",children:(0,u.tZ)(M.Z,{})})}):(0,u.tZ)("div",{className:f().dynamic([["5de27f185cb9bc33",[h,h]]])+" hover-state",children:(0,u.tZ)(L.Z,{})})]}):(0,u.tZ)(X.Z,{}),(0,u.tZ)("input",{ref:t,accept:W.W9.join(","),type:"file",onChange:function(e){var t=e.target,n=t.validity,r=t.files;n.valid&&(null===r||void 0===r?void 0:r.length)&&(s(null),l.uploadImage(r[0],H.N.TemplateIcon))},className:f().dynamic([["5de27f185cb9bc33",[h,h]]])})]}),o?(0,u.tZ)("div",{className:f().dynamic([["5de27f185cb9bc33",[h,h]]])+" error",children:o}):null,(0,u.tZ)(f(),{id:"5de27f185cb9bc33",dynamic:[h,h],children:".add-icon.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;border:1px dashed var(--foreground-dimmest);background-color:var(--background-root);width:".concat(h,"px;height:").concat(h,"px}.add-icon.__jsx-style-dynamic-selector:hover{color:var(--accent-primary-default);border-color:var(--accent-primary-default)}.add-icon.__jsx-style-dynamic-selector,.update-icon.__jsx-style-dynamic-selector{position:relative;cursor:pointer;background-color:var(--background-higher);-webkit-border-radius:var(--border-radius-4);-moz-border-radius:var(--border-radius-4);border-radius:var(--border-radius-4);padding:2px}.update-icon.__jsx-style-dynamic-selector:hover .hover-state.__jsx-style-dynamic-selector{opacity:.8}.hover-state.__jsx-style-dynamic-selector{opacity:0}.loading-state.__jsx-style-dynamic-selector{opacity:.8}.loading-icon.__jsx-style-dynamic-selector{-webkit-animation:rotate 1s linear infinite;-moz-animation:rotate 1s linear infinite;-o-animation:rotate 1s linear infinite;animation:rotate 1s linear infinite;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center}@-webkit-keyframes rotate{from{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes rotate{from{-moz-transform:rotate(0deg);transform:rotate(0deg)}to{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes rotate{from{-o-transform:rotate(0deg);transform:rotate(0deg)}to{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes rotate{from{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}.hover-state.__jsx-style-dynamic-selector,.loading-state.__jsx-style-dynamic-selector{color:var(--accent-primary-default);position:absolute;top:0;left:0;width:100%;height:100%;-webkit-border-radius:var(--border-radius-4);-moz-border-radius:var(--border-radius-4);border-radius:var(--border-radius-4);background-color:var(--background-root);overflow:hidden;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center}input.__jsx-style-dynamic-selector{opacity:0;position:absolute;top:0;left:0;width:100%;height:100%;z-index:-1}.error.__jsx-style-dynamic-selector{font-size:var(--font-size-default);color:var(--accent-negative-default)}")})]})}var $=n(58086),q=n(98202),Q=n(68368),K=n(80658),Y=n(99900),J=n(37838),ee=n(87238),te=n(75240),ne=n(58809),re=n(45528);function ie(e){return ae.apply(this,arguments)}function ae(){return(ae=(0,r.Z)(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",oe(t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function oe(e){return ce.apply(this,arguments)}function ce(){return ce=(0,r.Z)(l().mark((function e(t){var n,r=arguments;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:1,e.prev=1,e.next=4,se(t);case 4:e.next=11;break;case 6:if(e.prev=6,e.t0=e.catch(1),!(n>5)){e.next=10;break}throw e.t0;case 10:setTimeout((function(){oe(t,n+1)}),1e3*(Math.pow(2,n)-1));case 11:case"end":return e.stop()}}),e,null,[[1,6]])}))),ce.apply(this,arguments)}function se(e){return le.apply(this,arguments)}function le(){return(le=(0,r.Z)(l().mark((function e(t){var n,r,i,a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(0,te.Z)({onUnrecoverableError:function(e){throw new Error("Failed to create temporary goval connection. Received error ".concat(e.message))}}),ne.l){e.next=4;break}throw n.destroy(),new Error("Expected Apollo Client");case 4:return e.next=6,ne.l.query({query:ee.Pk,variables:{id:t}});case 6:if("Repl"===(r=e.sent.data).repl.__typename){e.next=10;break}throw n.destroy(),new Error("Failed to query repl info when creating temporary connection");case 10:return i=r.currentUser,a=r.repl,e.abrupt("return",new Promise((function(e){n.onConnectionStateChanged((function(t){t===te.e.CONNECTED&&(n.destroy(),e())})),n.connect({context:(0,re.U)({repl:a,currentUser:i})})})));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ue,de,fe=n(519),pe=n(13331),he=n(14317),me=n(81255),ve=n(89149);!function(e){e.Standard="standard",e.Boosted0="boosted_0",e.Boosted1="boosted_1",e.Boosted2="boosted_2",e.Boosted3="boosted_3",e.Boosted4="boosted_4"}(ue||(ue={}));var ge,be,xe,Ze=(de={},(0,i.Z)(de,0,ue.Standard),(0,i.Z)(de,1,ue.Boosted0),(0,i.Z)(de,2,ue.Boosted1),(0,i.Z)(de,3,ue.Boosted2),(0,i.Z)(de,4,ue.Boosted3),(0,i.Z)(de,5,ue.Boosted4),de),ye=(ge={},(0,i.Z)(ge,ue.Standard,0),(0,i.Z)(ge,ue.Boosted0,1),(0,i.Z)(ge,ue.Boosted1,2),(0,i.Z)(ge,ue.Boosted2,3),(0,i.Z)(ge,ue.Boosted3,4),(0,i.Z)(ge,ue.Boosted4,5),ge),we=(be={},(0,i.Z)(be,ue.Standard,"Your Repl is running at basic speeds"),(0,i.Z)(be,ue.Boosted0,"Your Repl is running 2x faster"),(0,i.Z)(be,ue.Boosted1,"Your Repl is running 4x faster"),(0,i.Z)(be,ue.Boosted2,"Your Repl is running 8x faster"),(0,i.Z)(be,ue.Boosted3,"Your Repl is running 12x faster"),(0,i.Z)(be,ue.Boosted4,"Your Repl is running at absurd speeds"),be),ke=(xe={},(0,i.Z)(xe,ue.Standard,"0.5 vCPU, 0.5 GiB RAM"),(0,i.Z)(xe,ue.Boosted0,"1 vCPU, 2 GiB RAM"),(0,i.Z)(xe,ue.Boosted1,"2 vCPU, 4 GiB RAM"),(0,i.Z)(xe,ue.Boosted2,"4 vCPU, 8 GiB RAM"),(0,i.Z)(xe,ue.Boosted3,"6 vCPU, 12 GiB RAM"),(0,i.Z)(xe,ue.Boosted4,"8 vCPU, 16 GiB RAM"),xe);function Ee(e){var t=e.isAlwaysOn,n=e.isBoosted,r=e.isGpu,i=e.canGpu,a=e.guaranteedProvisioningSku,o=e.canGuaranteedProvisioning,c=e.onBoostChange,s=e.onAlwaysOnChange,l=e.onGpuChange,d=e.onGuaranteedProvisioningSkuChange;return(0,u.BX)(k.G7,{css:[me.l0.colWithGap(16)],children:[(0,u.BX)(k.G7,{css:[me.l0.display.flex,me.l0.flex.row,me.l0.align.center,me.l0.justify.spaceBetween],children:[(0,u.BX)(k.G7,{css:[me.l0.colWithGap(8)],children:[(0,u.BX)(k.G7,{css:[me.l0.rowWithGap(8),me.l0.align.center],children:[(0,u.tZ)(he.Z,{size:16})," ",(0,u.tZ)(k.xv,{variant:"subheadDefault",children:ve.S["always-on"].name})]}),(0,u.tZ)(k.xv,{color:"dimmer",children:ve.S["always-on"].description})]}),(0,u.tZ)(fe.Z,{dataCy:"ws-always-on-toggle",isOn:t,onChange:s})]}),(0,u.BX)(k.G7,{css:[me.l0.display.flex,me.l0.flex.row,me.l0.align.center,me.l0.justify.spaceBetween],children:[(0,u.BX)(k.G7,{css:[me.l0.colWithGap(8)],children:[(0,u.BX)(k.G7,{css:[me.l0.rowWithGap(8),me.l0.align.center],children:[(0,u.tZ)(pe.Z,{size:16})," ",(0,u.tZ)(k.xv,{variant:"subheadDefault",children:ve.S.boost.name})]}),(0,u.tZ)(k.xv,{color:"dimmer",children:ve.S.boost.description})]}),(0,u.tZ)(fe.Z,{dataCy:"ws-boost-toggle",isOn:n,onChange:c})]}),i&&(0,u.BX)(k.G7,{css:[me.l0.display.flex,me.l0.flex.row,me.l0.align.center,me.l0.justify.spaceBetween],children:[(0,u.BX)(k.G7,{css:[me.l0.colWithGap(8)],children:[(0,u.BX)(k.G7,{css:[me.l0.rowWithGap(8),me.l0.align.center],children:[(0,u.tZ)(pe.Z,{size:16})," ",(0,u.tZ)(k.xv,{variant:"subheadDefault",children:"GPU"})]}),(0,u.tZ)(k.xv,{color:"dimmer",children:"Add a GPU to the Repl"})]}),(0,u.tZ)(fe.Z,{dataCy:"ws-gpu-toggle",isOn:r,onChange:l})]}),o&&(0,u.BX)(k.G7,{css:[me.l0.colWithGap(8),me.l0.justify.spaceBetween],children:[(0,u.BX)(k.G7,{css:[me.l0.rowWithGap(8)],children:[(0,u.tZ)(pe.Z,{size:16})," ",(0,u.tZ)(k.xv,{variant:"subheadDefault",children:"Extra Boosts"}),(0,u.tZ)(k.G7,{css:[me.l0.width(32)]}),(0,u.tZ)("input",{css:me.l0.flex.grow(1),type:"range",min:"0",max:"5","data-cy":"ws-guaranteed-provisioning-slider",value:ye[a],onChange:function(e){var t=e.currentTarget.value;d(Ze[parseInt(t,10)])}})]}),(0,u.tZ)(k.xv,{color:"dimmer",children:we[a]}),(0,u.tZ)(k.xv,{color:"dimmer",children:ke[a]})]})]})}var Se=n(97838),Ce=n(88205),Te=n(20177),Re=n(10449),_e=n(20861),Ie=n(86292),Pe=n(67629),De=n(75597),Ae=n(30992),Ne=n(88961),Ue=n(18048),je=n(7297),Be=n(31230),Oe=n(46829);function Ge(){var e=(0,je.Z)(["\n  query PendingChanges($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        deployment {\n          id\n          activeRelease {\n            id\n            pendingChanges {\n              fileName\n              changeType\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return Ge=function(){return e},e}var Le={},Me=(0,Be.ZP)(Ge());function ze(e){var t,n,r=function(e){var t=(0,a.Z)({},Le,e);return Oe.useQuery(Me,t)}({variables:{replId:e.replId},fetchPolicy:"cache-and-network"}),i=r.data,o=r.loading,c=r.error;if(o)return{loading:o,pendingChanges:null,error:null};if(c)return{loading:!1,pendingChanges:null,error:c};var s="Repl"===(null===i||void 0===i?void 0:i.repl.__typename)?i.repl:null;return s?{loading:!1,pendingChanges:(null===(t=s.deployment)||void 0===t||null===(n=t.activeRelease)||void 0===n?void 0:n.pendingChanges)||[],error:c}:{loading:!1,pendingChanges:null,error:new Error("Repl not found")}}var Fe=n(40914);function Xe(){var e=(0,je.Z)(["\n  mutation RevertTemplateRelease($input: RevertReplReleaseInput!) {\n    revertReplRelease(input: $input) {\n      ... on Repl {\n        id\n      }\n      ... on UserError {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n  }\n"]);return Xe=function(){return e},e}var We={},He=(0,Be.ZP)(Xe());function Ve(e){if(!e.data)return null;var t=e.data;if("revertReplRelease"in t){if("NotFoundError"===t.revertReplRelease.__typename||"UnauthorizedError"===t.revertReplRelease.__typename||"UserError"===t.revertReplRelease.__typename)return t.revertReplRelease.message;if("Repl"!==t.revertReplRelease.__typename)return"Something went wrong reverting your Template"}}function $e(){var e=(0,c.Z)(function(e){var t=(0,a.Z)({},We,e);return Oe.useMutation(He,t)}({refetchQueries:["ReplEnvironmentHeader"]}),2),t=e[0];function n(){return(n=(0,r.Z)(l().mark((function e(n){var r,i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.input,e.next=3,t({variables:{input:r}});case 3:return i=e.sent,e.abrupt("return",{data:i.data,error:Ve(i)});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return{revertTemplateRelease:function(e){return n.apply(this,arguments)},state:e[1]}}var qe=n(63736),Qe=n(79064),Ke=n(48551),Ye=n(17847),Je=n(61193),et=(0,k.KD)("form");function tt(e){if(0===e.length)return{message:"You cannot leave this empty."}}function nt(e){var t,n,r=e.changeType;return r===x.J5.NewFile?(t=k.TV.accentPositiveStronger,n="Added"):r===x.J5.DeletedFile?(t=k.TV.accentNegativeStronger,n="Deleted"):(t=k.TV.foregroundDefault,n="Changed"),(0,u.tZ)(k.xv,{variant:"small",css:[{color:t}],children:n})}function rt(e){var t=e.pendingChangesState;if(t.loading)return(0,u.tZ)(k.G7,{css:[k.l0.center],children:(0,u.tZ)(M.Z,{})});if(t.error)return(0,u.tZ)(k.E_,{icon:(0,u.tZ)(Ne.Z,{}),text:t.error.message||"Could not load modified files - please try again.",colorway:"negative"});if(!t.pendingChanges||0===t.pendingChanges.length)return(0,u.tZ)(k.xv,{multiline:!0,children:"No changes to publish. Come back when you have made changes to your Repl."});var n=t.pendingChanges,r=n.slice(0,15);return(0,u.BX)(k.G7,{css:[{display:"grid",gridTemplateColumns:"1fr 1fr",gap:k.TV.space8}],children:[r.map((function(e){return(0,u.BX)(p.Fragment,{children:[(0,u.BX)(k.G7,{css:[k.l0.rowWithGap(4),k.l0.align.center],children:[(0,u.tZ)(qe.Z,{size:12,path:e.fileName}),(0,u.tZ)(k.xv,{children:e.fileName})]},e.fileName),(0,u.tZ)(nt,{changeType:e.changeType})]},e.fileName)})),n.length>r.length&&(0,u.BX)(k.xv,{children:["And ",n.length-r.length," other files..."]})]})}function it(e){var t=e.repl,n=$e(),i=function(){var e=(0,r.Z)(l().mark((function e(r){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.revertTemplateRelease({input:{replId:t.id,releaseId:r}});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,u.BX)(k.G7,{children:[(0,u.tZ)(k.h4,{level:1,variant:"subheadBig",css:[k.l0.mb(16)],children:"Existing Releases"}),(0,u.tZ)(k.G7,{css:[{display:"grid",gridTemplateColumns:"2fr 3fr 1fr",gap:k.TV.space8}],children:t.releases.items.map((function(e){var n,r;return(0,u.BX)(p.Fragment,{children:[(0,u.tZ)("span",{children:(0,Ye.Z)(new Date(e.timeCreated),"do MMM, hh:mm a")}),(0,u.tZ)("span",{children:e.description}),(0,u.tZ)("span",{style:{justifySelf:"end"},children:e.id===(null===(n=t.deployment)||void 0===n||null===(r=n.activeRelease)||void 0===r?void 0:r.id)?(0,u.tZ)("span",{css:[k.l0.p(4),{display:"flex"}],children:"(active)"}):(0,u.tZ)(k.zx,{text:"revert",colorway:"primary",small:!0,onClick:function(t){t.preventDefault(),i(e.id)}})})]},e.id)}))})]})}function at(e){var t,n,i=e.repl,s=(0,N.H)(),d=(0,c.Z)(p.useState(!1),2),f=d[0],h=d[1],m=(0,c.Z)(p.useState(!1),2),v=m[0],g=m[1],b=function(e){var t=ze({replId:e.replId}),n=p.useMemo((function(){if(!t.pendingChanges)return[];var e=t.pendingChanges.slice().sort((function(e,t){return e.fileName.localeCompare(t.fileName)})).map((function(e){return{file:e,pathDepth:(0,Ke.U$)(e.fileName)}})).sort((function(e,t){return e.pathDepth-t.pathDepth})).map((function(e){return e.file}));return e}),[t.pendingChanges]);return(0,o.Z)((0,a.Z)({},t),{pendingChanges:n})}({replId:i.id}),x=(0,Fe.r)(),Z=(0,Ae.Y)("",tt),y=0!==(null===(t=b.pendingChanges)||void 0===t?void 0:t.length),w=Boolean(Z.error||!y||x.loading),E=(0,Je.c)("flag-revert-template-release"),S=E.enabled,C=(E.loading,S&&i.releases.items.length>1),T="";return Z.error?T="Please fill out the form":y||(T="No changes to publish in this release"),f?(0,u.tZ)(Qe.q,{repl:i,isUpdate:!0}):v?(0,u.tZ)(k.G7,{css:[k.l0.p(16),k.l0.colWithGap(16)],children:(0,u.tZ)(it,{repl:i})}):(0,u.BX)(et,{onSubmit:function(){var e=(0,r.Z)(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!w&&!Z.validate()){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,x.createRelease({input:{replId:i.id,description:Z.value}});case 5:if(!e.sent.error){e.next=8;break}return e.abrupt("return");case 8:h(!0);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),css:[k.l0.colWithGap(24)],children:[(0,u.tZ)(k.h4,{level:1,variant:"headerDefault",children:"Publish a new release"}),(0,u.BX)(k.G7,{css:[k.l0.colWithGap(8)],children:[(0,u.tZ)(k.h4,{level:2,variant:"subheadDefault",children:"Modified files"}),(0,u.tZ)(rt,{pendingChangesState:b})]}),!b.loading&&b.pendingChanges.length>0&&(0,u.BX)(k.G7,{css:[k.l0.colWithGap(4)],children:[(0,u.tZ)("label",{htmlFor:s("description"),css:[k.l0.color.foregroundDimmer,{fontSize:k.TV.fontSizeSmall,lineHeight:k.TV.lineHeightSmall}],children:"Description"}),(0,u.tZ)(k.B,{id:s("description"),onChange:function(e){return Z.setValue(e.target.value)},css:[k.l0.width("100%"),k.l0.minHeight(64),k.l0.maxHeight(128),{resize:"vertical"}],placeholder:"Explain what has changed about your template"}),Z.error&&(0,u.tZ)(k.E_,{icon:(0,u.tZ)(Ne.Z,{}),text:null===(n=Z.error)||void 0===n?void 0:n.message,colorway:"negative"})]}),(0,u.tZ)(k.G7,{children:x.error&&(0,u.tZ)(k.E_,{icon:(0,u.tZ)(Ne.Z,{}),text:x.error,colorway:"negative"})}),(0,u.BX)(k.G7,{css:[k.l0.rowWithGap(12),k.l0.justify.end],children:[C&&(0,u.tZ)(k.zx,{text:"Revert to older",colorway:"negative",onClick:function(){return g(!0)}}),(0,u.tZ)(k.u,{tooltip:T,placement:"bottom",isDisabled:!T,children:(0,u.tZ)(k.zx,{text:"Publish release",type:"submit",colorway:"primary",iconLeft:(0,u.tZ)(Ue.Z,{}),disabled:w})})]})]})}var ot,ct,st,lt=n(6600),ut=n(63377),dt={query:w.s8},ft={query:Z.eT},pt={query:y.BW};function ht(e){var t=e.setIsEditing,n=e.showCloseButton,r=(0,ut.Z)(),i=(0,Z.BZ)({variables:{replId:r}}),a=i.data,o=i.refetch,c="Repl"===(null===a||void 0===a?void 0:a.repl.__typename)?a.repl:null;return c?(0,u.tZ)(mt,{setIsEditing:t,showCloseButton:n,repl:c,refetch:o}):(0,u.tZ)(k.G7,{css:[k.l0.center,k.l0.p(16)],children:(0,u.tZ)(M.Z,{})})}function mt(e){var t,n,i,s,d,y,w=e.repl,G=e.showCloseButton,M=e.setIsEditing,z=(0,g.useRouter)(),F=(0,c.Z)(p.useState(!1),2),W=F[0],H=F[1],ee=(0,c.Z)(p.useState(null),2),te=ee[0],ne=ee[1],re=(0,c.Z)(p.useState(null),2),ae=re[0],oe=re[1],ce=(0,c.Z)(p.useState(w.isBoosted),2),se=ce[0],le=ce[1],ue=(0,c.Z)(p.useState(w.hasGpu),2),de=ue[0],fe=ue[1],pe=(0,c.Z)(p.useState(w.guaranteedProvisioningSku),2),he=pe[0],me=pe[1],ve=(0,c.Z)(p.useState(w.isRenamed?w.title:""),2),ge=ve[0],be=ve[1],xe=(0,c.Z)(p.useState(w.description||""),2),Ze=xe[0],ye=xe[1],we=(0,c.Z)(p.useState(w.rawTemplateLabel),2),ke=we[0],Ae=we[1],Ne=(0,_e.Z)({forceFetch:!1}).cycles,Ue=(0,Z.zu)().data,je=(0,S.Z)().showError,Be=w.publishedAs===x.O2.Template,Oe=Boolean(w.publishedAs);p.useEffect((function(){ye(w.description||"")}),[w.description]);var Ge=(0,U.Z)(),Le=p.useRef(w),Me=(0,c.Z)((0,Z.ap)({variables:{id:w.id},onCompleted:function(){return z.push("/home","/~")},update:(0,v.t)({id:w.id}),onError:function(e){return je((0,b.Z)(e.message))}}),1)[0],ze=(0,c.Z)((0,Z.vi)({onError:function(e){return je((0,b.Z)(e.message))},onCompleted:function(e){var t=e.updateRepl.repl,n=Le.current,r={};n.description!==t.description&&(r.description=t.description),n.title!==t.title&&(r.title=t.title),n.url!==t.url&&(r.url=t.url),n.isRenamed!==t.isRenamed&&(r.isRenamed=!!t.isRenamed),Le.current=w,Object.keys(r).length>0&&M(!1)}}),2),Fe=ze[0],Xe=ze[1].loading,We=(0,c.Z)((0,O.Z)(),2),He=We[0],Ve=We[1].loading,$e=(0,c.Z)((0,Z.pr)({onCompleted:function(e){"UserError"===e.setAlwaysOn.__typename&&je(e.setAlwaysOn.message)},onError:function(e){return je((0,b.Z)(e.message))},refetchQueries:[dt,(0,o.Z)((0,a.Z)({},ft),{variables:{replId:w.id}}),pt]}),2),qe=$e[0],Qe=$e[1].loading,Ke=(0,c.Z)((0,Z.Bj)({variables:{replId:w.id},onCompleted:function(e){var t=e.boostRepl;"UserError"!==t.__typename?(ie(w.id).catch((function(e){h.Tb(e),Ge.current&&je("Something went wrong when boosting your repl. Please refresh or try again.")})),Ge.current&&le(!0)):je(t.message)},onError:function(e){h.Tb(e),je((0,b.Z)(e.message))},refetchQueries:[dt,(0,o.Z)((0,a.Z)({},ft),{variables:{replId:w.id}}),pt]}),2),Ye=Ke[0],Je=Ke[1].loading,et=(0,c.Z)((0,Z.vN)({onCompleted:function(e){"UserError"!==e.setGpu.__typename&&"UnauthorizedError"!==e.setGpu.__typename?(ie(w.id).catch((function(e){h.Tb(e),Ge.current&&je("Something went wrong when boosting your repl. Please refresh or try again.")})),Ge.current&&"Repl"===e.setGpu.__typename&&fe(e.setGpu.hasGpu)):je(e.setGpu.message)},onError:function(e){return je((0,b.Z)(e.message))}}),2),tt=et[0],nt=et[1].loading,rt=(0,c.Z)((0,Z.NB)({onCompleted:function(e){"UserError"!==e.setGuaranteedProvisioningSku.__typename&&"UnauthorizedError"!==e.setGuaranteedProvisioningSku.__typename?(ie(w.id).catch((function(e){h.Tb(e),Ge.current&&je("Something went wrong when boosting your repl. Please refresh or try again.")})),Ge.current&&"Repl"===e.setGuaranteedProvisioningSku.__typename&&me(e.setGuaranteedProvisioningSku.guaranteedProvisioningSku)):je(e.setGuaranteedProvisioningSku.message)},onError:function(e){return je((0,b.Z)(e.message))}}),2),it=rt[0],st=rt[1].loading,ut=w.currentUserPermissions.publish,ht=!(null===w||void 0===w?void 0:w.publishedAs),mt=(null===w||void 0===w?void 0:w.publishedAs)===x.O2.RegularRepl,vt=(0,c.Z)((0,Z.gF)({variables:{input:{replId:w.id}},onError:function(e){h.Tb(e),je((0,b.Z)(e.message))}}),2),xt=vt[0],Zt=vt[1],yt=(0,c.Z)((0,Z.cr)({variables:{replId:w.id},onCompleted:function(e){var t=e.unboostRepl;"UserError"!==t.__typename?(ie(w.id).catch((function(e){h.Tb(e),Ge.current&&je("Something went wrong when unboosting your Repl. Please refresh or try again.")})),Ge.current&&le(!1)):je(t.message)},onError:function(e){h.Tb(e),je((0,b.Z)(e.message))},refetchQueries:[(0,o.Z)((0,a.Z)({},ft),{variables:{replId:w.id}}),pt]}),2),wt=yt[0],kt=yt[1].loading,Et=(0,Z.U5)({variables:{replId:w.id}}),St=Et.data,Ct=Et.loading,Tt=Et.error,Rt=p.useMemo((function(){return!(!ge||ge===w.title)||(ke!==w.rawTemplateLabel||!(""===Ze&&!w.description)&&Ze!==w.description)}),[w,ge,Ze,ke]),_t=p.useCallback((function(){if(Rt){var e={id:w.id,title:ge||w.title,description:Ze,templateLabel:w.currentUserPermissions.changeTemplateLabel?ke:void 0};Fe({variables:{input:e}})}}),[Rt,Fe,w,ge,Ze,ke]),It=W||null!==te||Ve,Pt=(0,R.Z)((function(){It||(Rt?_t():M(!1))}),[It,Rt,_t]),Dt=p.useContext(q.G).isGooglePlayStoreTWA,At=function(e){switch(e){case"boost":return"Repl"===(null===St||void 0===St?void 0:St.repl.__typename)&&"PowerUpCostsType"===St.repl.powerUpCosts.__typename?St.repl.powerUpCosts.boost.explanation:null;case"always-on":return"Repl"===(null===St||void 0===St?void 0:St.repl.__typename)&&"PowerUpCostsType"===St.repl.powerUpCosts.__typename?St.repl.powerUpCosts.alwaysOn.explanation:null;case"private":var t,n,r;return"UserPowerUpCostsType"===(null===St||void 0===St||null===(t=St.currentUser)||void 0===t?void 0:t.powerUpCosts.__typename)?null===(n=St.currentUser.powerUpCosts)||void 0===n||null===(r=n.private)||void 0===r?void 0:r.explanation:null;default:(0,Re.Z)(e)}},Nt=function(){Fe({variables:{input:{id:w.id,isPrivate:!w.isPrivate}},optimisticResponse:{updateRepl:{__typename:"UpdateReplPayload",repl:(0,o.Z)((0,a.Z)({},w),{isPrivate:!w.isPrivate})}},refetchQueries:[dt,(0,o.Z)((0,a.Z)({},ft),{variables:{replId:w.id}}),pt]}),(0,Ie.j)(Ie.U3.PRIVATE_TOGGLED,{enabled:!w.isPrivate,source:"workspace_info_modal"})},Ut=function(){if(!Qe){var e=!w.isAlwaysOn;qe({variables:{replId:w.id,enabled:e},optimisticResponse:{setAlwaysOn:(0,o.Z)((0,a.Z)({__typename:"Repl"},w),{isAlwaysOn:e})}})}},jt=function(){(0,Ie.j)(Ie.U3.BOOST_TOGGLED,{enabled:!se}),se?wt():Ye()},Bt=function(){if(!nt){var e=!de;tt({variables:{replId:w.id,enabled:e},optimisticResponse:{setGpu:(0,o.Z)((0,a.Z)({__typename:"Repl"},w),{hasGpu:e})}})}},Ot=w.isRenamed?"Name your Repl":"Default name: ".concat(w.title),Gt=[x.Sy.Submit,x.Sy.PublishTemplate,x.Sy.EditTemplate].includes(w.workspaceCta),Lt=[];w.currentUserPermissions.fork&&Lt.push({value:ot.Fork,label:"Fork",icon:(0,u.tZ)(B.Z,{})}),w.publishedAs===x.O2.RegularRepl&&ut&&Lt.push({value:ot.Unpublish,label:"Unpublish",icon:(0,u.tZ)(A.Z,{})}),Be&&ut&&Lt.push({value:ot.UnpublishTemplate,label:"Unpublish template",icon:(0,u.tZ)(A.Z,{})}),Oe&&ut&&Lt.push({value:ot.EditPublishSettings,label:"Edit Publish Settings",icon:(0,u.tZ)(L.Z,{})}),w.currentUserPermissions.delete&&Lt.push({isDestructive:!0,value:ot.Delete,label:"Delete",icon:(0,u.tZ)(C.Z,{})});var Mt,zt=(0,N.H)(),Ft=(null===Ue||void 0===Ue||null===(t=Ue.currentUser)||void 0===t?void 0:t.id)===(null===(n=w.user)||void 0===n?void 0:n.id),Xt=0===Ne&&Ft&&!0!==(null===Ue||void 0===Ue||null===(i=Ue.currentUser)||void 0===i?void 0:i.isHacker),Wt=Ft&&!0===(null===Ue||void 0===Ue||null===(s=Ue.currentUser)||void 0===s?void 0:s.hasGpuAvailableGate),Ht=Ft&&!0===(null===Ue||void 0===Ue||null===(d=Ue.currentUser)||void 0===d?void 0:d.hasGuaranteedProvisioningAvailableGate);return(0,u.BX)("div",{ref:Pt,className:f().dynamic([["10783cb8cb49cab0",[w.currentUserPermissions.changeDescription?"auto":"not-allowed",m.j.mobileMax]]]),children:[(0,u.tZ)("form",{onSubmit:function(e){e.preventDefault(),_t()},className:f().dynamic([["10783cb8cb49cab0",[w.currentUserPermissions.changeDescription?"auto":"not-allowed",m.j.mobileMax]]]),children:(0,u.BX)(k.G7,{css:[k.l0.align.stretch,k.l0.colWithGap(16)],children:[(0,u.BX)(k.G7,{css:[k.l0.colWithGap(8)],children:[(0,u.BX)(k.G7,{css:[k.l0.flex.row,k.l0.align.center,k.l0.justify.spaceBetween],children:[(0,u.BX)(k.G7,{css:[k.l0.rowWithGap(8),k.l0.center],children:[w.currentUserPermissions.changeIconUrl&&Be?(0,u.tZ)(V,{value:w.iconUrl,onChange:function(e){return Fe({variables:{input:{id:w.id,iconUrl:e}},optimisticResponse:{updateRepl:{__typename:"UpdateReplPayload",repl:(0,o.Z)((0,a.Z)({},w),{iconUrl:e})}}})}}):null,(0,u.tZ)(k.ZP,(0,o.Z)((0,a.Z)({prefetch:!1},(0,I.j3)(w)),{iconLeft:(0,u.tZ)(_.Z,{}),colorway:"primary",text:"Cover page",target:"_blank"}))]}),(0,u.BX)(k.G7,{css:[k.l0.align.center,k.l0.rowWithGap(8)],children:[ut&&ht?(0,u.tZ)(k.u,{tooltip:"This Repl is private. You need to make it public in order to publish it!",isDisabled:!(null===w||void 0===w?void 0:w.isPrivate),children:(0,u.tZ)(k.zx,{type:"button",iconLeft:(0,u.tZ)(X.Z,{}),onClick:function(){ne(ct.Publish)},dataCy:"ws-publish-button",text:"Publish",disabled:null===w||void 0===w?void 0:w.isPrivate})}):null,Be?(0,u.tZ)(k.zx,{type:"button",iconLeft:(0,u.tZ)(X.Z,{}),onClick:function(){return ne(ct.UpdatePublishedTemplate)},text:"Update"}):null,mt?(0,u.tZ)(k.zx,{type:"button",iconLeft:(0,u.tZ)(De.Chat,{}),onClick:function(){return ne(ct.UpdatePublishedRepl)},text:"Update"}):null,Lt.length>0&&(0,u.tZ)(k.G7,{children:(0,u.tZ)(j.Z,{label:Be?"Template Actions":"Repl Actions",large:!0,items:Lt,onItemClick:function(e){switch(e.value){case ot.Fork:return void ne(ct.ForkRepl);case ot.Unpublish:return void ne(ct.Unpublish);case ot.UnpublishTemplate:return void ne(ct.UnpublishTemplate);case ot.Delete:return void ne(ct.DeleteRepl);case ot.EditPublishSettings:ne(ct.EditPublishSettings)}},onOpenChange:H})}),G?(0,u.tZ)(k.hU,{alt:"Close",tooltipHidden:!0,onClick:function(){_t(),M(!1)},children:(0,u.tZ)(Pe.Z,{})}):null]})]}),w.lastPublishedAt&&ut?(0,u.BX)(k.xv,{variant:"small",color:"dimmest",children:["Last published on"," ",new Date(w.lastPublishedAt).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})]}):null]}),(0,u.BX)(k.Tg,{background:"default",css:[k.l0.colWithGap(16)],children:[(0,u.tZ)(k.G7,{css:[k.l0.flex.column],children:(0,u.BX)(k.G7,{css:[k.l0.colWithGap(4)],children:[(0,u.BX)(k.G7,{css:[k.l0.flex.row,k.l0.justify.spaceBetween,k.l0.align.end],children:[(0,u.tZ)("label",{htmlFor:zt("name"),className:f().dynamic([["10783cb8cb49cab0",[w.currentUserPermissions.changeDescription?"auto":"not-allowed",m.j.mobileMax]]]),children:(0,u.tZ)(k.xv,{variant:"small",color:"dimmer",children:"Name"})}),(0,u.tZ)(E.Z,{maxLength:60,value:ge,hideLabel:!0})]}),(0,u.tZ)(k.II,{style:{cursor:w.currentUserPermissions.changeTitle?"auto":"not-allowed"},disabled:!w.currentUserPermissions.changeTitle,maxLength:60,placeholder:Ot,value:ge,onChange:function(e){return be(e.target.value)},spellCheck:!1,id:zt("name"),dataCy:"ws-repl-info-title-input"})]})}),(0,u.tZ)(k.G7,{css:[k.l0.flex.column],children:(0,u.BX)(k.G7,{css:[k.l0.colWithGap(4)],children:[(0,u.BX)(k.G7,{css:[k.l0.flex.row,k.l0.justify.spaceBetween,k.l0.align.end],children:[(0,u.tZ)("label",{htmlFor:zt("description"),className:f().dynamic([["10783cb8cb49cab0",[w.currentUserPermissions.changeDescription?"auto":"not-allowed",m.j.mobileMax]]]),children:(0,u.tZ)(k.xv,{variant:"small",color:"dimmer",children:"Description"})}),(0,u.tZ)(E.Z,{maxLength:$.p,value:Ze,hideLabel:!0})]}),(0,u.tZ)(k.B,{onKeyDown:function(e){13===e.keyCode&&(e.ctrlKey||e.metaKey)},disabled:!w.currentUserPermissions.changeDescription,maxLength:$.p,value:Ze,onChange:function(e){return ye(e.target.value)},placeholder:"What does this Repl do?",css:[k.l0.minHeight(96),k.l0.maxHeight(128),{resize:"vertical"}],id:zt("description")})]})})]}),Be&&w.currentUserPermissions.changeTemplateLabel&&(0,u.tZ)(k.Tg,{background:"default",css:[k.l0.colWithGap(4)],children:(0,u.BX)(k.G7,{css:[k.l0.colWithGap(4)],children:[(0,u.tZ)("label",{htmlFor:zt("template"),className:f().dynamic([["10783cb8cb49cab0",[w.currentUserPermissions.changeDescription?"auto":"not-allowed",m.j.mobileMax]]]),children:(0,u.tZ)(k.xv,{color:"dimmer",variant:"small",children:"Template label"})}),(0,u.tZ)(k.II,{value:ke,maxLength:60,placeholder:"Template label",spellCheck:!1,onChange:function(e){return Ae(e.target.value)},id:zt("template")})]})})]})}),Gt?null:(0,u.BX)(k.G7,{css:[k.l0.colWithGap(24),k.l0.p(16),k.l0.pt(0)],children:[!Dt&&Xt?(0,u.tZ)(k.zx,{iconLeft:(0,u.tZ)(Se.Z,{}),type:"button",colorway:"primary",stretch:!0,onClick:function(){(0,Ie.j)(Ie.U3.UPGRADE_SELECTED,{source:"workspace_info_modal",planID:"cycles"}),ne(ct.BuyCycles)},text:"Power Up this Repl"}):null,w.currentUserPermissions.changePrivacy===x.HA.Allowed&&(0,u.BX)(k.G7,{css:[k.l0.colWithGap(8)],children:[(0,u.BX)(k.hE,{tag:"fieldset",name:zt("privacy"),value:w.isPrivate.toString(),onChange:function(){if(!Xe)if(w.isPrivate)Nt();else{var e=At("private");if(null==e||Ct)je("You're too fast for us! Please try again in a moment.");else if(Tt)je("This action is currently unavailable. Please refresh and try again.");else{if((0,Ie.j)(Ie.U3.POWER_UP_TOGGLE_REQUESTED,{powerUp:"private",setting:!w.isPrivate,source:"workspace_info_modal",costExplanation:e}),"NEEDS_CYCLES"===e||"SPEND_CYCLES"===e)return oe("private"),void ne(ct.SpendCycles);if("INCLUDED_IN_SUBSCRIPTION"!==e&&"INCLUDED_IN_EXISTING_ORDER"!==e)throw new Error("Unexpected cost explanation for enabling private: ".concat(e));Nt()}}},row:!0,primary:!0,stretch:!0,children:[(0,u.tZ)(k.rK,{id:zt("false"),value:"false",text:"Public",icon:(0,u.tZ)(P.Z,{})}),(0,u.tZ)(k.rK,{id:zt("true"),value:"true",text:"Private",icon:(0,u.tZ)(D.Z,{})})]}),(0,u.tZ)(k.xv,{variant:"small",color:"dimmest",children:w.isPrivate?"Only you can see and edit this Repl.":"Anyone can view and fork this Repl."})]}),w.currentUserPermissions.changeAlwaysOn!==x.fn.Disallowed&&(0,u.tZ)(Ee,{isAlwaysOn:w.isAlwaysOn,isBoosted:se,isGpu:de,canGpu:Wt,guaranteedProvisioningSku:bt[he],canGuaranteedProvisioning:Ht,onAlwaysOnChange:function(){var e=At("always-on");if(null==e||Qe||Ct)je("You're too fast for us! Please try again in a moment.");else if(Tt)je("This action is currently unavailable. Please refresh and try again.");else{if((0,Ie.j)(Ie.U3.POWER_UP_TOGGLE_REQUESTED,{powerUp:"always-on",setting:!w.isAlwaysOn,source:"workspace_info_modal",costExplanation:e}),!w.isAlwaysOn&&("NEEDS_CYCLES"===e||"SPEND_CYCLES"===e))return oe("always-on"),void ne(ct.SpendCycles);Ut()}},onBoostChange:function(){var e=At("boost");if(null==e||Je||kt||Ct)je("You're too fast for us! Please try again in a moment.");else if(Tt)je("This action is currently unavailable. Please refresh and try again.");else{if((0,Ie.j)(Ie.U3.POWER_UP_TOGGLE_REQUESTED,{powerUp:"boost",setting:!se,source:"workspace_info_modal",costExplanation:e}),!se&&("NEEDS_CYCLES"===e||"SPEND_CYCLES"===e))return oe("boost"),void ne(ct.SpendCycles);jt()}},onGpuChange:function(){Bt()},onGuaranteedProvisioningSkuChange:function(e){if(!st){var t=gt[e];it({variables:{replId:w.id,sku:t},optimisticResponse:{setGuaranteedProvisioningSku:(0,o.Z)((0,a.Z)({__typename:"Repl"},w),{guaranteedProvisioningSku:t})}})}}})]}),(0,u.tZ)(k.u_,{isOpen:te===ct.DeleteRepl,onRequestClose:function(){return ne(null)},children:(0,u.tZ)(T.Z,{delete:Me,entityType:"Repl",hideModal:function(){return ne(null)}})}),(0,u.tZ)(Te.Z,{context:"workspace_info_modal",isOpen:te===ct.SpendCycles,onRequestClose:function(){return ne(null)},onRequestBuyMore:function(){return ne(ct.BuyCycles)},onRequestPowerUp:(0,r.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=ae,e.next=null===e.t0?3:"boost"===e.t0?4:"always-on"===e.t0?6:"private"===e.t0?8:10;break;case 3:return e.abrupt("break",12);case 4:return jt(),e.abrupt("break",12);case 6:return Ut(),e.abrupt("break",12);case 8:return Nt(),e.abrupt("break",12);case 10:return(0,Re.Z)(ae),e.abrupt("break",12);case 12:return e.next=14,new Promise((function(e){return setTimeout(e,3e3)}));case 14:ne(null);case 15:case"end":return e.stop()}}),e)}))),canSpend:null!=ae&&At(ae)!==x.Ch.NeedsCycles,powerUp:null!==ae&&void 0!==ae?ae:"boost"},te),(0,u.tZ)(Ce.Z,{isOpen:te===ct.BuyCycles,onRequestClose:function(){return ne(null)},uponPurchaseGoTo:"workspace",context:"workspace_info_modal",replTitle:w.title}),(0,u.tZ)(k.u_,{isOpen:te===ct.ForkRepl,onRequestClose:function(){return ne(null)},children:(0,u.tZ)(K.Z,{onFork:function(e,t,n,r){He({originId:w.id,teamId:e,title:t,description:n,isPrivate:r,forkToPersonal:!e,trackingData:{forkSource:"editReplPopoverMenuItem"}}),(0,Ie.j)(Ie.U3.REPLS_REPL_SELF_FORKED,{replId:w.id})},initialTitle:w.title,initialDescription:null!==(Mt=w.description)&&void 0!==Mt?Mt:"",initialPrivacy:w.isPrivate,hideModal:function(){return ne(null)},teamContext:null===(y=w.user)||void 0===y?void 0:y.username})}),(0,u.tZ)(k.u_,{isOpen:te===ct.Unpublish,onRequestClose:function(){return ne(null)},children:(0,u.tZ)(Y.Z,{repl:w,source:"replEnvironment",onDone:function(){ne(null)}})}),(0,u.tZ)(k.u_,{isOpen:te===ct.UnpublishTemplate,onRequestClose:function(){return ne(null)},children:(0,u.tZ)(Q.Z,{confirmLabel:"Yes, unpublish this Template",isDestructive:!0,title:"Unpublish Template",onCancel:function(){return ne(null)},onConfirm:function(){Zt.loading||(xt(),ne(null))},children:"Your Repl will no longer be discoverable on Templates. You can republish again at any time, and all of your comments or reactions will stick around."})}),(0,u.tZ)(k.u_,{isOpen:te===ct.EditPublishSettings,onRequestClose:function(){return ne(null)},noPadding:!0,maxWidth:872,fitContent:!0,children:(0,u.tZ)(J.Z,{source:"replEnvironment",replId:w.id})}),(0,u.tZ)(k.u_,{isOpen:te===ct.Publish,onRequestClose:function(){return ne(null)},noPadding:!0,maxWidth:872,fitContent:!0,children:(0,u.tZ)(J.Z,{source:"replEnvironment",replId:w.id})}),(0,u.tZ)(k.u_,{isOpen:te===ct.UpdatePublishedTemplate,onRequestClose:function(){return ne(null)},children:(0,u.tZ)(at,{repl:w})}),(0,u.tZ)(k.u_,{isOpen:te===ct.UpdatePublishedRepl,onRequestClose:function(){return ne(null)},children:(0,u.tZ)(lt.Z,{repl:w,onDone:function(){return ne(null)},source:"replEnvironment"})}),(0,u.tZ)(f(),{id:"10783cb8cb49cab0",dynamic:[w.currentUserPermissions.changeDescription?"auto":"not-allowed",m.j.mobileMax],children:"form.__jsx-style-dynamic-selector{padding:var(--space-16)}textarea.__jsx-style-dynamic-selector{min-height:42px;height:200px;resize:none;cursor:".concat(w.currentUserPermissions.changeDescription?"auto":"not-allowed",";font-size:var(--font-size-default);font-family:var(--font-family-default);padding:var(--space-8);display:block;width:100%;-webkit-border-radius:var(--border-radius-4);-moz-border-radius:var(--border-radius-4);border-radius:var(--border-radius-4);border:1px solid var(--outline-dimmest);-webkit-transition:.2s border-color;-moz-transition:.2s border-color;-o-transition:.2s border-color;transition:.2s border-color;background-color:transparent;color:var(--foreground-default)}textarea.__jsx-style-dynamic-selector:hover{border-color:var(--accent-primary-dimmer)}textarea.__jsx-style-dynamic-selector:active,textarea.__jsx-style-dynamic-selector:focus{border-color:var(--accent-primary-default)}textarea.__jsx-style-dynamic-selector:disabled{opacity:.5}textarea.__jsx-style-dynamic-selector:focus,textarea.__jsx-style-dynamic-selector:active{outline:none;border-color:var(--accent-primary-default)}.edit-repl-actions.__jsx-style-dynamic-selector{padding:0 var(--space-16)}.menu-item.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;color:var(--foreground-default)}.delete-menu-item.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;color:var(--accent-negative-default)}.icon-container.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;padding:0 var(--space-4)}.menu-text.__jsx-style-dynamic-selector{padding:0 var(--space-4)}.upgrade-button-container.__jsx-style-dynamic-selector{padding:0 var(--space-8)}.upgrade-button-container.__jsx-style-dynamic-selector .sentence-case{text-transform:none}.upgrade-text-container.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;padding:var(--space-8);-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center}.always-on-indicator.__jsx-style-dynamic-selector{margin-left:var(--space-4);margin-right:var(--space-8);width:8px;height:8px;-webkit-border-radius:100%;-moz-border-radius:100%;border-radius:100%;background-color:var(--accent-green-default);-webkit-box-shadow:0 0 12px var(--accent-green-default);-moz-box-shadow:0 0 12px var(--accent-green-default);box-shadow:0 0 12px var(--accent-green-default)}@media screen and (max-width:").concat(m.j.mobileMax,"px){.edit-repl.__jsx-style-dynamic-selector{width:80vw}}")})]})}!function(e){e.Fork="Fork",e.Delete="Delete",e.Unpublish="Unpublish",e.UnpublishTemplate="UnpublishTemplate",e.EditPublishSettings="EditPublishSettings"}(ot||(ot={})),function(e){e.DeleteRepl="DeleteRepl",e.SpendCycles="SpendCycles",e.BuyCycles="BuyCycles",e.ForkRepl="ForkRepl",e.Unpublish="Unpublish",e.UnpublishTemplate="UnpublishTemplate",e.EditPublishSettings="EditPublishSettings",e.Publish="Publish",e.UpdatePublishedTemplate="UpdatePublishedTemplate",e.UpdatePublishedRepl="UpdatePublishedRepl"}(ct||(ct={}));var vt,gt=(st={},(0,i.Z)(st,ue.Standard,x.nz.Standard),(0,i.Z)(st,ue.Boosted0,x.nz.Boosted_0),(0,i.Z)(st,ue.Boosted1,x.nz.Boosted_1),(0,i.Z)(st,ue.Boosted2,x.nz.Boosted_2),(0,i.Z)(st,ue.Boosted3,x.nz.Boosted_3),(0,i.Z)(st,ue.Boosted4,x.nz.Boosted_4),st),bt=(vt={},(0,i.Z)(vt,x.nz.Standard,ue.Standard),(0,i.Z)(vt,x.nz.Boosted_0,ue.Boosted0),(0,i.Z)(vt,x.nz.Boosted_1,ue.Boosted1),(0,i.Z)(vt,x.nz.Boosted_2,ue.Boosted2),(0,i.Z)(vt,x.nz.Boosted_3,ue.Boosted3),(0,i.Z)(vt,x.nz.Boosted_4,ue.Boosted4),vt)},36316:function(e,t,n){n.d(t,{Z:function(){return m}});var r=n(26042),i=n(69396),a=n(35944),o=(n(67294),n(41664)),c=n.n(o),s=n(82447),l=n(63805),u=n(65975),d=n(53427),f=n(70917),p=(0,u.KD)("a"),h=(0,f.iv)([u.l0.truncate,u.l0.flex.shrink(1),u.l0.color.foregroundDimmest,{fontSize:u.TV.fontSizeSmall,textDecoration:"none","&:hover":{color:u.TV.accentPrimaryDefault}}]);function m(e){var t=e.repl,n=(0,l.isMobile)({tablet:!1}),o=t.user&&!n?(0,a.tZ)(c(),(0,i.Z)((0,r.Z)({},(0,s.Ru)(t.user)),{prefetch:!1,passHref:!0,children:(0,a.tZ)(p,{onClick:function(e){return e.stopPropagation()},css:h,children:t.user.username})})):null;return(0,a.BX)(u.G7,{css:[u.l0.rowWithGap(8),u.l0.align.center,u.l0.flex.growAndShrink(1)],children:[(0,a.tZ)(u.G7,{children:(0,a.tZ)(d.ZP,{iconUrl:t.iconUrl,size:32,alt:"Repl icon"})}),(0,a.BX)(u.G7,{css:[u.l0.align.start,u.l0.flex.shrink(1)],children:[(0,a.tZ)(u.xv,{css:u.l0.flex.shrink(1),"data-cy":"header-repl-title",children:t.title}),o]})]})}},83475:function(e,t,n){n.d(t,{ZP:function(){return W},al:function(){return M},L7:function(){return X}});var r=n(14924),i=n(26042),a=n(69396),o=n(35944),c=n(67294),s=n(7297),l=n(31230),u=n(46829);function d(){var e=(0,s.Z)(["\n  query WorkspaceRunButton($id: String!) {\n    repl(id: $id) {\n      ... on Repl {\n        id\n        language\n        title\n        rootOriginReplUrl\n      }\n    }\n    currentUser {\n      id\n    }\n  }\n"]);return d=function(){return e},e}var f={},p=(0,l.ZP)(d());var h=n(86292),m=n(63377),v=n(48920),g=n(81255),b=n(69346),x=n(77365),Z=n(33279),y=n(65975),w=n(70917),k=n(57263),E=n(10253),S=n(91131),C=n(64824);function T(){var e=(0,s.Z)(["\n  query CelebrateReplRunCurrentUser {\n    currentUser {\n      id\n      timeCreated\n    }\n  }\n"]);return T=function(){return e},e}var R={},_=(0,l.ZP)(T());var I=n(98146),P=n(26224),D=new Date("2022-07-08"),A=(0,C.O4)("useCelebrateFirstReplPlay",!1);function N(){var e,t,n=function(e){var t=(0,i.Z)({},R,e);return u.useQuery(_,t)}(),r=(0,P.Z)().preferences.extraDelight,a=(0,I.$0)().fireCircularBurstFrom,o=(0,E.Z)((0,S.KO)(A),2),c=o[0],s=o[1],l=null!==(t=null===(e=n.data)||void 0===e?void 0:e.currentUser)&&void 0!==t?t:null,d=!c&&l&&new Date(l.timeCreated)>=D;return{hasCelebrated:c,celebrate:function(e){(r||d)&&a({element:e}),d&&s(!0)}}}var U,j=n(8633),B=n(76075),O=n(85485);function G(e){switch(e.runState){case v.A.IDLE:return(0,o.tZ)(j.Z,{size:16});case v.A.RUNNING:return(0,o.tZ)(B.Z,{size:16});default:return(0,o.tZ)(x.Z,{size:16})}}var L=(U={},(0,r.Z)(U,v.A.IDLE,"Run"),(0,r.Z)(U,v.A.RUNNING,"Stop"),(0,r.Z)(U,v.A.STOPPING,"Stopping"),(0,r.Z)(U,v.A.OFFLINE,"Working"),U),M={small:60,large:100},z=(0,w.iv)([g.l0.py(12),g.l0.width(M.small),g.l0.flex.row,g.l0.center,g.l0.borderRadius(8),g.l0.backgroundColor.accentPositiveDimmest,g.l0.color.accentPositiveStronger,g.l0.cursor.pointer,(0,r.Z)({transition:"color 0.2s ease 0s, background-color 0.2s ease 0s",border:"1px solid",borderColor:g.TV.accentPositiveDimmest,lineHeight:1,outline:"0 none","&:hover":[{color:"white"},g.l0.backgroundColor.accentPositiveDefault]},(0,O.et)("tabletMax"),[g.l0.width(M.large)])]),F=(0,w.iv)([g.l0.color.foregroundDimmer,g.l0.backgroundColor.backgroundHigher,{borderColor:g.TV.backgroundHigher,"&:hover":[{color:"white"},g.l0.backgroundColor.backgroundHighest]}]);function X(e){var t=(0,c.useState)(e.getRunState()),n=t[0],r=t[1];return(0,c.useEffect)((function(){return r(e.getRunState()),e.onStateChanged((function(e){r(e)}))}),[e]),n}function W(e){var t=e.runner,n=e.onRunInitiated,c=e.style,s=void 0===c?"default":c,l=e.disableTooltip,d=(0,m.Z)(),x=X(t),w=function(e){var t=(0,i.Z)({},f,e);return u.useQuery(p,t)}({variables:{id:d}}).data,E="Repl"===(null===w||void 0===w?void 0:w.repl.__typename)?w.repl:null,S=N().celebrate,C=x!==v.A.IDLE&&x!==v.A.RUNNING,T=function(e){return x===v.A.IDLE?(n&&n(),t.run(),E&&(0,h.j)(h.U3.PROJECT_RAN,{language:E.language,replId:E.id,replTitle:E.title,rootOriginReplUrl:E.rootOriginReplUrl}),void S(e.currentTarget)):x===v.A.RUNNING?t.stopRun():void 0};if("floating"===s)return(0,o.tZ)(b.ZP,{tag:"button",disabled:C,css:[{position:"fixed",right:24,bottom:72,zIndex:1},g.l0.center,{height:"50px",width:"50px",opacity:"0.5",cursor:"pointer",borderRadius:"100%",border:"solid 2px var(--accent-positive-dimmer)",backgroundColor:g.TV.accentPositiveDimmest}],onClick:T,children:(0,o.tZ)(G,{runState:x})});var R=x===v.A.IDLE;return"inline-small"===s?(0,o.BX)("button",{onClick:T,disabled:C,css:[g.l0.p(12),g.l0.flex.row,g.l0.center,g.l0.borderRadius(8),R?g.l0.backgroundColor.accentPositiveDimmest:g.l0.backgroundColor.backgroundHigher,R?g.l0.color.accentPositiveStronger:g.l0.color.foregroundDimmer,{border:"1px solid",borderColor:R?g.TV.accentPositiveDimmest:g.TV.backgroundHigher},g.l0.width("100%"),g.l0.height("100%")],children:[(0,o.tZ)(G,{runState:x}),(0,o.tZ)(y.xv,{variant:"subheadDefault",css:[g.l0.pl(8)],children:L[x]})]}):(0,o.tZ)(y.u,{placement:"bottom",isDisabled:l,tooltip:(0,o.tZ)(Z.Z,{shortcut:{cmdOrCtrlKey:!0,key:"Enter"}}),children:function(e,t){return(0,o.BX)("button",(0,a.Z)((0,i.Z)({},e),{onClick:T,ref:t,css:[z,!R&&F],children:[(0,o.tZ)(G,{runState:x}),(0,o.tZ)(y.xv,{variant:"subheadDefault",css:[g.l0.pl(8),g.l0.display.none,(0,r.Z)({lineHeight:1,overflow:"visible"},"@media (min-width: ".concat(k.j.tabletMax,"px)"),[g.l0.display.block])],children:L[x]})]}))}})}},98563:function(e,t,n){n.d(t,{Z:function(){return Z}});var r=n(10253),i=n(35944),a=n(67294),o=n(29672),c=n(91202),s=n(48386),l=n(10129),u=n(69346),d=n(81255),f=n(34140),p=n(26224),h=n(23697),m=n(68944),v=n(83261),g=n(86292),b=n(84563);var x=(0,u.KD)("div");function Z(e){var t=e.container,n=e.className,Z=e.autoFocus,y=(0,p.Z)().preferences.accessibleTerminal,w=(0,r.Z)(function(e){var t=e.autoFocus,n=e.onShellKey,i=e.container,o=(0,r.Z)((0,h.Z)(),2),c=o[0],s=o[1],l=(0,v.Z)({service:"shell",container:i});return a.useEffect((function(){if(l.channel&&c){var e=c.onKey((function(e){var t=e.key,r=e.domEvent;"\r"===t&&(0,g.j)(g.U3.SHELL_COMMAND_EVALED),n&&n(r)})),t=i.client(),r=c.onData((function(e){if(l.channel&&"open"===l.channel.status&&t.connectionState===m.em.CONNECTED){var n=(0,b.I)(e);l.channel.send({input:n})}}));l.channel.onCommand((function(e){e.hint?c.write("\x1b[0m\x1b[33m".concat(e.hint.text,"\x1b[0m\r\n")):e.output&&c.write(e.output)}));var a=function(){l.channel&&"open"===l.channel.status&&t.connectionState===m.em.CONNECTED&&l.channel.send({resizeTerm:c.getSize()})},o=c.onResize(a);return a(),function(){e.dispose(),r.dispose(),o.dispose()}}}),[l.channel,c,n,i]),a.useEffect((function(){t&&c&&c.focus()}),[t,c]),[c,s]}({container:t,autoFocus:Z}),2),k=w[0],E=w[1],S=(0,r.Z)(a.useState(!1),2),C=S[0],T=S[1],R=C&&k?(0,i.tZ)(o.R,{findPrevious:k.findPrevious,findNext:k.findNext,exit:function(){return T(!1)}}):(0,i.tZ)(c.l,{onClick:function(){return T(!0)}}),_=(0,h.a)();return(0,i.BX)(u.ZP,{className:n,css:[d.l0.p(8),d.l0.position.relative,d.l0.height("100%"),d.l0.borderRadius(0,0,8,8),d.l0.backgroundColor.backgroundDefault,{"& .xterm":[d.l0.height("100%")],"& .xterm .xterm-viewport":[d.l0.height("100%"),d.l0.borderRadius(0,0,8,8),{overflowY:"auto"}],"&:focus-within .controls":{opacity:1}},_],onKeyDown:function(e){"f"===e.key&&(0,l.j)(e)&&(T(!0),e.preventDefault())},children:[!y&&(0,i.tZ)(f.T,{children:'Enable "Accessible Terminal" in Workspace Settings to use a screen reader with the shell.'}),(0,i.tZ)(x,{css:[d.l0.flex.growAndShrink(1)],ref:E}),k?(0,i.BX)(u.ZP,{className:"controls",css:[d.l0.position.absolute,d.l0.flex.row,d.l0.top(8),d.l0.right(8),d.l0.height(30),d.l0.align.center,{opacity:0,zIndex:4}],children:[R,(0,i.tZ)(s.Z,{onClick:k.clear})]}):(0,i.tZ)("code",{css:[d.l0.color.foregroundDimmest,d.l0.coverContainer,d.l0.p(8)],children:"Loading..."})]})}},17495:function(e,t,n){n.d(t,{xA:function(){return d},xh:function(){return p}});var r=n(26042),i=n(7297),a=n(31230),o=n(46829);function c(){var e=(0,i.Z)(["\n  mutation ReplEnvironmentHeaderSubmitRepl($replId: String!) {\n    submitRepl(replId: $replId) {\n      ... on Repl {\n        id\n        workspaceCta\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n"]);return c=function(){return e},e}function s(){var e=(0,i.Z)(["\n  query ReplEnvironmentHeaderSubmitReplDueDate($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        template {\n          id\n          dueDate\n        }\n      }\n    }\n  }\n"]);return s=function(){return e},e}var l={},u=(0,a.ZP)(c());function d(e){var t=(0,r.Z)({},l,e);return o.useMutation(u,t)}var f=(0,a.ZP)(s());function p(e){var t=(0,r.Z)({},l,e);return o.useQuery(f,t)}},24949:function(e,t,n){n.d(t,{Z:function(){return R}});var r=n(35944),i=n(67294),a=n(65975),o=n(88075),c=n(64614),s=n(41664),l=n.n(s),u=n(26042),d=n(69396),f=n(57738),p=n(92350),h=n(44897),m=n(15852),v=n(9903),g=n(26224),b=n(70917),x=function(e){return(0,b.iv)({wordBreak:"break-word",boxSizing:"border-box",lineHeight:1.5,color:a.TV.foregroundDefault,fontFamily:"".concat(a.TV.fontFamilyDefault," !important"),fontSize:e,textSizeAdjust:"100%","h1, h2, h3, h4, h5, h6":{color:a.TV.foregroundDefault,fontWeight:a.TV.fontWeightMedium,marginBottom:a.TV.space16,lineHeight:1.25,wordWrap:"break-word"},"h1, h2":{paddingBottom:a.TV.space8,borderBottom:"1px solid ".concat(a.TV.backgroundHigher),marginTop:a.TV.space32},h1:{fontSize:"2em"},h2:{fontSize:"1.5em"},h3:{fontSize:"1.25em",marginTop:a.TV.space24},h4:{fontSize:"1em",marginTop:a.TV.space16},h5:{fontSize:"0.875em"},h6:{color:a.TV.foregroundDimmer,fontSize:"0.85em"},".anchor":{float:"left",lineHeight:1,marginLeft:"calc(-1 * ".concat(a.TV.space16,")"),paddingRight:a.TV.space4},".anchor:focus":{outline:"none"},p:{marginBottom:a.TV.space16,fontSize:e,fontFamily:"".concat(a.TV.fontFamilyDefault," !important")},"p:last-child":{marginBottom:0},table:{borderSpacing:0,borderCollapse:"collapse",display:"block",width:"100%",overflow:"auto",marginBottom:a.TV.space16,wordBreak:"normal",th:{fontWeight:a.TV.fontWeightMedium},"td, th":{padding:"".concat(a.TV.space8," ").concat(a.TV.space12),border:"1px solid ".concat(a.TV.backgroundHighest),minWidth:"16ch"},tr:{backgroundColor:a.TV.backgroundDefault,borderTop:"1px solid ".concat(a.TV.backgroundHighest)},"tr:nth-child(2n)":{backgroundColor:a.TV.backgroundRoot}},"hr:after":{clear:"both"},"li > p":{marginBottom:0},li:{marginTop:a.TV.space4},dd:{marginLeft:0},"ol, ul":{paddingLeft:a.TV.space16,marginTop:0,marginBottom:0},ul:{listStyle:"initial",listStyleType:"disc",marginBottom:a.TV.space16},ol:{listStyle:"decimal",marginBottom:a.TV.space16},"ol ol, ol ul, ul ol, ul ul":{paddingLeft:a.TV.space16,marginTop:0,marginBottom:0,paddingBottom:0},"ul ul":{listStyleType:"circle"},"ul ul ul":{listStyleType:"square"},"ol ol, ul ol":{listStyleType:"lower-roman"},"ol ol ol, ol ul ol, ul ol ol, ul ul ol":{listStyleType:"lower-alpha"},pre:{lineHeight:18,fontFamily:"".concat(a.TV.fontFamilyCode," !important"),margin:"".concat(a.TV.space16," 0"),borderRadius:4,wordBreak:"break-all",wordWrap:"break-word",whiteSpace:"pre-wrap",color:a.TV.foregroundDefault},"pre:last-child":{marginBottom:"0 !important"},blockquote:{padding:"0 1em",marginBottom:a.TV.space16,borderLeft:"".concat(a.TV.space2," solid ").concat(a.TV.backgroundHighest),paddingLeft:a.TV.space16},"blockquote > *":{color:"".concat(a.TV.foregroundDimmer," !important")},"blockquote > :last-child":{marginBottom:"0 !important",borderBottom:"none !important"},"blockquote > :first-child":{marginTop:"0 !important"},kbd:{display:"inline-block",padding:"3px 5px",font:"11px ".concat(a.TV.fontFamilyCode),lineHeight:10,color:a.TV.foregroundDimmer,verticalAlign:"middle",backgroundColor:a.TV.backgroundHigher,border:"none",borderRadius:3,boxShadow:"inset 0 -1px 0 ".concat(a.TV.backgroundHighest)},a:{color:a.TV.accentPrimaryStronger,backgroundColor:"initial"},"> :first-child":{marginTop:"0 !important",paddingTop:"0 !important"},"> :last-child":{borderBottom:"none !important",marginBottom:"0 !important",paddingBottom:"0 !important"},'[type="checkbox"]':{boxSizing:"border-box",marginRight:a.TV.space8,padding:0},details:{marginBottom:a.TV.space16,display:"block",background:a.TV.backgroundHigher,borderRadius:a.TV.borderRadius4,padding:a.TV.space16},summary:{display:"list-item",userSelect:"none",cursor:"pointer",fontWeight:a.TV.fontWeightBold},"details[open] > summary":{borderBottom:"1px solid ".concat(a.TV.backgroundHighest),marginBottom:a.TV.space16,paddingBottom:a.TV.space16},hr:{height:1,backgroundColor:a.TV.backgroundHigher,margin:"".concat(a.TV.space24," 0"),border:0}})},Z=n(51356),y=n(64798),w=n(96711),k=["a","pre","code","em","strong","p","ul","ol","li","img","del","h1","h2","h3","h4","h5","h6","sup","sub","br","hr","blockquote","span","div"];function E(e){var t=e.content,n=(0,g.Z)().preferences.fontSize,a=i.useCallback((function(e){return(0,r.tZ)(v.Z,(0,d.Z)((0,u.Z)({},e),{asyncHighlighting:!0}))}),[]);return(0,r.tZ)("div",{css:[{"& ol":{paddingInlineStart:"20px"},"& ul":{paddingInlineStart:"20px",listStyle:"initial"}}],children:(0,r.tZ)(f.D,{css:x(n),allowedElements:k,remarkPlugins:[p.Ic,h.Z,m.Z,Z.Z],rehypePlugins:[y.Z],components:{code:a,img:w.Z},children:t})})}var S=(0,i.memo)(E),C=n(87514),T=function(e){var t=e.thread,n=e.message,s=!(!t||t.indexStart!==t.indexEnd),u={resolved:"Thread resolved. Re-open it any time in the inbox.",unresolved:"Thread re-opened"},d="Outdated",f="The code has changed since the comment was left",p=i.useMemo((function(){return(0,c.Z)(n.timeCreated)}),[n]);return n.user?(0,r.BX)(a.G7,{children:[(0,r.BX)(a.G7,{css:[a.l0.flex.row,a.l0.justify.spaceBetween,a.l0.pb(4)],children:[(0,r.BX)(a.G7,{css:[a.l0.flex.row,a.l0.align.center,a.l0.rowWithGap(8)],children:[(0,r.tZ)(l(),{passHref:!0,href:"/@".concat(n.user.username),children:(0,r.tZ)("a",{children:(0,r.tZ)(a.n5,{small:!0,src:n.user.image,username:n.user.username})})}),(0,r.tZ)("p",{children:(0,r.tZ)("small",{css:[a.l0.color.foregroundDimmer],children:p})})]}),s?(0,r.tZ)(a.u,{tooltip:f,children:(0,r.tZ)(a.DR,{colorway:"negative",text:d})}):null]}),"StatusMessageContentType"===n.content.__typename&&"resolved"===n.content.status&&(0,r.tZ)(a.E_,{colorway:"positive",icon:(0,r.tZ)(o.Z,{}),text:u.resolved}),"StatusMessageContentType"===n.content.__typename&&"unresolved"===n.content.status&&(0,r.tZ)(a.E_,{colorway:"primary",icon:(0,r.tZ)(C.Z,{}),text:u.unresolved}),"TextMessageContentType"===n.content.__typename&&(0,r.tZ)(S,{content:n.content.text})]}):null},R=(0,i.memo)(T)},64614:function(e,t,n){var r=n(93604),i=n(35977);t.Z=function(e){var t=new Date(e),n=new Date;return(0,i.Z)(n,t)<60?"now":(0,r.F)(t,!0)}},54168:function(e,t,n){n.d(t,{x:function(){return R},y:function(){return T}});var r=n(47568),i=n(29815),a=n(34051),o=n.n(a),c=n(92876),s=n(86292),l=n(51438),u=function(){function e(t){(0,l.Z)(this,e),this.code="",this.currentIndent=0,this.lib=t}var t=e.prototype;return t.indent=function(){this.currentIndent+=1},t.dedent=function(){if(0===this.currentIndent)throw new Error("indent at zero");this.currentIndent-=1},t.addIndents=function(){for(var e=0;e<this.currentIndent;e++)this.code+="  "},t.push=function(e){var t=e.split("\n"),n=!0,r=!1,i=void 0;try{for(var a,o=t[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var c=a.value;this.addIndents(),this.code+=c,this.newLine()}}catch(s){r=!0,i=s}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}},t.newLine=function(){this.code+="\n"},t.closeCurly=function(){this.addIndents(),this.code+=this.lib.getClosingBrackets()},t.toString=function(){return this.code},e}(),d=n(83160),f={testRunnerName:function(){return"TestRunner"},testSuiteName:function(){return"TestSuite"},defaultImports:function(){return"import org.junit.Before;\nimport org.junit.After;\nimport org.junit.Test;\nimport static org.junit.Assert.*;"},classIntro:function(){return"public class ".concat((0,d.Og)(f.testSuiteName())," {")},classConstructorName:function(){return(0,d.Og)(f.testSuiteName())},setupIntro:function(){return"@Before\npublic void setUp() {"},tearDownIntro:function(){return"@After\npublic void tearDown() {"},testIntro:function(e){return"".concat(f.testIntroPreName()).concat(e).concat(f.testIntroPostName())},testIntroPreName:function(){return"@Test\npublic void "},testIntroPostName:function(){return"() {"},getProperTestName:function(e){return e},parseTestResultName:function(e){return e.replace("(".concat((0,d.Og)(f.testSuiteName()),")"),"")},buildSuite:function(e){var t=e.tests,n=e.meta,r=new u(f);r.push(f.defaultImports()),n&&n.imports&&r.push(n.imports),r.newLine(),r.push(f.classIntro()),r.newLine(),r.indent(),n&&(n.initialization&&(r.push(n.initialization),r.newLine()),n.setup&&(r.push(f.setupIntro()),r.indent(),r.push(n.setup),r.dedent(),r.closeCurly(),r.newLine(),r.newLine()),n.tearDown&&(r.push(f.tearDownIntro()),r.indent(),r.push(n.tearDown),r.dedent(),r.closeCurly(),r.newLine(),r.newLine()));var i=!0,a=!1,o=void 0;try{for(var c,s=t[Symbol.iterator]();!(i=(c=s.next()).done);i=!0){var l=c.value;l.code&&(r.push(f.testIntro(l.name)),r.indent(),r.push(l.code),r.dedent(),r.closeCurly(),r.newLine(),r.newLine())}}catch(d){a=!0,o=d}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}return r.dedent(),r.closeCurly(),r.toString()},runSuite:function(e){return v.apply(this,arguments)},buildAndRunTests:function(e){var t=e.container,n=e.fs,r=e.packager,i=e.logger,a=e.tests,o=e.meta,c=f.buildSuite({tests:a,meta:o});return f.runSuite({container:t,fs:n,packager:r,logger:i,suiteCode:c})},hasClosingBrackets:function(){return!0},getClosingBrackets:function(){return"}"},hasSemicolon:function(){return!0},getCommentChar:function(){return"//"},getHelpText:function(){return"no react in this bitch either"},captureSetupError:function(e){var t=e.tag,n=e.raw;c.$e((function(e){e.setTag("unitTestLib","true"),e.setExtra("raw",n),e.setExtra("language","java10"),c.Tb(t)}))},exampleTest:{id:-1,failureMessage:"An Adder class should have an add method that adds two ints and returns the result",name:"add",code:"Adder adder = new Adder();\nint result = adder.add(1, 2);\nassertEquals(3, result);\n"}},p="__UNIT_TEST_RESULT_START__",h="__UNIT_TEST_RESULT_END__",m="import org.json.simple.JSONArray;\nimport org.json.simple.JSONObject;\nimport org.junit.runner.JUnitCore;\nimport org.junit.runner.Result;\nimport org.junit.runner.notification.Failure;\n\npublic class ".concat((0,d.Og)(f.testRunnerName())," {\n    public static void main(String[] args) {\n      Result result = JUnitCore.runClasses(").concat((0,d.Og)(f.testSuiteName()),'.class);\n      JSONArray failures = new JSONArray();\n\n        for (Failure failure : result.getFailures()) {\n            JSONObject obj = new JSONObject();\n            obj.put("name", failure.getTestHeader());\n            obj.put("stack", failure.getTrace());\n            failures.add(obj);\n        }\n        JSONObject out = new JSONObject();\n        out.put("passed", result.wasSuccessful());\n        out.put("failures", failures);\n        System.out.println();\n        System.out.println("').concat(p,'");\n        System.out.println(out);\n        System.out.println("').concat(h,'");\n    }\n}');function v(){return(v=(0,r.Z)(o().mark((function e(t){var n,r,a,c,l,u,v,g,b,x,Z,y,w,k,E,S,C,T,R,_,I,P,D,A,N;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.container,r=t.fs,a=t.packager,c=t.logger,l=t.suiteCode,v=c.startLogSpinner("Setting up the environment"),e.next=5,(0,d.WT)(r);case 5:return v("Creating your test files 1/2"),e.next=8,(0,d.e3)({fs:r,code:l,filename:"".concat(f.testSuiteName(),".java")});case 8:if(g=e.sent,!(b=g.error)){e.next=14;break}return"Failed to create suite code file",f.captureSetupError({tag:"Failed to create suite code file",raw:b}),e.abrupt("return",{error:"There was an error creating a test file, if this happens again, please contact support."});case 14:return v("Creating your test files 2/2"),e.next=17,(0,d.e3)({fs:r,code:m,filename:"".concat(f.testRunnerName(),".java")});case 17:if(x=e.sent,!(Z=x.error)){e.next=23;break}return"Failed to create test runner file",f.captureSetupError({tag:"Failed to create test runner file",raw:Z}),e.abrupt("return",{error:"There was an error creating a test file, if this happens again, please contact support."});case 23:return c.stopLogSpinner(),c.clearLine(),c.logMessage("Installing imported packages\r\n"),e.next=28,a.addPackages([{name:"junit:junit",version:"4.12"},{name:"com.googlecode.json-simple:json-simple",version:"1.1.1"},{name:"org.hamcrest:hamcrest-core",version:"1.3"}]);case 28:return e.next=30,a.installPackages();case 30:if(e.sent){e.next=33;break}return e.abrupt("return",{error:"Failed to install packages\r\n"});case 33:return c.clearLogs(),v=c.startLogSpinner("Compiling your files"),e.next=37,n.exec("find",".","-type","f","-name","*.java","-print0");case 37:if(y=e.sent,w=y.output,!(k=y.error)){e.next=44;break}return E="Failed to fetch working directory java files",f.captureSetupError({tag:E,raw:k}),e.abrupt("return",{error:"".concat(E,"\r\n\r\n")+(null===w||void 0===w?void 0:w.replace(/\n/g,"\n\r"))+"\r\n\r\n"+k});case 44:if("string"===typeof w){e.next=46;break}throw new Error("expected working directory files to be a string");case 46:return S=w.slice(0,-1).split("\0"),C=".:./target/dependency/*",e.next=50,(u=n).exec.apply(u,["javac","-classpath",C,"-d","."].concat((0,i.Z)(S)));case 50:if(T=e.sent,R=T.output,!(_=T.error)){e.next=57;break}return I="Failed to compile test runner file",f.captureSetupError({tag:I,raw:_}),e.abrupt("return",{error:"".concat(I,"\r\n\r\n")+(null===R||void 0===R?void 0:R.replace(/\n/g,"\n\r"))+"\r\n\r\n"+_});case 57:return v("Running your tests"),e.next=60,n.exec("java","-classpath",C,(0,d.Og)(f.testRunnerName()));case 60:if(P=e.sent,D=P.output,!(A=P.error)){e.next=66;break}return(0,s.j)(s.U3.REPL_UNIT_TEST_CONSTRUCTION_ERROR_INTERNAL),e.abrupt("return",{error:"Running tests failed\r\n\r\n"+(null===D||void 0===D?void 0:D.replace(/\n/g,"\n\r"))+"\r\n\r\n"+A});case 66:if("string"===typeof D){e.next=68;break}throw new Error("expected runOutput to be a string");case 68:return N=JSON.parse(D.slice(D.indexOf(p)+p.length,D.lastIndexOf(h))),e.abrupt("return",{result:N,error:null});case 70:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var g=f,b=function(e){return!!e&&e.trim().length>0&&e.split("\n").some((function(e){return!(e.trim().startsWith("#")||""===e.trim())}))},x={testRunnerName:function(){return"test_runner"},testSuiteName:function(){return"test_suite"},defaultImports:function(){return"import unittest\nfrom main import *\n"},classIntro:function(){return"class UnitTests(unittest.TestCase):"},classConstructorName:function(){return"__init__"},setupIntro:function(){return"def setUp(self):"},tearDownIntro:function(){return"def tearDown(self):"},testIntro:function(e){return x.testIntroPreName()+e+x.testIntroPostName()},testIntroPreName:function(){return"def test_"},testIntroPostName:function(){return"(self):"},getProperTestName:function(e){return"test_".concat(e)},parseTestResultName:function(e){return e},buildSuite:function(e){var t=e.tests,n=e.meta,r=new u(x);r.push(x.defaultImports()),n&&n.imports&&r.push(n.imports),r.newLine(),r.push(x.classIntro()),r.newLine(),r.indent(),n&&(n.initialization&&(r.push(n.initialization),r.newLine()),b(n.setup)&&(r.push(x.setupIntro()),r.indent(),r.push(n.setup),r.dedent(),r.newLine()),b(n.tearDown)&&(r.push(x.tearDownIntro()),r.indent(),r.push(n.tearDown),r.dedent(),r.newLine()));var i=!0,a=!1,o=void 0;try{for(var c,s=t[Symbol.iterator]();!(i=(c=s.next()).done);i=!0){var l=c.value;r.push(x.testIntro(l.name)),r.indent(),r.push(l.code||"pass"),r.dedent(),r.newLine()}}catch(d){a=!0,o=d}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}return r.toString()},runSuite:function(e){return k.apply(this,arguments)},buildAndRunTests:function(e){var t=e.container,n=e.fs,r=e.packager,i=e.logger,a=e.tests,o=e.meta,c=x.buildSuite({tests:a,meta:o});return x.runSuite({container:t,fs:n,packager:r,logger:i,suiteCode:c})},hasClosingBrackets:function(){return!1},getClosingBrackets:function(){throw new Error("This language does not have closing brackets, check `hasClosingBrackets` first")},hasSemicolon:function(){return!1},getCommentChar:function(){return"#"},getHelpText:function(){return"no react in this bitch"},captureSetupError:function(e){var t=e.tag,n=e.raw;c.$e((function(e){e.setTag("unitTestLib","true"),e.setExtra("raw",n),e.setExtra("language","python3"),c.Tb(t)}))},exampleTest:{id:-1,failureMessage:"In main.py you should have an add functions that adds two numbers and returns the result",name:"add",code:"self.assertEquals(add(1, 2), 3)"}},Z="__UNIT_TEST_RESULT_START__",y="__UNIT_TEST_RESULT_END__",w="import unittest\nimport ".concat((0,d.Og)(x.testSuiteName()),"\nimport os\nimport json\nfrom time import sleep\n\nsuite = unittest.TestLoader().loadTestsFromTestCase(\n  ").concat((0,d.Og)(x.testSuiteName()),'.UnitTests)\nf = open(os.devnull,"w")\ntest_res = unittest.TextTestRunner(stream=f).run(suite)\n\n# Merge errors and failures and normalize to {name, stack}\nfailures = [\n    {\n        "name": r[0]._testMethodName,\n        "stack": r[1],\n    } for r in test_res.errors + test_res.failures\n]\nprint()\nprint(\'').concat(Z,'\')\nsleep(1)\nprint(json.dumps({\n    "passed": test_res.wasSuccessful(),\n    "failures": failures,\n}))\nprint()\nprint(\'').concat(y,"');");function k(){return(k=(0,r.Z)(o().mark((function e(t){var n,r,i,a,c,l,u,f,p,h,m,v,g,b;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.container,r=t.fs,i=t.packager,a=t.logger,c=t.suiteCode,l=a.startLogSpinner("Setting up the environment"),e.next=4,(0,d.WT)(r);case 4:return l("Creating your test files 1/2"),e.next=7,(0,d.e3)({fs:r,code:c,filename:"".concat(x.testSuiteName(),".py")});case 7:if(u=e.sent,!(f=u.error)){e.next=13;break}return"Failed to create suite code file",x.captureSetupError({tag:"Failed to create suite code file",raw:f}),e.abrupt("return",{error:"There was an error creating a test file, if this happens again, please contact support."});case 13:return l("Creating your test files 2/2"),e.next=16,(0,d.e3)({fs:r,code:w,filename:"".concat(x.testRunnerName(),".py")});case 16:if(p=e.sent,!(h=p.error)){e.next=22;break}return"Failed to create test runner file",x.captureSetupError({tag:"Failed to create test runner file",raw:h}),e.abrupt("return",{error:"There was an error creating a test file, if this happens again, please contact support."});case 22:return a.stopLogSpinner(),a.clearLine(),a.logMessage("Installing imported packages\r\n"),e.next=27,i.installPackages();case 27:if(e.sent){e.next=30;break}return e.abrupt("return",{error:"Failed to install packages\r\n"});case 30:return a.clearLogs(),a.startLogSpinner("Running your tests"),e.next=34,n.exec("python","-B",(0,d.Og)("".concat(x.testRunnerName(),".py")));case 34:if(m=e.sent,v=m.output,!(g=m.error)){e.next=40;break}return(0,s.j)(s.U3.REPL_UNIT_TEST_CONSTRUCTION_ERROR_INTERNAL),e.abrupt("return",{error:"Running tests failed\r\n\r\n"+(null===v||void 0===v?void 0:v.replace(/\n/g,"\n\r"))+"\r\n"+g});case 40:if("string"===typeof v){e.next=42;break}throw new Error("expected runoutput to be a string");case 42:return b=JSON.parse(v.slice(v.indexOf(Z)+Z.length,v.lastIndexOf(y))),e.abrupt("return",{result:b,error:null});case 44:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var E={testRunnerName:function(){throw new Error("Node test runner uses jest directly")},testSuiteName:function(){return"test_suite"},defaultImports:function(){return"const index = require('./index.js');"},classIntro:function(){return'describe("UnitTests", function() {'},classConstructorName:function(){return null},setupIntro:function(){return"beforeAll(async function() {"},tearDownIntro:function(){return"afterAll(async function() {"},testIntro:function(e){return E.testIntroPreName()+e+E.testIntroPostName()},testIntroPreName:function(){return'test("'},testIntroPostName:function(){return'", async function() {'},getProperTestName:function(e){return e},parseTestResultName:function(e){return e},buildSuite:function(e){var t=e.tests,n=e.meta,r=new u(E);r.push(E.defaultImports()),n&&n.imports&&r.push(n.imports),r.newLine(),r.push(E.classIntro()),r.newLine(),r.indent(),n&&(n.initialization&&(r.push(n.initialization),r.newLine()),n.setup&&(r.push(E.setupIntro()),r.indent(),r.push(n.setup),r.dedent(),r.closeCurly(),r.newLine(),r.newLine()),n.tearDown&&(r.push(E.tearDownIntro()),r.indent(),r.push(n.tearDown),r.dedent(),r.closeCurly(),r.newLine(),r.newLine()));var i=!0,a=!1,o=void 0;try{for(var c,s=t[Symbol.iterator]();!(i=(c=s.next()).done);i=!0){var l=c.value;l.code&&(r.push(E.testIntro(l.name)),r.indent(),r.push(l.code),r.dedent(),r.closeCurly(),r.newLine(),r.newLine())}}catch(d){a=!0,o=d}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}return r.dedent(),r.closeCurly(),r.toString()},runSuite:function(e){return S.apply(this,arguments)},buildAndRunTests:function(e){var t=e.container,n=e.fs,r=e.packager,i=e.logger,a=e.tests,o=e.meta,c=E.buildSuite({tests:a,meta:o});return E.runSuite({container:t,fs:n,packager:r,logger:i,suiteCode:c})},hasClosingBrackets:function(){return!0},getClosingBrackets:function(){return"});"},hasSemicolon:function(){return!0},getCommentChar:function(){return"//"},getHelpText:function(){return"no react yet"},captureSetupError:function(e){var t=e.tag,n=e.raw;c.$e((function(e){e.setTag("unitTestLib","true"),e.setExtra("raw",n),e.setExtra("language","nodejs"),c.Tb(t)}))},exampleTest:{id:-1,failureMessage:"",name:"add",code:"expect(index.add(1, 2)).toBe(3);"}};function S(){return(S=(0,r.Z)(o().mark((function e(t){var n,r,i,a,c,l,u,f,p,h,m,v,g,b,x,Z,y,w,k,S,C,T;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.container,r=t.fs,i=t.packager,a=t.logger,c=t.suiteCode,l=a.startLogSpinner("Setting up the environment"),e.next=4,(0,d.WT)(r);case 4:return l("Creating your test files 1/2"),e.next=7,(0,d.e3)({fs:r,code:c,filename:"".concat(E.testSuiteName(),".js")});case 7:if(u=e.sent,!(f=u.error)){e.next=13;break}return"Failed to create suite code file",E.captureSetupError({tag:"Failed to create suite code file",raw:f}),e.abrupt("return",{error:"There was an error creating a test file, if this happens again, please contact support."});case 13:return l("Creating your test files 2/2"),p=69,h="jest.config.json",m={testRegex:(0,d.Og)("".concat(E.testSuiteName(),".js")),testEnvironment:"node",testFailureExitCode:p},e.next=19,(0,d.e3)({fs:r,code:JSON.stringify(m),filename:h});case 19:if(v=e.sent,!(g=v.error)){e.next=25;break}return"Failed to create config file",E.captureSetupError({tag:"Failed to create config file",raw:g}),e.abrupt("return",{error:"There was an error creating a test file, if this happens again, please contact support."});case 25:return a.stopLogSpinner(),a.clearLine(),a.logMessage("Installing imported packages\r\n"),e.next=30,i.installPackages();case 30:if(e.sent){e.next=33;break}return e.abrupt("return",{error:"Failed to install packages\r\n"});case 33:return a.clearLogs(),l=a.startLogSpinner("Running your tests"),b=(0,d.Og)("output.json"),e.next=38,n.exec("jest","--json","--outputFile",b,"--config",(0,d.Og)(h),"--forceExit","--passWithNoTests");case 38:if(x=e.sent,Z=x.output,!(y=x.error)||y.endsWith(p.toString())){e.next=44;break}return(0,s.j)(s.U3.REPL_UNIT_TEST_CONSTRUCTION_ERROR_INTERNAL),e.abrupt("return",{error:"Running tests failed\r\n\r\n"+(null===Z||void 0===Z?void 0:Z.replace(/\n/g,"\n\r"))+"\r\n"+y});case 44:return l("Parsing your test results"),e.next=47,r.readFile(b);case 47:if(!(w=e.sent).error){e.next=52;break}return"Error reading test results",E.captureSetupError({tag:"Error reading test results",raw:w.error}),e.abrupt("return",{error:"There was an error getting test results, if this happens please contact support."});case 52:if(k=w.content.toString(),!(S=JSON.parse(k)).success){e.next=56;break}return e.abrupt("return",{error:null,result:{passed:!0,failures:[]}});case 56:if(C=S.testResults[0],(T=C.assertionResults.filter((function(e){return"passed"!==e.status})).map((function(e){return{name:e.title,stack:e.failureMessages[0]}}))).length){e.next=60;break}return e.abrupt("return",{error:C.message.replace(/\n/g,"\r\n")});case 60:return e.abrupt("return",{error:null,result:{passed:!1,failures:T}});case 61:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var C={java10:g,java10_beta:g,java:g,python3:x,python3_beta:x,python:x,nodejs:E,javascript:E,nodejs_beta:E};function T(e){return e in C}function R(e){if(!T(e))throw new Error("".concat(e," is not a supported unit testing language, it has to be one of ").concat(Object.keys(C)));return C[e]}},83160:function(e,t,n){n.d(t,{Og:function(){return d},WT:function(){return h},e3:function(){return f}});var r=n(47568),i=n(34051),a=n.n(i),o=n(92876),c=n(31066),s=n(65456),l=n(58794),u="_test_runner";function d(e){return u+e}function f(e){return p.apply(this,arguments)}function p(){return(p=(0,r.Z)(a().mark((function e(t){var n,r,i,o,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.fs,r=t.code,i=t.filename,o=d(i),c=l.Z.from(r,"utf8"),e.abrupt("return",n.writeFile(o,c));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return m.apply(this,arguments)}function m(){return(m=(0,r.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.readDir(c.Ql);case 3:if(!(n=e.sent).error){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,Promise.all(n.children.map((function(e){return e.filename.startsWith(u)?e.type===s.Tv.File?t.deleteFile(e.filename):t.deleteDir(e.filename):Promise.resolve(null)})));case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),o.$e((function(t){t.setTag("unitTestLib","true"),o.Tb(e.t0)}));case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}},64576:function(e,t,n){n.d(t,{AF:function(){return y},Hd:function(){return k},IV:function(){return T},Rb:function(){return g},aA:function(){return v},kO:function(){return S},lQ:function(){return _},rU:function(){return x}});var r=n(26042),i=n(7297),a=n(31230),o=n(46829);function c(){var e=(0,i.Z)(["\n  fragment UnitTestsReplUnitTestMeta on ReplUnitTestMeta {\n    id\n    imports\n    initialization\n    setup\n    tearDown\n  }\n"]);return c=function(){return e},e}function s(){var e=(0,i.Z)(["\n  fragment UnitTestsReplUnitTest on ReplUnitTest {\n    id\n    name\n    code\n    failureMessage\n  }\n"]);return s=function(){return e},e}function l(){var e=(0,i.Z)(["\n  mutation createUnitTestMeta($input: CreateReplUnitTestMetaInput!) {\n    createReplUnitTestMeta(input: $input) {\n      ... on ReplUnitTestMeta {\n        id\n        ...UnitTestsReplUnitTestMeta\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return l=function(){return e},e}function u(){var e=(0,i.Z)(["\n  mutation updateUnitTestMeta($input: UpdateReplUnitTestMetaInput!) {\n    updateReplUnitTestMeta(input: $input) {\n      ... on ReplUnitTestMeta {\n        id\n        ...UnitTestsReplUnitTestMeta\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return u=function(){return e},e}function d(){var e=(0,i.Z)(["\n  mutation createUnitTest($input: CreateReplUnitTestInput!) {\n    createReplUnitTest(input: $input) {\n      ... on ReplUnitTest {\n        id\n        ...UnitTestsReplUnitTest\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return d=function(){return e},e}function f(){var e=(0,i.Z)(["\n  mutation updateUnitTest($input: UpdateReplUnitTestInput!) {\n    updateReplUnitTest(input: $input) {\n      ... on ReplUnitTest {\n        id\n        ...UnitTestsReplUnitTest\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return f=function(){return e},e}function p(){var e=(0,i.Z)(["\n  mutation deleteUnitTest($testId: Int!) {\n    deleteReplUnitTest(testId: $testId) {\n      ... on ReplUnitTest {\n        id\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n"]);return p=function(){return e},e}function h(){var e=(0,i.Z)(["\n  mutation updateReplUnitTestLastRun(\n    $input: UpdateReplUnitTestLastRunInput!\n    $replId: String!\n  ) {\n    updateReplUnitTestLastRun(input: $input) {\n      ... on UpdateReplUnitTestLastRunUpdatedTests {\n        __typename\n        updatedTests {\n          ... on ReplUnitTest {\n            id\n            __typename\n            lastRun(replId: $replId) {\n              ... on ReplUnitTestLastRun {\n                __typename\n                status\n              }\n              ... on UserError {\n                __typename\n                message\n              }\n            }\n          }\n          ... on UserError {\n            __typename\n            message\n          }\n        }\n      }\n      ... on UserError {\n        __typename\n        message\n      }\n    }\n  }\n"]);return h=function(){return e},e}var m={},v=(0,a.ZP)(c()),g=(0,a.ZP)(s()),b=(0,a.ZP)(l(),v);function x(e){var t=(0,r.Z)({},m,e);return o.useMutation(b,t)}var Z=(0,a.ZP)(u(),v);function y(e){var t=(0,r.Z)({},m,e);return o.useMutation(Z,t)}var w=(0,a.ZP)(d(),g);function k(e){var t=(0,r.Z)({},m,e);return o.useMutation(w,t)}var E=(0,a.ZP)(f(),g);function S(e){var t=(0,r.Z)({},m,e);return o.useMutation(E,t)}var C=(0,a.ZP)(p());function T(e){var t=(0,r.Z)({},m,e);return o.useMutation(C,t)}var R=(0,a.ZP)(h());function _(e){var t=(0,r.Z)({},m,e);return o.useMutation(R,t)}},69128:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(2916),i=n(25497),a=n(99408),o=n(67294),c=n(54168);function s(){var e=(0,r.Z)(),t=(0,a.Z)().dotReplit,n=null===e||void 0===e?void 0:e.language,s=(0,o.useState)(null),l=s[0],u=s[1],d=(0,o.useState)(!0),f=d[0],p=d[1];return(0,o.useEffect)((function(){if(n){if((0,c.y)(n))return u(n),void p(!1);var e=!1,r=t.watch((function(t){var n,r;if(e||(e=!0,p(!1)),t.error)t.error===i.Yt.NotFound&&u(null);else{var a=null===(n=t.config.unitTest)||void 0===n||null===(r=n.language)||void 0===r?void 0:r.toLowerCase();a&&(0,c.y)(a)?u(a):u(null)}}));return function(){r()}}}),[n,t]),{language:l,isLoading:f}}},88954:function(e,t,n){n.d(t,{I5:function(){return f},sY:function(){return u}});var r=n(26042),i=n(7297),a=n(31230),o=n(46829);function c(){var e=(0,i.Z)(["\n  fragment ReplEnvironmentWebviewRepl on Repl {\n    id\n    prodUrl: hostedUrl(dotty: true)\n    devUrl: hostedUrl(dev: true, noCustomDomain: true)\n    config {\n      domain\n      isServer\n    }\n    currentUserPermissions {\n      linkDomain\n    }\n    lang {\n      id\n    }\n  }\n"]);return c=function(){return e},e}function s(){var e=(0,i.Z)(["\n  query ReplEnvironmentWebview($id: String!) {\n    repl(id: $id) {\n      ... on Repl {\n        id\n        ...ReplEnvironmentWebviewRepl\n      }\n    }\n    currentUser {\n      id\n    }\n  }\n  ","\n"]);return s=function(){return e},e}var l={},u=(0,a.ZP)(c()),d=(0,a.ZP)(s(),u);function f(e){var t=(0,r.Z)({},l,e);return o.useQuery(d,t)}},96769:function(e,t,n){n.d(t,{Z:function(){return Re}});var r=n(26042),i=n(69396),a=n(35944),o=n(67294),c=n(92876),s=n(88954),l=n(63377),u=n(60536),d=n.n(u),f=n(44781),p=n(30019),h=n(19526),m=n(86292);function v(){return o.useEffect((function(){(0,m.j)(m.U3.WS_REPLCO_UNREACHABLE)}),[]),(0,a.BX)("div",{className:"jsx-88c49dc4f1cb807b unreachable",children:[(0,a.BX)(h.gC,{align:"center",spacing:4,children:[(0,a.BX)(h.gC,{align:"center",children:[(0,a.tZ)(p.Z,{level:1,children:"\ud83d\ude48"}),(0,a.tZ)(p.Z,{level:4,children:"This Repl link isn\u2019t broken!"}),(0,a.tZ)(p.Z,{level:4,foreground:2,children:"It\u2019s just blocked."})]}),(0,a.BX)(h.gC,{spacing:2,className:"why",children:[(0,a.tZ)(f.Z,{foreground:2,children:"Why this might be happening:"}),(0,a.tZ)(f.Z,{foreground:2,children:(0,a.BX)("ul",{className:"jsx-88c49dc4f1cb807b",children:[(0,a.BX)("li",{className:"jsx-88c49dc4f1cb807b",children:["repl.co URLs could be"," ",(0,a.tZ)(f.Z,{fontWeight:"medium",foreground:1,children:"blocked by a firewall,"})," ","so contact your IT administrator"]}),(0,a.BX)("li",{className:"jsx-88c49dc4f1cb807b",children:["repl.co URLs could be"," ",(0,a.tZ)(f.Z,{fontWeight:"medium",foreground:1,children:"blocked by your ISP,"})," ","so try getting in touch with them"]})]})})]}),(0,a.BX)(f.Z,{foreground:2,align:"center",children:["If you have any other questions, please check out"," ",(0,a.tZ)("a",{href:"https://docs.replit.com/teams-edu/it-administrators-toolkit",target:"_blank",rel:"noopener noreferrer",className:"jsx-88c49dc4f1cb807b",children:"our IT docs"})," ","or"," ",(0,a.tZ)("a",{href:"https://replit.com/support",target:"_blank",rel:"noopener noreferrer",className:"jsx-88c49dc4f1cb807b",children:"contact support"}),"."]})]}),(0,a.tZ)(d(),{id:"88c49dc4f1cb807b",children:".unreachable.jsx-88c49dc4f1cb807b{padding:var(--space-32)}.unreachable.jsx-88c49dc4f1cb807b ul.jsx-88c49dc4f1cb807b{list-style-position:inside}.unreachable.jsx-88c49dc4f1cb807b li.jsx-88c49dc4f1cb807b{padding-bottom:var(--space-16)}"})]})}var g=o.createContext(!1),b=n(69346),x=n(81255),Z=n(47979),y=n(10253),w=n(64080),k=n(20787),E=n(46702),S=n(99534),C=n(7297),T=n(31230),R=n(46829);function _(){var e=(0,C.Z)(["\n  fragment EditDomainRepl on Repl {\n    id\n    hostedUrl\n    apexProxy\n    config {\n      domain\n    }\n    domains {\n      domain\n      state\n    }\n  }\n"]);return _=function(){return e},e}function I(){var e=(0,C.Z)(["\n  query EditDomain($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        ...EditDomainRepl\n      }\n      ... on ReplRedirect {\n        replUrl\n      }\n      ... on SubscriptionExpiredError {\n        replId\n      }\n    }\n  }\n  ","\n"]);return I=function(){return e},e}function P(){var e=(0,C.Z)(["\n  query EditDomainCheckDomain($replId: String!, $domain: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        checkDomain(domain: $domain) {\n          verified\n          retry\n          status\n        }\n      }\n    }\n  }\n"]);return P=function(){return e},e}function D(){var e=(0,C.Z)(["\n  query EditDomainCheckDomain2($replId: String!, $domain: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        checkDomain2(domain: $domain) {\n          ... on DomainStatus2 {\n            verified\n            retry\n            status\n            records {\n              A\n              TXT\n              CNAME\n            }\n          }\n          ... on NotFoundError {\n            message\n          }\n          ... on ServiceUnavailable {\n            message\n          }\n        }\n      }\n    }\n  }\n"]);return D=function(){return e},e}function A(){var e=(0,C.Z)(["\n  mutation EditDomainLinkReplDomain2($replId: String!, $domain: String!) {\n    linkReplDomain2(replId: $replId, domain: $domain) {\n      ... on Repl {\n        id\n        ...EditDomainRepl\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on ServiceUnavailable {\n        message\n      }\n    }\n  }\n  ","\n"]);return A=function(){return e},e}function N(){var e=(0,C.Z)(["\n  mutation EditDomainUpdateRepl($input: UpdateReplInput!) {\n    updateRepl(input: $input) {\n      repl {\n        id\n        ...EditDomainRepl\n      }\n    }\n  }\n  ","\n"]);return N=function(){return e},e}var U={},j=(0,T.ZP)(_()),B=(0,T.ZP)(I(),j);P();var O=(0,T.ZP)(D());var G=(0,T.ZP)(A(),j);var L=(0,T.ZP)(N(),j);var M=n(65975),z=n(79500),F=n(48966),X=n.n(F),W=n(92002),H=n(37424),V=n(88808),$=n(57704);function q(e){var t=e.repl,n=e.existingDomain,i=e.onLink,s=e.onGoBack,l=e.onLinkStarted,u=e.onStateChanged,d=(0,o.useState)(n?"loading":null),f=d[0],p=d[1],h=(0,o.useState)(!1),m=h[0],v=h[1],g=(0,o.useState)(null),b=g[0],x=g[1],Z=(0,o.useState)(!1),w=Z[0],k=Z[1],E=(0,y.Z)(function(e){var t=(0,r.Z)({},U,e);return R.useMutation(G,t)}(),2),S=E[0],C=E[1],T=(0,o.useRef)(null),_=(0,o.useRef)(null),I=(0,o.useRef)(null),P=function(e){(null===e||void 0===e?void 0:e.current)&&e.current.select()},D=function(e){var t;(null===e||void 0===e||null===(t=e.current)||void 0===t?void 0:t.value)&&(0,z.Z)(e.current.value).catch((function(e){c.$e((function(t){t.setTag("domain-link",!0),t.setExtra("type","copy"),c.Tb(e)}))}))},A=(0,o.useState)(n||""),N=A[0],j=A[1];(0,o.useEffect)((function(){C.data&&"Repl"===C.data.linkReplDomain2.__typename&&i()}),[C.data,i]);var B=function(e){p(e),u()},O=X().isURL(N,{require_valid_protocol:!1})&&N.split(".").length>=2,L=O&&2===N.split(".").length,F=t.hostedUrl.replace(/^https:\/\//,""),W=t.apexProxy,$="replit-verify=".concat(t.id),q=(0,H.H)();return(0,a.BX)(M.G7,{css:[M.l0.colWithGap(16)],children:[(0,a.BX)(M.G7,{css:[M.l0.colWithGap(8)],children:[(0,a.tZ)(M.h4,{level:2,variant:"subheadDefault",children:"New Domain Link"}),(0,a.BX)(M.xv,{multiline:!0,children:["Learn more"," ",(0,a.tZ)("a",{href:"https://docs.replit.com/hosting/hosting-web-pages#custom-domains",target:"_blank",children:"here"}),"."]})]}),(0,a.BX)(M.G7,{css:[M.l0.colWithGap(4)],children:[(0,a.tZ)("label",{htmlFor:q("domain"),children:(0,a.tZ)(M.xv,{color:"dimmer",variant:"small",children:"Step 1: Enter your domain"})}),(0,a.tZ)(M.II,{className:"cname-url",readOnly:"loading"===f,value:N,onChange:function(e){j(e.target.value)},onBlur:function(){!function(){try{var e=new URL("/",N);j(e.hostname)}catch(t){}}()},placeholder:"example.com",id:q("domain")})]}),L&&!w?(0,a.BX)(M.G7,{css:[M.l0.colWithGap(8)],children:[(0,a.BX)(M.G7,{css:[M.l0.colWithGap(4)],children:[(0,a.tZ)("label",{htmlFor:q("record"),children:(0,a.BX)(M.xv,{color:"dimmer",variant:"small",children:["Step 2: Add an ",(0,a.tZ)("code",{children:"A"})," Record"]})}),(0,a.BX)(M.G7,{css:[M.l0.rowWithGap(8),M.l0.align.center],children:[(0,a.tZ)(M.xv,{css:{fontFamily:M.TV.fontFamilyCode,maxWidth:"40%"},children:N}),(0,a.tZ)(M.xv,{css:{fontFamily:M.TV.fontFamilyCode},children:"A"}),(0,a.tZ)(M.II,{readOnly:!0,ref:T,onChange:function(){return null},value:W,onFocus:function(){return P(T)},id:q("record")}),(0,a.tZ)(M.zx,{onClick:function(){return D(T)},text:"Copy"})]})]}),(0,a.tZ)(M.G7,{css:[M.l0.flex.row,M.l0.align.stretch],children:(0,a.tZ)(M.zx,{outlined:!0,onClick:function(){return k(!0)},text:"Use CNAME record instead."})})]}):null,!O||!w&&L?null:(0,a.BX)(M.G7,{css:[M.l0.colWithGap(4)],children:[(0,a.tZ)("label",{htmlFor:q("CNAMERecord"),children:(0,a.BX)(M.xv,{color:"dimmer",variant:"small",children:["Step 2: Add a ",(0,a.tZ)("code",{children:"CNAME"})," Record"]})}),(0,a.BX)(M.G7,{css:[M.l0.rowWithGap(8),M.l0.align.center],children:[(0,a.tZ)(M.xv,{css:{fontFamily:M.TV.fontFamilyCode,maxWidth:"40%"},children:N}),(0,a.tZ)(M.xv,{css:{fontFamily:M.TV.fontFamilyCode},children:"CNAME"}),(0,a.tZ)(M.II,{readOnly:!0,ref:I,onChange:function(){return null},value:F,onFocus:function(){return P(I)},id:q("CNAMERecord")}),(0,a.tZ)(M.zx,{onClick:function(){return D(I)},text:"Copy"})]}),L?(0,a.BX)(M.G7,{css:[M.l0.colWithGap(8)],children:[(0,a.tZ)(M.xv,{variant:"small",multiline:!0,children:'Note: this CNAME record requires that your DNS provider supports CNAMEs for apex domains - for example Cloudflare with "CNAME Flattening".'}),(0,a.tZ)(M.G7,{css:[M.l0.flex.row,M.l0.align.stretch],children:(0,a.tZ)(M.zx,{onClick:function(){return k(!1)},text:"Use A record instead",outlined:!0})})]}):null]}),O?(0,a.BX)(M.G7,{css:[M.l0.colWithGap(4)],children:[L?(0,a.tZ)("label",{htmlFor:q("txtRecord"),children:(0,a.BX)(M.xv,{color:"dimmer",variant:"small",children:["This domain also requires a ",(0,a.tZ)("code",{children:"TXT"})," Record"]})}):(0,a.BX)("label",{children:['If you are using a service like Cloudflare (with "orange cloud") that rewrites domain records, you can add a ',(0,a.tZ)("code",{children:"TXT"})," ","Record for verification purposes."]}),(0,a.BX)(M.G7,{css:[M.l0.rowWithGap(8),M.l0.align.center],children:[(0,a.tZ)(M.xv,{css:{fontFamily:M.TV.fontFamilyCode,maxWidth:"40%"},children:N}),(0,a.tZ)(M.xv,{css:{fontFamily:M.TV.fontFamilyCode},children:"TXT"}),(0,a.tZ)(M.II,{readOnly:!0,ref:_,onChange:function(){return null},value:$,onClick:function(){return P(_)},id:q("txtRecord")}),(0,a.tZ)(M.zx,{onClick:function(){return D(_)},text:"Copy"})]})]}):null,"loading"===f?(0,a.tZ)(M.G7,{css:[M.l0.colWithGap(12),M.l0.pt(16)],children:(0,a.tZ)(Q,{replId:t.id,domain:N,onVerified:function(){return B("verified")},onError:function(){return B("error")}})}):null,"verified"===f?(0,a.tZ)(M.G7,{css:[M.l0.colWithGap(12),M.l0.pt(16)],children:(0,a.tZ)(M.xv,{children:"Your domain has been verified."})}):null,"error"===f||b?(0,a.tZ)(M.G7,{css:[M.l0.colWithGap(12),M.l0.pt(16)],children:(0,a.BX)(M.xv,{children:["Creating the domain link failed",b?": "+b:"","."]})}):null,(0,a.BX)(M.G7,{css:[M.l0.rowWithGap(12),M.l0.justify.end],children:[(0,a.tZ)(M.zx,{onClick:s,text:"Close"}),O&&null===f?(0,a.tZ)(M.zx,{disabled:m,onClick:function(){v(!0),x(null),S({variables:{replId:t.id,domain:N}}).then((function(e){var t,n=(null===(t=e.data)||void 0===t?void 0:t.linkReplDomain2)||null;"Repl"===(null===n||void 0===n?void 0:n.__typename)||"ServiceUnavailable"===(null===n||void 0===n?void 0:n.__typename)?(x(null),B("loading")):("NotFoundError"!==(null===n||void 0===n?void 0:n.__typename)&&"UnauthorizedError"!==(null===n||void 0===n?void 0:n.__typename)||x(null===n||void 0===n?void 0:n.message),B("error")),v(!1),l()})).catch((function(e){v(!1),x(e.message)}))},text:"".concat(m?"Linking domain...":"Link domain"),iconLeft:(0,a.tZ)(V.Z,{}),colorway:"primary"}):null]})]})}function Q(e){var t,n=e.domain,i=e.replId,c=e.onVerified,s=e.onError,l=function(e){var t=(0,r.Z)({},U,e);return R.useQuery(O,t)}({variables:{replId:i,domain:n},pollInterval:1e3}),u=l.data,f=l.stopPolling;if((0,o.useEffect)((function(){var e,t;if(u&&"Repl"===u.repl.__typename){var n=u.repl;if("NotFoundError"!==(null===(e=n.checkDomain2)||void 0===e?void 0:e.__typename)){if("DomainStatus2"===(null===(t=n.checkDomain2)||void 0===t?void 0:t.__typename)){var r=n.checkDomain2,i=r.retry,a=r.verified;a||i?(!a&&i||f(),a&&c()):s()}}else s()}}),[u,f,c,s]),"Repl"===(null===u||void 0===u?void 0:u.repl.__typename)&&u.repl.checkDomain2){var p,h,m,v="DomainStatus2"===u.repl.checkDomain2.__typename?u.repl.checkDomain2:null,g=null;if(null===v||void 0===v?void 0:v.records){var b=v.records;b.__typename;g=(0,S.Z)(b,["__typename"])}var x,Z=null;if(!(null===v||void 0===v?void 0:v.status))"ServiceUnavailable"===(null===(x=u.repl.checkDomain2)||void 0===x?void 0:x.__typename)&&(Z=u.repl.checkDomain2.message),Z||(Z="DNS updates can take up to 48 hours to fully synchronize. Feel free to check back later.");return(0,a.BX)(M.G7,{css:[M.l0.colWithGap(16),M.l0.justify.spaceBetween],children:[(0,a.BX)(M.G7,{css:[M.l0.rowWithGap(16),M.l0.align.center],children:[(0,a.tZ)("div",{css:[M.l0.width("20px"),M.l0.height("20px"),{aspectRatio:"1 / 1"},{borderRadius:"100%"},{borderRadius:"100%"},{borderStyle:"solid"},{borderWidth:"3px"},{borderColor:M.TV.accentPrimaryDimmer},{borderTopColor:M.TV.accentPrimaryDefault},{transform:"rotate(0deg)"},{animation:"linear domain-loading 1s infinite"}],className:"jsx-4e6cc6caecb799c9"}),(0,a.tZ)("div",{className:"jsx-4e6cc6caecb799c9",children:Z})]}),g||"DomainStatus2"===(null===(p=u.repl.checkDomain2)||void 0===p?void 0:p.__typename)&&(null===(h=u.repl.checkDomain2)||void 0===h?void 0:h.retry)||"ServiceUnavailable"===(null===(m=u.repl.checkDomain2)||void 0===m?void 0:m.__typename)?(0,a.BX)(M.G7,{children:[(0,a.tZ)("br",{className:"jsx-4e6cc6caecb799c9"}),g?(0,a.BX)(M.G7,{children:["Currently, your domain\u2019s records show:",(0,a.tZ)("pre",{css:[M.l0.overflow("scroll")],className:"jsx-4e6cc6caecb799c9",children:Object.entries(g).map((function(e){var t=(0,y.Z)(e,2),r=t[0],i=t[1];return null===i||void 0===i?void 0:i.map((function(e){return(0,a.BX)("div",{className:"jsx-4e6cc6caecb799c9",children:[n," ",r," ",e]},"{domain}-{dnsType}")}))}))})]}):(0,a.tZ)(M.xv,{multiline:!0,children:"Currently, your domain is either not returning any records, or something is getting in the way of our verification process."})]}):null,(0,a.tZ)(d(),{id:"4e6cc6caecb799c9",children:"@-webkit-keyframes domain-loading{from{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes domain-loading{from{-moz-transform:rotate(0deg);transform:rotate(0deg)}to{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes domain-loading{from{-o-transform:rotate(0deg);transform:rotate(0deg)}to{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes domain-loading{from{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}"})]})}return"Repl"===(null===u||void 0===u?void 0:u.repl.__typename)&&"NotFoundError"===(null===(t=u.repl.checkDomain2)||void 0===t?void 0:t.__typename)?(0,a.tZ)(a.HY,{children:"We ran into an internal error while checking the domain. Please try again later."}):null}function K(e){var t=e.replId,n=e.domain,i=e.onUnlink,c=e.onGoBack,s=(0,y.Z)(function(e){var t=(0,r.Z)({},U,e);return R.useMutation(L,t)}({variables:{input:{id:t,removeDomain:n}}}),2),l=s[0],u=s[1];return(0,o.useEffect)((function(){u.data&&u.data.updateRepl.repl&&i()}),[u.data,i]),(0,a.BX)(M.G7,{css:[M.l0.colWithGap(16)],children:[(0,a.BX)(M.G7,{css:[M.l0.colWithGap(8)],children:[(0,a.tZ)(M.h4,{level:3,variant:"subheadDefault",children:"Domain Unlinking"}),(0,a.BX)(M.xv,{multiline:!0,children:["Are you sure you want to unlink"," ",(0,a.tZ)("a",{target:"_blank",rel:"noopener",href:"https://"+n,children:n}),"?"]})]}),(0,a.BX)(M.G7,{css:[M.l0.rowWithGap(12),M.l0.justify.end],children:[(0,a.tZ)(M.zx,{onClick:c,text:"Cancel"}),(0,a.tZ)(M.zx,{onClick:function(){u.loading||l()},text:u.loading?"Unlinking domain...":"Yes, unlink this domain",colorway:"negative",iconLeft:(0,a.tZ)($.Z,{}),disabled:u.loading})]})]})}function Y(e){var t=e.replId,n=e.onUnlink,i=e.onLink,c=function(e){var t=(0,r.Z)({},U,e);return R.useQuery(B,t)}({variables:{replId:t}}),s=c.data,l=c.loading,u=c.refetch,d=(0,o.useState)("listing"),f=d[0],p=d[1],h=(0,o.useState)(null),m=h[0],v=h[1],g=null;if(l)g=(0,a.tZ)(a.HY,{children:"loading..."});else if(s&&"Repl"===s.repl.__typename){var b=s.repl;"listing"===f?g=(0,a.BX)(M.G7,{css:[M.l0.colWithGap(16)],children:[b.domains&&(0===b.domains.length?(0,a.tZ)(M.xv,{children:"No domains are currently linked."}):(0,a.BX)(M.G7,{children:[(0,a.tZ)(M.h4,{level:3,variant:"subheadDefault",children:"Currently Linked Domains"}),(0,a.tZ)(M.G7,{css:[M.l0.colWithGap(8)],children:b.domains.map((function(e){return e?(0,a.tZ)(M.G7,{children:(0,a.BX)(M.G7,{css:[M.l0.rowWithGap(12),M.l0.justify.spaceBetween,M.l0.align.center],children:[(0,a.BX)(M.xv,{children:[e.domain,": ",e.state,"..."]}),(0,a.BX)(M.G7,{css:[M.l0.rowWithGap(12),M.l0.justify.end,M.l0.align.center],children:[(0,a.tZ)(M.zx,{text:"Unlink",onClick:function(){v(e.domain),p("unlinking")}}),"verified"!==e.state?(0,a.tZ)(M.zx,{text:"Check status",onClick:function(){v(e.domain),p("linking")}}):null]})]})},e.domain):null}))})]})),(0,a.tZ)(M.zx,{text:"Create Domain Link",onClick:function(){return p("linking")},iconLeft:(0,a.tZ)(W.Z,{})})]}):"linking"===f?g=(0,a.tZ)(q,{repl:b,existingDomain:m,onLink:i,onGoBack:function(){p("listing"),v(null)},onLinkStarted:u,onStateChanged:u}):"unlinking"===f&&null!==m&&(g=(0,a.tZ)(K,{replId:b.id,domain:m,onUnlink:function(){u(),n()},onGoBack:function(){p("listing"),v(null)}}))}else s&&"ReplRedirect"===s.repl.__typename?g=(0,a.BX)("div",{children:["This repl has moved to"," ",(0,a.tZ)("a",{href:s.repl.replUrl,children:s.repl.replUrl})]}):s&&"SubscriptionExpiredError"===s.repl.__typename&&(g=(0,a.tZ)("div",{children:"Subscription expired"}));return(0,a.BX)(M.G7,{css:[M.l0.colWithGap(24)],children:[(0,a.tZ)(M.h4,{level:1,variant:"headerDefault",children:"Domain Linking"}),g]})}var J=n(40381),ee=n(76945),te=n(29163),ne=(0,o.forwardRef)((function(e,t){return(0,a.tZ)(te.Z,(0,r.Z)({ref:t,className:e.className,css:[{color:"var(--foreground-dimmest)",":hover":{color:"var(--foreground-default)"}},e.css]},e))})),re=n(31980),ie=new Set(["draw.js"]);var ae=function(e){var t=e.iframe,n=(0,l.Z)();return o.useEffect((function(){var e="https://".concat(n,".id.repl.co"),t=function(t){if(t.origin===e&&"DOWNLOAD"===t.data.action){var n=document.createElement("a");document.body.appendChild(n),n.setAttribute("style","display: none"),n.href=t.data.url,n.download=t.data.filename,n.click(),document.body.removeChild(n)}};return window.addEventListener("message",t),function(){window.removeEventListener("message",t)}}),[n]),(0,a.BX)(a.HY,{children:[(0,a.tZ)(ne,{alt:"Save image",onClick:function(){var e,n;null===(e=t.current)||void 0===e||null===(n=e.contentWindow)||void 0===n||n.postMessage({action:"REQUEST_SCREENSHOT"},"*")},children:(0,a.tZ)(ee.Z,{})}),(0,a.tZ)(ne,{alt:"Toggle Record",onClick:function(){var e,n;null===(e=t.current)||void 0===e||null===(n=e.contentWindow)||void 0===n||n.postMessage({action:"REQUEST_TOGGLE_RECORD"},"*")},children:(0,a.tZ)(re.Z,{})})]})},oe=n(18374),ce=n(70804),se=n(40963),le=n(70917),ue=n(12215),de=n(24897),fe=n(37497),pe=n(78597);var he={id:"DevToolsIntro",title:"Try our new devtools",content:function(){return(0,a.BX)(b.ZP,{css:x.l0.m(2),children:["No need to reach for your browser\u2019s console. You can now:",(0,a.BX)(b.ZP,{tag:"ul",css:[x.l0.px(16),x.l0.py(8),{listStyle:"disc",lineHeight:1.7}],children:[(0,a.tZ)("li",{children:"Explore the DOM tree"}),(0,a.tZ)("li",{children:"View console logs"}),(0,a.tZ)("li",{children:"Run JavaScript"}),(0,a.tZ)("li",{children:"Inspect localStorage"}),(0,a.tZ)("li",{children:"and more!"})]}),"\u2026directly from our brand new devtools. Press this button to toggle it."]})}};function me(e){var t=e.targetElement,n=function(e){var t=(0,pe.Pp)({variables:{tours:e}}).data;return o.useMemo((function(){var n,r,i;return null===(i=null===t||void 0===t||null===(n=t.currentUser)||void 0===n||null===(r=n.toursSeen)||void 0===r?void 0:r.find((function(t){return t.id===e})))||void 0===i?void 0:i.seen}),[t,e])}("workspace-desktop-tour"),r=(0,ue.Z)("workspace","devtools-intro"),i=r.shouldDisplay,c=r.register,s=r.dismiss;return o.useEffect((function(){c()}),[c]),!0===n&&t&&i?(0,a.BX)(a.HY,{children:[(0,a.tZ)(de.w,{targetElement:t}),(0,a.tZ)(fe.k,{placement:"bottom-start",targetElement:t,activeStep:he,currentStepIndex:0,done:s,goto:function(){},totalSteps:1,disableAnimation:!0})]}):null}var ve=n(13331),ge=(0,le.F4)("from{transform:rotate(0deg);}to{transform:rotate(359deg);}");function be(e){var t=e.refreshing,n=e.devToolsBadge,r=e.url,i=e.onToggleDevtools,c=o.useRef(null),s=(0,y.Z)(o.useState(!1),2),l=s[0],u=s[1];return(0,a.BX)(b.ZP,{css:[x.l0.rowWithGap(8),x.l0.p(8),x.l0.align.center],children:[(0,a.tZ)(ne,{alt:t?"Refreshing...":"Refresh",onClick:e.onRefresh,css:t&&{animation:"".concat(ge," infinite 0.5s")},children:(0,a.tZ)(k.Z,{})}),(0,a.tZ)(se.ZP,{dataCy:"ws-webvew-url-bar-input",css:[x.l0.px(4),x.l0.py(2),x.l0.flex.growAndShrink(1),x.l0.fontSize(12)],value:r,type:"text",onFocus:function(t){e.trackUrlSelect(),t.currentTarget.select()},readOnly:!0}),(0,a.BX)(b.ZP,{css:[x.l0.rowWithGap(4)],children:[e.canEditDomain&&(0,a.BX)(ce.Z,{showArrow:!0,maxWidth:520,isOpen:l,onClickOutside:function(){return u(!1)},growToMaxWidth:!0,children:[(0,a.tZ)(ne,{alt:"Custom domain",onClick:function(){return u(!l)},children:(0,a.tZ)(w.Z,{})}),(0,a.tZ)(Y,{onLink:function(){return u(!1)},onUnlink:function(){return u(!1)},replId:e.replId})]}),i&&(0,a.tZ)(ne,{alt:"Toggle developer tools",ref:c,onClick:i,css:{position:"relative"},suffix:!!n&&(0,a.tZ)("span",{css:{position:"absolute",color:x.TV.accentNegativeStrongest,borderRadius:x.TV.borderRadiusRound,padding:"".concat(x.TV.space2," ").concat(x.TV.space4),backgroundColor:x.TV.accentNegativeDimmer,top:-5,right:-3,fontSize:9},children:n}),children:(0,a.tZ)(oe.Z,{})}),(0,a.tZ)("a",{href:r,css:{color:"inherit"},target:"_blank",children:(0,a.tZ)(ne,{alt:"Open in a new tab",children:(0,a.tZ)(E.Z,{})})}),e.isKaboomDraw&&e.iframe&&(0,a.tZ)(ae,{iframe:e.iframe}),e.onDeployment?(0,a.tZ)(ne,{alt:"Deploy",onClick:e.onDeployment,children:(0,a.tZ)(ve.Z,{})}):null]}),i&&e.isVisible?(0,a.tZ)(me,{targetElement:c.current}):null]})}var xe=n(48920),Ze=n(99408),ye=n(7787);var we=n(39571),ke=n(43804),Ee=n(34385),Se=n(83241);function Ce(){return o.useEffect((function(){(0,m.j)(m.U3.WS_WEBVIEW_CIRCUIT_BROKEN)}),[]),(0,a.tZ)(M.G7,{css:[M.l0.align.center,M.l0.p(32)],children:(0,a.BX)(M.G7,{css:[M.l0.align.center,M.l0.p(32)],children:[(0,a.BX)(M.G7,{css:[M.l0.align.center],children:[(0,a.tZ)(p.Z,{level:1,children:"\ud83d\ude48"}),(0,a.tZ)(p.Z,{level:4,children:"We've detected a crash loop"}),(0,a.tZ)(p.Z,{level:4,foreground:2,children:"Website preview is disabled until you click run button again."})]}),(0,a.BX)(M.G7,{css:[M.l0.p(16)],children:[(0,a.tZ)(M.xv,{css:[M.l0.color.foregroundDimmer,M.l0.pb(16)],children:"Why this might be happening:"}),(0,a.BX)("ul",{css:[{listStylePosition:"inside"}],children:[(0,a.tZ)("li",{css:M.l0.pb(16),children:(0,a.tZ)(M.xv,{css:M.l0.color.foregroundDimmer,children:"There are errors in the code and Website preview is trying to reconnect to the repl and restarting it."})}),(0,a.tZ)("li",{css:M.l0.pb(16),children:(0,a.tZ)(M.xv,{css:M.l0.color.foregroundDimmer,children:"Please fix the errors and click run button again."})})]})]})]})})}var Te=function(e,t){var n=e.fs,u=e.session,d=e.trackUrlSelect,f=e.isVisible,p=e.className,h=e.onDeployment,w=(0,l.Z)(),k=(0,s.I5)({variables:{id:w}}).data,E="Repl"===(null===k||void 0===k?void 0:k.repl.__typename)?k.repl:null,S=(0,o.useContext)(g),C=function(){var e=(0,Ze.Z)().runner,t=(0,y.Z)(o.useState(!1),2),n=t[0],r=t[1];return o.useEffect((function(){if("shellrunner"===e.mode){var t,n=[],i=Date.now(),a=Array(10),o=0;return n.push(e.onLocalRun((function(){i=Date.now(),r(!1)}))),n.push(e.onStateChanged((function(e){if(t===xe.A.RUNNING&&e===xe.A.IDLE){var n=Date.now();a[o%10]=n;var c=a.at((o-9)%10);void 0!==c&&n-c<6e4&&null!=i&&i<c&&(r(!0),ye.kg.info("webview circuit broken",{lastRunnerStops:JSON.stringify(a),runnerStopCount:o,lastLocalRunTimestamp:i})),o++,t=e}else t=e}))),function(){r(!1),n.forEach((function(e){return e()}))}}}),[e,r]),{isCircuitBroken:n}}().isCircuitBroken,T=(0,o.useRef)(null),R=(0,o.useState)(!1),_=R[0],I=R[1],P=(0,o.useState)(0),D=P[0],A=P[1],N=(0,Z.f6)();!function(e,t){var n=(0,Z.f6)(),r=(0,J.Z)(),i=o.useCallback((function(e,n){var r,i;null===(r=t.current)||void 0===r||null===(i=r.contentWindow)||void 0===i||i.postMessage({action:"FILE_UPDATE",file:e,content:n},"*")}),[t]);o.useEffect((function(){if(t.current&&n){var r=!0,a=!1,o=void 0;try{for(var c,s=function(){var n=c.value;t.current.onload=function(){e.readFile(n).then((function(e){e.error||i(n,e.content.toString())}))}},l=ie[Symbol.iterator]();!(r=(c=l.next()).done);r=!0)s()}catch(u){a=!0,o=u}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}}}),[e,i,t,n]),o.useEffect((function(){if(n&&r&&ie.has(r))return e.watchOtFile(r,{onReady:function(e){var t=e.initialContent;return i(r,t.toString())},onChange:function(e){var t=e.latestContent;return i(r,t)}})}),[e,r,i,n])}(n,T);var U="html"===(null===E||void 0===E?void 0:E.lang.id)||"html_beta"===(null===E||void 0===E?void 0:E.lang.id),j=null;j=E?S?(0,a.tZ)(v,{}):C?(0,a.tZ)(Ce,{}):(0,a.tZ)("iframe",(0,r.Z)({title:"webview","data-cy":"ws-webview",ref:T,src:E.devUrl,css:[x.l0.flex.growAndShrink(1),{border:"none",display:"block",backgroundColor:x.TV.white}]},Se.Z)):null,(0,o.useEffect)((function(){var e=function(e){var t;if((new URL(e.origin).hostname.endsWith(".id.repl.co")||new URL(e.origin).hostname.endsWith(".id.firewalledreplit.co"))&&"object"===typeof e.data&&(null===(t=e.data)||void 0===t?void 0:t.type))switch(e.data.type){case"event":var n=e.data,a=n.event,o=n.payload;return void("error"===a?c.Tb(o):(0,m.j)(a,(0,i.Z)((0,r.Z)({},o),{replId:w,isHTML:U})));case"show-badge":return void A(e.data.count);case"ready":var s,l;if(e.data.wasShown)null===(s=T.current)||void 0===s||null===(l=s.contentWindow)||void 0===l||l.postMessage({type:"toggleDevtools",source:"automatic"},"*");return;case"open-file":var d=(0,we.om)(e.data.fileName)||e.data.fileName;d&&u.updateDeeplink({path:d,line:e.data.lineNumber,col:e.data.columnNumber})}};if(T.current)return window.addEventListener("message",e),function(){window.removeEventListener("message",e)}}),[w,U,T.current,u]);var B=function(){A(0),I(!0),n.flush().then((function(){T.current&&(T.current.src+="")})).finally((function(){I(!1)}))};(0,o.useImperativeHandle)(t,(function(){return{refresh:B}}));var O=(0,Ee.Z)(ke.H.Output);return E?(0,a.BX)(b.ZP,{className:p,css:[x.l0.backgroundColor.backgroundDefault,x.l0.height("100%"),x.l0.borderRadius(4),{overflow:"hidden"}],innerRef:U?O:function(){},children:[(0,a.tZ)(be,{canEditDomain:E.currentUserPermissions.linkDomain,anon:E.devUrl.includes("--five-nine.repl.co"),url:E.config.domain?"https://".concat(E.config.domain):E.prodUrl,trackUrlSelect:function(){d&&d(E.devUrl)},replId:w,refreshing:_,onRefresh:B,isKaboomDraw:N,iframe:T,isVisible:f,devToolsBadge:D,onToggleDevtools:function(){var e,t;A(0),null===(e=T.current)||void 0===e||null===(t=e.contentWindow)||void 0===t||t.postMessage({type:"toggleDevtools",source:"manual"},"*")},onDeployment:h}),j]}):null},Re=(0,o.forwardRef)(Te)},2581:function(e,t,n){n.d(t,{VD:function(){return l},d8:function(){return o},uN:function(){return s}});var r=n(10253),i=n(91131),a=n(67294),o=Symbol("CodeEditorView"),c=(0,i.cn)(null);function s(){return(0,i.KO)(c,o)[0]}function l(e){var t=(0,r.Z)((0,i.KO)(c,o),2),n=t[0],s=t[1];(0,a.useEffect)((function(){n!==e&&s(e)}),[e,n,s])}},89390:function(e,t,n){n.d(t,{P:function(){return f},Z:function(){return h}});var r=n(47568),i=n(34051),a=n.n(i),o=n(11163),c=n.n(o),s=n(67294),l=n(37452),u=n(25602),d=n(63377);var f=function(){var e=(0,r.Z)(a().mark((function e(t,n,r,i){var o,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.W)({fs:t,dotReplit:r,replId:i});case 2:o=e.sent,(c=o.entrypoint)&&n.openFile(c);case 5:case"end":return e.stop()}}),e)})));return function(t,n,r,i){return e.apply(this,arguments)}}(),p=function(){var e=(0,r.Z)(a().mark((function e(t,n){var r,i,o,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,u.u9)()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,u.mv)(t);case 4:if(r=e.sent,i=r.path,o=r.line,c=r.col,i){e.next=10;break}return e.abrupt("return");case 10:i!==n.getActiveFile()&&n.openFile(i),n.updateDeeplink({path:i,line:o,col:c});case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function h(e,t,n){var i=(0,d.Z)(),o=(0,s.useRef)(!1);(0,s.useEffect)((function(){return t.onDeeplinkUpdated((function(e){var t=function(e){var t=e.path,n=e.line,r=e.col,i="#".concat(t);return n?r?"".concat(i,":").concat(n,":").concat(r):"".concat(i,":").concat(n):i}(e);window.location.hash=t}))}),[t]),(0,s.useEffect)((function(){(0,r.Z)(a().mark((function r(){return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!t.getActiveFile()){r.next=2;break}return r.abrupt("return");case 2:return r.next=4,p(e,t);case 4:t.getActiveFile()||f(e,t,n,i);case 5:case"end":return r.stop()}}),r)})))()}),[e,t,n,i]),(0,s.useEffect)((function(){var n=function(){var n=(0,r.Z)(a().mark((function n(){return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!o.current){n.next=3;break}return o.current=!1,n.abrupt("return");case 3:return n.next=5,p(e,t);case 5:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return window.addEventListener("hashchange",n),function(){window.removeEventListener("hashchange",n)}}),[e,t]),(0,s.useEffect)((function(){return t.onSessionStateChanged((0,r.Z)(a().mark((function n(){var r,i,s;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.getActiveFile()){n.next=3;break}return n.abrupt("return");case 3:if(!(0,u.u9)()){n.next=10;break}return n.next=6,(0,u.mv)(e);case 6:if(i=n.sent,i.path!==r){n.next=10;break}return n.abrupt("return");case 10:o.current=!0,window.location.hash.length>0?t.updateDeeplink({path:r}):(s=c().asPath.includes("#")?c().asPath.slice(0,c().asPath.indexOf("#")):c().asPath,c().replace({pathname:c().pathname,query:c().query},"".concat(s,"#").concat(r),{shallow:!0}));case 12:case"end":return n.stop()}}),n)}))))}),[e,t])}},40005:function(e,t,n){n.d(t,{u:function(){return m}});var r=n(47568),i=n(10253),a=n(34051),o=n.n(a),c=n(67294),s=n(6625),l=n(99408),u=n(65977),d=n(30345),f=n(88812),p=n(65456),h=function(e){var t=e.split("/");if(1===t.length)return t;for(var n=[],r=0;r<t.length;r++)n.push(t.slice(0,r+1).join("/"));return n},m=function(){var e=(0,l.Z)().fs,t=(0,u.O)(),n=(0,s.Z)(),a=(0,i.Z)(c.useState(null),2),m=a[0],v=a[1];return c.useEffect((function(){var i=function(){var i=(0,r.Z)(o().mark((function r(){var i,a,c,s;return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t){r.next=2;break}return r.abrupt("return");case 2:return r.next=4,e.listFiles();case 4:if(i=r.sent,n.current){r.next=7;break}return r.abrupt("return");case 7:if(!i.error&&i.files){r.next=10;break}return v([]),r.abrupt("return");case 10:return r.next=12,e.readFile(f.l);case 12:a=r.sent,c=i.files,s=d.uP.concat(d.nh),v(c.filter((function(e){return(a.error===p.Df.NotFound||!t.some((function(t){return h(e).some((function(e){return t.test(e)}))})))&&!s.includes(e)})));case 16:case"end":return r.stop()}}),r)})));return function(){return i.apply(this,arguments)}}();i()}),[t,e,n]),m}},60573:function(e,t,n){n.d(t,{Z:function(){return c}});var r=n(31826),i=n(63805),a=n(86292),o=n(21131);function c(){return(0,o.Z)((function(){return(0,r.Z)((function(e){(0,a.j)(a.U3.WS_TYPED,{fileExt:e,isMobile:(0,i.isMobile)({tablet:!1})})}),6e4)}),[])}},9117:function(e,t,n){n.d(t,{h:function(){return u},x:function(){return l}});var r=n(29815),i=n(67294),a=n(61927),o=n(10129),c=n(91131),s=(0,c.cn)([]);function l(e,t){var n=t.run,a=t.enabled,o=void 0===a||a,l=(0,c.b9)(s);(0,i.useEffect)((function(){if(o){var t={shortcut:e,run:n};return l((function(e){return(0,r.Z)(e).concat([t])})),function(){l((function(e){return e.filter((function(e){return e!==t}))}))}}}),[e,n,l,o])}function u(){var e=(0,c.Dv)(s);return(0,i.useEffect)((function(){var t=function(t){(0,a.b)(t);var n=!0,r=!1,i=void 0;try{for(var c,s=e[Symbol.iterator]();!(n=(c=s.next()).done);n=!0){var l,u=c.value,d=u.shortcut,f=u.run;d.cmdOrCtrlKey===Boolean((0,o.j)(t))&&d.altKey===Boolean(t.altKey)&&d.shiftKey===Boolean(t.shiftKey)&&(null===(l=d.key)||void 0===l?void 0:l.toLowerCase())===t.key.toLowerCase()&&(t.preventDefault(),f())}}catch(p){r=!0,i=p}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}};return document.addEventListener("keydown",t),function(){document.removeEventListener("keydown",t)}}),[e]),null}},9583:function(e,t,n){n.d(t,{YI:function(){return U},kW:function(){return N}});var r,i=n(26042),a=n(69396),o=n(35944),c=n(60536),s=n.n(c),l=(n(67294),n(44781));!function(e){e.TEXT="TEXT",e.MENTION="MENTION",e.LINK="LINK",e.REPL_LINK="REPL_LINK",e.DEEP_LINK="DEEP_LINK",e.CODE="CODE",e.BOLD="BOLD",e.ITALICS="ITALICS",e.STRIKETHROUGH="STRIKETHROUGH",e.QUOTE="QUOTE"}(r||(r={}));var u=function(e){var t=e.fragment,n=e.onClick;return(0,o.tZ)(l.Z,{size:"small",onClick:n,children:t.content})},d=function(e){var t=e.fragment,n=e.onClick;return(0,o.tZ)(l.Z,{size:"small",fontWeight:"medium",onClick:n,children:t.content})},f=function(e){var t=e.fragment,n=e.onClick;return(0,o.tZ)("a",{href:t.url,onClick:n,rel:"noreferrer noopener nofollow",target:"_blank",children:t.content})},p=function(e){var t=e.fragment,n=e.onClick;return(0,o.tZ)("a",{href:t.url,onClick:n,target:"_blank",children:t.content})},h=function(e){var t=e.fragment,n=e.onClick;return(0,o.tZ)("a",{href:t.url,onClick:n,children:t.content})},m=function(e){var t=e.fragment,n=e.onClick,r=e.style;return(0,o.tZ)("code",{onClick:n,style:r,children:t.content})},v=function(e){var t=e.fragment,n=e.onClick;return(0,o.tZ)("b",{onClick:n,children:t.content})},g=function(e){var t=e.fragment,n=e.onClick;return(0,o.tZ)("i",{onClick:n,children:t.content})},b=function(e){var t=e.fragment,n=e.onClick;return(0,o.BX)("span",{onClick:n,className:"jsx-e2f6e2707e7599fa",children:[t.content,(0,o.tZ)(s(),{id:"e2f6e2707e7599fa",children:"span.jsx-e2f6e2707e7599fa{text-decoration:line-through}"})]})},x=function(e){var t=e.fragment,n=e.onClick;return(0,o.BX)("blockquote",{onClick:n,className:"jsx-8741a91fadaf26be",children:[t.content,(0,o.tZ)(s(),{id:"8741a91fadaf26be",children:"blockquote.jsx-8741a91fadaf26be{border-left:2px solid var(--foreground-dimmest);padding-left:6px;color:var(--foreground-dimmest)}"})]})},Z=/(@[0-9a-zA-Z_]+)/,y=/(#[-a-zA-Z0-9@:%._+~#=/]+)/,w=/(https?:\/\/[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{2,6}\b(?:[-a-zA-Z0-9()@:%_+.~#?&//=]*))/,k=/(`.+?`)/,E=/(\*\*.+?\*\*)/,S=/(_.+?_)/,C=/(\*.+?\*)/,T=/(~~.+?~~)/,R=/(^>.+?$\n?)/m,_=/\/@([0-9a-zA-Z_]+)\/(.+)/;function I(e){var t=e.url;return{type:r.LINK,url:t,content:t}}function P(e){var t=e.hash;return{type:r.DEEP_LINK,url:t,content:t}}function D(e,t){if(w.test(e)){var n={};try{n=new window.URL(e)}catch(a){return{content:e,type:r.TEXT}}return["repl.it","replit.com","firewalledreplit.com",document.location.host].includes(n.host)?n.pathname===t.replUrl?P({hash:n.hash}):_.test(n.pathname)?function(e){var t=e.url,n=_.exec(t.pathname);if(!n)throw new Error("Not a Repl URL");return{type:r.REPL_LINK,url:t.href,content:"@".concat(n[1],"/").concat(n[2]).concat(t.hash)}}({url:n}):I({url:e}):I({url:e})}if(y.test(e))return P({hash:e});if(R.test(e))return function(e){var t=e.text;return{type:r.QUOTE,content:t}}({text:e.slice(1).trim()});if(k.test(e))return function(e){var t=e.code;return{type:r.CODE,content:t}}({code:e.slice(1,-1)});if(E.test(e))return function(e){var t=e.text;return{type:r.BOLD,content:t}}({text:e.slice(2,-2)});if(S.test(e)||C.test(e))return function(e){var t=e.text;return{type:r.ITALICS,content:t}}({text:e.slice(1,-1)});if(T.test(e))return function(e){var t=e.text;return{type:r.STRIKETHROUGH,content:t}}({text:e.slice(2,-2)});if(Z.test(e)){var i=e.slice(1);if(!t.users||t.users.includes(i))return function(e){var t=e.username;return{type:r.MENTION,username:t,content:"@".concat(t)}}({username:i})}return{content:e,type:r.TEXT}}var A=new RegExp([k.source,E.source,S.source,C.source,T.source,w.source,Z.source,y.source,R.source].join("|"),"m");function N(e,t){var n=e.split(A),i=[],a=[],o=!0,c=!1,s=void 0;try{for(var l,u=n[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var d=l.value;if(d){var f=D(d,t);if(f){if(f.type===r.MENTION){if(!f.username)continue;i.push(f.username)}a.push(f)}}}}catch(p){c=!0,s=p}finally{try{o||null==u.return||u.return()}finally{if(c)throw s}}return{tokens:a,mentions:i}}function U(e){var t=e.message,n=e.onMentionClick,c=void 0===n?function(){}:n,s=e.codeStyles,l=void 0===s?{}:s;return(0,o.tZ)(o.HY,{children:t.tokens.map((function(e,t){var n={fragment:e,key:t};return e.type===r.MENTION?(0,o.tZ)(d,(0,a.Z)((0,i.Z)({},n),{onClick:function(){return c(e)}})):e.type===r.LINK?(0,o.tZ)(f,(0,i.Z)({},n)):e.type===r.REPL_LINK?(0,o.tZ)(p,(0,i.Z)({},n)):e.type===r.DEEP_LINK?(0,o.tZ)(h,(0,i.Z)({},n)):e.type===r.CODE?(0,o.tZ)(m,(0,a.Z)((0,i.Z)({},n),{style:l})):e.type===r.BOLD?(0,o.tZ)(v,(0,i.Z)({},n)):e.type===r.ITALICS?(0,o.tZ)(g,(0,i.Z)({},n)):e.type===r.STRIKETHROUGH?(0,o.tZ)(b,(0,i.Z)({},n)):e.type===r.QUOTE?(0,o.tZ)(x,(0,i.Z)({},n)):(0,o.tZ)(u,(0,i.Z)({},n))}))})}}}]);
//# sourceMappingURL=3243-f6a8ae9eaeeb6f17.js.map